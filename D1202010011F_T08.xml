<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="748" Id="D1202010011F_T08" Left="8" OnLoadCompleted="D1202010011F_T08_OnLoadCompleted" OnUnloadCompleted="D1202010011F_T08_OnUnloadCompleted" PidAttrib="7" Title="중점관리시설순찰점검등록_D1202010011F_T08" Top="8" Ver="1.0" Width="1260" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi_T08"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Faci"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FaciSave">
				<Contents>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIFT_WORK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Dub"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel"></Dataset>
		</Datasets>
		<Shape BKColor="user15" Bottom="23" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1251" TabOrder="1" Top="20" Type="Rectangle" Width="1246"></Shape>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static52" Left="110" Style="table" TabOrder="4" Top="338" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static0" Left="5" Style="table" TabOrder="3" Text="시설물번호" Top="338" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static1" Left="110" Style="table" TabOrder="7" Top="359" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static55" Left="5" Style="table" TabOrder="5" Text="구" Top="359" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static57" Left="317" Style="table" TabOrder="6" Text="시설명" Top="338" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static60" Left="629" Style="table" TabOrder="8" Text="공사번호" Top="338" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static61" Left="317" Style="table" TabOrder="9" Text="시공회사" Top="359" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="FACI_NUM" Enable="FALSE" Height="18" Id="edt_FaciNum" ImeMode="none" Left="143" Style="edit" TabOrder="10" Top="340" Width="171"></Edit>
		<Image Align="Left" Height="13" Id="Image9" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="11" Text="시설&#32;정보" Top="318" Width="117"></Image>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static50" Left="110" Style="table" TabOrder="12" Top="401" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static51" Left="5" Style="table" TabOrder="2" Text="시점&#32;주소" Top="401" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static5" Left="110" Style="table" TabOrder="14" Top="422" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="5" Style="table" TabOrder="13" Text="종점&#32;주소" Top="422" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static7" Left="110" Style="table" TabOrder="16" Top="380" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static8" Left="5" Style="table" TabOrder="15" Text="압력1" Top="380" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static11" Left="317" Style="table" TabOrder="17" Text="압력2" Top="380" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static12" Left="629" Style="table" TabOrder="18" Text="연장1(m)" Top="380" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="PIPE_PRESS_1" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="143" Style="edit" TabOrder="19" Top="382" Width="171"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static15" Left="110" Style="table" TabOrder="21" Top="443" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static14" Left="5" Style="table" TabOrder="20" Text="차단밸브번호&#32;1" Top="443" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="14" Id="Image0" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="22" Text="순찰점검&#32;등록" Top="471" Width="137"></Image>
		<Shape BKColor="user15" Bottom="494" Height="3" Id="Shape1" Left="5" LineWidth="0" Right="1251" TabOrder="24" Top="491" Type="Rectangle" Width="1246"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_FaciSave" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="743" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="249" Id="grd_MultiSave" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_MultiSave_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="23" TabStop="true" Top="494" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="232"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell bkcolor="user11" col="2" display="text" text="점검일자"/>
						<cell col="3" display="text" text="시설명"/>
						<cell bkcolor="user11" col="4" display="text" text="점검표등록여부"/>
						<cell col="5" display="text" text="특이사항"/>
						<cell col="6" display="text" text="점검자&#32;1"/>
						<cell col="7" display="text" text="점검자&#32;2"/>
						<cell col="8" display="text" text="점검자&#32;3"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell col="2" colid="PATROL_YMD" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="FACI_NM" display="text"/>
						<cell col="4" colid="CHK_YN" display="combo" expandimage="popup" expandshow="true"/>
						<cell col="5" colid="CHK_DESC" display="text"/>
						<cell align="center" col="6" colid="TAKER_EMPID1_NM" display="text"/>
						<cell align="center" col="7" colid="TAKER_EMPID2_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="8" colid="TAKER_EMPID3_NM" display="text" expandsize="18" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button276" ImageID="btn_8_Inquiry" Left="1124" LeftMargin="21" OnClick="btn_ImporRst_OnClick" Style="button" TabOrder="25" Text="순찰점검&#32;이력조회" Top="470" Width="127"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button282" ImageID="btn_6_reg" Left="1020" LeftMargin="21" OnClick="btn_MainterReq_OnClick" Style="button" TabOrder="26" Text="정비보수의뢰" Top="470" Width="100"></Button>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="GU" Enable="FALSE" Height="18" Id="Edit1" ImeMode="none" Left="143" Style="edit" TabOrder="27" Top="361" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="WORK_FIRM_CD" Enable="FALSE" Height="18" Id="edt_WorkFirmCd" ImeMode="none" Left="455" Style="edit" TabOrder="30" Top="361" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="FACI_NM" Enable="FALSE" Height="18" Id="edt_FaciNm" ImeMode="none" Left="455" Style="edit" TabOrder="28" Top="340" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="PIPE_PRESS_2" Enable="FALSE" Height="18" Id="Edit7" ImeMode="none" Left="455" Style="edit" TabOrder="29" Top="382" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="WORK_NUM" Enable="FALSE" Height="18" Id="edt_WorkNum" ImeMode="none" Left="767" Style="edit" TabOrder="31" Top="340" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Faci" Border="Flat" Column="PIPE_LENG_1" Enable="FALSE" Height="18" Id="Edit11" ImeMode="none" Left="767" Style="edit" TabOrder="32" Top="382" Width="171"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Faci" Border="Flat" Column="STR_ZIP_NO1" Enable="FALSE" Height="18" Id="edt_StrZipNo1" ImeMode="none" Left="143" Style="edit" TabOrder="33" Top="403" Width="33"></Edit>
		<Static Height="13" Id="C2502030010F" Left="177" Style="static" TabOrder="34" Text="-" Top="406" Width="10"></Static>
		<Edit Align="CENTER" BindDataset="ds_Faci" Border="Flat" Column="STR_ZIP_NO2" Enable="FALSE" Height="18" Id="edt_StrZipNo2" ImeMode="none" Left="185" Style="edit" TabOrder="35" Top="403" Width="33"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Enable="FALSE" Height="18" Id="Edit13" ImeMode="none" Left="219" Style="edit" TabOrder="36" Top="403" Width="1029"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Enable="FALSE" Height="18" Id="Edit15" ImeMode="none" Left="219" Style="edit" TabOrder="40" Top="424" Width="1029"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Faci" Border="Flat" Column="END_ZIP_NO1" Enable="FALSE" Height="18" Id="edt_EndZipNo1" ImeMode="none" Left="143" Style="edit" TabOrder="37" Top="424" Width="33"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Faci" Border="Flat" Column="END_ZIP_NO2" Enable="FALSE" Height="18" Id="edt_EndZipNo2" ImeMode="none" Left="185" Style="edit" TabOrder="39" Top="424" Width="33"></Edit>
		<Static Height="13" Id="Static20" Left="177" Style="static" TabOrder="38" Text="-" Top="427" Width="10"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Multi_T08" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="312" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="289" Id="grd_Multi" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_Multi_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="41" TabStop="true" Top="23" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="93"/>
						<col width="92"/>
						<col width="154"/>
						<col width="89"/>
						<col width="220"/>
						<col width="220"/>
						<col width="100"/>
						<col width="100"/>
						<col width="28"/>
						<col width="19"/>
						<col width="31"/>
						<col width="25"/>
						<col width="20"/>
						<col width="30"/>
						<col width="25"/>
						<col width="20"/>
						<col width="30"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="시설물번호"/>
						<cell col="3" display="text" text="시설명"/>
						<cell col="4" display="text" text="팀"/>
						<cell col="5" display="text" text="구간"/>
						<cell col="6" display="text" text="시점주소"/>
						<cell col="7" display="text" text="종점주소"/>
						<cell col="8" display="text" text="계획일자"/>
						<cell col="9" display="text" text="전&#32;점검일자"/>
						<cell col="10" colspan="3" display="text" text="공사정보조회"/>
						<cell col="13" colspan="3" display="text" text="시설물카드"/>
						<cell col="16" colspan="3" display="text" text="GIS위치보기"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="FACI_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="FACI_NM" display="text"/>
						<cell col="4" colid="TEAM_NM" display="text"/>
						<cell align="center" col="5" colid="BLOCK_CD" display="text"/>
						<cell col="6" colid="STR_LOT_NUM_UNION" display="text"/>
						<cell col="7" colid="END_LOT_NUM_UNION" display="text"/>
						<cell col="8" colid="PLAN_YMD" display="date"/>
						<cell col="9" colid="PATROL_YMD" display="date"/>
						<cell col="10" display="text"/>
						<cell col="11" colid="WORK_INFO" display="text" expandimage="search" expandshow="true"/>
						<cell col="12" display="text"/>
						<cell col="13" colid="FACI_CARD" colspan="3" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text" expandimage="search" expandshow="true" expandsize="17"/>
							<cell col="2" display="text"/>
						</cell>
						<cell col="16" colid="GIS_POSITION" colspan="3" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text" expandimage="search" expandshow="true" expandsize="17"/>
							<cell col="2" display="text"/>
						</cell>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Border="Flat" Height="22" Id="Static17" Left="317" Style="table" TabOrder="42" Text="차단밸브번호&#32;2" Top="443" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static18" Left="629" Style="table" TabOrder="43" Text="차단밸브번호&#32;3" Top="443" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="CUT_VALVE_NUM_01" Enable="FALSE" Height="18" Id="edt_CutValveNum01" ImeMode="none" Left="143" Style="edit" TabOrder="44" Top="445" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="CUT_VALVE_NUM_02" Enable="FALSE" Height="18" Id="edtJ_CutValveNum02" ImeMode="none" Left="455" Style="edit" TabOrder="45" Top="445" Width="171"></Edit>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="CUT_VALVE_NUM_03" Enable="FALSE" Height="18" Id="edt_CutValveNum03" ImeMode="none" Left="767" Style="edit" TabOrder="46" Top="445" Width="171"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static30" Left="629" Style="table" TabOrder="47" Text="관경1" Top="359" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="PIPE_DIAM1_CD" Enable="FALSE" Height="18" Id="Edit30" ImeMode="none" Left="767" Style="edit" TabOrder="48" Top="361" Width="171"></Edit>
		<Static Height="13" Id="Static4" Left="989" Style="static" TabOrder="49" Text="※미점검&#32;&#32;&#32;&#32;&#32;개,&#32;금일점검&#32;&#32;&#32;&#32;&#32;&#32;개,&#32;점검대상&#32;&#32;&#32;&#32;&#32;개" Top="6" Width="264"></Static>
		<Static Align="Right" Height="10" Id="Static6" Left="1032" Style="static" TabOrder="50" Text="00" Top="6" Width="24"></Static>
		<Static Align="Right" Height="10" Id="Static53" Left="1122" Style="static" TabOrder="51" Text="00" Top="6" Width="24"></Static>
		<Static Align="Right" Height="10" Id="Static54" Left="1212" Style="static" TabOrder="52" Text="00" Top="6" Width="24"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static32" Left="941" Style="table" TabOrder="53" Text="지사" Top="338" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="BRANCH_CD" Enable="FALSE" Height="18" Id="edt_BranchCd" ImeMode="none" Left="1079" Style="edit" TabOrder="54" Top="340" Width="169"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static36" Left="941" Style="table" TabOrder="55" Text="관경2" Top="359" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="PIPE_DIAM2_CD" Enable="FALSE" Height="18" Id="Edit34" ImeMode="none" Left="1079" Style="edit" TabOrder="56" Top="361" Width="169"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static37" Left="941" Style="table" TabOrder="57" Text="연장2(m)" Top="380" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="941" Style="table" TabOrder="59" Text="차단밸브번호&#32;4" Top="443" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Faci" Border="Flat" Column="CUT_VALVE_NUM_04" Enable="FALSE" Height="18" Id="edt_CutValveNum04" ImeMode="none" Left="1079" Style="edit" TabOrder="60" Top="445" Width="168"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Faci" Border="Flat" Column="PIPE_LENG_2" Enable="FALSE" Height="18" Id="Edit35" ImeMode="none" Left="1079" Style="edit" TabOrder="58" Top="382" Width="169"></Edit>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Excel" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="800" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="41" Id="grd_Excel" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_Multi_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="61" TabStop="true" Top="759" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="220"/>
						<col width="220"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="시설물번호"/>
						<cell col="3" display="text" text="시설명"/>
						<cell col="4" display="text" text="팀"/>
						<cell col="5" display="text" text="구간"/>
						<cell col="6" display="text" text="시점주소"/>
						<cell col="7" display="text" text="종점주소"/>
						<cell col="8" display="text" text="시설구분"/>
						<cell col="9" display="text" text="계획일자"/>
						<cell col="10" display="text" text="최근전검일자"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="FACI_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="FACI_NM" display="text"/>
						<cell col="4" colid="TEAM_CD" display="text"/>
						<cell align="center" col="5" colid="BLOCK_CD" display="text"/>
						<cell col="6" colid="STR_LOT_NUM_UNION" display="text"/>
						<cell col="7" colid="END_LOT_NUM_UNION" display="text"/>
						<cell col="8" colid="FACI_FLAG" display="text"/>
						<cell col="9" colid="PLAN_YMD" display="date"/>
						<cell col="10" colid="PATROL_YMD" display="date"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1201010010F_T08.xml
* Form 설명   : 중점관리시설 순찰점검등록 조회,등록,수정,삭제
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2008-12-11
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONA10008.js";

var strRowType = "";
var strFaciNum = "";
var strPatrolYmd = "";
var fv_FaciNum2 = "";
var strFaciNm = "";

var fv_BranchCd    = "";
var fv_TeamCd      = "";
var fv_ShiftWorkCd = "";
var fv_ZipNo1      = "";
var fv_ChkYear     = "";
var fv_ChkQuarter  = "";
var fv_BlockCd     = "";
var fv_PlanYmd     = "";

function D1202010011F_T08_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	gfn_D1_SetGrid_Sort(grd_Multi);
	gfn_D1_SetGrid_Sort(grd_MultiSave);
	fn_D1_Combo_Set();
	
	if (IsExistVar("PORTLET_FLAG", true)){
		if (PORTLET_FLAG == "p"){
			fn_D1_PortletFind(FACI_NUM, PLAN_YMD);
		}
	}
}


function fn_D1_Combo_Set()
{
	gfn_SetGrdComboBox_Comcode("grd_MultiSave",4,"D10189");		//점검대장등록여부
	grd_MultiSave.SetCellProp("body",3,"Edit","none");			//시설구분
	grd_MultiSave.SetCellProp("body",4,"Edit","none");			//점검대장등록여부
}


//------------------------------------------------------------------------------- 
// 함수명: fn_D1_ExcelExport()
//  설명: 특별관리시설 엑셀로 저장
// arguments   
//  return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_ExcelExport()
{ 
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 :"     + RPad(cob_PBranchCd.Text," ",20);
    SearchCondition = SearchCondition + "팀 :"       + RPad(cob_PTeamCd.Text," ",20);
    SearchCondition = SearchCondition + "조 :"       + RPad(cob_PShiftWorkCd.Text," ",20);
    SearchCondition = SearchCondition + "구간코드 :" + RPad(cob_block.Text," ",20);
    SearchCondition = SearchCondition + "순찰일자 :" + RPad(cal_PPatrolYmd.Text," ",20);
    SearchCondition = SearchCondition + "시설물번호 :" + RPad(edt_PFaciNum.Text," ",20);
    
	gfn_ExportExcel("중점관리시설 순찰점검등록", 5, SearchCondition, "grd_Excel");
}


//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Find()
// 설명     : 순찰점검 주 계획을 조회한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------

function fn_D1_Find()
{
	//입력한 날짜가 오늘 보다 클 경우
	if(!fn_DateCheckToday(cal_PPatrolYmd))
	{
		return;
	}
	
	ds_Faci.ClearData();
	ds_FaciSave.ClearData();

	var strSvcID = "fn_D1_Find";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	           + "&BRANCH_CD="		+cob_PBranchCd.Value		//지사코드
	           + "&BLOCK_CD=" 		+cob_block.Value        	//구코드
	           + "&TEAM_CD=" 		+cob_PTeamCd.Value			//팀코드
	           + "&SHIFT_WORK_CD="  +cob_PShiftWorkCd.Value		//조코드
	           + "&PATROL_YMD=" 	+cal_PPatrolYmd.Value		//순찰일자
	           + "&FACI_NUM="	    +edt_PFaciNum.Text			//시설물번호
	           ;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_T08=ds_Multi ds_Excel=ds_Excel";
	var strArgument  = "find8";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);

	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}			              
	              
	if(ds_Multi_T08.GetRowCount()==0) trace("조회결과가 없습니다.");
	
	if(ds_Multi_T08.GetRowCount()==0)
	{
        grd_Multi.NoDataText="조회결과가 없습니다.";
    }
	
	strFaciNum = "";	//담은 값을 지움 한 번 조회를 탄 후 값을 가지고 있으므로 null처리를 안해주면 
						//한번 조회 후 다시 조회 할때 '순찰계획을 선택해주세요' 라는 alert이 안뜨고 그냥 행추가가 되는것을 막기위한 
}


function grd_Multi_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if("FACI_CARD" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		fn_Card(nRow);
	}

	if("GIS_POSITION" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		var args = "BUNGI='01' GU_NM="  	+ds_Multi_T08.GetColumn(nRow,"STR_ZIP_NO1")		//시점_우편번호1
		         + "BUNGI='01' DONG_NM_H="  +ds_Multi_T08.GetColumn(nRow,"STR_ZIP_NO2")		//시점_우편번호2
		         + "BUNGI='01' FNU="   		+ds_Multi_T08.GetColumn(nRow,"STR_ADDR_M")		//시점_본번
		         + "BUNGI='01' SNU="   		+ds_Multi_T08.GetColumn(nRow,"STR_ADDR_S");		//시점_부번
		gfn_Dialog("D10","D1402060011U",args,1208,840,true,-1,-1);	//GIS 불러오기
	}
	
	if("WORK_INFO" == grd_Multi.GetCellProp("body",nCell,"ColId"))		//공사정보조회
	{
		var strPrefix = "B20";
		var strFormid = "B2204010010F";
		var strArg    = "";
		gfn_NewWindow(strPrefix,strFormid,strArg);
	}

	
	strFaciNum      = ds_Multi_T08.GetColumn(nRow,"FACI_NUM");		//시설물번호
	strPatrolYmd    = ds_Multi_T08.GetColumn(nRow,"PATROL_YMD");	//순찰일자
	strFaciNm       = ds_Multi_T08.GetColumn(nRow,"FACI_NM");		//시설명
	fv_BranchCd     = ds_Multi_T08.GetColumn(nRow,"BRANCH_CD" );  
	fv_TeamCd       = ds_Multi_T08.GetColumn(nRow,"TEAM_CD" );
	fv_ShiftWorkCd  = ds_Multi_T08.GetColumn(nRow,"SHIFT_WORK_CD" );
	fv_ZipNo1       = ds_Multi_T08.GetColumn(nRow,"ZIP_NO1" );
	fv_ChkYear      = ds_Multi_T08.GetColumn(nRow,"CHK_YEAR" );
	fv_ChkQuarter   = ds_Multi_T08.GetColumn(nRow,"CHK_QUARTER" );
	fv_BlockCd      = ds_Multi_T08.GetColumn(nRow,"BLOCK_CD" );
	fv_PlanYmd      = ds_Multi_T08.GetColumn(nRow,"PLAN_YMD" );	
	
	fn_D1_DetailFind(strFaciNum, strFaciNm);
	
	strRowType = "search";
}

//------------------------------------------------------------------------------- 
//   함수명: fn_Card(obj)
//   설명  : 밸브 시설물카드조회 팝업
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_Card(nRow)
{

	// 함수 호출용 파라미터를 설정한다
	var strTitle ="중점관리시설 시설물카드조회"; 
	var strPart ="D10";           
	var strReport="D1202010031P"; 
	var strParameter="FACI_NUM=" 	  +ds_Multi_T08.GetColumn(nRow,"FACI_NUM")    		//시설물번호
					+",PATROL_YMD="   +ds_Multi_T08.GetColumn(nRow,"PATROL_YMD")		//순찰일자(안넘기는것 같음 확인하기)
					+",BLOCK_CD=" 	  +ds_Multi_T08.GetColumn(nRow,"BLOCK_CD")			//구간코드
					+",PIPE_CHK_NUM=" +ds_Multi_T08.GetColumn(nRow,"PIPE_CHK_NUM")		//배관점검번호(안넘기는것 같음 확인하기)
					;
	//gfn_bt_d2_Report
	// 공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
} 

//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Find()
// 설명     : 순찰점검 주 계획을 조회한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------

function fn_D1_DetailFind(strFaciNum, strFaciNm)
{
	var strSvcID = "fn_D1_DetailFind";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	           + "&FACI_NUM="	    +strFaciNum			//시설물번호
	           + "&FACI_NM="		+strFaciNm			//시설명
	           ; 
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Faci=ds_Faci ds_FaciSave=ds_FaciSave";
	var strArgument  = "find8_Detail";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);

	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}			              
	              
	if(ds_FaciSave.GetRowCount()==0) trace("조회결과가 없습니다.");

	if(ds_FaciSave.GetRowCount()==0)
	{
        grd_MultiSave.NoDataText="조회결과가 없습니다.";
    }
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_SAVE
//   설명  : 사유지 점용료 협의사항를 등록/업데이트한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Save()
{

	if(ds_FaciSave.RowCount() == 0)
	{
		return;
	}
	
	if(strFaciNum != "")
	{
		if(ds_FaciSave.GetRowType(0) == "insert")
		{
			var strChkFlag = fn_D1_CheckReg();
			
			if(!strChkFlag) 
			{
				alert('이미 등록된 순찰일자입니다.');
				return;
			}
		}
	}else{
		alert('상세화면 조회 후 가능합니다.');
		return;
	}
	
	
	if(ds_FaciSave.GetColumn(0,"PATROL_YMD") == "" || ds_FaciSave.GetColumn(0,"PATROL_YMD") == null)	//순찰일자
	{
		alert(gfn_GetMessage("M000011","%AAA%","순찰일자를"));	//순찰일자를 입력하세요
		return;
	}	
	
	if(ds_FaciSave.GetColumn(0,"CHK_YN") == "20")	//점검대장 등록여부
	{
		alert('점검대장 등록여부를 등록해주세요.');
		return;
	}
	
	if(ds_FaciSave.GetColumn(0,"CHK_DESC") == ""||ds_FaciSave.GetColumn(0,"CHK_DESC") == null)
	{
		alert(gfn_GetMessage("M000011","%AAA%","점검사항을"));	//점검사항을 입력하세요
		return;
	}	
	
	//수정 등록시 셋팅할 사용자 정보
	ds_FaciSave.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
	ds_FaciSave.SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
	ds_FaciSave.SetColumn(0, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
	ds_FaciSave.SetColumn(0, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
	ds_FaciSave.SetColumn(0, "FACI_NUM" ,strFaciNum);
	ds_FaciSave.SetColumn(0, "BRANCH_CD"     ,fv_BranchCd );
	ds_FaciSave.SetColumn(0, "TEAM_CD"       ,fv_TeamCd );
	ds_FaciSave.SetColumn(0, "SHIFT_WORK_CD" ,fv_ShiftWorkCd );
	ds_FaciSave.SetColumn(0, "ZIP_NO1"       ,fv_ZipNo1 );
	ds_FaciSave.SetColumn(0, "CHK_YEAR"      ,fv_ChkYear );
	ds_FaciSave.SetColumn(0, "CHK_QUARTER"   ,fv_ChkQuarter);
	ds_FaciSave.SetColumn(0, "BLOCK_CD"      ,fv_BlockCd );
	ds_FaciSave.SetColumn(0, "PLAN_YMD"      ,fv_PlanYmd);
	
	var strSvcID         = "fn_D1_Save";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service" ;					
	var strInDatasets    = "ds_FaciSave=ds_FaciSave:u";
	var strOutDatasets   = "";		
	var strArgument      = "save_T08";
	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );

	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009","%AAA%","저장을"));
	}

}


//------------------------------------------------------------------------------- 
// 함수명: fn_D1_CheckReg()
//   설명: 중점관리시설점검 결과등록을 하기 전 기 등록 여부 확인
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_CheckReg()
{
    var strSvcID       = "fn_D1_CheckReg";
    var strPart        = "D10";
    var strURL         = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
					   + "&FACI_NUM=" 	+strFaciNum
					   + "&PATROL_YMD=" +ds_FaciSave.GetColumn(0,"PATROL_YMD")
					   ;
    var strInDatasets  = "";
    var strOutDatasets = "ds_Dub=ds_Dub";
    var strArgument    = "Dub_T08";   
    
    gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}					   
			   
	if(ds_Dub.RowCount() != 0) return false;
	return true;
}

// ------------------------------------------------------------------------------- 
// 함수명: fn_D1_Addrowm()
// 설명  :  구간 행추가 
// return 내용: 없음
// ------------------------------------------------------------------------------- 
function fn_D1_Addrowm()
{
	
	if(strFaciNum != "")
	{
		//행추가를 했을때 점검일자는 금일날짜를 뿌려줌, 점검일자가 키이기 때문에 행추가를 한번으로 막기위한 함수
		if(Today() != ds_FaciSave.GetColumn(0,"PATROL_YMD"))	
		{
			ds_FaciSave.InsertRow(0);									//insert시 맨위에 행추가
			ds_FaciSave.SetColumn(0,"CHK_YN","20");
			ds_FaciSave.SetColumn(0,"PATROL_YMD", Today());
			ds_FaciSave.SetColumn(0, "TAKER_EMPID1_NM", edt_empnm1.text);	
			ds_FaciSave.SetColumn(0, "TAKER_EMPID2_NM", edt_empnm2.text);
			ds_FaciSave.SetColumn(0, "TAKER_EMPID3_NM", edt_empnm3.text);
			ds_FaciSave.SetColumn(0, "TAKER_EMPID1",edt_empid1.text );	
			ds_FaciSave.SetColumn(0, "TAKER_EMPID2",edt_empid2.text );
			ds_FaciSave.SetColumn(0, "TAKER_EMPID3",edt_empid3.text );		
			
			strRowType = "insert";
		}
		
		//선택된 시설물에 따라 등록 그리드에 자동 셋팅
		fv_FaciNum2 = ds_Faci.GetColumn(0,"FACI_NUM");
		fv_FaciNum2 = substr(fv_FaciNum2,0,2);
		if(fv_FaciNum2 == "BH")
		{
			ds_FaciSave.SetColumn(0, "FACI_NM", strFaciNm);		//교량첨가
		}
		else if(fv_FaciNum2 == "UC")
		{
			ds_FaciSave.SetColumn(0, "FACI_NM", strFaciNm);		//하상통과
		}
		else if(fv_FaciNum2 == "RO")
		{
			ds_FaciSave.SetColumn(0, "FACI_NM", strFaciNm);		//철길통과
		}
	}else{
		alert('순찰계획을 선택해주세요');
    }
}


// ---------------------------------------------------------
// 달력 팝업 및 점검대장 팝업
// ---------------------------------------------------------
function grd_MultiSave_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	

	if("CHK_YN" == grd_MultiSave.GetCellProp("body",nCell,"ColId"))		//점검대장 등록여부
	{
		if(ds_FaciSave.GetColumn(nRow,"PATROL_YMD") == null)
		{
			alert('순찰일자를 먼저 등록해 주세요');
			return;
		}
		else if(strRowType == "insert")
		{
			var strChkFlag = fn_D1_CheckReg();
			
			if(!strChkFlag)
			{
				alert('이미 등록된 순찰일자입니다.');
				return;
			}
		}
			
		var strCopyType = "";
		var args = "";
		
		args  = "FACI_NUM="    +strFaciNum;									//시설물번호
		args += " PATROL_YMD=" +ds_FaciSave.GetColumn(nRow,"PATROL_YMD");	//순찰일자
		args += " ROWTYPE="    +strRowType;
		
		fv_FaciNum2 = ds_Multi_T08.GetColumn(ds_Multi_T08.row,"FACI_NUM");
		fv_FaciNum2 = substr(fv_FaciNum2,0,2);
		
		if(fv_FaciNum2 == "BH")
		{
			strRowType = gfn_Dialog("D10","D1202010028U",args,600,400,true,-1,-1);	//교량첨가 점검대장
		}
		else if(fv_FaciNum2 == "UC")
		{
			strRowType = gfn_Dialog("D10","D1202010029U",args,600,365,true,-1,-1);	//하상통과 점검대장
		}
		else if(fv_FaciNum2 == "RO")
		{
			strRowType = gfn_Dialog("D10","D1202010030U",args,600,329,true,-1,-1);	//철길통과 점검대장
		}
		
		if(strRowType == "savePass")
		{
			strRowType = "update";
			ds_FaciSave.SetColumn(ds_FaciSave.row,"CHK_YN","10");	//점검대장등록 여부
		}else if(strRowType == "saveNotPass")
		{
			strRowType = "update";
			ds_FaciSave.SetColumn(ds_FaciSave.row,"CHK_YN","10");	//점검대장등록 여부
		}else
		{
			strRowType = strCopyType;
		}
	}
	//이 화면은 등록만 되고 수정이 안됨, 수정을 하고 싶은면 삭제후 다시 등록 요함. 그래서 insert만 활성화 됨.
	if(ds_FaciSave.GetRowType(nRow) == "insert")
	{
		grd_MultiSave.SetCellProp("body",5,"Edit","normal");	//특이사항
	}else
	{
		grd_MultiSave.SetCellProp("body",5,"Edit","none");		//특이사항
	}
}

//---------------------------------------------------------
// 정비보수의뢰 조회 popup
//---------------------------------------------------------
function btn_MainterReq_OnClick(obj)
{
	var strPrefix = "D10";
	var strFormid = "D1601010010F";
	var strArg    = "BRANCH_CD="   + ds_Faci.GetColumn(0, "BRANCH_CD");
	    strArg   += " FACI_NUM="   + ds_Faci.GetColumn(0, "FACI_NUM") ;
	gfn_NewWindow(strPrefix,strFormid,strArg);
}


//---------------------------------------------------------
// 중점관리시설 순찰점검 이력조회 popup
//---------------------------------------------------------
function btn_ImporRst_OnClick(obj)
{
	if(edt_FaciNum == "" || edt_FaciNum == null)
	{
		alert('순찰계획을 선택해주세요');
		return;
	}
	var args = "FACI_NUM=" +ds_Faci.GetColumn(0,"FACI_NUM");	//중점관리 시설물번호
	
	gfn_Dialog("D10","D1202010032U",args,660,400,true,-1,-1);
}

function D1202010011F_T08_OnUnloadCompleted(obj)
{
	if(ds_FaciSave.GetUpdate())
	{
		if(!confirm(gfn_GetMessage("M000016","%AAA%","편집중인 내용을 무시하고 종료")))
		 {
			 return false;
		 }	
	}
}

function fn_D1_PortletFind(str_FaciNum, str_PlanYmd){

	var strSvcID = "fn_D1_Find";
	var strPart  = "D10";				
	var strURL   = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	             + "&BRANCH_CD="	+ "" 
	             + "&BLOCK_CD=" 	+ ""
	             + "&TEAM_CD=" 		+ ""
	             + "&SHIFT_WORK_CD="+ ""
	             + "&PATROL_YMD=" 	+ str_PlanYmd
	             + "&FACI_NUM="	    + str_FaciNum
	             ;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Multi_T08=ds_Multi";
	var strArgument     = "find8";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);

	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}			              
	
	if(ds_Multi_T08.GetRowCount()==0)
	{
        grd_Multi.NoDataText="조회결과가 없습니다.";
    }
    
    grd_Multi_OnCellClick ("",0,"","","","");
}
]]></Script>
</Window>