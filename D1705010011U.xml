<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="615" Id="D1705010011U" Left="8" OnLoadCompleted="D1705010011U_OnLoadCompleted" PidAttrib="7" Title="잔존가접수내역&#32;등록" Top="8" Ver="1.0" Width="742" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Close_Cost_h_List">
				<Contents>
					<colinfo id="CLOSE_COST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCU_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLOSE_PIPE_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DESIGN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEPRE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_CLOSE_PIPE_REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocuV" OnColumnChanged="ds_MoveDocuV_OnColumnChanged">
				<Contents>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_WORK_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="255" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFERENCE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="HILL" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_BLD_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRST_MOVE_DOCU" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Close_Cost_h" OnColumnChanged="ds_Close_Cost_h_OnColumnChanged">
				<Contents>
					<colinfo id="CLOSE_COST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCU_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLOSE_PIPE_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DESIGN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEPRE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_CLOSE_PIPE_REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Close_Cost_h_Append">
				<Contents>
					<colinfo id="CLOSE_COST_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCU_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLOSE_PIPE_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DESIGN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_DEPRE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_CLOSE_PIPE_REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Sequence">
				<Contents>
					<colinfo id="MAX_NUM" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Move">
				<Contents>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CLOSE_COST_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocuD">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Radio">
				<Contents>
					<colinfo id="name" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<name>예</name>
						<value>0</value>
					</record>
					<record>
						<name>아니요</name>
						<value>1</value>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static30" Left="75" Style="table" TabOrder="65" Top="568" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static25" Left="83" Style="table" TabOrder="63" Top="484" VAlign="Middle" Width="653" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static13" Left="75" Style="table" TabOrder="62" Top="526" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static4" Left="83" Style="table" TabOrder="46" Top="463" VAlign="Middle" Width="653" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="39" Id="Image0" ImageID="popup_top" LeftMargin="33" Style="popup_title" TabOrder="23" Text="폐관비용&#32;이설보수&#32;접수내역&#32;등록" Transparent="TRUE" Width="740"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Close_Cost_h_List" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="250" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="Grid0" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" NoDataText="검색조건에&#32;대한&#32;조회결과가&#32;없습니다." OnCellClick="Grid0_OnCellClick" OnHeadClick="Grid0_OnHeadClick" Right="739" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="24" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="731">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="100"/>
						<col fix="left" width="100"/>
						<col fix="left" width="80"/>
						<col fix="left" width="227"/>
						<col fix="left" width="142"/>
						<col fix="left" width="80"/>
					</columns>
					<head>
						<cell col="0" display="text" text="폐관비용관리번호"/>
						<cell col="1" display="text" text="이설보수번호"/>
						<cell col="2" display="text" text="산출일자"/>
						<cell col="3" display="text" text="공사명"/>
						<cell col="4" display="text" text="의뢰자명"/>
						<cell col="5" display="text" text="폐관요청일"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CLOSE_COST_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" colid="MOVE_REPAIR_NUM" display="text"/>
						<cell align="center" col="2" colid="CALCU_YMD" display="date"/>
						<cell align="center" col="3" colid="WORK_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="4" colid="WORK_FIRM_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="5" colid="CLOSE_PIPE_REQ_YMD" display="date" expandsize="18" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="13" Id="Image1" ImageID="blt_8" Left="7" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="26" Text="잔존가&#32;접수내역&#32;등록" Top="404" Width="163"></Image>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static17" Left="75" Style="table" TabOrder="41" Top="505" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static2" Left="75" Style="table" TabOrder="38" Top="442" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static0" Left="75" Style="table" TabOrder="40" Top="421" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static20" Left="75" Style="table" TabOrder="27" Top="589" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Height="18" Id="edtFileList" ImeMode="none" Left="95" Readonly="TRUE" Style="edit" TabOrder="22" Top="591" Width="562"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="Button23" ImageID="btn_4_fileadd" Left="658" LeftMargin="21" OnClick="Button0_OnClick" Style="button" TabOrder="29" Text="파일첨부&#32;" Top="591" Width="75"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_WORK_NM" Height="18" Id="edt_MoveRepairWorkNm" ImeMode="none" Left="337" MaxLength="60" Style="edit" TabOrder="12" Top="465" Width="216"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static18" Left="75" Style="table" TabOrder="31" Top="547" VAlign="Middle" Width="661" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_DESC" Height="18" Id="edt_DiscuDesc" ImeMode="none" Left="95" MaxLength="50" Style="edit" TabOrder="20" Top="549" Width="638"></Edit>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static6" Left="247" Style="table" TabOrder="32" Text="공사명" Top="463" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_TYPE" Enable="FALSE" Height="18" Id="cob_MoveRepairType" Left="644" Style="combo_indis" TabOrder="13" Top="464" Width="89"></Combo>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="BRANCH_CD" Height="18" Id="cob_ObjectFlag1" Left="94" Style="combo_indis" TabOrder="11" Top="464" Width="88"></Combo>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="TAKER_EMPID" Enable="FALSE" Height="18" Id="edt_TakerEmpid" ImeMode="none" Left="337" MaxLength="9" Style="edit_Indis" TabOrder="7" Top="444" Width="92"></Edit>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static130" Left="555" Style="table" TabOrder="34" Text="이설보수유형" Top="463" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static21" Left="247" Style="table" TabOrder="35" Text="협의자" Top="442" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="RECEIVE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReceiveYmd" Left="645" OnChanged="cal_ReceiveYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="3" Top="423" WeeksFont="Default,-1" Width="87"></Calendar>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static128" Left="5" Style="table" TabOrder="36" Text="지사" Top="463" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static1" Left="555" Style="table" TabOrder="39" Text="접수일자" Top="421" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="5" Style="table" TabOrder="37" Text="의뢰자&#32;연락처" Top="442" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static15" Left="5" Style="table" TabOrder="33" Text="공사위치" Top="505" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static7" Left="5" Style="table" TabOrder="30" Text="요청사항" Top="547" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static19" Left="5" Style="table" TabOrder="28" Text="첨부문서" Top="589" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Height="13" Id="Static8" Left="147" Style="static" TabOrder="42" Text="-" Top="447" Width="10"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_EXN" Height="18" Id="edt_ReasonTel_EXN" ImeMode="none" Left="155" MaxLength="4" Number="TRUE" Style="edit" TabOrder="5" Top="444" Width="38"></Edit>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_NUM" Height="18" Id="edt_ReasonTel_NUM" ImeMode="none" Left="202" MaxLength="4" Number="TRUE" Style="edit" TabOrder="6" Top="444" Width="42"></Edit>
		<Static Height="13" Id="Static9" Left="194" Style="static" TabOrder="43" Text="-" Top="447" Width="10"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_DDD" Height="18" Id="cob_ReasonTelDDD" Left="94" Style="combo" TabOrder="4" Top="443" Width="53"></Combo>
		<Button Cursor="HAND" Height="17" Id="Button0" ImageID="search" Left="536" OnClick="Button4_OnClick" TabOrder="9" Text="Button8" Top="445" Width="17"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="TAKER_NAME" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="430" MaxLength="9" Style="edit" TabOrder="8" Top="444" Width="105"></Edit>
		<Image Align="Left" Height="13" Id="Image2" ImageID="blt_8" Left="7" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="44" Text="잔존가&#32;폐관비용&#32;산정내역(선택)" Top="253" Width="219"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Close_Cost_h_Append" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="399" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="130" Id="Grid1" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" NoDataText="검색조건에&#32;대한&#32;조회결과가&#32;없습니다." Right="736" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="45" TabStop="true" Top="269" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="731">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="114"/>
						<col width="116"/>
						<col width="100"/>
						<col width="100"/>
						<col width="70"/>
						<col width="81"/>
					</columns>
					<head>
						<cell col="0" display="text" text="폐관비용관리번호"/>
						<cell col="1" display="text" text="설계금액(원)"/>
						<cell col="2" display="text" text="상각금액(원)"/>
						<cell col="3" display="text" text="폐관비용(원)"/>
						<cell col="4" display="text" text="지사"/>
						<cell col="5" display="text" text="시/구"/>
						<cell col="6" display="text" text="담당자"/>
					</head>
					<body>
						<cell align="center" col="0" colid="CLOSE_COST_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell col="1" colid="TOT_DESIGN_AMT" display="number" expandsize="18" wordwrap="word"/>
						<cell col="2" colid="TOT_DEPRE_AMT" display="number"/>
						<cell col="3" colid="TOT_CLOSE_PIPE_REQ_AMT" display="number"/>
						<cell align="center" col="4" colid="BRANCH_NM" display="text"/>
						<cell align="center" col="5" colid="ZIP_NO1_NM" display="text"/>
						<cell align="center" col="6" colid="TAKER_NAME" display="text"/>
					</body>
					<summary>
						<cell align="center" col="0" display="text" text="소계"/>
						<cell align="right" col="1" display="number" expr='SumNF(&quot;TOT_DESIGN_AMT&quot;)'/>
						<cell align="right" col="2" display="number" expr='SumNF(&quot;TOT_DEPRE_AMT&quot;)'/>
						<cell align="right" col="3" display="number" expr='SumNF(&quot;TOT_CLOSE_PIPE_REQ_AMT&quot;)'/>
						<cell col="4" display="text"/>
						<cell col="5" display="text"/>
						<cell col="6" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button7" ImageID="btn_deleterow" Left="688" LeftMargin="15" OnClick="Button1_OnClick" Style="button" TabOrder="47" Text="삭제" Top="248" Width="48"></Button>
		<Image Align="Left" Height="13" Id="Image9" ImageID="blt_8" Left="7" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="25" Text="잔존가&#32;폐관비용&#32;산정내역" Top="99" Width="163"></Image>
		<Shape BKColor="user9" Bottom="92" Height="24" Id="Shape2" Left="5" LineColor="user10" Right="736" TabOrder="48" Top="68" Type="Rectangle" Width="731"></Shape>
		<Combo Border="Flat" Height="18" Id="cob_ObjectFlag" Left="54" OnChanged="cob_BranchCd_OnChanged" Style="combo_indis" TabOrder="49" Top="71" Width="114"></Combo>
		<Combo Border="Flat" Height="18" Id="cob_CountyFlag" Left="223" Style="edit_Indis" TabOrder="50" Top="71" Width="114"></Combo>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_CalCu_Ymd_Start" Left="415" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="51" Top="71" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Height="13" Id="Static10" Left="504" Style="static" TabOrder="52" Text="~" Top="74" Width="10"></Static>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_CalCu_Ymd_End" Left="514" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="53" Top="71" WeeksFont="Default,-1" Width="88"></Calendar>
		<Image Align="Left" Height="18" Id="Image5" ImageID="blt" Left="16" LeftMargin="12" Style="blt_search" TabOrder="54" Text="지사" Top="71" Transparent="TRUE" Width="81"></Image>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="179" LeftMargin="12" Style="blt_search" TabOrder="55" Text="시/구" Top="71" Transparent="TRUE" Width="81"></Image>
		<Image Align="Left" Height="18" Id="Image6" ImageID="blt" Left="350" LeftMargin="12" Style="blt_search" TabOrder="56" Text="산출일자" Top="71" Transparent="TRUE" Width="81"></Image>
		<Div Height="29" Id="Div0" TabOrder="57" Text="Div0" Top="39" Url="globals::ComButton.xml" Width="737">
			<Contents></Contents>
		</Div>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static5" Left="5" Style="table" TabOrder="58" Text="이설보수번호" Top="421" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_NUM" Enable="FALSE" Height="18" Id="Edit2" ImeMode="none" Left="96" MaxLength="10" Style="edit" TabOrder="1" Top="423" Width="148"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static16" Left="247" Style="table" TabOrder="59" Text="의뢰자" Top="421" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_NM" Height="18" Id="edt_Reason" ImeMode="none" Left="337" MaxLength="9" Style="edit" TabOrder="2" Top="423" Width="216"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static11" Left="555" Style="table" TabOrder="60" Text="협의일자" Top="442" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="CONFERENCE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="Calendar0" Left="645" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="10" Top="444" WeeksFont="Default,-1" Width="87"></Calendar>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static12" Left="5" Style="table" TabOrder="61" Text="신주소" Top="526" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static29" Left="5" Style="table" TabOrder="64" Text="특기사항" Top="568" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="RMK1" Height="18" Id="Edit3" ImeMode="none" Left="95" MaxLength="50" Style="edit" TabOrder="21" Top="570" Width="638"></Edit>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="edt_ZipNo1" ImeMode="none" Left="95" Style="edit_Indis" TabOrder="15" Top="507" Width="38"></Edit>
		<Static Height="13" Id="C2502030010F" Left="134" Style="static" TabOrder="66" Text="-" Top="510" Width="10"></Static>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="edt_ZipNo2" ImeMode="none" Left="142" Style="edit_Indis" TabOrder="16" Top="507" Width="38"></Edit>
		<Button Cursor="HAND" Height="17" Id="btn_DZip" ImageID="search" Left="181" OnClick="fn_ZipSearch" TabOrder="17" Text="Button8" Top="508" Width="17"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="ADDR_UNION" Enable="FALSE" Height="18" Id="edt_Addr" ImeMode="none" Left="200" Style="edit" TabOrder="18" Top="507" Width="533"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="NEW_ADDR_UNION" Enable="FALSE" Height="18" Id="edt_Addr_Union" ImeMode="none" Left="95" Style="edit" TabOrder="19" Top="528" Width="638"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="ZIP_SEQ" Height="18" Id="edt_Zip_Seq" Left="6" MaxLength="160" Style="edit" TabOrder="74" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="HILL" Height="18" Id="edt_Hill" Left="54" MaxLength="160" Style="edit" TabOrder="67" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="ADDR_S" Height="18" Id="edt_Addr_S" Left="153" MaxLength="160" Style="edit" TabOrder="68" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="SECOND_ADDR" Height="18" Id="edt_Second_Addr" Left="201" MaxLength="160" Style="edit" TabOrder="69" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="NEW_ADDR_BLD_SEQ" Height="18" Id="edt_New_Addr_Bld_Seq" Left="297" MaxLength="160" Style="edit" TabOrder="71" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="BLD_DONG" Height="18" Id="edt_Bld_Ding" Left="249" MaxLength="160" Style="edit" TabOrder="70" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="NEW_HOSU" Height="18" Id="edt_New_Hosu" Left="345" MaxLength="160" Style="edit" TabOrder="72" Top="617" Visible="FALSE" Width="45"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Height="18" Id="edt_Center" Left="393" MaxLength="160" Style="edit" TabOrder="73" Top="617" Visible="FALSE" Width="45"></Edit>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="EVIDENCE_YN" Height="18" Id="cob_TaxFlag" ImeMode="none" Left="94" Style="combo" TabOrder="14" Top="485" Width="88"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static27" Left="5" Style="table" TabOrder="75" Text="부가세여부" Top="484" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static14" Left="247" Style="table" TabOrder="76" Text="선공사여부" Top="484" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static22" Left="555" Style="table" TabOrder="77" Top="484" VAlign="Middle" Width="88" WordWrap="TRUE"></Static>
		<Radio BindDataset="ds_MoveDocuV" Border="None" CodeColumn="value" Color="user17" Column="FIRST_MOVE_DOCU" ColumnCount="2" DataColumn="name" Height="13" Id="Radio" INDEX="0" InnerDataset="ds_Radio" Left="338" OnClick="Radio_OnClick" Style="radio" TabOrder="78" Top="489" Value="1" Width="92">
			<Contents>
				<Layout Height="20" left="0" text="명" width="80"/>
				<Layout Height="20" left="80" text="코드" width="80"/>
			</Contents>
		</Radio>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="ADDR_M" Height="18" Id="edt_Addr_M" Left="104" MaxLength="160" Style="edit" TabOrder="79" Top="617" Visible="FALSE" Width="45"></Edit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1705010011U.xml
* Form 설명  : 잔존가 접수내역 등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 정주혜 
* 작성일     : 2009-04-20
* 변경내용   : 
****************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONE20001.js";
#include "JS::COMMONA10005.js";

var MOVE_REPAIR_NUM_IMSI = '';

function D1705010011U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
	fn_D1_find();
}

function fn_Init()
{
	// 임시
	// 버튼을 강제 세팅할 경우만 사용
	// 권한관리 하면 사용말것 *** 순서대로 세팅
	//gfn_SetButton("1111011");
	
	//-----------------------------------------
	//  콤보박스의 내용을 셋팅한다.
	// 지사코드, 영업구코드
	//-----------------------------------------
	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_ObjectFlag"));
	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_ObjectFlag1"));
	gfn_D1_SetComboBox_Comcode("D10130",gfn_setDsObject_Comcode("cob_MoveRepairType"), '10#20');
			
	 gfn_D1_NULL_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_ReasonTelDDD"));
	 gfn_D1_NULL_SetComboBox_Comcode("D10224",gfn_setDsObject_Comcode("cob_TaxFlag"));
	
	 gfn_D1_NULL_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("Combo0"));
	 gfn_D1_NULL_SetComboBox_Comcode("D10034",gfn_setDsObject_Comcode("Combo1"));
	 gfn_D1_NULL_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("Combo2"));
	
	//-----------------------------------------
	//  콤보박스의 초기 설정 : 지사, 구
	//-----------------------------------------
	
	if (IsExistVar("BRANCH_CD", true)) {
	  
			cob_ObjectFlag.value = BRANCH_CD;
			cal_CalCu_Ymd_Start.Value = CALCU_YMD_START;
			cal_CalCu_Ymd_End.Value = CALCU_YMD_END;
			
	}else{
		    cob_ObjectFlag   .Index = 0;
		    cal_CalCu_Ymd_Start.Value = substr(today(), 0, 6) + '01';
			cal_CalCu_Ymd_End.Value   = today();
	}
	
	cob_BranchCd_OnChanged();
	fn_D1_Sequence(subStr(cal_ReceiveYmd.Value, 0, 6));
}

/********************************************************************************
* 기      능   :  지사별 구를 조회하여 콤보박스에 셋팅
********************************************************************************/
function cob_BranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

    // 지사별 구 콤보 셋팅 시
    fn_SetComboBox_Comcode("1", cob_ObjectFlag.value , fn_setDsObject_Comcode("1", "cob_CountyFlag" ));    
    
    if (IsExistVar("ZIP_NO1", true)) {
			cob_CountyFlag.Value = ZIP_NO1;
	}else{
		    cob_CountyFlag.Index  = 0;
	}    
}

///-------------------------------------------------------------------------------
// 함수명: fn_CommonSearch()
// 설명: DB에 값을 조회한다.
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonSearch(){
	fn_D1_Sequence(subStr(cal_ReceiveYmd.Value, 0, 6));
	fn_D1_find();
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonExcelExport()
// 설명: 엑셀 button 실행, 조회된데이터를 엑셀형식으로변환한다
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonExcelExport(){
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  잔존가 접수 상세내역 조회
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_find()
{	
    var strSvcID        = "";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairClosingPipeMgr-service"
						+ "&BRANCH_CD="       + cob_ObjectFlag     .Value
						+ "&ZIP_NO1="         + cob_CountyFlag     .Value
						+ "&CALCU_YMD_START=" + cal_CalCu_Ymd_Start.Value
						+ "&CALCU_YMD_END="   + cal_CalCu_Ymd_End  .Value
						;
												
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Close_Cost_h_List=ds_Close_Cost_h_List";
	var strArgument     = "search_popup";
	 	 
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
	);
	

	ds_Close_Cost_h_Append.ClearData();
	ds_MoveDocuV.ClearData();
	edtFileList.text = '';
}

// CellClick 하였을 경우 이설보수잔존가로 등록할 row 정보 하단 데이터셋에 셋팅
function Grid0_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	if(ds_Close_Cost_h_List.GetColumn(nRow, "MOVE_REPAIR_NUM") != '' && ds_Close_Cost_h_List.GetColumn(nRow, "MOVE_REPAIR_NUM") != null){
		alert("이미 이설보수 접수내역으로 접수된 건입니다. ");
		return;
	}
	
	var strSvcID        = "";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairClosingPipeMgr-service"
						+ "&CLOSE_COST_NUM="  + ds_Close_Cost_h_List.GetColumn(nRow, "CLOSE_COST_NUM")
						;
	
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Close_Cost_h=ds_Close_Cost_h";
	var strArgument     = "view";
	 	 
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			    );
			    
	for(var i=0; i<ds_Close_Cost_h_Append.GetRowCount(); i++){
		if(ds_Close_Cost_h_Append.GetColumn(i, "CLOSE_COST_NUM") == ds_Close_Cost_h.GetColumn(0, "CLOSE_COST_NUM")){
			alert("이미 선택된 폐관비용번호입니다. ");
			return;
		}
	}

	var i = ds_Close_Cost_h_Append.AddRow();
	ds_Close_Cost_h_Append.CopyRow(i, "ds_Close_Cost_h", ds_Close_Cost_h.row, "");
	
	if(ds_MoveDocuV.GetRowCount() > 0){
		return;
	}
	ds_MoveDocuV.AddRow();
	Radio.Value = 1;
	cob_ObjectFlag1   .Index = cob_ObjectFlag.Index;
	cob_MoveRepairType.Index = 0;	
	cob_ObjectFlag1.Enable = flase;
	
	edt_TakerEmpid.Text = gfn_GetGlobalValue("G_USER_NO");
	Edit0.Text          = gfn_GetGlobalValue("G_NAME");  
	Edit1.Text          = gfn_GetGlobalValue("G_DEPT_NAME");
}

function Button1_OnClick(obj)
{
	ds_Close_Cost_h_Append.DeleteRow(ds_Close_Cost_h_Append.GetRowCount()-1);
	
	if(ds_Close_Cost_h_Append.GetRowCount() <= 0){
			ds_MoveDocuV.ClearData();
	}
}

//-------------------------------------------------------------------------------
// 함수명: fn_ZipSearch()
//   설명: 우편번호 조회클릭시 우편번호 조회 popup화면 로딩
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_ZipSearch(obj)
{
	//-----------------------------------------
	//  주소검색 팝업창을 부른다 
	//-----------------------------------------	
	var arrList = gfn_Dialog("A10", "A1101020010U", "", 1100, 600, true, -1, -1);
	
	if (arrList != "" || arrList != null) {					
		if (cob_CountyFlag.Value != arrList[2]) {
			 alert("해당 시/구를 선택해주세요.");
			 return;
		}
	}	
	
	//지번주소
	edt_Zip_Seq    .Text = arrList[0];            // "주소일련번호"
	edt_ZipNo1 	   .Text = arrList[2];            // "우편번호1"
	edt_ZipNo2 	   .Text = arrList[3];            // "우편번호2"
	edt_Hill	   .Text = arrList[10];           // "산번지"
	edt_Addr_M     .Text = arrList[11];           // "본번"
	edt_Addr_S     .Text = arrList[12];           // "지번"
	edt_Second_Addr.Text = arrList[13];     	  // "보조주소"
	edt_Bld_Ding   .Text = arrList[15];           // "호수"
	edt_Addr       .Text = arrList[17];           // "지번주소조합";
			
	//새주소
	edt_New_Addr_Bld_Seq.Text	= arrList[18];    // "주소일련번호";
	edt_New_Hosu	    .Text	= arrList[21];    // "호수";
	edt_Addr_Union	    .Text	= arrList[23];    // "새주소조합";
	edt_Center			.Text	= arrList[24];    // 센터코드
	
}

//-------------------------------------------------------------------------------
// 함수명: Button4_OnClick()
//   설명: 사원번호 조회클릭시 우편번호 조회 popup화면 로딩
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function Button4_OnClick(obj)
{
 var retValue = gfn_E2_SearchOutEmplDialog();
 
 if(retValue != null)
 {
	 edt_TakerEmpid.Text = retValue[0];
	 Edit0.Text = retValue[1];
 } 
}

//-------------------------------------------------------------------------------
// 함수명: Button0_OnClick()
//   설명: 첨부파일 popup화면 로딩
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function Button0_OnClick(obj)
{
	if(ds_MoveDocuV.GetRowCount() <= 0 ){
		alert("하나의 이설보수내역을 선택하세요. ");
		return;
	}
	
	if(ds_MoveDocuV.GetRowType(0) == 'insert'){
			ds_MoveDocuV.SetColumn(0, "MOVE_REPAIR_NUM" , MOVE_REPAIR_NUM_IMSI); // 시퀀스 셋팅
	}
		
	var arg = "fa_Url=handle.do?ServiceName=D1_MoveingRepairSpecMgr-service&MOVE_REPAIR_NUM="+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_NUM") +"&ATTACH_FILE_FLAG=" + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_TYPE") + "&ATTACH_GROUP_FLAG=10 fa_Part=D10";
	
	var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
	
	edtFileList.text = "";
	
	for(var i=0; i<arrList.length; i++)
	{
		edtFileList.text += arrList[i];
		if(arrList.length-1 != i) edtFileList.text += "/";
	}
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonSave()
// 설명: 등록된 내용을 저장한다.
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonSave(){
	
	if(ds_MoveDocuV.GetRowCount() == 0){
		return;
	}	
	
	if(cal_ReceiveYmd.Value == ''){
		alert("접수일자는 필수입력 사항입니다. ");
		cal_ReceiveYmd.SetFocus();
		return;
	}	
	if(cob_ObjectFlag1.Value == ''){
		alert("지사정보는 필수입력 사항입니다.. ");
		cob_ObjectFlag1.SetFocus();
		return;
	}
	if(edt_TakerEmpid.Text == ''){
		alert("협의자정보는 필수입력 사항입니다. ");
		edt_TakerEmpid.SetFocus();
		return;
	}
	if(edt_MoveRepairWorkNm.Text == ''){
		alert("공사명은 필수입력 사항입니다. ");
		edt_MoveRepairWorkNm.SetFocus();
		return;
	}	
	if(cob_TaxFlag.Text == ''){
		alert("부가세구분은 필수항목입니다. ");
		cob_TaxFlag.SetFocus();
		return;
	}
	
	if(Radio.Value == ''){
		alert("선공사여부는 필수입력 사항입니다. ");
		Radio.SetFocus();
		return;
	}
	if(edt_ZipNo1.Text == '' || edt_ZipNo2.Text == ''){
		alert("공사위치는 필수입력 사항입니다. ");
		if(edt_ZipNo1.text ==''){
			edt_ZipNo1.SetFocus();
		}else{
			edt_ZipNo2.SetFocus();
		}
		return;
	}
	if(cob_MoveRepairType.Value == ''){
		alert("이설보수유형은 필수입력 사항입니다. ");
		cob_MoveRepairType.SetFocus();
		return;
	}			
	
	
	cal_ReceiveYmd_OnChanged();
	
	fn_GetDataSet_Value();
	fn_D1_save();
	
	var result = Confirm("이설보수접수내역 화면으로 이동하시겠습니까? ");
		
	if(result == '0'){
			CLOSE();
			return;
	}

	var strPrefix = "D10";
	var strFormid = "D1701010010F";
	var strArg    = ""; 
	    strArg = strArg + "MOVE_REPAIR_NUM=" + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_NUM") + "%$" + " ";
		strArg = strArg + "BRANCH_CD="       + cob_ObjectFlag.Value + " ";
		strArg = strArg + "ZIP_NO1="         + cob_CountyFlag.Value + " ";
		strArg = strArg + "FLAG="            + "1";
 
	gfn_NewWindow(strPrefix, strFormid, strArg, "이설보수접수내역등록", strFormid, "", 0, "");
	
	//gfn_Dialog("D10","D1701010010F",strArg,705,552,true,-1,-1);
	
	CLOSE();
	
	return;
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Sequence()
//   설명  :  이설보수접수내역 시퀀스 조회
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Sequence(val)
{	
    var strSvcID        = "";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairSpecMgr-service"
						+ "&MOVE_REPAIR_NUM="  + val
						;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Sequence=ds_Sequence";
	var strArgument     = "max";
	 	 
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}

//------------------------------------------------------------------------------- 
//   함수명: fn_GetDataSet_Value()
//   설명  :  원인자 이설 보수 내역 등록 기본 셋팅
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_GetDataSet_Value(){
	
	var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;   // SESSION ID
	var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");   // SESSION IP

	ds_MoveDocuV.AddColumn("UPD_EMPID"     , "STRING", 256 );	// ID
	ds_MoveDocuV.AddColumn("UPD_IP"        , "STRING", 256 );	// IP
	ds_MoveDocuV.AddColumn("CRT_EMPID"     , "STRING", 256 );	// ID
	ds_MoveDocuV.AddColumn("CRT_IP"        , "STRING", 256 );	// IP
	
	ds_MoveDocuV.SetColumn(0, "UPD_EMPID"  , USER_ID       );
	ds_MoveDocuV.SetColumn(0, "UPD_IP"     , USER_IP       );	
	ds_MoveDocuV.SetColumn(0, "CRT_EMPID"  , USER_ID       );
	ds_MoveDocuV.SetColumn(0, "CRT_IP"     , USER_IP       );
	ds_MoveDocuV.SetColumn(0, "PROC_STS_CD", "10"); // 접수 진행 코드
	ds_MoveDocuV.SetColumn(0, "MOVE_REPAIR_NUM", MOVE_REPAIR_NUM_IMSI); // 시퀀스 셋팅
}

//------------------------------------------------------------------------------- 
//   함수명 : fn_D1_SAVE
//   설명  : 이설 보수 접수 내역 저장한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
//-------------------------------------------------------------------------------
//  Transition   : Service id
//  ServicePart   : Service part
//  Url          : Server url
//  InputDsList   : Input Dataset List
//  OutputDsList   : Output Dataset List
//  Argument   :  Argument
//-------------------------------------------------------------------------------
function fn_D1_save(){
	
	var strSvcID         = "";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_MoveingRepairSpecMgr-service";	
	var strInDatasets    = "ds_MoveDocuV=ds_MoveDocuV:u";
	var strOutDatasets   = "";		
	var strArgument      = "insert";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			    );
			   

	if(ErrorCode<0)
	{    
		return false;
	}
			
	fn_D1_save1 (); // 등록 후 변경이력 등록
	fn_D1_update(); // 폐관비용 이설보수번호 등록됨
	
	//"저장을 완료하였습니다."
	gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
}

//------------------------------------------------------------------------------- 
//   함수명 : fn_D1_SAVE1()
//   설명  : 이설 보수 접수 내역 이력 등록한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
//-------------------------------------------------------------------------------
//  Transition   : Service id
//  ServicePart   : Service part
//  Url          : Server url
//  InputDsList   : Input Dataset List
//  OutputDsList   : Output Dataset List
//  Argument   :  Argument
//-------------------------------------------------------------------------------
	
function fn_D1_save1(){	
	
	ds_MoveDocuV.UpdateControl = false;
	ds_MoveDocuV.SetRowType(0, "insert");
	
	var strSvcID         = "";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_MoveingRepairSpecMgr-service";	
	var strInDatasets    = "ds_MoveDocuV=ds_MoveDocuV:u";
	var strOutDatasets   = "";		
	var strArgument      = "insert_his";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			    );
}

//------------------------------------------------------------------------------- 
//   함수명 : fn_D1_UPDATE
//   설명  : 폐관비용번호에 이설보수번호 저장한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
//-------------------------------------------------------------------------------
//  Transition   : Service id
//  ServicePart   : Service part
//  Url          : Server url
//  InputDsList   : Input Dataset List
//  OutputDsList   : Output Dataset List
//  Argument   :  Argument
//-------------------------------------------------------------------------------
function fn_D1_update(){		
				
	var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;   // SESSION ID
	var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");   // SESSION IP

	ds_Move.AddColumn("UPD_EMPID"       , "STRING", 256 );	// ID
	ds_Move.AddColumn("UPD_IP"          , "STRING", 256 );	// IP
	ds_Move.AddColumn("MOVE_REPAIR_NUM" , "STRING", 256 );	// IP
	ds_Move.AddColumn("CLOSE_COST_NUM"  , "STRING", 256 );	// IP
	
	for(var i=0; i<ds_Close_Cost_h_Append.GetRowCount(); i++){
		
		ds_Move.AddRow();
	
		ds_Move.SetColumn(i, "UPD_EMPID"  , USER_ID       );
		ds_Move.SetColumn(i, "UPD_IP"     , USER_IP       );
		
		ds_Move.SetColumn(i, "MOVE_REPAIR_NUM", ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_NUM"         ));
		ds_Move.SetColumn(i, "CLOSE_COST_NUM" , ds_Close_Cost_h_Append.GetColumn(i, "CLOSE_COST_NUM"));
		
		ds_Move.UpdateControl = false;
		ds_Move.SetRowType(i, "update");
	}
			
	var strSvcID         = "";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_MoveingRepairClosingPipeMgr-service";	
	var strInDatasets    = "ds_Move=ds_Move:u";
	var strOutDatasets   = "";		
	var strArgument      = "modify_Move";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			    );			   

}

function cal_ReceiveYmd_OnChanged(obj,strOldText,strNewText)
{	
	// 등록될 이설번호 가져오기
	if(ds_MoveDocuV.GetRowType(0) == 'insert'){
		fn_D1_Sequence(subStr(cal_ReceiveYmd.Value, 0, 6));
		MOVE_REPAIR_NUM_IMSI = subStr(cal_ReceiveYmd.Value, 0, 6) + ds_Sequence.GetColumn(0, "MAX_NUM");
	}
	
	// 접수일자가 없을 경우 이설보수번호도 존재하지 않음
	if(cal_ReceiveYmd.Value == '' || cal_ReceiveYmd.Value == null){
		Edit2.Text = '';
	}
}

function ds_MoveDocuV_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'RECEIVE_YMD'   ){ fn_DateCheckTodayGrid(cal_ReceiveYmd, "접수일자");}
	if(strColumnID == 'CONFERENCE_YMD'){ fn_DateCheckTodayGrid(Calendar0     , "협의일자");}
}
]]></Script>
</Window>