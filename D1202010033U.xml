<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="395" Id="D1202010033U" Left="8" OnLoadCompleted="D1202010033U_OnLoadCompleted" PidAttrib="7" Title="중압직공급조정기&#32;점검표_D1202010033U" Top="8" Ver="1.0" Width="700" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_SpeciDire">
				<Contents>
					<colinfo id="AS_CHK_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_RSLT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_NOT_PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DETAIL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_FLAG" size="256" summ="default" type="STRING"/>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>10</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>가스누출</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>11</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>입상보호대&#32;설치상태</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>12</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>조정기(BOX)설치상태(빗물,직사광선방지)</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>13</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>배관의&#32;비틀림&#32;및&#32;고정상태</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>14</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>조정기&#32;작동상태(소음,진동&#32;유무)</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>15</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>입.출구&#32;압력확인</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>16</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>조정기&#32;등의&#32;부식&#32;또는&#32;손상&#32;및&#32;Vent의&#32;청결상태</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>외관점검</AS_CHK_FLAG>
						<CHK_FLAG>10</CHK_FLAG>
						<CHK_ITEM>17</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>자기압력기록계&#32;확인</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>기능점검</AS_CHK_FLAG>
						<CHK_FLAG>20</CHK_FLAG>
						<CHK_ITEM>20</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>밸브작동(입,출구밸브&#32;작동상태)</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>기능점검</AS_CHK_FLAG>
						<CHK_FLAG>20</CHK_FLAG>
						<CHK_ITEM>21</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>R/V&#32;작동상태(Setting압력에서&#32;작동)</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>기능점검</AS_CHK_FLAG>
						<CHK_FLAG>20</CHK_FLAG>
						<CHK_ITEM>22</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>SSV&#32;작동상태(Setting압력에서&#32;작동)</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>기능점검</AS_CHK_FLAG>
						<CHK_FLAG>20</CHK_FLAG>
						<CHK_ITEM>23</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>필터상태&#32;점검</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<AS_CHK_FLAG>기타</AS_CHK_FLAG>
						<CHK_FLAG>90</CHK_FLAG>
						<CHK_ITEM>99</CHK_ITEM>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CHK_RSLT></CHK_RSLT>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DETAIL_NUM></DETAIL_NUM>
						<FACI_NUM></FACI_NUM>
						<INSPECT_KITEM>조정기&#32;전단의&#32;전위상태</INSPECT_KITEM>
						<PATROL_YMD></PATROL_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SpeciDireList">
				<Contents>
					<colinfo id="CHK_RSLT" size="256" type="STRING"/>
					<colinfo id="RMK1" size="256" type="STRING"/>
					<colinfo id="RMK2" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Flag">
				<Contents>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DETAIL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Align="Left" Height="39" Id="Image0" ImageID="popup_top" LeftMargin="33" Style="popup_title" TabOrder="1" Text="중압직공급조정기&#32;점검표" Transparent="TRUE" Width="700"></Image>
		<Shape BKColor="user16" Bottom="92" Height="3" Id="Shape2" Left="5" LineWidth="0" Right="695" TabOrder="3" Top="89" Type="Rectangle" Width="690"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_SpeciDire" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="368" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="276" Id="grd_Multi" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" OnCellClick="grd_Multi_OnCellClick" Right="695" SelColor="MENU" Style="grid_pop" TabOrder="2" TabStop="true" Top="92" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="690">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="80"/>
						<col width="302"/>
						<col width="60"/>
						<col width="60"/>
						<col width="110"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" rowspan="2" text="NO"/>
						<cell col="1" display="text" rowspan="2" text="구분"/>
						<cell col="2" display="text" rowspan="2" text="점검항목"/>
						<cell col="3" colspan="2" display="text" text="점검결과"/>
						<cell col="6" display="text" rowspan="2" text="비고"/>
						<cell col="3" display="text" row="1" text="적합"/>
						<cell col="4" display="text" row="1" text="부적합"/>
						<cell col="5" display="text" rowspan="2" text="특기사항"/>
					</head>
					<body>
						<cell align="center" bkcolor="user12" col="0" display="text" expr="rowindex+1" SuppressAlign="Middle"/>
						<cell align="center" bkcolor="user12" col="1" colid="AS_CHK_FLAG" display="text" expandsize="18" suppress="1" SuppressAlign="Middle" wordwrap="word"/>
						<cell align="left" bkcolor="user12" col="2" colid="INSPECT_KITEM" display="text" expandsize="18" suppress="2" SuppressAlign="Middle" wordwrap="word"/>
						<cell col="3" colid="CHK_PASS" display="checkbox" edit="checkbox" expandsize="18" wordwrap="word"/>
						<cell col="4" colid="CHK_NOT_PASS" display="checkbox" edit="checkbox" expandsize="18" wordwrap="word"/>
						<cell col="5" colid="RMK2" display="text" edit="normal" expandsize="18" wordwrap="word"/>
						<cell col="6" colid="RMK1" display="text" edit="normal" expandsize="18" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Cursor="HAND" Height="17" Id="Button1" ImageID="search" Left="-152" OnClick="Button8_OnClick" TabOrder="4" Text="Button8" Top="-134" Width="117"></Button>
		<Div DisableBKColor="white" Height="29" Id="Div0" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="5" Text="Div0" Top="39" Url="globals::ComButton.xml" Visible="FALSE" Width="695">
			<Contents></Contents>
		</Div>
		<Image Align="Left" Height="10" Id="Image5" ImageID="blt_8" Left="5" LeftMargin="12" Style="text_title" TabOrder="6" Text="점검내용" Top="71" Width="74"></Image>
		<Static Height="13" Id="Static0" Left="5" Style="static" TabOrder="7" Text="※점검주기&#32;:&#32;일상점검(주1회/주),&#32;기능점검(1회/6월),&#32;분해점검(1회/3년)실시" Top="373" Width="495"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Sanction" ImageID="btn_4" Left="619" LeftMargin="21" OnClick="btn_Sanction_OnClick" Style="button" TabOrder="8" Text="전자결재" Top="68" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button80" ImageID="btn_4_copy" Left="540" LeftMargin="21" OnClick="fn_D1_Print1" Style="button" TabOrder="9" Text="장표출력" Top="69" Width="76"></Button>
		<Static Color="user24" Height="13" Id="edt_DECIDE_PROC_STS" Left="444" TabOrder="10" Top="71" Width="72"></Static>
		<Static Height="13" Id="Static1" Left="380" TabOrder="11" Text="결재상태" Top="72" Width="56"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1202010033U.xml
* Form 설명   : 순찰중점관리 중압직공급조정기 점검대장 조회,등록,수정,삭제
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2008-01-15
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONA10008.js";

var strFaciNum = "";
var strDetailNum = "";
var strPatrolYmd = "";
var strChkFlag = "";
var strRmk1 = "";
var strRmk2 = "";
var strRowType = "";

//---------------------------------------------------------
//	화면 OnLoadCompleted 이벤트처리 발생하는 함수( 화면ID_OnLoadCompleted )
//---------------------------------------------------------
function D1202010033U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
	fn_CommonSearch();
}


function fn_Init()
{	
		
	if(IsExistVar("FACI_NUM"))
	{
		strFaciNum = FACI_NUM;
	}

	strDetailNum = '0001';
	
	if(IsExistVar("PATROL_YMD"))
	{
		strPatrolYmd = PATROL_YMD;
	}
	
	if(DECIDE_PROC_STS == '0')
	{
		edt_DECIDE_PROC_STS.Text = '결재완료';
	}	
	else if(DECIDE_PROC_STS == '2')
	{
		edt_DECIDE_PROC_STS.Text = '결재중';
	}		
	else if(DECIDE_PROC_STS == '4')
	{
		edt_DECIDE_PROC_STS.Text = '요청취소';
	}		
	else if(DECIDE_PROC_STS == '5')
	{
		edt_DECIDE_PROC_STS.Text = '반려';
	}	
	 
	
	// if(IsExistVar("ROWTYPE"))
	// {
		// strRowType = ROWTYPE;
		// if(strRowType == "search" || strRowType == "update")
		// {
			// fn_D1_Find();
		// }
		// if(strRowType == "search" )
		// {
			// grd_Multi.Enable = "false";
		// }
	// }
}


/*===============================================================================
 * 공통 div_ComHead 에서 버튼 이벤트
		추가	fn_CommonAddRow
		삭제	fn_CommonDeleteRow
		저장	fn_CommonSave
		조회	fn_CommonSearch
		엑셀	fn_CommonExcelExport
		인쇄	fn_CommonPrint
		닫기	공통에서 처리
===============================================================================*/ 

/*===============================================================================
 * 함수명: fn_CommonAddRow()
   설명: 탭별  내용를 신규 추가 하는 모드로 변경 하는 함수
   return 내용: 없음
===============================================================================*/ 
function fn_CommonAddRow()
{
	fn_D1_Addrowm();
}

/*===============================================================================
 * 함수명: fn_CommonDeleteRow()
   설명: 탭별 삭제 하는 함수
   return 내용: 없음
===============================================================================*/ 
function fn_CommonDeleteRow()
{
	fn_D1_DeleteRow();
}

/*===============================================================================
 * 함수명: fn_CommonSave()
   설명: 탭별 상세 내용를 저장 하는 함수
   return 내용: 없음
===============================================================================*/ 
function fn_CommonSave()
{
	fn_D1_Save();
}

/*===============================================================================
 * 함수명: fn_CommonSearch()
   설명: 공통 조회 클릭시 조회 업무  수행 
   return 내용: 없음
===============================================================================*/ 
function fn_CommonSearch()
{
	fn_D1_Find();
}

//---------------------------------------------------------
//	공통 버튼 클릭 - 엑셀 Export
//---------------------------------------------------------
function fn_CommonExcelExport()
{

}

//---------------------------------------------------------
//	공통 버튼 클릭 - Print
//---------------------------------------------------------
function fn_CommonPrint()
{
	PrintScreen(true);
}

//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Find()
// 설명     : 순찰점검 주 계획을 조회한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------

function fn_D1_Find()
{	
	var strSvcID = "fn_D1_Find";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1202010033U-service"
	           + "&FACI_NUM="		+strFaciNum					//특별관리시설번호코드
	           + "&DETAIL_NUM="		+strDetailNum				//상세번호
	           + "&PATROL_YMD=" 	+strPatrolYmd				//순찰일자
	           ;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_SpeciDireList=ds_SpeciDireList";
	var strArgument  = "find";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	
	fn_D1_Set();
}


//------------------------------------------------------------------------------- 
// 함수명: fn_D1_Set()
//   설명:  순찰중점관리 교량첨가배관 점검대장 해당 내용을 셋팅한다.
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Set()
{	
	for(var i=0;i<ds_SpeciDireList.RowCount();i++)
	{
		if(ds_SpeciDireList.GetColumn(i,"CHK_RSLT") == "1")			//점검결과
		{
			ds_SpeciDire.SetColumn(i,"CHK_PASS",1);					//양호
		}else if(ds_SpeciDireList.GetColumn(i,"CHK_RSLT") == "2")	//점검결과
		{
			ds_SpeciDire.SetColumn(i,"CHK_NOT_PASS",1);				//불량
		}
		ds_SpeciDire.SetColumn(i,"RMK2",ds_SpeciDireList.GetColumn(i,"RMK2"));	//특기사항
		ds_SpeciDire.SetColumn(i,"RMK1",ds_SpeciDireList.GetColumn(i,"RMK1"));	//비고
	}
}


//---------------------------------------------------------
// 검사 결과 에 따른 체크값 설정
//---------------------------------------------------------
function grd_Multi_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if("CHK_PASS" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		ds_SpeciDire.SetColumn(nRow,"CHK_NOT_PASS",0);
	}else if("CHK_NOT_PASS" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		ds_SpeciDire.SetColumn(nRow,"CHK_PASS",0);
	}
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Save
//   설명  : 점검표를 등록한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Save()
{
	if(ds_SpeciDire.RowCount() == 0)
	{
		return;
	}
	
	// 2012.01.30 결재완료 : 0, 결재중 : 2 를 제외한 나머지는 전가결재 가능하게 수정 - 이건민
	/*
	if(DECIDE_PROC_STS == '0' || DECIDE_PROC_STS == '1' || DECIDE_PROC_STS == '2')
	{
		alert("현재 " + edt_DECIDE_PROC_STS.text + "입니다 수정불가");
		return;
	}	
	*/
	
	if(DECIDE_PROC_STS == '0' || DECIDE_PROC_STS == '2')
	{
		alert("현재 " + edt_DECIDE_PROC_STS.text + "입니다 수정불가");
		return;
	}
	
	var strType = "";
	var strChkRslt = "";
	var strRmk1 = "";
	var strRmk2 = "";
	
	
	// if(strRowType == "update")
	// {
		// strType = "update";
	// }else if(strRowType == "insert")
	// {
		// strType = "insert";
	// }else {
		// close();
	// }
	
	for(var i=0; i<ds_SpeciDire.RowCount(); i++)
	{
		var strRstCd = 0;
		if(ds_SpeciDire.GetColumn(i,"CHK_PASS") == 1)
		{
			strRstCd = "1";
		}else if(ds_SpeciDire.GetColumn(i,"CHK_NOT_PASS") == 1)
		{
			strRstCd = "2";
		}//else 
		// {
			// alert('검사항목을 모두 체크해 주세요');
			// return;
		// }
		
		ds_SpeciDire.UpdateControl = false;
		
		if(ds_SpeciDireList.GetRowCount()>0)
		{
			ds_SpeciDire.SetRowType(i, "update");
		}
		else
		{
			ds_SpeciDire.SetRowType(i, "insert");
		}
		// ds_SpeciDire.UpdateControl = false;
		// ds_SpeciDire.SetRowType(i, strType);
		//수정 등록시 셋팅할 사용자 정보
		ds_SpeciDire.SetColumn(i, "FACI_NUM", strFaciNum);
		ds_SpeciDire.SetColumn(i, "DETAIL_NUM", strDetailNum);
		ds_SpeciDire.SetColumn(i, "PATROL_YMD", strPatrolYmd);
		ds_SpeciDire.SetColumn(i, "CHK_RSLT", strRstCd);

		ds_SpeciDire.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));
		ds_SpeciDire.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));
		ds_SpeciDire.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));
		ds_SpeciDire.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));
		strRstCd = 0;
	}
	
	var strSvcID         = "fn_D1_Save";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1202010033U-service" ;					
	var strInDatasets    = "ds_SpeciDire=ds_SpeciDire:u";
	var strOutDatasets   = "";		
	var strArgument      = "save";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	if(ErrorCode < 0)
	{
		Close("saveNo");
		return;
	}
    else
    {
        fn_D2_update();
		alert(gfn_GetMessage("M000009","%AAA%","저장을"));
		
		Close("saveOk");
	}
}
//------------------------------------------------------------------------------- 
//   함수명: fn_D2_update
//   설명  : 중압직공급 점검등록여부 업데이트 
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D2_update()
{
	ds_Flag.ClearData();
	ds_Flag.AddRow();
	ds_Flag.SetColumn(0, "FACI_NUM", strFaciNum);
	ds_Flag.SetColumn(0, "DETAIL_NUM", strDetailNum);
	ds_Flag.SetColumn(0, "PATROL_YMD", strPatrolYmd);
	ds_Flag.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));
	ds_Flag.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	ds_Flag.UpdateControl = false;
	ds_Flag.SetRowType(0,"update");
	
	var strSvcID         = "fn_D1_Save2";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1202010033U-service" ;					
	var strInDatasets    = "ds_Flag=ds_Flag:u";
	var strOutDatasets   = "";		
	var strArgument      = "update";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	if(ErrorCode < 0)
	{
		return;
	}
}
//-------------------------------------------------------------------------------
// 함수명   : btn_Sanction_OnClick(obj)
// 설명     : 전자결재
// return 내용 : 없음
//-------------------------------------------------------------------------------
function btn_Sanction_OnClick(obj)
{
	
	// 2012.01.30 결재완료 : 0, 결재중 : 2 를 제외한 나머지는 전가결재 가능하게 수정 - 이건민
	/*
	if(DECIDE_PROC_STS == '0' || DECIDE_PROC_STS == '1' || DECIDE_PROC_STS == '2')
	{
		alert("현재 " + edt_DECIDE_PROC_STS.text + "입니다");
		return;
	}	 	
	*/ 
	
	if(DECIDE_PROC_STS == '0' || DECIDE_PROC_STS == '2')
	{
		alert("현재 " + edt_DECIDE_PROC_STS.text + "입니다");
		return;
	}	 	
	
	if(ds_SpeciDireList.GetRowCount()>0)
	{
		var FaciNum = strFaciNum;
		var PatrolYmd = strPatrolYmd;
		var DetailNum = strDetailNum; 	//DETAIL_NUM 상세번호(PK) 추가해주기
		gfv_callGWInfo("fmD06","D10","D1202010033P",3,FaciNum+","+DetailNum+","+PatrolYmd);
	   // 1번 : 화면명칭   2번 : 업무그룹 (b10,b20... OZ 인경우 필수), 3번: 프로그램ID (oz인경우 필수) 4: 아규먼트 갯수 (1....5)
	   // 5번 : 아규먼트 목록 (형식 , 표시로 각 아규먼트 구분자 사용)
	}
	
}

function fn_D1_Print1(obj)
{
	var strTitle    = "중앙직공급 조정기 점검표" ;  		// 출력물 제목
    var strPart     = "D10" ;         	    		  				// 시스템 명 
	var strReport   = "D1202010033P" ;  	    	 				// 출력물 ID 
	var strParameter= "FACI_NUM="    + strFaciNum
				    + ",DETAIL_NUM="	+ strDetailNum
				    + ",PATROL_YMD="	+ strPatrolYmd
				    ;		   
				   
	//공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);	
}

// function D1202010033U_OnUnloadCompleted(obj)
// {
	// if(ds_SpeciDire.GetUpdate())
	// {
		// if(!confirm(gfn_GetMessage("M000016","%AAA%","편집중인 내용을 무시하고 종료")))
		 // {
			 // return false;
		 // }	
	// }
// }

//------------------------------------------------------------------------------- 
//   함수명: fn_Card(obj)
//   설명  :  정배류기 점검대장 팝업
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_OZ_OnClick(obj)
{

	if(ds_SpeciDireList.GetRowCount()>0)
	{
		// 함수 호출용 파라미터를 설정한다
		var strTitle    ="중압직공급 조정기점검표"; 
		var strPart     ="D10";           
		var strReport   ="D1202010034P";	//화면 아이디 따기                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 ㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊㅊ"; 
		var strParameter="FACI_NUM=" 	+FACI_NUM
						+",PATROL_YMD=" +PATROL_YMD
						;
		//gfn_bt_d2_Report
		// 공통 레포트 팝업 함수 호출 
		gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
	}
}]]></Script>
</Window>