<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="748" Id="D1202010011F_T06" Left="8" OnLoadCompleted="D1202010011F_T06_OnLoadCompleted" OnUnloadCompleted="D1202010011F_T06_OnUnloadCompleted" PidAttrib="7" Title="배류기순찰점검등록_D1202010011F_T06" Top="8" Ver="1.0" Width="1260" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi_T06">
				<Contents>
					<colinfo id="column0" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Drainage"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DrainageSave">
				<Contents>
					<colinfo id="FACI_NUM" size="8" summ="default" type="CHAR"/>
					<colinfo id="PATROL_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="UPD_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="UPD_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="UPD_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="CRT_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="CRT_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="VOLTAGE" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="VOLTAIC" size="5" summ="default" type="DECIMAL"/>
					<colinfo id="CHK_DESC" size="160" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="9" summ="default" type="CHAR"/>
					<colinfo id="TAKER_EMPID2" size="9" summ="default" type="CHAR"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIFT_WORK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Dub"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel"></Dataset>
		</Datasets>
		<Shape BKColor="user15" Bottom="23" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1251" TabOrder="1" Top="20" Type="Rectangle" Width="1246"></Shape>
		<Image Align="Left" Height="13" Id="Image9" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="2" Text="배류기&#32;정보" Top="289" Width="117"></Image>
		<Image Align="Left" Height="14" Id="Image0" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="3" Text="순찰점검&#32;등록" Top="511" Width="137"></Image>
		<Shape BKColor="user15" Bottom="531" Height="3" Id="Shape1" Left="5" LineWidth="0" Right="1251" TabOrder="5" Top="528" Type="Rectangle" Width="1246"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_DrainageSave" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="743" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="212" Id="grd_MultiSave" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_MultiSave_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="4" TabStop="true" Top="531" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="25"/>
						<col width="100"/>
						<col width="110"/>
						<col width="468"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell bkcolor="user11" col="2" display="text" text="점검일자"/>
						<cell col="3" display="text" text="전압(V)"/>
						<cell col="4" display="text" text="전류(A)"/>
						<cell col="5" colspan="2" display="text" text="전위(mV)"/>
						<cell bkcolor="user11" col="7" display="text" text="점검표등록여부"/>
						<cell col="8" display="text" text="점검사항"/>
						<cell col="9" display="text" text="점검자&#32;1"/>
						<cell col="10" display="text" text="점검자&#32;2"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell col="2" colid="PATROL_YMD" display="date" expandsize="18" wordwrap="word"/>
						<cell align="right" col="3" colid="VOLTAGE" display="number"/>
						<cell align="right" col="4" colid="VOLTAIC" display="number"/>
						<cell align="right" col="5" display="text" text="-"/>
						<cell align="left" col="6" colid="RECTIFER_ELECT_POT" display="text"/>
						<cell col="7" colid="CHK_DOCU_REF_YN" display="combo" expandimage="popup" expandshow="true"/>
						<cell col="8" colid="CHK_DESC" display="text"/>
						<cell align="center" col="9" colid="TAKER_EMPID1_NM" display="text"/>
						<cell align="center" col="10" colid="TAKER_EMPID2_NM" display="text" expandsize="18" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button276" ImageID="btn_8_Inquiry" Left="1124" LeftMargin="21" OnClick="btn_Drainage_OnClick" Style="button" TabOrder="6" Text="순찰점검&#32;이력조회" Top="507" Width="127"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button282" ImageID="btn_6_reg" Left="1020" LeftMargin="21" OnClick="btn_MainterReq_OnClick" Style="button" TabOrder="7" Text="정비보수의뢰" Top="507" Width="100"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Multi_T06" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="284" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="261" Id="grd_Multi" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_Multi_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="8" TabStop="true" Top="23" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="83"/>
						<col width="100"/>
						<col width="124"/>
						<col width="83"/>
						<col width="280"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="28"/>
						<col width="18"/>
						<col width="31"/>
						<col width="40"/>
						<col width="17"/>
						<col width="45"/>
						<col width="25"/>
						<col width="20"/>
						<col width="20"/>
						<col width="25"/>
						<col width="20"/>
						<col width="30"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="배류기번호"/>
						<cell col="3" display="text" text="배류기명"/>
						<cell col="4" display="text" text="팀"/>
						<cell col="5" display="text" text="구간"/>
						<cell col="6" display="text" text="주소"/>
						<cell col="7" display="text" text="시설구분"/>
						<cell col="8" display="text" text="계획일자"/>
						<cell col="9" display="text" text="최근점검일자"/>
						<cell col="10" colspan="3" display="text" text="공사정보조회"/>
						<cell col="13" colspan="3" display="text" text="방식설비대장보기"/>
						<cell col="16" colspan="3" display="text" text="시설물카드"/>
						<cell col="19" colspan="3" display="text" text="GIS위치보기"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="FACI_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell col="3" colid="DRAINAGE_NM" display="text"/>
						<cell col="4" colid="TEAM_NM" display="text"/>
						<cell col="5" colid="BLOCK_CD" display="text"/>
						<cell col="6" colid="LOT_NUM_UNION" display="text"/>
						<cell col="7" colid="FACI_FLAG" display="text"/>
						<cell col="8" colid="PLAN_YMD" display="date"/>
						<cell col="9" colid="PATROL_YMD" display="date"/>
						<cell col="10" display="text"/>
						<cell col="11" colid="WORK_INFO" display="text" expandimage="search" expandshow="true"/>
						<cell col="12" display="text"/>
						<cell col="13" display="text"/>
						<cell col="14" colid="CATH_LST" display="text" expandimage="search" expandshow="true"/>
						<cell col="15" display="text"/>
						<cell col="16" colid="FACI_CARD" colspan="3" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text" expandimage="search" expandshow="true" expandsize="17"/>
							<cell col="2" display="text"/>
						</cell>
						<cell col="19" colid="GIS_POSITION" colspan="3" display="text">
							<cell col="0" display="text"/>
							<cell col="1" display="text" expandimage="search" expandshow="true" expandsize="17"/>
							<cell col="2" display="text"/>
						</cell>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Height="13" Id="Static4" Left="989" Style="static" TabOrder="9" Text="※미점검&#32;&#32;&#32;&#32;&#32;개,&#32;금일점검&#32;&#32;&#32;&#32;&#32;&#32;개,&#32;점검대상&#32;&#32;&#32;&#32;&#32;개" Top="6" Width="264"></Static>
		<Static Align="Right" Height="10" Id="Static6" Left="1032" Style="static" TabOrder="10" Text="00" Top="6" Width="24"></Static>
		<Static Align="Right" Height="10" Id="Static53" Left="1122" Style="static" TabOrder="11" Text="00" Top="6" Width="24"></Static>
		<Static Align="Right" Height="10" Id="Static54" Left="1212" Style="static" TabOrder="12" Text="00" Top="6" Width="24"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static30" Left="110" Style="table" TabOrder="50" Top="478" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static18" Left="110" Style="table" TabOrder="13" Top="331" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static22" Left="110" Style="table" TabOrder="15" Top="352" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static23" Left="5" Style="table" TabOrder="14" Text="주소" Top="352" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static25" Left="110" Style="table" TabOrder="17" Top="373" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static26" Left="5" Style="table" TabOrder="16" Text="신주소" Top="373" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static28" Left="110" Style="table" TabOrder="19" Top="394" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static29" Left="5" Style="table" TabOrder="18" Text="정격용량" Top="394" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static45" Left="629" Style="table" TabOrder="20" Text="시공감리일" Top="394" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static0" Left="110" Style="table" TabOrder="22" Top="310" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static1" Left="5" Style="table" TabOrder="21" Text="시설물번호" Top="310" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static2" Left="317" Style="table" TabOrder="23" Text="배류기명" Top="310" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static5" Left="629" Style="table" TabOrder="24" Text="공사번호" Top="310" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static8" Left="5" Style="table" TabOrder="25" Text="시공업체" Top="331" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static3" Left="110" Style="table" TabOrder="27" Top="415" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static11" Left="5" Style="table" TabOrder="26" Text="출력전류" Top="415" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static12" Left="110" Style="table" TabOrder="29" Top="436" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static13" Left="5" Style="table" TabOrder="28" Text="점용면적(m²)" Top="436" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static24" Left="317" Style="table" TabOrder="30" Text="임피던스본드" Top="415" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static16" Left="317" Style="table" TabOrder="31" Text="시설구분" Top="394" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static7" Left="110" Style="table" TabOrder="33" Top="457" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="5" Style="table" TabOrder="32" Text="계량기번호" Top="457" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static14" Left="317" Style="table" TabOrder="34" Text="제조사" Top="436" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static15" Left="629" Style="table" TabOrder="35" Text="점용관리대상여부" Top="415" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static17" Left="629" Style="table" TabOrder="36" Text="제조일자" Top="436" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="FACI_NUM" Enable="FALSE" Height="18" Id="edt_FaciNum" ImeMode="none" Left="143" Style="edit" TabOrder="37" Top="312" Width="171"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static27" Left="317" Style="table" TabOrder="38" Text="고객번호" Top="457" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="DRAINAGE_NM" Enable="FALSE" Height="18" Id="edt_DRAINAGE_NM" ImeMode="none" Left="455" Style="edit" TabOrder="39" Top="312" Width="171"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static10" Left="629" Style="table" TabOrder="40" Text="AC전원" Top="457" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Drainage" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="edt_ZipNo1" ImeMode="none" Left="143" Style="edit" TabOrder="41" Top="354" Width="38"></Edit>
		<Static Height="13" Id="C2502030010F" Left="182" Style="static" TabOrder="42" Text="-" Top="357" Width="10"></Static>
		<Edit Align="CENTER" BindDataset="ds_Drainage" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="edt_ZipNo2" ImeMode="none" Left="190" Style="edit" TabOrder="43" Top="354" Width="38"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="LOT_NUM_UNION" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="229" Style="edit" TabOrder="44" Top="354" Width="1018"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="NEW_ADDR_UNION" Enable="FALSE" Height="18" Id="Edit7" ImeMode="none" Left="229" Style="edit" TabOrder="48" Top="375" Width="1018"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Drainage" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="Edit14" ImeMode="none" Left="143" Style="edit" TabOrder="45" Top="375" Width="38"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Drainage" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="Edit21" ImeMode="none" Left="190" Style="edit" TabOrder="47" Top="375" Width="38"></Edit>
		<Static Height="13" Id="Static20" Left="182" Style="static" TabOrder="46" Text="-" Top="378" Width="10"></Static>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="RMK" Enable="FALSE" Height="18" Id="edt_Rmk" ImeMode="none" Left="143" Style="edit" TabOrder="51" Top="480" Width="1104"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static31" Left="5" Style="table" TabOrder="49" Text="특기사항" Top="478" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static33" Left="941" Style="table" TabOrder="53" Text="지사" Top="310" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static34" Left="941" Style="table" TabOrder="52" Text="출력전압" Top="394" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static35" Left="941" Style="table" TabOrder="54" Text="점용구분" Top="415" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static36" Left="941" Style="table" TabOrder="55" Text="원방전위대상" Top="436" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static37" Left="941" Style="table" TabOrder="56" Text="지하철명" Top="457" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static38" Left="317" Style="table" TabOrder="57" Text="중압&#32;방식연장(m)" Top="331" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static39" Left="629" Style="table" TabOrder="58" Text="저압&#32;방식연장(m)" Top="331" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="WORK_NUM" Enable="FALSE" Height="18" Id="edt_WorkNum" ImeMode="none" Left="767" Style="edit" TabOrder="59" Top="312" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="M_PRESS_CATHODIC_LENG" Enable="FALSE" Height="18" Id="edt_MPressCathodicLeng" ImeMode="none" Left="455" Style="edit" TabOrder="60" Top="333" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="L_PRESS_CATHODIC_LENG" Enable="FALSE" Height="18" Id="edt_LPressCathodicLeng" ImeMode="none" Left="767" Style="edit" TabOrder="61" Top="333" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="CUST_NUM" Enable="FALSE" Height="18" Id="edt_CustNum" ImeMode="none" Left="455" Style="edit" TabOrder="62" Top="459" Width="171"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="IMPEDANCE_BOND_NUM" Enable="FALSE" Height="18" Id="edt_ImpedanceBondNum" ImeMode="none" Left="455" Style="edit" TabOrder="63" Top="417" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="SQUARE" Enable="FALSE" Height="18" Id="edt_Square" ImeMode="none" Left="143" Style="edit" TabOrder="64" Top="438" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="MTR_NUM" Enable="FALSE" Height="18" Id="edt_MtrNum" ImeMode="none" Left="143" Style="edit" TabOrder="65" Top="459" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="OUTPUT_VOLTAIC" Enable="FALSE" Height="18" Id="edt_OutputVoltaic" ImeMode="none" Left="143" Style="edit" TabOrder="66" Top="417" Width="171"></Edit>
		<Calendar BindDataset="ds_Drainage" Border="Flat" Column="INST_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="Calendar0" Left="767" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="67" Top="396" WeeksFont="Default,-1" Width="171"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static21" Left="941" Style="table" TabOrder="68" Text="사용전압" Top="331" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="OUTPUT_VOLTAGE" Enable="FALSE" Height="18" Id="edt_OutputVoltage" ImeMode="none" Left="1079" Style="edit" TabOrder="69" Top="396" Width="168"></Edit>
		<Calendar BindDataset="ds_Drainage" Border="Flat" Column="MAKE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_MakeYmd" Left="767" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="70" Top="438" WeeksFont="Default,-1" Width="171"></Calendar>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="SUBWAY_NM" Enable="FALSE" Height="18" Id="edt_SubwayNm" ImeMode="none" Left="1079" Style="edit" TabOrder="71" Top="459" Width="168"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="WORK_FIRM_CD" Enable="FALSE" Height="18" Id="edt_WorkFirmCd" ImeMode="none" Left="143" Style="edit" TabOrder="72" Top="333" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="USE_FORMAL_CAPA" Enable="FALSE" Height="18" Id="edt_UseFormalCapa" ImeMode="none" Left="143" Style="edit" TabOrder="73" Top="396" Width="171"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="LEASE_FLAG" Enable="FALSE" Height="18" Id="edt_LeaseFlag" ImeMode="none" Left="1079" Style="edit" TabOrder="74" Top="417" Width="168"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="ELECT_POT_YN" Enable="FALSE" Height="18" Id="edt_ElectPotYn" ImeMode="none" Left="1079" Style="edit" TabOrder="75" Top="438" Width="168"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="BRANCH_CD" Enable="FALSE" Height="18" Id="edt_BranchCd" ImeMode="none" Left="1079" Style="edit" TabOrder="76" Top="312" Width="168"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="USE_VOLTAGE" Enable="FALSE" Height="18" Id="edt_UseVoltage" ImeMode="none" Left="1079" Style="edit" TabOrder="77" Top="333" Width="168"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="LEASE_MANAGE_OBJ_YN" Enable="FALSE" Height="18" Id="edt_LeaseManageObjYn" ImeMode="none" Left="767" Style="edit" TabOrder="78" Top="417" Width="171"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_Drainage" Border="Flat" Column="AC_ELECT" Enable="FALSE" Height="18" Id="edt_AcElect" ImeMode="none" Left="767" Style="edit" TabOrder="79" Top="459" Width="171"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="FACI_FLAG" Enable="FALSE" Height="18" Id="edt_FaciFlag" ImeMode="none" Left="455" Style="edit" TabOrder="81" Top="396" Width="171"></Edit>
		<Edit BindDataset="ds_Drainage" Border="Flat" Column="MAKER_NM" Enable="FALSE" Height="18" Id="edt_MakerNm" ImeMode="none" Left="455" Style="edit" TabOrder="80" Top="438" Width="171"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button47" ImageID="btn_8_Stat" Left="889" LeftMargin="21" OnClick="fn_MeasElectPot_OnClick" Style="button" TabOrder="82" Text="측정전위&#32;통계보기" Top="507" Width="127"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Excel" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="809" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="50" Id="grd_Excel" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_Multi_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="83" TabStop="true" Top="759" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="40"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="배류기번호"/>
						<cell col="3" display="text" text="배류기명"/>
						<cell col="4" display="text" text="팀"/>
						<cell col="5" display="text" text="구간"/>
						<cell col="6" display="text" text="주소"/>
						<cell col="7" display="text" text="시설구분"/>
						<cell col="8" display="text" text="계획일자"/>
						<cell col="9" display="text" text="최근점검일자"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="FACI_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell col="3" colid="DRAINAGE_NM" display="text"/>
						<cell col="4" colid="TEAM_CD" display="text"/>
						<cell col="5" colid="BLOCK_CD" display="text"/>
						<cell col="6" colid="LOT_NUM_UNION" display="text"/>
						<cell col="7" colid="FACI_FLAG" display="text"/>
						<cell col="8" colid="PLAN_YMD" display="date"/>
						<cell col="9" colid="PATROL_YMD" display="date"/>
					</body>
				</format>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1201010010F_T06.xml
* Form 설명   : 배류기 순찰점검등록 조회,등록,수정,삭제
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2008-12-11
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONA10008.js";

var strRowType = "";
var strFaciNum = "";		//배류기번호
var strPatrolYmd = "";		//순찰일자

var fv_BranchCd    = "";
var fv_TeamCd      = "";
var fv_ShiftWorkCd = "";
var fv_ZipNo1      = "";
var fv_ChkYear     = "";
var fv_ChkQuarter  = "";
var fv_BlockCd     = "";
var fv_PlanYmd     = "";

function D1202010011F_T06_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	gfn_D1_SetGrid_Sort(grd_Multi);
	gfn_D1_SetGrid_Sort(grd_MultiSave);
	fn_D1_Combo_Set();
	
	if (IsExistVar("PORTLET_FLAG", true)){
		if (PORTLET_FLAG == "p"){
			fn_D1_PortletFind(FACI_NUM, PLAN_YMD);
		}
	}
}


function fn_D1_Combo_Set()
{
	grd_MultiSave.SetCellProp("body",7,"Edit","none");
}


//------------------------------------------------------------------------------- 
// 함수명: fn_D1_ExcelExport()
//  설명: 특별관리시설 엑셀로 저장
// arguments   
//  return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_ExcelExport()
{ 
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 :"     	+ RPad(cob_PBranchCd.Text," ",20);
    SearchCondition = SearchCondition + "팀 :"       	+ RPad(cob_PTeamCd.Text," ",20);
    SearchCondition = SearchCondition + "조 :"       	+ RPad(cob_PShiftWorkCd.Text," ",20);
    SearchCondition = SearchCondition + "구간코드 :" + RPad(cob_block.Text," ",20);
    SearchCondition = SearchCondition + "순찰일자 :" 	+ RPad(cal_PPatrolYmd.Text," ",20);
    SearchCondition = SearchCondition + "시설물번호 :" 	+ RPad(edt_PFaciNum.Text," ",20);
    
	gfn_ExportExcel("배류기 순찰점검등록", 5, SearchCondition, "grd_Excel");
}


function fn_D1_Find()
{
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_Find()
	// 설명     : 순찰점검 주 계획을 조회한다.
	// return 내용 : 없음
	//-------------------------------------------------------------------------------
	
	//입력한 날짜가 오늘 보다 클 경우
	if(!fn_DateCheckToday(cal_PPatrolYmd))
	{
		return;
	}

	ds_Drainage.ClearData();
	ds_DrainageSave.ClearData();

	var strSvcID = "fn_D1_Find";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	           + "&BRANCH_CD="		+cob_PBranchCd.Value		//지사코드
	           + "&BLOCK_CD=" 		+cob_block.Value         	//구코드
	           + "&TEAM_CD=" 		+cob_PTeamCd.Value			//팀코드
	           + "&SHIFT_WORK_CD="  +cob_PShiftWorkCd.Value		//조코드
	           + "&PATROL_YMD=" 	+cal_PPatrolYmd.Value		//순찰일자
	           + "&FACI_NUM="	    +edt_PFaciNum.Text			//시설물번호
	           ;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_T06=ds_Multi ds_Excel=ds_Excel";
	var strArgument  = "find6";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	              
	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}			
	
	if(ds_Multi_T06.GetRowCount()==0) trace("조회결과가 없습니다.");
	
	if(ds_Multi_T06.GetRowCount()==0)
	{
        grd_Multi.NoDataText="조회결과가 없습니다.";
    }
	
	strFaciNum = ""; 	//담은 값을 지움 한 번 조회를 탄 후 값을 가지고 있으므로 null처리를 안해주면 
						//한번 조회 후 다시 조회 할때 '순찰계획을 선택해주세요' 라는 alert이 안뜨고 그냥 행추가가 되는것을 막기위한 
}


function grd_Multi_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if("FACI_CARD" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		fn_Card(nRow);
	}

	if("GIS_POSITION" == grd_Multi.GetCellProp("body",nCell,"ColId"))
	{
		var args = "BUNGI='12' FACI_NUM=" +ds_Multi_T06.GetColumn(nRow,"FACI_NUM");
		gfn_Dialog("D10","D1402060011U",args,1208,840,true,-1,-1);	//GIS 불러오기
	}

	if("CATH_LST" == grd_Multi.GetCellProp("body",nCell,"ColId"))		//방설비대장보기
	{
		var Arguments = "fv_faciNum=" +ds_Multi_T06.GetColumn(nRow,"FACI_NUM");
		trace("Arguments"+Arguments);
		var Result = gfn_Dialog("D10","D1101010013U",Arguments,660,767,true,-1,-1);
		G_ACTIVEWIN = parent.id;
	}
	
	if("WORK_INFO" == grd_Multi.GetCellProp("body",nCell,"ColId"))		//공사정보조회
	{
		var strPrefix = "B20";
		var strFormid = "B2204010010F";
		var strArg    = "";
		gfn_NewWindow(strPrefix,strFormid,strArg);
	}

	strFaciNum  = ds_Multi_T06.getColumn(nRow,"FACI_NUM");
	strPatrolYmd = ds_Multi_T06.GetColumn(nRow,"PATROL_YMD");
	fv_BranchCd     = ds_Multi_T06.GetColumn(nRow,"BRANCH_CD" );  
	fv_TeamCd       = ds_Multi_T06.GetColumn(nRow,"TEAM_CD" );
	fv_ShiftWorkCd  = ds_Multi_T06.GetColumn(nRow,"SHIFT_WORK_CD" );
	fv_ZipNo1       = ds_Multi_T06.GetColumn(nRow,"ZIP_NO1" );
	fv_ChkYear      = ds_Multi_T06.GetColumn(nRow,"CHK_YEAR" );
	fv_ChkQuarter   = ds_Multi_T06.GetColumn(nRow,"CHK_QUARTER" );
	fv_BlockCd      = ds_Multi_T06.GetColumn(nRow,"BLOCK_CD" );
	fv_PlanYmd      = ds_Multi_T06.GetColumn(nRow,"PLAN_YMD" );
	fn_D1_DetailFind(strFaciNum);
	
	strRowType = "search";
}


function fn_Card(nRow)
{
//------------------------------------------------------------------------------- 
//   함수명: fn_Card(obj)
//   설명  :  밸브 시설물카드조회 팝업
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 

	// 함수 호출용 파라미터를 설정한다
	var strTitle ="배류기시설물카드조회"; 
	var strPart ="D10";           
	var strReport="D1202010024P"; 
	var strParameter="FACI_NUM=" 	+ds_Multi_T06.GetColumn(nRow,"FACI_NUM")    
					;
	//gfn_bt_d2_Report
	// 공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
} 


function fn_D1_DetailFind(strFaciNum)
{
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_Find()
	// 설명     : 순찰점검 주 계획을 조회한다.
	// return 내용 : 없음
	//-------------------------------------------------------------------------------

	var strSvcID = "fn_D1_DetailFind";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	           + "&FACI_NUM="	    +strFaciNum			//시설물번호
	           ; 
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Drainage=ds_Drainage ds_DrainageSave=ds_DrainageSave";
	var strArgument  = "find6_Detail";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	              
	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}		
	
	if(ds_DrainageSave.GetRowCount()==0) trace("조회결과가 없습니다.");
	
	if(ds_DrainageSave.GetRowCount()==0)
	{
        grd_MultiSave.NoDataText="조회결과가 없습니다.";
    }
}


function fn_D1_Save()
{
//------------------------------------------------------------------------------- 
//   함수명: fn_D1_SAVE
//   설명  : 사유지 점용료 협의사항를 등록/업데이트한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
	
	if(ds_DrainageSave.RowCount() == 0)
	{
		return;
	}
	
	if(strFaciNum != "")
	{
		if(ds_DrainageSave.GetRowType(0) == "insert")
		{
			var strChkFlag = fn_D1_CheckReg();
			
			if(!strChkFlag) 
			{
				alert('이미 등록된 순찰일자입니다.');
				return;
			}
		}
	}else{
		alert('상세화면 조회 후 가능합니다.');
		return;
	}
	
	/*	달력이 필요가 없어짐(오늘 날짜로 무조건 set해주기 때문)
	if(ds_DrainageSave.GetColumn(0,"PATROL_YMD") == "" || ds_DrainageSave.GetColumn(0,"PATROL_YMD") == null)	//순찰일자
	{
		alert(gfn_GetMessage("M000011","%AAA%","순찰일자를"));	//순찰일자를 입력하세요
		return;
	}	
	*/
	
	if(ds_DrainageSave.GetColumn(0,"CHK_DOCU_REF_YN") == "미점검")	//점검대장 등록여부
	{
		alert('점검대장 등록여부를 등록해주세요.');
		return;
	}
	
	if(ds_DrainageSave.GetColumn(0,"CHK_DESC") == ""||ds_DrainageSave.GetColumn(0,"CHK_DESC") == null)
	{
		alert(gfn_GetMessage("M000011","%AAA%","점검사항을"));	//점검사항을 입력하세요
		return;
	}
	
	//수정 등록시 셋팅할 사용자 정보
	ds_DrainageSave.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
	ds_DrainageSave.SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//수정자 IP
	ds_DrainageSave.SetColumn(0, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
	ds_DrainageSave.SetColumn(0, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//등록자 IP
	ds_DrainageSave.SetColumn(0, "BRANCH_CD"     ,fv_BranchCd );
	ds_DrainageSave.SetColumn(0, "TEAM_CD"       ,fv_TeamCd );
	ds_DrainageSave.SetColumn(0, "SHIFT_WORK_CD" ,fv_ShiftWorkCd );
	ds_DrainageSave.SetColumn(0, "ZIP_NO1"       ,fv_ZipNo1 );
	ds_DrainageSave.SetColumn(0, "CHK_YEAR"      ,fv_ChkYear );
	ds_DrainageSave.SetColumn(0, "CHK_QUARTER"   ,fv_ChkQuarter);
	ds_DrainageSave.SetColumn(0, "BLOCK_CD"      ,fv_BlockCd );
	ds_DrainageSave.SetColumn(0, "PLAN_YMD"      ,fv_PlanYmd);
	// DB에 입력시킬 다음 값들을 셋팅 시켜 준다.
	ds_DrainageSave.SetColumn(0, "FACI_NUM" , strFaciNum);
	
	var strSvcID         = "fn_D1_Save";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service" ;					
	var strInDatasets    = "ds_DrainageSave=ds_DrainageSave:u";
	var strOutDatasets   = "";
	var strArgument      = "save_T06";
	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );

	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009","%AAA%","저장을"));
	}
}


//------------------------------------------------------------------------------- 
// 함수명: fn_D1_CheckReg()
//   설명: 중점관리시설점검 결과등록을 하기 전 기 등록 여부 확인
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_CheckReg()
{
    var strSvcID       = "fn_D1_CheckReg";
    var strPart        = "D10";
    var strURL         = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
					   + "&FACI_NUM=" 	+strFaciNum
					   + "&PATROL_YMD=" +ds_DrainageSave.GetColumn(0,"PATROL_YMD")
					   ;
    var strInDatasets  = "";
    var strOutDatasets = "ds_Dub=ds_Dub";
    var strArgument    = "Dub_T06";   
    
    gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}					   
			   
	if(ds_Dub.RowCount() != 0) return false;
	return true;
}


function fn_D1_Addrowm()
{
//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Addrowm()
//   설명  :  구간 행추가 
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
	
	if(strFaciNum != "")
	{
		//행추가를 했을때 점검일자는 금일날짜를 뿌려줌, 점검일자가 키이기 때문에 행추가를 한번으로 막기위한 함수
		if(Today() != ds_DrainageSave.GetColumn(0,"PATROL_YMD"))	
		{
			ds_DrainageSave.InsertRow(0);									//insert시 맨위에 행추가
			ds_DrainageSave.SetColumn(0,"CHK_DOCU_REF_YN","미점검");		//(컬럼이 없어서 코드값이 아닌 미점검 한글로 set)
			ds_DrainageSave.SetColumn(0,"PATROL_YMD",Today());
			
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID1_NM", edt_empnm1.text);	
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID2_NM", edt_empnm2.text);
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID3_NM", edt_empnm3.text);
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID1",edt_empid1.text );	
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID2",edt_empid2.text );
			ds_DrainageSave.SetColumn(0, "TAKER_EMPID3",edt_empid3.text );
			
			strRowType = "insert";
		}
	}else{
		alert('순찰계획을 선택해주세요');
    }
}


// ---------------------------------------------------------
// 달력 팝업 및 점검대장 팝업
// ---------------------------------------------------------
function grd_MultiSave_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{	
	/* 달력이 필요가 없어짐(오늘 날짜로 무조건 set해주기 때문)
	if(ds_DrainageSave.GetRowType(nRow) == "insert")		// 달력 팝업 insert시만 활성화
	{
		if("PATROL_YMD" == grd_MultiSave.GetCellProp("body",nCell,"ColId"))
		{
			gfn_SetCalendar(obj, nRow, nCell);
		}
	}

	if(ds_DrainageSave.GetRowType(nRow) == "insert")	//그리드의 타입에 따라 순찰일자의 활성화 여부
	{
		if("PATROL_YMD" == grd_MultiSave.GetCellProp("body",nCell,"ColId"))
		{
			grd_MultiSave.SetCellProp("body",2,"Edit","date");
		}
	}else
	{
		if("PATROL_YMD" == grd_MultiSave.GetCellProp("body",nCell,"ColId"))
		{
			grd_MultiSave.SetCellProp("body",2,"Edit","none");
		}
	}
	*/

	if("CHK_DOCU_REF_YN" == grd_MultiSave.GetCellProp("body",nCell,"ColId"))	//점검대장 등록여부
	{
		if(ds_DrainageSave.GetColumn(nRow,"PATROL_YMD") == null)
		{
			alert('순찰일자를 먼저 등록해 주세요');
			return;
		}
		else if(strRowType == "insert")
		{
			var strChkFlag = fn_D1_CheckReg();
			//alert(strChkFlag);
			if(!strChkFlag)
			{
				alert('이미 등록된 순찰일자입니다.');
				return;
			}
		}
			
		var strCopyType = "";
		var args = "";
		
		strCopyType = strRowType;
		
		args  = "FACI_NUM="    +strFaciNum;								//시설물번호
		args += " PATROL_YMD=" +ds_DrainageSave.GetColumn(nRow,"PATROL_YMD");	//순찰일자
		args += " ROWTYPE="    +strRowType;
		args += " VOLTAGE="    +ds_DrainageSave.GetColumn(nRow,"VOLTAGE");
		args += " VOLTAIC="    +ds_DrainageSave.GetColumn(nRow,"VOLTAIC");
		
		var retValue = gfn_Dialog("D10","D1202010021U",args,660,620,true,-1,-1);
	
		if(retValue == null || retValue == 0)
		{
			strRowType = "";
		}else{
			strRowType = retValue[1];
		}
		
		if(strRowType == "savePass")
		{
			strRowType = "update";
			ds_DrainageSave.SetColumn(ds_DrainageSave.row,"CHK_DOCU_REF_YN","점검");	//점검대장등록 여부
			ds_DrainageSave.SetColumn(ds_DrainageSave.row,"RECTIFER_ELECT_POT",retValue[0]);	//전위
		}else if(strRowType == "saveNotPass")
		{
			strRowType = "update";
			ds_DrainageSave.SetColumn(ds_DrainageSave.row,"CHK_DOCU_REF_YN","점검");	//점검대장등록 여부
			ds_DrainageSave.SetColumn(ds_DrainageSave.row,"RECTIFER_ELECT_POT",retValue[0]);	//전위
		}else
		{
			strRowType = strCopyType;
		}
	}
	//이 화면은 등록만 되고 수정이 안됨, 수정을 하고 싶은면 삭제후 다시 등록 요함. 그래서 insert만 활성화 됨.
	if(ds_DrainageSave.GetRowType(nRow) == "insert")
	{
		grd_MultiSave.SetCellProp("body",3,"Edit","number");	//전압
		grd_MultiSave.SetCellProp("body",4,"Edit","number");	//전류
		grd_MultiSave.SetCellProp("body",8,"Edit","normal");	//점검사항
	}else
	{
		grd_MultiSave.SetCellProp("body",3,"Edit","none");		//전압
		grd_MultiSave.SetCellProp("body",4,"Edit","none");		//전류
		grd_MultiSave.SetCellProp("body",8,"Edit","none");		//점검사항
	}
}

/*	그리드 안으로 옮김
//---------------------------------------------------------
// 공사정보 조회 popup
//---------------------------------------------------------
function btn_WorkNumFind_OnClick(obj)
{
	// var args = "FACI_NUM=" +ds_MultiGovRoom_T02.GetColumn(0,"FACI_NUM")		//정압실번호
		     // + " GOV_NUM=" +ds_MultiGov_T02.GetColumn(0,"GOV_NUM");			//정압기번호
		     
	if(ds_Drainage.GetColumn(0, "WORK_NUM") == ""|| ds_Drainage.GetColumn(0, "WORK_NUM") == null)
	{
		alert("시설물을 선택해 주세요.");
		return;
	}		     
		     
	var strPrefix = "B20";
	var strFormid = "B2204010010F";
	var strArg    = "";
	gfn_NewWindow(strPrefix,strFormid,strArg);
}
*/

/*	그리드 안으로 옮김
//---------------------------------------------------------
// 정배류기 방식설비대장 popup
//---------------------------------------------------------
function btn_CathLst_OnClick(obj)
{
   	if(ds_Drainage.GetColumn(0, "FACI_NUM") == "" || ds_Drainage.GetColumn(0, "FACI_NUM") == null)
	{
		alert("시설물을 선택해 주세요.");
		return;
	}
    
    var Arguments = "fv_faciNum="+edt_FaciNum.value;
    trace("Arguments"+Arguments);
    var Result = gfn_Dialog("D10","D1101010013U",Arguments,660,767,true,-1,-1);
    G_ACTIVEWIN = parent.id;
}
*/

//---------------------------------------------------------
// 측정전위 popup
//---------------------------------------------------------
function fn_MeasElectPot_OnClick(obj)
{  
	if((ds_DrainageSave.GetColumn(0, "FACI_NUM") == ""|| ds_DrainageSave.GetColumn(0, "FACI_NUM") == null)  && ds_DrainageSave.GetRowCount()==0)
	{
		alert("배류기를 선택해주세요.");
		return;
	}	
	else if(ds_DrainageSave.GetRowType(0) == "normal" || ds_DrainageSave.GetRowType(0) == "update")
	{
		var args = "FACI_NUM=" + quote(ds_DrainageSave.GetColumn(0,"FACI_NUM"));		//배류기번호
		gfn_Dialog("D10","D1202010020U",args,600,400,true,-1,-1);
		//gfn_Dialog(strPrefix,strFormID,strInArgument,nWidth,nHeight,strOpenStyle,nLeft,nTop)
	}
}


//---------------------------------------------------------
// 정비보수의뢰 조회 popup
//---------------------------------------------------------
function btn_MainterReq_OnClick(obj)
{
	var strPrefix = "D10";
	var strFormid = "D1601010010F";
	var strArg    = "";
	gfn_NewWindow(strPrefix,strFormid,strArg);
}


//---------------------------------------------------------
// 배류기 순찰점검 이력조회 popup
//---------------------------------------------------------
function btn_Drainage_OnClick(obj)
{
	if(edt_FaciNum == "" || edt_FaciNum == null)
	{
		alert('순찰계획을 선택해주세요');
		return;
	}
	var args = "FACI_NUM=" +ds_Drainage.GetColumn(0,"FACI_NUM");	//배류기번호
	gfn_Dialog("D10","D1202010025U",args,700,400,true,-1,-1);
}


function D1202010011F_T06_OnUnloadCompleted(obj)
{
	if(ds_DrainageSave.GetUpdate())
	{
		if(!confirm(gfn_GetMessage("M000016","%AAA%","편집중인 내용을 무시하고 종료")))
		 {
			 return false;
		 }	
	}
}

function fn_D1_PortletFind(str_FaciNum, str_PlanYmd){

	var strSvcID = "fn_D1_Find";
	var strPart  = "D10";				
	var strSvcID = "fn_D1_Find";
	var strPart = "D10";				
	var strURL = "handle.do?ServiceName=D1_PatrolCheckResultMgr-service"
	           + "&BRANCH_CD="		+ ""
	           + "&BLOCK_CD=" 		+ ""
	           + "&TEAM_CD=" 		+ ""
	           + "&SHIFT_WORK_CD="  + ""
	           + "&PATROL_YMD=" 	+ str_PlanYmd
	           + "&FACI_NUM="	    + str_FaciNum
	           ;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Multi_T06=ds_Multi";
	var strArgument     = "find6";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	              
	if(ErrorCode < 0)
	{
		alert(ErrorMsg);
		return;
	}			
	
	if(ds_Multi_T06.GetRowCount()==0)
	{
        grd_Multi.NoDataText="조회결과가 없습니다.";
    }
    
    grd_Multi_OnCellClick ("",0,"","","","");
}]]></Script>
</Window>