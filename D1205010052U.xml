<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="853" Id="D1205010052F" Left="8" OnLoadCompleted="D1205010052U_OnLoadCompleted" PidAttrib="7" Title="D1205010052U_측정전위통계-막대그래프" Top="8" Ver="1.0" Width="1270" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Area">
				<Contents>
					<colinfo id="CODE_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_KNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_ENAME" size="256" summ="default" type="STRING"/>
					<colinfo id="C_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="N_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="N_VALUE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_ID" size="256" summ="default" type="STRING"/>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>1</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>전위ON-OFF</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>2</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>토양비저항</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>3</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>분극량</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Align="Left" Height="10" Id="Image4" ImageID="blt_8" Left="5" LeftMargin="12" Style="text_title" TabOrder="1" Top="80" Width="12"></Image>
		<Shape BKColor="user15" Bottom="98" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1265" TabOrder="2" Top="95" Type="Rectangle" Width="1260"></Shape>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape3" Left="5" LineColor="user7" Right="1265" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="3" Top="30" Type="RoundRect" Width="1260"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape4" Left="10" LineWidth="0" Right="1260" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="4" Top="35" Type="Rectangle" Width="1250"></Shape>
		<Div DisableBKColor="white" Height="30" Id="div_Common" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="5" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1260">
			<Contents></Contents>
		</Div>
		<Edit Border="None" DisableBKColor="white" DisableColor="user1" Enable="FALSE" Font="돋움,9,Bold" Height="12" Id="Edit3" Left="115" ShadowColor="user6" TabOrder="8" Text="영역조사&#32;통계" Top="78" Width="85"></Edit>
		<Edit Border="None" DisableBKColor="white" DisableColor="user1" Enable="FALSE" Font="돋움,9,Bold" Height="12" Id="title_gb" Left="24" ShadowColor="user6" TabOrder="8" Top="78" Width="90"></Edit>
		<XChart AllowDrag="true" AxesStyle="AxesStyle_Frame3D" Bottom="804" Chart3D="true" Font="굴림,8" Grid="ChartGrid_Horz" Height="700" Id="XChart" Left="8" MarkerShape="MarkerShape_VertLine" MenuBar="true" NSeries="2" NValues="5" PointLabels="true" Right="1268" Scrollable="true" SerLegBox="true" ToolBar="true" Top="104" View3DDepth="100" Visible="FALSE" Width="1260">
			<_PersistData>&#13;&#10;/6yFv45y30NGWDYA8vJNQ/9oYXJ0RlgsIP9WZXJzaW9uPf82LjIuMTM0Mv8uMCwgQ3VsdP91cmU9bmV1dP9yYWwsIFB1Yv9saWNL&#13;&#10;ZXlUb/9rZW49YTE4N/84ZTIwNTJjMP84ZGNlElNvZv90d2FyZUZYLtr59B/y8wAj8vAgAOkBYAJrDQTy8AEB/qn/gQVrBQFrBQJr&#13;&#10;BgbUpQSRBWTy8BCSBP//b/9/giB5BQADjgj/AQbqtbTrprySewBBbw/y8gWOBawFAP5GD1gSLkhpZ2j9bCoQdFNldHRpn25ncxAJ&#13;&#10;kwhGHwA9B3YFAQEACAMdFB9/WAUuQXhpc5UBxn0CAAI7EPLzZhYoOBfgAApIFQtIGZ4H0B8I3RmVAZ4BAYAG3R93C40OJo8FAgyc&#13;&#10;H64QDbIfYy/AdS/oHH8HfS8TL8QvAA6iWxgPjgW8AfLxUvn0Lg9CYXNlAA8SDyQPNg35F3gf/SINLklHYf9sbGVyeVR5cBVllQEU&#13;&#10;MyUR+wyKP5Y49RKWNRONBgVoQEuI0gByM/LwFeUtSD/8Iwn/LkxpbmVJbmYhb9sCvizTA1oRQpY/lwipAbkagQEWJEUX5hcP70Rl&#13;&#10;ZmEZMC5XaR9uZG93cw==&#13;&#10;</_PersistData>
		</XChart>
		<Image Align="Left" Color="user0" Height="18" Id="Image10" ImageID="blt" Left="16" LeftMargin="12" Style="blt_search_1" TabOrder="12" Text="기간" Top="41" Width="40"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_InputYmdFrom" Left="58" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="9" Top="41" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Height="13" Id="Static3" Left="151" Style="static" TabOrder="11" Text="~" Top="45" Width="10"></Static>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_InputYmdTo" Left="168" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="10" Top="41" WeeksFont="Default,-1" Width="88"></Calendar>
		<Combo Border="Flat" CodeColumn="CODE_ITEM" DataColumn="ITEM_KNAME" Height="18" Id="cob_AreaGb" InnerDataset="ds_Area" Left="329" OnChanged="fn_CommonSearch" Style="combo" TabOrder="14" Top="41" Width="105"></Combo>
		<Image Align="Left" Color="user0" Height="18" Id="Image3" ImageID="blt" Left="264" LeftMargin="12" Style="blt_search_1" TabOrder="13" Text="영역종류" Top="42" Width="64"></Image>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1205010051U.xml
* Form 설명   : 측정전위통계-막대그래프(분극량, 소요전류, 방식연장, 방식면적, 전류밀도, 코팅저항, 토양비저항)
* 시스템 명   : 안전공금(D1)
* 작성자      : 김도현  
* 작성일      : 2013-03-25
* 변경내용    : 변경내용없음
****************************************************************************************************/
//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONE10001.js";
#include "JS::COMMONB30001.js";
#include "JS::COMMONE20001.js";
#include "JS::COMMONE50001.js";

//---------------------------------------------------------
//	화면 OnLoadCompleted 이벤트처리 발생하는 함수( 화면ID_OnLoadCompleted )
//---------------------------------------------------------
function D1205010052U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	gfn_SetButton("00010001");	
	gfn_InitChart(XChart);
	fn_D1_On_load();	
	cob_AreaGb.Index = INDEX;
	fn_CommonSearch();
}

/*===============================================================================
 * 공통 div_ComHead 에서 버튼 이벤트
		추가	fn_CommonAddRow
		삭제	fn_CommonDeleteRow
		저장	fn_CommonSave
		조회	fn_CommonSearch
		엑셀	fn_CommonExcelExport
		인쇄	fn_CommonPrint
		닫기	공통에서 처리
===============================================================================*/ 
//---------------------------------------------------------
//	공통 버튼 클릭 - 조회
//---------------------------------------------------------
function fn_CommonSearch()
{
	fn_E1_Tr_find();
}

function fn_D1_On_load()
{
	cal_InputYmdFrom = YMDFROM;
	cal_InputYmdTo = YMDTO;
}  

function fn_E1_Tr_find()
{
	var strSvcID = "fn_E1_Tr_find";
	var strPart = "D10";
	var srcGb = "00";	
	// 전위ON-OFF일경우에는 평균값을 구하지 않음
	if(cob_AreaGb.Value == '1'){
		srcGb = "99";
	}
	
	var strURL = "handle.do?ServiceName=D1_GraphMgr-service&find02=1"
               + "&FACI_NUM=" + FACI_NUM                 
	           + "&INPUT_YMD_FROM=" + cal_InputYmdFrom.Value	//기준일자FROM 
	           + "&INPUT_YMD_TO="+ cal_InputYmdTo.Value      	//기준일자TO   
	           + "&SECTOR_NUM="
	           + "&SRC_GB="+srcGb
	           ;
	           
	var strInDatasets  = "";
	var strOutDatasets  = "";
	    strOutDatasets += "ds_Multi=ds_Multi";
	var strArgument  = "";
	var strCallbackFunc = "";
	              
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
			   
	if(ErrorCode <0) {
	
	} else {
		fn_Chart();

		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true);	//"조회를 완료하였습니다."
	}
}

/*===============================================================================
 * callback
===============================================================================*/
function fn_CallBack(svcId, ErrorCode, ErrorMsg)
{
	if ( ErrorCode <0 )
	{
		var tr_name;
		var tr_kname;
		switch(svcId){
			case "fn_E1_Tr_find": 
			//조회 실패시 
				tr_name="find";
				tr_kname="조회";
			break;
		}
		//alert(gfn_E1_GetDBErrorMsg(tr_name, ErrorMsg,tr_kname));
		return;
	}

	 switch(svcid)
	 {
		case "fn_E1_Tr_find":
			trace("fn_E1_Tr_find callback");
			//trace(ds_Multi.SaveXML());
			//조회 완료후 
			gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true);	//"조회를 완료하였습니다."
			break;
	}
}

function fn_Chart()
{
	//	Chart Style
	//	LINE,BAR,PIE,GANTT,CUBE
	var style = "BAR";
	XChart.ClearData(true);
	// SERIES LABEL을 ARRAY로 넘긴다.
	var arrLabelList = array();
	if(cob_AreaGb.Value == '1'){	/*전위ON-OFF*/
		title_gb.Text = "[전위ON-OFF]";
		arrLabelList[0] = "전위ON";
		arrLabelList[1] = "전위OFF";
	}else if(cob_AreaGb.Value == '2'){	/*토양비저항*/
		title_gb.Text = "[토양비저항]";
		arrLabelList[0] = "토양비저항";
		arrLabelList[1] = "평균";
	}else if(cob_AreaGb.Value == '3'){	/*분극량*/
		title_gb.Text = "[분극량]";
		arrLabelList[0] = "분극량";
		arrLabelList[1] = "평균";
	}
	// SERIES COLUMN을 ARRAY로 넘긴다.
	var arrXColList = array();
	if(cob_AreaGb.Value == '1'){	/*전위ON-OFF*/
		arrXColList[0] = "ELECT_ON";
		arrXColList[1] = "ELECT_OFF";
	}else if(cob_AreaGb.Value == '2'){	/*토양비저항*/
		arrXColList[0] = "SOIL_RESIS";
		arrXColList[1] = "SOIL_RESIS_AVG";
	}else if(cob_AreaGb.Value == '3'){	/*분극량*/
		arrXColList[0] = "POLAR_AMT";
		arrXColList[1] = "POLAR_AMT_AVG";
	}

	// Y TEXT COLUMN
	strYCol = "GROUP_NUM";
	XChart.AxisX.LabelAngle = 90;
	XChart.OpenData("COD_Values",arrLabelList.length(),ds_Multi.RowCount());
	XChart.OpenData("COD_Colors",arrLabelList.length(),ds_Multi.RowCount());
	XChart.AxisY.LabelsFormat.Decimals = 0;
	var bStack = false;
	
	gfn_DrawChart(XChart,ds_Multi,style,arrLabelList,arrXColList,strYCol,bStack);
	
	XChart.CloseData("COD_Values");
	XChart.CloseData("COD_Colors");
	
	if(ds_Multi.RowCount() == 0){
		alert("조회한 내역이 없습니다.");
		XChart.ClearData(true);
	}
	
}
]]></Script>
</Window>