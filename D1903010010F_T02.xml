<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="728" Id="D1903010010F_T02" Left="8" OnLoadCompleted="D1903010010F_T02_OnLoadCompleted" PidAttrib="7" Title="비계획실적_D1903010010F_T02" Top="8" Ver="1.0" Width="1280" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Dummy">
				<Contents>
					<colinfo id="ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="SYS_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="GU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Flag">
				<Contents>
					<colinfo id="EXPLOR_FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="GU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_STR_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="SYS_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPL_DATE" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME1" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME2" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME3" size="256" summ="default" type="STRING"/>
					<colinfo id="DAMAGE_LOC" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="GAP_DISTANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME4" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME5" size="256" summ="default" type="STRING"/>
					<colinfo id="RESECH_NAME6" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Dcvg" OnColumnChanged="ds_Dcvg_OnColumnChanged" OnLoadCompleted="ds_Dcvg_OnLoadCompleted" OnRowPosChanged="ds_Dcvg_OnRowPosChanged">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_POINT" size="256" summ="default" type="STRING"/>
					<colinfo id="END_POINT" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="GU_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="COMPL_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="DONG_NM_H" size="256" summ="default" type="STRING"/>
					<colinfo id="ORIGINAL_INPUT_ID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DcvgArRst" OnRowPosChanged="ds_DcvgArRst_OnRowPosChanged">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SYS_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_STR_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_BLOCK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DcvgRst">
				<Contents>
					<colinfo id="PIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MANAGE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_BLOCK_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_RSLT_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO" size="256" summ="default" type="STRING"/>
					<colinfo id="DAMAGE_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="GAP_DISTANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="DAMAGE_RESECH" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Decide">
				<Contents>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_PlnYn">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Search">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_END_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user15" Bottom="24" Height="3" Id="Shape0" Left="4" LineWidth="0" Right="1253" TabOrder="3" Top="21" Type="Rectangle" Width="1249"></Shape>
		<Image Align="Left" Height="9" Id="Image9" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="1" Text="DCVG&#32;비계획실적등록" Top="5" Width="150"></Image>
		<Shape BKColor="user15" Bottom="235" Height="3" Id="Shape1" Left="5" LineWidth="0" Right="1254" TabOrder="2" Top="232" Type="Rectangle" Width="1249"></Shape>
		<Image Align="Left" Height="9" Id="Image0" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="4" Text="비계획탐사구간등록" Top="215" Width="182"></Image>
		<Image Align="Left" Height="9" Id="Image2" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="6" Text="비계획&#32;손상의심부" Top="404" Width="182"></Image>
		<Shape BKColor="user15" Bottom="424" Height="3" Id="Shape2" Left="5" LineWidth="0" Right="1251" TabOrder="5" Top="421" Type="Rectangle" Width="1246"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button15" ImageID="btn_addrow" Left="1102" LeftMargin="15" OnClick="Btn_add_Rst_OnClick" Style="button" TabOrder="7" Text="추가" Top="399" Width="50"></Button>
		<Button ButtonStyle="TRUE" Height="19" Id="btn_CarOperat" ImageID="btn_4_Putson" Left="1179" LeftMargin="21" OnClick="Button91_OnClick" Style="button" TabOrder="8" Text="차량운행" Top="1" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Save" ImageID="btn_2" Left="1155" LeftMargin="15" OnClick="btn_save_Rst_OnClick" Style="button" TabOrder="10" TabStop="FALSE" Text="저장" Top="399" Width="48"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button2" ImageID="btn_deleterow" Left="1208" LeftMargin="15" OnClick="btn_del_Rst_OnClick" Style="button" TabOrder="9" Text="삭제" Top="399" Width="48"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Dcvg" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="205" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="181" Id="grd_Dcvg" InputPanel="FALSE" Left="4" LineColor="silver" LineType="ExVERT" MinWidth="100" NoDataText="조회내역이&#32;없습니다." OnHeadClick="Grid1_OnHeadClick" Right="1253" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="10" TabStop="true" Top="24" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1249">
			<contents>
				<format id="Default">
					<columns>
						<col width="60"/>
						<col width="88"/>
						<col width="83"/>
						<col width="60"/>
						<col width="72"/>
						<col width="82"/>
						<col width="226"/>
						<col width="224"/>
						<col width="67"/>
						<col width="61"/>
						<col width="86"/>
						<col width="83"/>
						<col width="76"/>
					</columns>
					<head>
						<cell bkcolor="user11" col="0" display="text" text="기준년도"/>
						<cell bkcolor="INFOBK" col="1" display="text" text="배관_ID"/>
						<cell col="2" display="text" text="준공년도"/>
						<cell col="3" display="text" text="관경(A)"/>
						<cell col="4" display="text" text="구명"/>
						<cell col="5" display="text" text="동명"/>
						<cell col="6" display="text" text="시점"/>
						<cell col="7" display="text" text="종점"/>
						<cell bkcolor="user11" col="8" display="text" text="연장(m)"/>
						<cell col="9" display="text" text="압력"/>
						<cell col="10" display="text" text="초기입력ID"/>
						<cell col="11" display="text" text="최근탐사일자"/>
						<cell col="12" display="text" text="완료여부"/>
					</head>
					<body>
						<cell align="center" col="0" colid="BASE_YEAR" display="text" limit="4"/>
						<cell align="center" col="1" colid="MPIPE_ID" display="text" edit="expr:iif(rowtype==&apos;insert&apos;,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" limit="11"/>
						<cell align="center" col="2" colid="COMPL_YEAR" display="text"/>
						<cell align="right" col="3" colid="PIPE_DIAM_NM" display="text"/>
						<cell align="center" col="4" colid="GU_NM" display="text"/>
						<cell align="center" col="5" colid="DONG_NM_H" display="text"/>
						<cell align="left" col="6" colid="STR_POINT" display="text"/>
						<cell align="left" col="7" colid="END_POINT" display="text"/>
						<cell align="right" col="8" colid="LENG" display="number" edit='expr:iif(ds_Dcvg.GetColumn(currow,&#32;&quot;EXPLOR_END_YN&quot;)&#32;==&apos;1&apos;,&#32;&apos;number&apos;,&#32;&apos;none&apos;)' limit="12" LimitDec="2"/>
						<cell align="center" col="9" colid="PRESS_NM" display="text"/>
						<cell align="center" col="10" colid="ORIGINAL_INPUT_ID" display="text"/>
						<cell align="center" col="11" colid="EXPLOR_YMD" display="text" Mask="####-##-##"/>
						<cell align="center" col="12" colid="EXPLOR_END_NM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_DcvgArRst" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="396" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="161" Id="grd_DcvgArRst" InputPanel="FALSE" Left="5" LineColor="silver" LineType="ExVERT" MinWidth="100" NoDataText="조회내역이&#32;없습니다." OnCellClick="grd_DcvgArRst_OnCellClick" Right="1254" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="10" TabStop="true" Top="235" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1249">
			<contents>
				<format id="Default">
					<columns>
						<col width="77"/>
						<col width="75"/>
						<col width="79"/>
						<col width="248"/>
						<col width="256"/>
						<col width="92"/>
						<col width="340"/>
						<col width="79"/>
					</columns>
					<head>
						<cell col="0" display="text" text="배관_ID"/>
						<cell col="1" display="text" text="연장(m)"/>
						<cell bkcolor="user11" col="2" display="text" text="탐사연장(m)"/>
						<cell col="3" display="text" text="시점"/>
						<cell col="4" display="text" text="종점"/>
						<cell bkcolor="user11" col="5" display="text" text="탐사일자"/>
						<cell col="6" display="text" text="비고"/>
						<cell col="7" display="text" text="결재여부"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MPIPE_ID" display="text"/>
						<cell align="right" col="1" colid="SYS_LENG" display="number"/>
						<cell align="right" col="2" colid="EXPLOR_LENG" display="number" edit="number" limit="12" LimitDec="2"/>
						<cell align="left" col="3" colid="EXPLOR_STR_ADDR" display="text"/>
						<cell align="left" col="4" colid="EXPLOR_END_ADDR" display="text"/>
						<cell align="center" col="5" colid="EXPLOR_YMD" display="date" expandimage="calendar" expandshow="true"/>
						<cell align="left" col="6" colid="EXPLOR_RMK" display="text" edit="normal"/>
						<cell align="center" col="7" colid="DECIDE_PROC_STS" display="text"/>
					</body>
					<summary>
						<cell align="center" bkcolor="greenyellow" col="0" display="text" text="계"/>
						<cell align="right" bkcolor="greenyellow" col="1" display="number" expr='SumNF(&quot;SYS_LENG&quot;)&#32;/&#32;rowcount'/>
						<cell align="right" bkcolor="greenyellow" col="2" display="number" expr='iif(SumNF(&quot;EXPLOR_LENG&quot;)==&apos;0&apos;,&#32;null,&#32;SumNF(&quot;EXPLOR_LENG&quot;))'/>
						<cell align="center" bkcolor="greenyellow" col="3" display="text"/>
						<cell bkcolor="greenyellow" col="4" display="text"/>
						<cell bkcolor="greenyellow" col="5" display="text"/>
						<cell bkcolor="greenyellow" col="6" display="text"/>
						<cell bkcolor="greenyellow" col="7" display="text"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_DcvgRst" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="612" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="188" Id="grd_DcvgRst" InputPanel="FALSE" Left="5" LineColor="silver" LineType="ExVERT" MinWidth="100" NoDataText="조회내역이&#32;없습니다." OnExpandEdit="grd_DcvgRst_OnExpandEdit" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="10" TabStop="true" Top="424" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col width="176"/>
						<col width="69"/>
						<col width="93"/>
						<col width="80"/>
						<col width="530"/>
						<col width="61"/>
						<col width="60"/>
						<col width="84"/>
					</columns>
					<head>
						<cell col="0" display="text" text="관리번호"/>
						<cell col="1" display="text" text="탐사일자"/>
						<cell bkcolor="user11" col="2" display="text" text="배관_ID"/>
						<cell bkcolor="user11" col="3" colspan="2" display="text" text="손상위치"/>
						<cell col="5" display="text" text="압력"/>
						<cell col="6" display="text" text="관경(A)"/>
						<cell bkcolor="user11" col="7" display="text" text="포장종류"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MANAGE_NUM" display="text"/>
						<cell align="center" col="1" colid="EXPLOR_YMD" display="text" Mask="@@@@-@@-@@"/>
						<cell align="center" col="2" colid="MPIPE_ID" display="text"/>
						<cell align="center" col="3" colid="ZIP_NO" display="text"/>
						<cell align="left" col="4" colid="DAMAGE_ADDR" display="text" expandimage="search" expandshow="true" limit="50"/>
						<cell align="center" col="5" colid="PRESS_NM" display="text"/>
						<cell align="right" col="6" colid="PIPE_DIAM_NM" display="text"/>
						<cell align="center" col="7" colid="PAVEMENT_KIND" display="combo" edit="combo"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button231" ImageID="btn_8_Search" Left="1122" LeftMargin="21" OnClick="Button231_OnClick" Style="button" TabOrder="10" Text="배관진단&#32;이력조회" Top="209" Width="132"></Button>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="ZIP_SEQ" Height="18" Id="edt_zip_seq" ImeMode="none" Left="92" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="24" TabStop="FALSE" Top="750" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image7" ImageID="blt_8" Left="1" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="25" TabStop="FALSE" Text="우편일련번호" Top="756" Visible="FALSE" Width="117"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="HILL" Height="18" Id="edt_hill" ImeMode="none" Left="212" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="26" TabStop="FALSE" Top="750" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image10" ImageID="blt_8" Left="169" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="15" TabStop="FALSE" Text="산번지" Top="756" Visible="FALSE" Width="101"></Image>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image12" ImageID="blt_8" Left="297" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="19" TabStop="FALSE" Text="본번" Top="756" Visible="FALSE" Width="101"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="ADDR_M" Height="18" Id="edt_addr_m" ImeMode="none" Left="336" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="20" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="ADDR_S" Height="18" Id="edt_addr_s" ImeMode="none" Left="456" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="16" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image13" ImageID="blt_8" Left="417" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="17" TabStop="FALSE" Text="부번" Top="756" Visible="FALSE" Width="101"></Image>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image14" ImageID="blt_8" Left="537" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="19" TabStop="FALSE" Text="보조주소" Top="756" Visible="FALSE" Width="101"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="SECOND_ADDR" Height="18" Id="edt_second_addr" ImeMode="none" Left="600" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="18" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image15" ImageID="blt_8" Left="681" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="25" TabStop="FALSE" Text="건물동" Top="756" Visible="FALSE" Width="101"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="BLD_DONG" Height="18" Id="edt_bld_dong" ImeMode="none" Left="728" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="26" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image16" ImageID="blt_8" Left="809" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="27" TabStop="FALSE" Text="호수" Top="756" Visible="FALSE" Width="101"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="HOSU" Height="18" Id="edt_hosu" ImeMode="none" Left="848" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="28" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image18" ImageID="blt_8" Left="1" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="29" TabStop="FALSE" Text="새주소건물일련번호" Top="788" Visible="FALSE" Width="125"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Height="18" Id="edt_new_addr_bld_seq" ImeMode="none" Left="128" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="30" TabStop="FALSE" Top="784" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image19" ImageID="blt_8" Left="409" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="31" TabStop="FALSE" Text="새주소호수" Top="788" Visible="FALSE" Width="77"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Height="18" Id="edt_new_hosu" ImeMode="none" Left="488" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="32" TabStop="FALSE" Top="784" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image17" ImageID="blt_8" Left="209" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="33" TabStop="FALSE" Text="새주소지하여부" Top="788" Visible="FALSE" Width="101"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Height="18" Id="edt_new_addr_ungrnoud_yn" ImeMode="none" Left="316" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="34" TabStop="FALSE" Top="782" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image20" ImageID="blt_8" Left="929" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="21" TabStop="FALSE" Text="우편번호1" Top="756" Visible="FALSE" Width="117"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="ZIP_NO1" Height="18" Id="edt_zip_no1" ImeMode="none" Left="1000" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="20" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Image Align="Left" Font="돋움,8,Bold" Height="13" Id="Image21" ImageID="blt_8" Left="1081" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="23" TabStop="FALSE" Text="우편번호2" Top="756" Visible="FALSE" Width="117"></Image>
		<Edit Align="RIGHT" BindDataset="ds_DcvgRst" Border="Flat" Column="ZIP_NO2" Height="18" Id="edt_zip_no2" ImeMode="none" Left="1152" OnCharChanged="edt_PipeDiam1_OnCharChanged" Style="edit" TabOrder="22" TabStop="FALSE" Top="752" Visible="FALSE" Width="78"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button0" ImageID="btn_addrow" Left="966" LeftMargin="15" OnClick="Btn_add_ArRst_OnClick" Style="button" TabOrder="40" Text="추가" Top="209" Width="48"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button3" ImageID="btn_2" Left="1020" LeftMargin="15" OnClick="btn_save_ArRst_OnClick" Style="button" TabOrder="41" TabStop="FALSE" Text="저장" Top="209" Width="48"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_deleterow" Left="1072" LeftMargin="15" OnClick="btn_del_ArRst_OnClick" Style="button" TabOrder="39" Text="삭제" Top="209" Width="48"></Button>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1903010010F.xml
* Form 설명  : DCVG탐사 비계획/구간/결과 등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 김창현 
* 작성일     : 2013-03-28
* 변경내용   : 
****************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMONE20001.js";
#include "JS::COMMONA10008.js";

var nRow_Pln    = "0"; // 계획내역 nRow Number
var nRow_ArRst  = "0"; // 구간실적 nRow Number
var Dcvg_RCount = "";
var DcvgArRst_RCount = "";
var nCount    = 0;
var nCount1   = 0;
var iGridPos = '';
var fvSaveMode = ""; 
var fvExplorLengOld = 0; // 탐사길이 조회되는 시점의 값
var oldLeng = 0;

function D1903010010F_T02_OnLoadCompleted(obj)
{	
	gfn_LoadForm(obj);
	fn_Init();
}

//---------------------------------------------------------
//	초기 설정
//---------------------------------------------------------
function fn_Init()
{
	gfn_SetGrdComboBox_Comcode("grd_DcvgRst",7,"D10040");
	gfn_SetGrdComboBox_Comcode("grd_DcvgArRst",7,"A10411");
	grd_DcvgArRst.SetCellProp("body",7,"edit","none");
}

/*===============================================================================
 * 공통 div_ComHead 에서 버튼 이벤트
		추가	fn_CommonAddRow
		삭제	fn_CommonDeleteRow
		저장	fn_CommonSave
		조회	fn_CommonSearch
		엑셀	fn_CommonExcelExport
		인쇄	fn_CommonPrint
		닫기	공통에서 처리
===============================================================================*/ 
//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  계획실적 조회
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_find()
{	
	ds_Dcvg.ClearData();
	
	ds_Search.DeleteAll();
	var strRow = ds_Search.AddRow();
	//Search Parameter Setting
	ds_Search.SetColumn(strRow, "BASE_YEAR", sp_Year.Value);
	ds_Search.SetColumn(strRow, "BRANCH_CD", cob_ObjectFlag.Value);
	ds_Search.SetColumn(strRow, "ZIP_NO1", cob_CountyFlag.Value);
	ds_Search.SetColumn(strRow, "MPIPE_ID", trim(edt_MpipeSearch.Text));
	ds_Search.SetColumn(strRow, "EXPLOR_FLAG", "2");
	ds_Search.SetColumn(strRow, "EXPLOR_END_YN", "");
	
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------	
    var ServiceId     = "selectDcvgList";
    var ServicePart   = "D10";
    var Url           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList   = "ds_Search=ds_Search";
    var OutputDsList  = "ds_Dcvg=ds_Dcvg";
    var Argument      = "selectDcvgList";
  
    gfn_SyncCall(ServiceId, ServicePart, Url, InputDsList, OutputDsList, Argument); 
    
    if(ErrorCode < 0){
		return;
    }else{
		grd_Dcvg.NoDataText = "조회결과가 없습니다.";
    }
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  구간실적 조회
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_find1(strbase_year, strmpipe_id)
{	

    ds_DcvgArRst.ClearData();

    var strSvcID        = "";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeMgr-service"
						+ "&BASE_YEAR="  + strbase_year
						+ "&MPIPE_ID="   + strmpipe_id
						;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_DcvgArRst=ds_DcvgArRst";
	var strArgument     = "view_ArRst";
	 	 
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ds_DcvgArRst.GetRowCount()==0) {
		ds_DcvgRst.ClearData();
	}
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  결과실적 조회
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_find2(strbase_year, strmpipe_id)
{	
    ds_DcvgRst.ClearData();

    var strSvcID        = "";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeMgr-service"
						+ "&BASE_YEAR="        + strbase_year						
						+ "&MPIPE_ID="         + strmpipe_id
						;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_DcvgRst=ds_DcvgRst";
	var strArgument     = "view_Rst";
	 	 
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_addRow()
//   설명  :  구간 행추가 
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_addRow()
{	
	//2012.12.18 이건민 추가
	ds_Dcvg.InsertRow(0);
	ds_Dcvg.SetColumn(0, "BASE_YEAR", substr(gfn_GetServerDate(), 0, 4));
	ds_Dcvg.SetColumn(0, "EXPLOR_END_NM", "준비"           );
	ds_Dcvg.SetColumn(0, "EXPLOR_END_YN", "1"              );
	
	grd_Dcvg.SetCellPos(grd_Dcvg.GetBindCellIndex("BODY","MPIPE_ID"));
	grd_Dcvg.ShowEditor(true);
	
}

//------------------------------------------------------------------------------- 
//   함수명 : fn_D1_SAVE
//   설명  : 구간 실적 등록된 내용을 저장한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
//-------------------------------------------------------------------------------
//  Transition   : Service id
//  ServicePart   : Service part
//  Url          : Server url
//  InputDsList   : Input Dataset List
//  OutputDsList   : Output Dataset List
//  Argument   :  Argument
//-------------------------------------------------------------------------------
function fn_D1_save()
{	
	
	if(!ds_Dcvg.GetUpdate()){
		
		alert("변경사항이 없습니다.");
		return;
	}
	
	for(var i=0; i<ds_Dcvg.GetRowCount(); i++)
	{
		if(ds_Dcvg.GetColumn(i, "MPIPE_ID") == '' || ds_Dcvg.GetColumn(i, "MPIPE_ID") == null)
		{
			alert("배관 ID는 필수입력사항입니다. ");
			return;
		}
		
		if(ds_Dcvg.GetColumn(i, "LENG") == '' || ds_Dcvg.GetColumn(i, "LENG") == null)
		{
			alert("연장정보는 필수입력사항입니다. ");
			return;
		}			
		
		if(ds_Dcvg.GetColumn(i, "BRANCH_CD") == '' || ds_Dcvg.GetColumn(i, "BRANCH_CD") == null)
		{
			alert("지사정보는 필수입력사항입니다. ");
			return;
		}
		
		if(ds_Dcvg.GetColumn(i, "ZIP_NO1") == '' || ds_Dcvg.GetColumn(i, "ZIP_NO1") == null)
		{
			alert("시/구정보는 필수입력사항입니다. ");
			return;
		}
		
//		alert("mpipe_id::::" + ds_Dcvg.GetColumn(i, "MPIPE_ID") + "====rowType::::" +ds_Dcvg.GetRowType(i));

		if (ds_Dcvg.GetRowType(i) == 'update')
		{
			if(ds_Dcvg.GetColumn(i, "LENG") < ds_DcvgArRst.SUM("EXPLOR_LENG")){
				alert("연장의 길이가 이미 저장된 탐사구간의 탐사연장(m) 총 합 보다 적습니다.");
				return ;
			}
		}		
		
		if (ds_Dcvg.GetRowType(i) == 'insert')
		{
			ds_Dcvg.SetColumn(i, "BASE_YEAR", substr(today(),0,4));	//기준년도
			ds_Dcvg.SetColumn(i, "EXPLOR_FLAG", "2");//비계획분
			ds_Dcvg.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_Dcvg.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP		
			ds_Dcvg.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_Dcvg.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP			
		}
		else
		{
			ds_Dcvg.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_Dcvg.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP		
		}
		
		
	}
	//iGridPos = ds_Dcvg.row;
				
	var Transition     	= "insertDcvg";
    var ServicePart     = "D10";
    var Url             = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList     = "ds_Dcvg=ds_Dcvg:u";
    var OutputDsList 	= "ds_Dcvg=ds_Dcvg";
    var Argument      	= "insertDcvg";
    
    gfn_SyncCall(Transition, ServicePart, Url, InputDsList, OutputDsList, Argument);				
				
	if(ErrorCode<0)
	{
		return;
	}	
	
	alert("저장이 완료되었습니다.");
	
	fn_D1_find();
	
}

//------------------------------------------------------------------------------- 
//   함수명: grd_MultiSave_OnExpandEdit1()
//   설명  :  달력 기능과 사원번호 팝업
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function grd_MultiSave_OnExpandEdit1(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == '11' || nCell == '12')
	 {
		gfn_SetCalendar(obj, nRow, nCell);
	 }
}

function Button231_OnClick(obj)
{
	 var strPrefix = "D10";
	 var strFormid = "D1902010014F";
	 var strArg    = "" ;
		 strArg    = "BASE_YEAR="        + substr(today(),0,4);
		 strArg	  += " BRANCH_CD="       + quote(cob_ObjectFlag.Value) ;
		 strArg	  += " EXPLOR_YMD_FROM=" + quote(cal_Ymd_from  .Value) ;
		 strArg	  += " EXPLOR_YMD_TO="   + quote(cal_Ymd_to    .Value) ;
		 strArg	  += " EXPLOR_FLAG="     + '2';
	 
	 gfn_NewWindow(strPrefix,strFormid,strArg) ;  
}

// 차량 운행일지 팝업
function Button91_OnClick(obj)
{
	 var strPrefix = "E30";
	 var strFormid = "E3201080010F";
	 var strArg    = "" ;
	 gfn_NewWindow(strPrefix,strFormid,strArg) ; 
}


function fn_D1_Excel(){

	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 : " +     RPad(cob_ObjectFlag.Text," ",20);
    SearchCondition = SearchCondition + "시/구 : " +    RPad(cob_CountyFlag.Text," ",20);
    SearchCondition = SearchCondition + "기준년도 : " + RPad(sp_Year.Value," ",20);
	SearchCondition = SearchCondition + "배관번호 : " + RPad(edt_MpipeSearch.Text," ",20);
        
    gfn_ExportExcel("배관진단실적등록_비계획실적", 5, SearchCondition, "grd_Dcvg");             
}

function fn_D1_Print(){
	PrintScreen();
}

// 결과등록 주소 등록
function grd_DcvgRst_OnExpandEdit(obj,nRow,nCell,strVal,nPivotIndex)
{
	if(nCell == '4')
	{
		var arrList = gfn_Dialog("A10", "A1101020010U", "", 1100, 600, true, -1, -1);
		
		if(arrList == 0){
			return;
		}		
		
		if (arrList != "" && arrList != null) {
			
			if (ds_Dcvg.GetColumn(ds_Dcvg.row, "ZIP_NO1") != arrList[2]) {
				 alert("해당 시/구를 선택해주세요.");
				 return;
			}
			ds_DcvgRst.SetColumn(nRow, "ZIP_NO1"     ,arrList[2]) ;
			ds_DcvgRst.SetColumn(nRow, "ZIP_NO2"     ,arrList[3]) ;
			ds_DcvgRst.SetColumn(nRow, "DAMAGE_ADDR" ,arrList[17]) ;
			ds_DcvgRst.SetColumn(nRow, "ZIP_NO", "(" +arrList[2] + "-" + arrList[3] + ")") ;	
			ds_DcvgRst.SetColumn(nRow, "ZIP_SEQ"     ,arrList[0]);
			ds_DcvgRst.SetColumn(nRow, "HILL"        ,arrList[10]);
			ds_DcvgRst.SetColumn(nRow, "ADDR_M"      ,arrList[11]);
			ds_DcvgRst.SetColumn(nRow, "ADDR_S"      ,arrList[12]);
			ds_DcvgRst.SetColumn(nRow, "SECOND_ADDR" ,arrList[13]);
			ds_DcvgRst.SetColumn(nRow, "BLD_DONG"    ,arrList[14]);
			ds_DcvgRst.SetColumn(nRow, "HOSU"        ,arrList[15]);
		}	
		
		G_ACTIVEWIN = parent.id;
	}		
}

function fn_D1_DcvgArRstSave()
{
	ds_PlnYn.ClearData();
	ds_PlnYn.AddRow();			
	ds_PlnYn.UpdateControl = false ;
	ds_PlnYn.SetRowType(0, "update");
	ds_PlnYn.SetColumn(0,"BASE_YEAR",ds_Dcvg.GetColumn(0,"BASE_YEAR"));
	ds_PlnYn.SetColumn(0,"MPIPE_ID",ds_DcvgArRst.GetColumn(0, "MPIPE_ID"));		
	ds_PlnYn.SetColumn(0,"UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
	ds_PlnYn.SetColumn(0,"UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP		

	if(ds_Dcvg.GetColumn(ds_Dcvg.row, "LENG") != oldLeng){
		alert("연장을 변경했을경우 비계획 실적 등록을 저장해야만 탐사구간 등록이 가능합니다.");
		return ;
	}


	if(ds_DcvgArRst.GetRowType(ds_DcvgArRst.row) == "normal"){
		alert("변경된 내용이 없습니다.");
		return;
	}
	
	if(ds_DcvgArRst.GetRowCount() == 0)
	{
		return;
	}
	
	if(ds_Dcvg.getColumn(ds_Dcvg.row,"EXPLOR_END_YN") == "3"){
		if(today() > 20130628){
			alert("탐사완료된 건입니다. 수정/삭제 하실 수 없습니다.");
			return;
		}
	}
	
	var sys_len = ds_DcvgArRst.GetColumn(0, "SYS_LENG");
	var	sum_len = ds_DcvgArRst.SUM("EXPLOR_LENG");	
	
	for(var i =0; i<ds_DcvgArRst.GetRowCount();i++)
	{ 
		if (sys_len < sum_len)
		{
			alert("계획연장 초과 탐사연장입니다.");
			return;
		}
	
		if (ds_DcvgArRst.GetRowType(i) == 'insert' || ds_DcvgArRst.GetRowType(i) == 'update')
		{	
			if(ds_DcvgArRst.GetColumn(i, "EXPLOR_YMD") == '' || ds_DcvgArRst.GetColumn(i, "EXPLOR_YMD") == null)
			{
				alert("배관탐사일자를 지정하세요. ");
				return;
			}
			
			if(ds_DcvgArRst.GetColumn(i, "EXPLOR_LENG") == '' || ds_DcvgArRst.GetColumn(i, "EXPLOR_LENG") == null)
			{
				alert("탐사연장 지정하세요. ");
				return;
			}
		
			if (ds_DcvgArRst.GetRowType(i) == 'insert')
			{
				fn_D1_decide();
				
				if(ds_Decide.GetColumn(0, "DECIDE_PROC_STS") == '0' || ds_Decide.GetColumn(0, "DECIDE_PROC_STS") == '1'
					|| ds_Decide.GetColumn(0, "DECIDE_PROC_STS") == '2' )				
				{
					alert("해당탐사일은 결재 진행/완료건으로 등록이 불가능합니다.");
					return;
				}		

				ds_DcvgArRst.SetColumn(i,"BRANCH_CD",ds_Dcvg.GetColumn(ds_Dcvg.row,"BRANCH_CD"));
				ds_DcvgArRst.SetColumn(i,"BASE_YEAR",ds_Dcvg.GetColumn(ds_Dcvg.row,"BASE_YEAR"));
				ds_DcvgArRst.SetColumn(i,"UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
				ds_DcvgArRst.SetColumn(i,"UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
				ds_DcvgArRst.SetColumn(i,"CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
				ds_DcvgArRst.SetColumn(i,"CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
				ds_DcvgArRst.SetColumn(i,"EXPLOR_FLAG","2"); //비계획분(2)
										
			}
			else
			{
				if(ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '1'
					|| ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '2' )
				{
					alert("결재 진행/완료건으로 수정이 불가능합니다...");
					return;
				}		
				ds_DcvgArRst.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
				ds_DcvgArRst.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
			}		
		
			if(ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '1'
				|| ds_DcvgArRst.GetColumn(i, "DECIDE_PROC_STS") == '2' )
			{
				alert("결재 진행/완료건으로 등록 및 수정이 불가능합니다...");
				return;
			}		
		
			
			if (ds_DcvgArRst.GetRowType(i) == "update") 
			{
				ds_DcvgArRst.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
				ds_DcvgArRst.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
			}	
			
		}	
	}		
	
	iGridPos = ds_Dcvg.row;

	var Transition     	= "insertDcvgArRst";
    var ServicePart     = "D10";
    var Url             = "handle.do?ServiceName="+"D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList     = "ds_DcvgArRst=ds_DcvgArRst:u";
    var OutputDsList 	= "ds_DcvgArRst=ds_DcvgArRst";
    var Argument      	= "insertDcvgArRst";
    
    gfn_SyncCall(Transition, ServicePart, Url, InputDsList, OutputDsList, Argument);	
			   
	if(ErrorCode<0)
	{
		return;
	}
	
	alert("저장/수정을 되었습니다.");
	fn_D1_Modify();
	fn_D1_find();
	
}

//비계획 실적 등록 삭제
function fn_D1_deleteRow()
{
	if(ds_Dcvg.GetRowType(ds_Dcvg.row) == "insert"){
		ds_Dcvg.DeleteRow(ds_Dcvg.row);
		return;
	}

	if(ds_Dcvg.GetRowCount() == 0)
	{
		return;
	}
	
	for(var i =0; i<ds_DcvgArRst.GetRowCount();i++)
	{ 	
		if (ds_Dcvg.GetColumn(ds_Dcvg.row, "EXPLOR_YMD") == ds_DcvgArRst.GetColumn(i, "EXPLOR_YMD"))
		{
			alert("해당 탐사일자에 DCVG 비계획 탐사구간 내역이 존재합니다. \nDCVG 비계획 탐사구간내역 삭제 후 삭제 하십시요..");
			return;
		}	
	}
	
	if(confirm("DCVG 비계획 실적을 삭제하시겠습니까?"))
	{
		fn_DeleteDcvg();
	}		
}

function fn_DeleteDcvg()
{		
	ds_Dcvg.DeleteRow(ds_Dcvg.row);

	iGridPos = ds_Dcvg.row;
	
	var Transition     	= "deleteDcvg";
    var ServicePart     = "D10";
    var Url             = "handle.do?ServiceName="+"D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList     = "ds_Dcvg=ds_Dcvg:u";
    var OutputDsList 	= "";
    var Argument      	= "deleteDcvg";
	
    gfn_SyncCall(Transition, ServicePart, Url, InputDsList, OutputDsList, Argument);		
	
	if(ErrorCode < 0)
	{
		return;
	}
	
	alert("정상 삭제 되었습니다.");
	
	fn_D1_find();
}


//-------------------------------------------------------------------------------
// 함수명: btn_add_Rst_OnClick()
// 설명: 접수행을 삭제 한다.
// arguments	없음
// return  없음
//--------------
function btn_add_Rst_OnClick(obj)
{		
	if(ds_DcvgArRst.RowCount() == 0)
	{
		return;
	}
		
	if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"BASE_YEAR") == null || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"BASE_YEAR") == '')
	{
		alert("DCVG탐사구간을 먼저 등록 후 추가버튼을 클릭하세요..");
		return;	
	}
	
	if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '1'
		|| ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '2' )
	{
		alert("결재 진행/완료건으로 추가가 불가능합니다...");
		return;
	}
	
	var nRow = ds_DcvgRst.AddRow();
	
	ds_DcvgRst.SetColumn(nRow, "BASE_YEAR", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"BASE_YEAR"));
	ds_DcvgRst.SetColumn(nRow, "MPIPE_ID", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"MPIPE_ID"));
	ds_DcvgRst.SetColumn(nRow, "PIPE_ID", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"PIPE_ID"));	
	ds_DcvgRst.SetColumn(nRow, "EXPLOR_YMD", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD"));
	ds_DcvgRst.SetColumn(nRow, "EXPLOR_BLOCK_SEQ", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_BLOCK_SEQ"));
	ds_DcvgRst.SetColumn(nRow, "BRANCH_CD", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row,"BRANCH_CD"));	
	ds_DcvgRst.SetColumn(nRow, "PRESS_NM", ds_Dcvg.GetColumn(ds_Dcvg.row,"PRESS_NM"));
	ds_DcvgRst.SetColumn(nRow, "PIPE_DIAM_NM", ds_Dcvg.GetColumn(ds_Dcvg.row,"PIPE_DIAM_NM"));
}

//------------------------------------------------------------------------------- 
// 함수명: btn_save_Rst_OnClick()
// 설명: DCYG 손상의심부 등록
// arguments   
// return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_save_Rst_OnClick(obj)
{
	if (ds_DcvgRst.GetRowCount() == 0)
	{
		return;
	}
	
	for(var i =0; i<ds_DcvgRst.GetRowCount();i++)
	{
		if(ds_DcvgRst.GetRowType(i)=="insert" || ds_DcvgRst.GetRowType(i)=="update")
		{
			if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD") == '' || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD") == null)
			{
				alert("배관탐사일자를 지정하세요. ");
				return;
			}
			
			if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '1'
			    || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '2' )
			{
				alert("결재 진행/완료건으로 둥록 및 수정이 불가능합니다...");
				return;
			}				
			
			ds_DcvgRst.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_DcvgRst.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
			ds_DcvgRst.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_DcvgRst.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
		}	
		else
		{	
			ds_DcvgRst.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_DcvgRst.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
		}
	}

	if(!fn_CheckGridNotNullColumn(grd_DcvgRst)) return;
	
	iGridPos = ds_Dcvg.row;

	var Transition     	= "insertDcvgRst";
    var ServicePart     = "D10";
    var Url             = "handle.do?ServiceName="+"D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList     = "ds_DcvgRst=ds_DcvgRst:u";
    var OutputDsList 	= "ds_DcvgRst=ds_DcvgRst";
    var Argument      	= "insertDcvgRst";

    gfn_SyncCall(Transition, ServicePart, Url, InputDsList, OutputDsList, Argument);	
			   
	if(ErrorCode<0)
	{
		return false;
	}
	
	alert("정상 저장/수정 되었습니다.");	
		
	fn_D1_find();	
	
}
//비계획 손상의심부 삭제
function btn_del_Rst_OnClick(){

	if(ds_DcvgRst.GetRowType(ds_DcvgRst.row) == "insert")
	{
		ds_DcvgRst.DeleteRow(ds_DcvgRst.row);
		return;
	}

	if(ds_DcvgRst.GetRowCount() == 0)
	{
		return;
	}
	
	if(ds_Dcvg.getColumn(ds_Dcvg.row,"EXPLOR_END_YN") == "3"){
		
		alert("탐사완료된 건입니다. 수정/삭제 하실 수 없습니다.");
		return;
	}
	
	if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '1'
		|| ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '2' )
	{
		alert("결재 진행/완료건으로 삭제가 불가능합니다...");
		return;
	}
	

	var sManageNum 	=  ds_DcvgRst.getColumn(ds_DcvgRst.row , "MANAGE_NUM");
	var sMpipeId 	=  ds_DcvgRst.getColumn(ds_DcvgRst.row , "MPIPE_ID"); 
	var sExplorYmd 	=  ds_DcvgRst.getColumn(ds_DcvgRst.row , "EXPLOR_YMD"); 
	
	if(confirm("관리번호 : " + sManageNum + " , 배관ID : " +sMpipeId+ " , 탐사일자 : "+ sExplorYmd +" 삭제하시겠습니까?"))
	{
		ds_DcvgRst.DeleteRow(ds_DcvgRst.row);
	
		iGridPos = ds_Dcvg.row;
		
		var strSvcID         = "deleteDcvgRst";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service" ;	
		var strInDatasets    = "ds_DcvgRst=ds_DcvgRst:u";
		var strOutDatasets   = "";		
		var strArgument      = "deleteDcvgRst";
		
		gfn_SyncCall( 
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
		
		if(ErrorCode < 0)
		{
			return;
		}
	
		alert("정상 삭제 되었습니다.");
		
		fn_D1_find();
	}
}

function ds_Dcvg_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if (strColumnID == "MPIPE_ID") // GetCellProp로 colid를 가져왔기 때문에 colid의 값을 리턴한다.
	{	
		ds_Flag.ClearData();
		
		var strSvcID        = "mpipe_flag";
		var strPart         = "D10";	
		var strURL          = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeMgr-service";
		var strInDatasets   = "";
		var strOutDatasets  = "ds_Flag=ds_Flag";
		var strArgument     = "mpipe_flag=1";
			strArgument		+= " BASE_YEAR="  + quote(obj.Getcolumn(nRow,"BASE_YEAR"));
			strArgument		+= " MPIPE_ID="	  + quote(varNewValue);
	
		gfn_syncCall( 
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
					
		if(ds_Flag.GetColumn(0, "EXPLOR_FLAG") == '1')
		{ 
			alert("이미 계획분에 등록된 배관 ID입니다. ");
			obj.fireEvent = false;
			obj.SetColumn(nRow,"MPIPE_ID",'');
			obj.fireEvent = true;
			return;
		}
		else if (ds_Flag.GetColumn(0, "EXPLOR_FLAG") == '2')
		{
			alert("이미 비 계획분에 등록된 배관 ID입니다. ");
			obj.fireEvent = false;
			obj.SetColumn(obj.row,"MPIPE_ID",'');
			obj.fireEvent = true;
			return;		
		}

		ds_Dummy.ClearData();
	
		var strSvcID        = "search_mpipe";
		var strPart         = "D10";	
		var strURL          = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeMgr-service";
		var strInDatasets   = "";
		var strOutDatasets  = "ds_Dummy=ds_Dummy";
		var strArgument     = "search_mpipe=1";
			strArgument		+= " ID="  + quote(ds_Dcvg.GetColumn(ds_Dcvg.row, "MPIPE_ID"));
	
		gfn_syncCall( 
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
					
		
		if(ds_Dummy.GetRowCount() <= 0) { 
			alert("존재하지 않는 배관 ID입니다. ");
			return;	
		}
		
		fn_D1_Set_View();
	}
}

function fn_D1_Set_View(){

	ds_Dcvg.SetColumn(ds_Dcvg.row, "BRANCH_CD"     , ds_Dummy.GetColumn(0, "BRANCH_CD"));		
	ds_Dcvg.SetColumn(ds_Dcvg.row, "BRANCH_NM"     , ds_Dummy.GetColumn(0, "BRANCH_NM"));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "ZIP_NO1"       , ds_Dummy.GetColumn(0, "ZIP_NO1"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "GU_NM"         , ds_Dummy.GetColumn(0, "GU_NM"    ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "STR_POINT"     , ds_Dummy.GetColumn(0, "STR_ADDR"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "END_POINT"     , ds_Dummy.GetColumn(0, "END_ADDR"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "LENG"          , ds_Dummy.GetColumn(0, "SYS_LENG"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "PRESS_FLAG"    , ds_Dummy.GetColumn(0, "PRESS_FLAG"));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "PRESS_NM"      , ds_Dummy.GetColumn(0, "PRESS_NM"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "PIPE_DIAM_CD"  , ds_Dummy.GetColumn(0, "PIPE_DIAM_CD"));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "PIPE_DIAM_NM"  , ds_Dummy.GetColumn(0, "PIPE_DIAM_NM"));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "COMPL_YMD"     , ds_Dummy.GetColumn(0, "COMPL_DATE"  ));
	ds_Dcvg.SetColumn(ds_Dcvg.row, "WORK_NUM"      , ds_Dummy.GetColumn(0, "WORK_NUM" ));
	//ds_Dcvg.SetColumn(ds_Dcvg.row, "PIPE_ID"       , ds_Dummy.GetColumn(0, "PIPE_ID" ));
}

function ds_DcvgArRst_OnRowPosChanged(obj,nOldRow,nRow)
{
	
	ds_DcvgRst.ClearData();

	ds_Search.ClearData();
	var strRow = ds_Search.AddRow();
	//Parameter Setting
	ds_Search.SetColumn(strRow, "BASE_YEAR", obj.GetColumn(nRow,"BASE_YEAR"));
	ds_Search.SetColumn(strRow, "MPIPE_ID", obj.GetColumn(nRow,"MPIPE_ID"));
	ds_Search.SetColumn(strRow, "EXPLOR_YMD", obj.GetColumn(nRow,"EXPLOR_YMD"));

	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------	
    var ServiceId     = "selectDcvgRstList";
    var ServicePart   = "D10";
    var Url           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList   = "ds_Search=ds_Search";
    var OutputDsList  = "ds_DcvgRst=ds_DcvgRst";
    var Argument      = "selectDcvgRstList";	

    gfn_SyncCall(ServiceId, ServicePart, Url, InputDsList, OutputDsList, Argument); 
    
}

function grd_DcvgArRst_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if("EXPLOR_YMD" == grd_DcvgArRst.GetCellProp("body",nCell,"ColId"))
	{
		if(today() > 20130628){
			if(object(obj.BindDataset).GetRowType(nRow) == 'insert'){
				gfn_SetCalendar(obj, nRow, nCell);
			}
		}else{
			gfn_SetCalendar(obj, nRow, nCell);
		}

	}
}

function fn_D1_decide(){

	ds_Decide.ClearData();
	
	ds_Search.ClearData();
	var strRow = ds_Search.AddRow();
	//Search Parameter Setting
	ds_Search.SetColumn(strRow, "BASE_YEAR", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "BASE_YEAR"));
	ds_Search.SetColumn(strRow, "EXPLOR_YMD", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD"));
	ds_Search.SetColumn(strRow, "BRANCH_CD", ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "BRANCH_CD"));
	
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------	
    var ServiceId     = "selectDecideYn";
    var ServicePart   = "D10";
    var Url           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList   = "ds_Search=ds_Search";
    var OutputDsList  = "ds_Decide=ds_Decide";
    var Argument      = "selectDecideYn";	

    gfn_SyncCall(ServiceId, ServicePart, Url, InputDsList, OutputDsList, Argument);   

}	
		   
function ds_Dcvg_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason){
	if(nreason == 0) //반드시 0에서 로직 처리 0인경우가 DataSet을 모부 받은 경우입니다.
	{
		grd_Dcvg.SetFocus();
		ds_Dcvg.row = iGridPos;
	}	
}

function Grid1_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
		//-------------------------------------------------------------------------------
	//	sorting - Master Grid
	//-------------------------------------------------------------------------------
	gfn_SetGridSort(obj, nCell);
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Modify()
//   설명  :  탐사 여부 수정
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Modify()
{
	var strSvcID         = "Pln_Yn";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeMgr-service";					
	var strInDatasets    = "ds_PlnYn=ds_PlnYn:u";
	var strOutDatasets   = "";		
	var strArgument      = "Pln_Yn=1";

	gfn_SyncCall(
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );			 	 			 	 
	}
}

//------------------------------------------------------------------------------- 
//   함수명: DCVG탐사구간조회
//   설명  :  탐사 여부 수정
//   arguments BASE_YEAR, MPIPE_ID
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function ds_Dcvg_OnRowPosChanged(obj,nOldRow,nRow)
{

	ds_DcvgArRst.ClearData();
	
	ds_Search.DeleteAll();
	var strRow = ds_Search.AddRow();
	//Parameter Setting
	ds_Search.SetColumn(strRow, "BASE_YEAR", ds_Dcvg.GetColumn(nRow,"BASE_YEAR"));
	ds_Search.SetColumn(strRow, "MPIPE_ID", ds_Dcvg.GetColumn(nRow,"MPIPE_ID"));

	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------	
    var ServiceId     = "selectDcvgArRstList";
    var ServicePart   = "D10";
    var Url           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service";
    var InputDsList   = "ds_Search=ds_Search";
    var OutputDsList  = "ds_DcvgArRst=ds_DcvgArRst";
    var Argument      = "selectDcvgArRstList";	

    gfn_SyncCall(ServiceId, ServicePart, Url, InputDsList, OutputDsList, Argument);   
      
    if(ErrorCode < 0){
		fvExplorLengOld = ds_DcvgArRst.sum("EXPLOR_LENG");
		return;
    }else{
		if(ds_DcvgArRst.GetRowCount() == 0){
			grd_DcvgArRst.NoDataText = "조회결과가 없습니다.";
			grd_DcvgRst.NoDataText = "조회결과가 없습니다.";
		}
    }      
    oldLeng = ds_Dcvg.GetColumn(ds_Dcvg.currow,"LENG");

}

//------------------------------------------------------------------------------- 
//   함수명: btn_add_ArRst_OnClick()
//   설명  : 비계획탐사구간 Row 추가
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_add_ArRst_OnClick(obj)
{
	if(ds_Dcvg.GetRowCount() == '0')
	{
		return;
	}
	
	if(ds_Dcvg.GetColumn(ds_Dcvg.row, "LENG") != oldLeng){
		alert("연장을 변경했을경우 비계획 실적 등록을 저장해야만 탐사구간 등록이 가능합니다.");
		return ;
	}

	if(ds_Dcvg.GetColumn(ds_Dcvg.row,"BASE_YEAR") == null || ds_Dcvg.GetColumn(ds_Dcvg.row,"BASE_YEAR") == '')
	{
		alert("DCVG탐사 대상을 먼저 등록 후 추가버튼을 클릭하세요..");
		return;	
	}
	
	if(ds_Dcvg.GetColumn(ds_Dcvg.row,"CRT_DTM") == null || ds_Dcvg.GetColumn(ds_Dcvg.row,"CRT_DTM") == '')
	{
		alert("DCVG탐사 대상을 먼저 등록 후 추가버튼을 클릭하세요..");
		return;	
	}

	if(ds_DcvgArRst.GetColumn(0,"SYS_LENG") == ds_DcvgArRst.Sum("EXPLOR_LENG"))
	{
		alert("연장을 초과하여 탐사 실적 등록이 불가능합니다..");
		return;
	}
	
	var nRow = ds_DcvgArRst.AddRow();

	ds_DcvgArRst.SetColumn(nRow,"MPIPE_ID",ds_Dcvg.GetColumn(ds_Dcvg.row,"MPIPE_ID"));
	ds_DcvgArRst.SetColumn(nRow,"PIPE_ID",ds_Dcvg.GetColumn(ds_Dcvg.row,"PIPE_ID"));
	ds_DcvgArRst.SetColumn(nRow,"SYS_LENG",ds_Dcvg.GetColumn(ds_Dcvg.row,"LENG"));
	ds_DcvgArRst.SetColumn(nRow,"EXPLOR_STR_ADDR",ds_Dcvg.GetColumn(ds_Dcvg.row,"STR_POINT"));
	ds_DcvgArRst.SetColumn(nRow,"EXPLOR_END_ADDR",ds_Dcvg.GetColumn(ds_Dcvg.row,"END_POINT"));	
}

//------------------------------------------------------------------------------- 
//   함수명: btn_save_ArRst_OnClick()
//   설명  : 비계획탐사구간 Row 추가
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_save_ArRst_OnClick(obj)
{	
	//저장하는 함수 호출
	fn_D1_DcvgArRstSave();
}

//비계획 탐사구간 삭제
function btn_del_ArRst_OnClick(obj)
{

	ds_PlnYn.ClearData();
	ds_PlnYn.AddRow();			
	ds_PlnYn.UpdateControl = false ;
	ds_PlnYn.SetRowType(0, "update");
	ds_PlnYn.SetColumn(0,"BASE_YEAR",ds_Dcvg.GetColumn(0,"BASE_YEAR"));
	ds_PlnYn.SetColumn(0,"MPIPE_ID",ds_DcvgArRst.GetColumn(0, "MPIPE_ID"));		
	ds_PlnYn.SetColumn(0,"UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
	ds_PlnYn.SetColumn(0,"UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP		

	if(ds_Dcvg.GetColumn(ds_Dcvg.row, "LENG") != oldLeng){
		alert("연장을 변경했을경우 비계획 실적 등록을 저장해야만 탐사구간 등록이 가능합니다.");
		return ;
	}

	
	if(ds_DcvgArRst.GetRowType(ds_DcvgRst.row) == "insert")
	{
		ds_DcvgArRst.DeleteRow(ds_DcvgArRst.row);
		return;
	}
	
	if(ds_DcvgArRst.GetRowCount() == 0)
	{
		return;
	}
	
	if(ds_Dcvg.getColumn(ds_Dcvg.row,"EXPLOR_END_YN") == "3"){
		
		alert("탐사완료된 건입니다. 수정/삭제 하실 수 없습니다.");
		return;
	}
	
	if(ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '0' || ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '1'
		|| ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "DECIDE_PROC_STS") == '2' )
	{
		alert("결재 진행/완료건으로 삭제가 불가능합니다...");
		return;
	}
	
	for(var i =0; i<ds_DcvgRst.GetRowCount();i++)
	{ 	
		if (ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD") == ds_DcvgRst.GetColumn(i, "EXPLOR_YMD"))
		{
			alert("해당 탐사일자에 DCVG탐사결과(손상부) 내역이 존재합니다. \nDCVG탐사결과(손상부)내역 삭제 후 삭제 하십시요..");
			return;
		}	
	}
	

	var sMpipeId = ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "MPIPE_ID");
	var sExplorLeng = ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_LENG");
	var sExplorYmd = ds_DcvgArRst.GetColumn(ds_DcvgArRst.row, "EXPLOR_YMD");
	
	
	if(confirm("배관ID : " + sMpipeId + " , 탐사연장 : " +sExplorLeng+ " , 탐사일자 : "+ sExplorYmd +" 삭제하시겠습니까?"))
	{
		ds_DcvgArRst.DeleteRow(ds_DcvgArRst.row);
	
		var strSvcID         = "deleteDcvgArRst";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1_DCVGSechActualResultPlanPipeAMgr-service" ;	
		var strInDatasets    = "ds_DcvgArRst=ds_DcvgArRst:u";
		var strOutDatasets   = "";		
		var strArgument      = "deleteDcvgArRst";
			 
		gfn_SyncCall( 
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
		
		if(ErrorCode < 0)
		{
			return;
		}
	
		alert("삭제가 완료되었습니다");
		
		fn_D1_Modify();
		
		fn_D1_find();
	}
}


function fn_CheckGridNotNullColumn(grdObj){

	var arryCheck = gfn_CheckGridNotNullColumn(grdObj);

	if(arryCheck.length > 0){
		
		alert(grdObj.GetCellProp("HEAD",arryCheck[2],"Text") +"을 입력해주세요.");
		object(grdObj.BindDataset).row = arryCheck[0];
		grdObj.SetCellPos(arryCheck[1]);
		grdObj.ShowEditor(true);
		return false;
	} 
	
	return true;
	
}
]]></Script>
</Window>