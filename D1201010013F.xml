<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="853" Id="D1201010013F" Left="8" OnLoadCompleted="D1201010013F_OnLoadCompleted" PidAttrib="7" Style="combo_indis" Title="분기순찰계획등록_D1201010013F" Top="8" Ver="1.0" Width="1032" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Faci" OnColumnChanged="ds_Faci_OnColumnChanged">
				<Contents>
					<colinfo id="NAME_BIG" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME_MIDDLE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME_SMALL" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCLE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CYCLE" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CYCLE1" size="256" summ="default" type="STRING"/>
					<colinfo id="TARGET" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCLE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCLE_NM1" size="256" summ="default" type="STRING"/>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>10</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>배관</NAME_BIG>
						<NAME_MIDDLE>본관</NAME_MIDDLE>
						<NAME_SMALL>도보</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>11</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>배관</NAME_BIG>
						<NAME_MIDDLE>본관</NAME_MIDDLE>
						<NAME_SMALL>누출탐지차량</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>12</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>배관</NAME_BIG>
						<NAME_MIDDLE>공급관</NAME_MIDDLE>
						<NAME_SMALL>도보</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>13</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>배관</NAME_BIG>
						<NAME_MIDDLE>공급관</NAME_MIDDLE>
						<NAME_SMALL>누출탐지차량</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>10</CHK_CYCLE>
						<CHK_CYCLE1>10</CHK_CYCLE1>
						<CYCLE_CD>14</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>배관</NAME_BIG>
						<NAME_MIDDLE>차량</NAME_MIDDLE>
						<NAME_SMALL>차량</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>10</CHK_CYCLE>
						<CHK_CYCLE1>10</CHK_CYCLE1>
						<CYCLE_CD>15</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>정압기</NAME_BIG>
						<NAME_MIDDLE>지구</NAME_MIDDLE>
						<NAME_SMALL>지구</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>11</CHK_CYCLE>
						<CHK_CYCLE1>11</CHK_CYCLE1>
						<CYCLE_CD>16</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>정압기</NAME_BIG>
						<NAME_MIDDLE>지역</NAME_MIDDLE>
						<NAME_SMALL>지역</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>16</CHK_CYCLE>
						<CHK_CYCLE1>16</CHK_CYCLE1>
						<CYCLE_CD>17</CYCLE_CD>
						<CYCLE_NM>0.125</CYCLE_NM>
						<CYCLE_NM1>0.125</CYCLE_NM1>
						<NAME_BIG>정압기</NAME_BIG>
						<NAME_MIDDLE>분해점검</NAME_MIDDLE>
						<NAME_SMALL>분해점검</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>14</CHK_CYCLE>
						<CHK_CYCLE1>14</CHK_CYCLE1>
						<CYCLE_CD>18</CYCLE_CD>
						<CYCLE_NM>0.5</CYCLE_NM>
						<CYCLE_NM1>0.5</CYCLE_NM1>
						<NAME_BIG>테스트박스</NAME_BIG>
						<NAME_MIDDLE>본관</NAME_MIDDLE>
						<NAME_SMALL>본관</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>14</CHK_CYCLE>
						<CHK_CYCLE1>14</CHK_CYCLE1>
						<CYCLE_CD>19</CYCLE_CD>
						<CYCLE_NM>0.5</CYCLE_NM>
						<CYCLE_NM1>0.5</CYCLE_NM1>
						<NAME_BIG>테스트박스</NAME_BIG>
						<NAME_MIDDLE>공급관</NAME_MIDDLE>
						<NAME_SMALL>공급관</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>20</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>밸브</NAME_BIG>
						<NAME_MIDDLE>본관</NAME_MIDDLE>
						<NAME_SMALL>본관</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>21</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>밸브</NAME_BIG>
						<NAME_MIDDLE>공급관</NAME_MIDDLE>
						<NAME_SMALL>공급관</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>14</CHK_CYCLE>
						<CHK_CYCLE1>14</CHK_CYCLE1>
						<CYCLE_CD>22</CYCLE_CD>
						<CYCLE_NM>0.5</CYCLE_NM>
						<CYCLE_NM1>0.5</CYCLE_NM1>
						<NAME_BIG>밸브</NAME_BIG>
						<NAME_MIDDLE>인입밸브</NAME_MIDDLE>
						<NAME_SMALL>인입밸브</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>23</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>수취기</NAME_BIG>
						<NAME_MIDDLE>공급관</NAME_MIDDLE>
						<NAME_SMALL>공급관</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>24</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>정배류기</NAME_BIG>
						<NAME_MIDDLE>정류기</NAME_MIDDLE>
						<NAME_SMALL>정류기</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>13</CHK_CYCLE>
						<CHK_CYCLE1>13</CHK_CYCLE1>
						<CYCLE_CD>25</CYCLE_CD>
						<CYCLE_NM>1</CYCLE_NM>
						<CYCLE_NM1>1</CYCLE_NM1>
						<NAME_BIG>정배류기</NAME_BIG>
						<NAME_MIDDLE>배류기</NAME_MIDDLE>
						<NAME_SMALL>배류기</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>12</CHK_CYCLE>
						<CHK_CYCLE1>12</CHK_CYCLE1>
						<CYCLE_CD>26</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>중점관리</NAME_BIG>
						<NAME_MIDDLE>교량첨가</NAME_MIDDLE>
						<NAME_SMALL>교량첨가</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>12</CHK_CYCLE>
						<CHK_CYCLE1>12</CHK_CYCLE1>
						<CYCLE_CD>27</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>중점관리</NAME_BIG>
						<NAME_MIDDLE>하상(천)통과</NAME_MIDDLE>
						<NAME_SMALL>하상(천)통과</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>12</CHK_CYCLE>
						<CHK_CYCLE1>12</CHK_CYCLE1>
						<CYCLE_CD>28</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>중점관리</NAME_BIG>
						<NAME_MIDDLE>철길통과</NAME_MIDDLE>
						<NAME_SMALL>철길통과</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
					<record>
						<CHK_CYCLE>11</CHK_CYCLE>
						<CHK_CYCLE1>11</CHK_CYCLE1>
						<CYCLE_CD>29</CYCLE_CD>
						<CYCLE_NM></CYCLE_NM>
						<CYCLE_NM1></CYCLE_NM1>
						<NAME_BIG>특별시설</NAME_BIG>
						<NAME_MIDDLE>중압직공급</NAME_MIDDLE>
						<NAME_SMALL>중압직공급</NAME_SMALL>
						<TARGET></TARGET>
						<TOTAL></TOTAL>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ArFaci">
				<Contents>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_WALK_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_FID_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_WALK_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_FID_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_CAR_TOT_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="ZONE_GOV_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="AREA_GOV_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="GOV_DISJOINT_CHK_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_TB_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_TB_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_VALVE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_VALVE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="INTO_VALVE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_WTDR_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECTIFIER_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="DRAINAGE_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="BRIGE_ADD_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="RIVER_PASS_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="RAIL_PASS_PIPE_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="SPECI_DIRE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_TeamCd">
				<Contents>
					<colinfo id="KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Block">
				<Contents>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Cycle">
				<Contents>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CYCLE_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CYCLE" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Count">
				<Contents>
					<colinfo id="NCOUNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_OrgEmpId">
				<Contents>
					<colinfo id="BLOCK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SHIFT_WORK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Parm">
				<Contents>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape2" Left="5" LineColor="user7" Right="1027" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="3" Top="30" Type="RoundRect" Width="1022"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape5" Left="10" LineWidth="0" Right="1022" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="4" Top="35" Type="Rectangle" Width="1012"></Shape>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="1" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1020">
			<Contents></Contents>
		</Div>
		<Image Align="Left" Height="18" Id="Image7" ImageID="blt" Left="13" LeftMargin="12" Style="blt_search_Indis" TabOrder="2" Text="지사" Top="41" Width="61"></Image>
		<Combo Border="Flat" Height="18" Id="cob_PBranchCd" Left="53" OnChanged="cob_PBranchCd_OnChanged" Style="combo_indis" TabOrder="5" Top="40" Width="115"></Combo>
		<Spin Border="Flat" Height="18" Id="sp_PChkYear" Left="654" OnCharChanged="sp_PChkYear_OnCharChanged" OnClickUpDown="sp_PChkYear_OnClickUpDown" Style="spin_indis" TabOrder="6" Text="2008" Top="40" Width="56"></Spin>
		<Image Align="Left" Height="18" Id="Image2" ImageID="blt" Left="721" LeftMargin="12" Style="blt_search_Indis" TabOrder="8" Text="분기" Top="41" Width="41"></Image>
		<Combo Border="Flat" Height="18" Id="cob_PChkQuarter" Left="759" OnChanged="cob_PChkQuarter_OnChanged" Style="combo_indis" TabOrder="9" Top="40" Width="90"></Combo>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="KITEM" Height="18" Id="cob_PTeamCd" InnerDataset="ds_TeamCd" Left="201" OnChanged="cob_PTeamCd_OnChanged" Style="combo" TabOrder="11" Top="40" Width="130"></Combo>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="171" LeftMargin="12" Style="blt_search_Indis" TabOrder="10" Text="팀" Top="41" Width="41"></Image>
		<Image Align="Left" Height="18" Id="Image4" ImageID="blt" Left="338" LeftMargin="12" Style="blt_search" TabOrder="12" Text="구간" Top="41" Width="41"></Image>
		<Grid AutoEnter="TRUE" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="795" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="694" Id="grd_Multi" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" NoDataText="조회된&#32;결과가&#32;없습니다." Right="592" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="14" TabStop="true" Top="101" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="584">
			<contents>
				<format id="Default">
					<columns>
						<col width="90"/>
						<col width="90"/>
						<col width="100"/>
						<col width="67"/>
						<col width="88"/>
						<col width="63"/>
						<col width="81"/>
					</columns>
					<head>
						<cell col="0" colspan="3" display="text" text="시설물"/>
						<cell bkcolor="user11" col="3" display="text" text="점검주기"/>
						<cell bkcolor="user11" col="4" display="text" text="대상"/>
						<cell bkcolor="user11" col="5" display="text" text="대상주기"/>
						<cell col="6" display="text" text="물량"/>
					</head>
					<body>
						<cell bkcolor="user12" col="0" colid="NAME_BIG" display="text" suppress="1" text="배관"/>
						<cell bkcolor="user12" col="1" colid="NAME_MIDDLE" display="text" expandsize="18" suppress="2" text="본관" wordwrap="word"/>
						<cell bkcolor="user12" col="2" colid="NAME_SMALL" display="text" text="도보"/>
						<cell bkcolor="user12" col="3" colid="CHK_CYCLE" display="normal"/>
						<cell align="right" col="4" colid="TARGET" display="number"/>
						<cell align="right" col="5" colid="CYCLE_NM" display="number" edit="expr:iif(CYCLE_NM1==&#32;&apos;&apos;,&#32;&apos;number&apos;,&#32;&apos;none&apos;)" limit="2" LimitDec="2"/>
						<cell align="right" col="6" colid="TOTAL" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user15" Bottom="101" Height="3" Id="Shape0" Left="8" LineWidth="0" Right="592" TabOrder="13" Top="98" Type="Rectangle" Width="584"></Shape>
		<Shape BKColor="user15" Bottom="101" Height="3" Id="Shape1" Left="594" LineWidth="0" Right="1024" TabOrder="15" Top="98" Type="Rectangle" Width="430"></Shape>
		<Grid AutoEnter="TRUE" BindDataset="ds_OrgEmpId" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="795" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="694" Id="grd_Multi2" InputPanel="FALSE" Left="594" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" NoDataText="조회된&#32;결과가&#32;없습니다." Right="1024" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="16" TabStop="true" Top="101" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="430">
			<contents>
				<format id="Default">
					<columns>
						<col width="27"/>
						<col width="127"/>
						<col width="69"/>
						<col width="69"/>
						<col width="68"/>
						<col width="69"/>
					</columns>
					<head>
						<cell col="0" display="text" text="NO"/>
						<cell col="1" display="text" text="구간"/>
						<cell col="2" display="text" text="조"/>
						<cell col="3" display="text" text="담당자1"/>
						<cell col="4" display="text" text="담당자2"/>
						<cell col="5" display="text" text="담당자3"/>
					</head>
					<body>
						<cell align="right" col="0" display="text" expr="rowindex+1"/>
						<cell col="1" colid="BLOCK_NM" display="text"/>
						<cell align="center" col="2" colid="SHIFT_WORK_CD" display="combo"/>
						<cell align="center" col="3" colid="TAKER_EMPID1" display="text"/>
						<cell align="center" col="4" colid="TAKER_EMPID2" display="text"/>
						<cell align="center" col="5" colid="TAKER_EMPID3" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="18" Id="Image1" ImageID="blt" Left="614" LeftMargin="12" Style="blt_search_Indis" TabOrder="7" Text="년도" Top="41" Width="41"></Image>
		<Combo BKColor="user8" Border="Flat" CodeColumn="BLOCK_CD" DataColumn="BLOCK_NM" Height="18" Id="cob_PBlockCd" ImeMode="none" InnerDataset="ds_Block" Left="378" OnChanged="cob_PBlockCd_OnChanged" Style="combo" TabOrder="17" Top="40" Width="230"></Combo>
		<Image Align="Left" Height="13" Id="Image9" ImageID="blt_8" Left="11" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="18" Text="분기순찰계획등록" Top="83" Width="125"></Image>
		<Image Align="Left" Height="13" Id="Image5" ImageID="blt_8" Left="596" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="19" Text="구간&#32;담당자" Top="83" Width="173"></Image>
		<Image Align="Left" Height="18" Id="Image6" ImageID="blt" Left="334" LeftMargin="12" Style="blt_search" TabOrder="20" TabStop="FALSE" Text="등록일자&#32;:&#32;" Top="80" Width="67"></Image>
		<Static Align="Center" Border="Flat" BorderColor="red" Height="17" Id="st_Reg" Left="404" Style="static" TabOrder="21" Top="79" Width="136"></Static>
		<Static Align="Center" Border="Flat" BorderColor="blueviolet" Height="17" Id="st_Nm" Left="541" Style="static" TabOrder="22" Top="79" Width="48"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1201010013F.xml
* Form 설명   : 분기순찰계획 등록,수정
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2008-01-20
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
//---------------------------------------------------------
//	화면 OnLoadCompleted 이벤트처리 발생하는 함수( 화면ID_OnLoadCompleted )
//---------------------------------------------------------
var chk_quarter = '';
var plan_yn = 'N';


function D1201010013F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_D1_On_load();
}

function fn_D1_On_load()
{
	//-----------------------------------------
	//  콤보박스의 내용을 셋팅한다.
	//-----------------------------------------
	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_PBranchCd"));		//지사 구분	
	//-----------------------------------------
	//  콤보박스의 초기 설정
	//-----------------------------------------
	if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") {
	    cob_PBranchCd.Index = 0;
	} else {
	    cob_PBranchCd.Value = gfn_GetGlobalValue("G_BRANCH_CD");
	    cob_PBranchCd.Enable = false;
	}

	cob_PBranchCd_OnChanged();

	gfn_SetComboBox_Comcode("E50059",gfn_setDsObject_Comcode("cob_PChkQuarter"));	//분기 구분

	sp_PChkYear.Value = substr(today(),0,4);
	
	if (substr(today(), 4, 2) == "01" || substr(today(), 4, 2) == "02" || substr(today(), 4, 2) == "03") {
	    cob_PChkQuarter.Index = 0;
	    chk_quarter = '1';
	} else if (substr(today(), 4, 2) == "04" || substr(today(), 4, 2) == "05" || substr(today(), 4, 2) == "06") {
	    cob_PChkQuarter.Index = 1;
	    chk_quarter = '2';
	} else if (substr(today(), 4, 2) == "07" || substr(today(), 4, 2) == "08" || substr(today(), 4, 2) == "09") {
	    cob_PChkQuarter.Index = 2;
	    chk_quarter = '3';
	} else if (substr(today(), 4, 2) == "10" || substr(today(), 4, 2) == "11" || substr(today(), 4, 2) == "12") {
	    cob_PChkQuarter.Index = 3;
	    chk_quarter = '4';
	}							
		
}

//---------------------------------------------------------------------------------
// 기      능   :  지사별 구를 조회하여 콤보박스에 셋팅
//---------------------------------------------------------------------------------
function cob_PBranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 지사별 팀 콤보 셋팅 시
    gfn_D1_SetComboBox_Teamcd01("ds_TeamCd",cob_PBranchCd);
    
    if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") {
	    cob_PTeamCd.Index = 0;
	} else {
	    cob_PTeamCd.value = gfn_GetGlobalValue("G_DEPT_CODE");
	}
    
    cob_PTeamCd_OnChanged();
}

//---------------------------------------------------------------------------------
// 기      능   :  지사에 따른 구에 따른 팀에 따른 구간코드를 불러오기 위해
//---------------------------------------------------------------------------------
function cob_PTeamCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	ds_Parm.ClearData();
	ds_Parm.AddRow();
	
	ds_Parm.SetColumn(0, "BRANCH_CD" , cob_PBranchCd.Value);
	ds_Parm.SetColumn(0, "TEAM_CD", cob_PTeamCd.Value);
	
	var strSvcID = "find_block";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";
	var strInDatasets  = "ds_Parm=ds_Parm";
	var strOutDatasets  = "ds_Block=ds_Block";
	var strArgument  = "find_block=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					 	
	    
    if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}
	
	cob_PBlockCd.Index = 0;
	
	if(ds_Block.GetRowCount() == 0){
		cob_PBlockCd.Enable = false;
	}else{
		cob_PBlockCd.Enable = true;		
	}	
	
	fn_CommonSearch();
}

/*===============================================================================
 * 함수명: fn_CommonSearch()
   설명: 공통 조회 클릭시 조회 업무  수행 
   return 내용: 없음
===============================================================================*/ 
function fn_CommonSearch()
{   
	st_Reg.Value = '';
	st_Nm.Value = '';
	
	ds_Count.ClearData();
	ds_Parm.ClearData();
	ds_Parm.AddRow();
	
	ds_Parm.SetColumn(0, "CHK_YEAR" , sp_PChkYear.Value);
	ds_Parm.SetColumn(0, "CHK_QUARTER", cob_PChkQuarter.Value);
	ds_Parm.SetColumn(0, "BLOCK_CD", cob_PBlockCd.Value);
	
	var strSvcID = "count";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";
	var strInDatasets  = "ds_Parm=ds_Parm";
	var strOutDatasets  = "ds_Count=ds_Count";
	var strArgument  = "count=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					 	
		             
	if(ds_Count.GetColumn(0, "NCOUNT") > 0)   //계획등록 존재시
    {
		fn_D1_Plan_Find();
		grd_Multi.Editable = false;	
		plan_yn = 'Y';
    }
    else  //계획등록 미 존재시
    {
		fn_D1_Find();		
		grd_Multi.Editable = true;   
		plan_yn = 'N';
    }
    
   	fn_Set();
}

//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Count
// 설명     : 분기순찰계획 등록 여부 조회
//-------------------------------------------------------------------------------
function fn_D1_Count(){

	ds_Parm.ClearData();
	ds_Parm.AddRow();
	
	ds_Parm.SetColumn(0, "CHK_YEAR" , sp_PChkYear.Value);
	ds_Parm.SetColumn(0, "CHK_QUARTER", cob_PChkQuarter.Value);
	ds_Parm.SetColumn(0, "BLOCK_CD", cob_PBlockCd.Value);
	
	var strSvcID = "count";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";
	var strInDatasets  = "ds_Parm=ds_Parm";
	var strOutDatasets  = "ds_Count=ds_Count";
	var strArgument  = "count=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					 			             
}


function fn_CommonSave()
{
	var current_year_guarter = '';
	var chk_year_guarter = '';
	
	current_year_guarter = substr(today(), 0, 4) + chk_quarter;
	chk_year_guarter = sp_PChkYear.Value + cob_PChkQuarter.Value;
		
	if(current_year_guarter > chk_year_guarter)
	{
		alert("해당 년도 분기계획 등록이 마감되었습니다...");
		return;
	}

	if(current_year_guarter == chk_year_guarter)
	{
	  if(substr(today(), 4, 2) == "01" || substr(today(), 4, 2) == "04" || substr(today(), 4, 2) == "07" || substr(today(), 4, 2) == "10")
	  {
		if(substr(today(), 6, 2) > "30")
		{
			alert("해당 분기계획 등록기간은 분기시작월 30일까지 입니다...");
			return;	  		
		}
	  }
	  else
	  {
		alert("해당 분기계획 등록이 마감되었습니다...");
		return;	  
	  }
	}
	   
	if(st_Reg.Text != '')
	{
		alert("해당 분기계획 등록은 수정이 불가능 합니다. 삭제 후 재 등록 바랍니다..");
		return;	  	
	}
	
	if(plan_yn == 'N'){ // 등록된 데이터가 없으므로 구간시설물 현황에서 조회
		fn_D1_Save();
	}
	else
	{	
		alert("분기 계획건은 수정이 불가합니다. \n삭제하신 후 다시 등록하십시오. ");
	}	
}


function fn_CommonDeleteRow(){	
	if(plan_yn == 'N'){ // 등록된 데이터가 없으므로 구간시설물 현황에서 조회
		alert("삭제할 데이터가 없습니다. ");
		return;
	}
	
	var current_year_guarter = '';
	var chk_year_guarter = '';
	
	current_year_guarter = substr(today(), 0, 4) + chk_quarter;
	chk_year_guarter = sp_PChkYear.Value + cob_PChkQuarter.Value;
		
	if(current_year_guarter > chk_year_guarter)
	{
		alert("해당 년도 분기계획 등록이 마감되었습니다...");
		return;
	}

	if(current_year_guarter == chk_year_guarter)
	{
	  if(substr(today(), 4, 2) == "01" || substr(today(), 4, 2) == "04" || substr(today(), 4, 2) == "07" || substr(today(), 4, 2) == "10")
	  {
		if(substr(today(), 6, 2) > "30")
		{
			alert("해당 분기계획 삭제는 분기시작월 15일까지 입니다...");
			return;	  		
		}
	  }
	  else
	  {
		alert("해당 분기계획 등록이 마감되었습니다...");
		return;	  
	  }
	}
	   
	
	if(!confirm(cob_PBlockCd.Text + " " + sp_PChkYear.Value + "년도" + cob_PChkQuarter.Text + " 계획을 삭제하시겠습니까?"))
    {
		return;		
    }
		 
	ds_Parm.ClearData();
	ds_Parm.AddRow();
	ds_Parm.UpdateControl = false;
	ds_Parm.SetRowType(0, 'delete');
	
	ds_Parm.SetColumn(0, "CHK_YEAR"   , ds_ArFaci.GetColumn(0, "CHK_YEAR"));
	ds_Parm.SetColumn(0, "CHK_QUARTER", ds_ArFaci.GetColumn(0, "CHK_QUARTER"));
	ds_Parm.SetColumn(0, "BLOCK_CD"   , ds_ArFaci.GetColumn(0, "BLOCK_CD"));
	
	var strSvcID         = "delete";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";					
	var strInDatasets    = "ds_Parm=ds_Parm:u";
	var strOutDatasets   = "";		
	var strArgument      = "delete=1";

	gfn_SyncCall(
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
				   	
	if(ErrorCode<0)
	{
		alert("삭제 오류입니다... ");
		return false;
	}
		
	alert("삭제 되었습니다.. ");
		
	fn_CommonSearch();
	
}

//---------------------------------------------------------
//	공통 버튼 클릭 - 엑셀 Export
//---------------------------------------------------------
function fn_CommonExcelExport()
{
	fn_D1_ExcelExport();
}

//---------------------------------------------------------
//	공통 버튼 클릭 - Print
//---------------------------------------------------------
function fn_CommonPrint()
{
	PrintScreen(true);
}

function fn_D1_Find()
{
	ds_Parm.ClearData();
	ds_Parm.AddRow();
	
	ds_Parm.SetColumn(0, "BRANCH_CD" , cob_PBranchCd.Value);
	ds_Parm.SetColumn(0, "TEAM_CD", cob_PTeamCd.Value);
	ds_Parm.SetColumn(0, "BLOCK_CD", cob_PBlockCd.Value);
	ds_Parm.SetColumn(0, "CHK_YEAR", sp_PChkYear.Value);
	ds_Parm.SetColumn(0, "CHK_QUARTER", cob_PChkQuarter.Value);
	
	var strSvcID = "ArFaciFind";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";
	var strInDatasets  = "ds_Parm=ds_Parm";
	var strOutDatasets  = "ds_ArFaci=ds_ArFaci ds_OrgEmpId=ds_OrgEmpId";
	var strArgument  = "ArFaciFind=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					 				              		
}

function fn_D1_Plan_Find()
{		
	ds_Parm.ClearData();
	ds_Parm.AddRow();
	
	ds_Parm.SetColumn(0, "BRANCH_CD" , cob_PBranchCd.Value);
	ds_Parm.SetColumn(0, "TEAM_CD", cob_PTeamCd.Value);
	ds_Parm.SetColumn(0, "BLOCK_CD", cob_PBlockCd.Value);
	ds_Parm.SetColumn(0, "CHK_YEAR", sp_PChkYear.Value);
	ds_Parm.SetColumn(0, "CHK_QUARTER", cob_PChkQuarter.Value);
		
	var strSvcID = "Planfind";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";
	var strInDatasets  = "ds_Parm=ds_Parm";
	var strOutDatasets  = "ds_ArFaci=ds_ArFaci ds_Cycle=ds_Cycle ds_OrgEmpId=ds_OrgEmpId";
	var strArgument  = "Planfind=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					 	
			   			   	              
	gfn_SetGrdComboBox_Comcode("grd_Multi",3,"D10222"); //코드요청 확인시 변경할 것
	grd_Multi.SetCellProp("body",3,"edit","none");		
}

function fn_Set(){

	grd_Multi.BindDataset = "";          
	
	ds_Faci.SetColumn( 0,"TARGET"  , ds_ArFaci.GetColumn(0,"KOPIPE_WALK_LENG"		  ));// 배관 본관 도보
	ds_Faci.SetColumn( 1,"TARGET"  , ds_ArFaci.GetColumn(0,"KOPIPE_FID_LENG"		  ));// 배관 본관 누출탐지차량
	ds_Faci.SetColumn( 2,"TARGET"  , ds_ArFaci.GetColumn(0,"MPIPE_WALK_LENG"		  ));// 배관 공급관 도보
	ds_Faci.SetColumn( 3,"TARGET"  , ds_ArFaci.GetColumn(0,"MPIPE_FID_LENG"		    ));// 배관 공급관 누출탐지차량		
	ds_Faci.SetColumn( 4,"TARGET"  , ds_ArFaci.GetColumn(0,"PIPE_CAR_TOT_LENG"		));// 배관 차량
	ds_Faci.SetColumn( 5,"TARGET"  , ds_ArFaci.GetColumn(0,"ZONE_GOV_CNT"			    ));// 정압기 지구 
	ds_Faci.SetColumn( 6,"TARGET"  , ds_ArFaci.GetColumn(0,"AREA_GOV_CNT"			    ));// 정압기 지역
	ds_Faci.SetColumn( 7,"TARGET"  , ds_ArFaci.GetColumn(0,"GOV_DISJOINT_CHK_CNT"	));// 정압기 분해점검
	ds_Faci.SetColumn( 8,"TARGET"  , ds_ArFaci.GetColumn(0,"KOPIPE_TB_CNT"			  ));// 테스트박스 본관
	ds_Faci.SetColumn( 9,"TARGET"  , ds_ArFaci.GetColumn(0,"MPIPE_TB_CNT"			    ));// 테스트박스 공급관 
	ds_Faci.SetColumn(10,"TARGET"  , ds_ArFaci.GetColumn(0,"KOPIPE_VALVE_CNT"		  ));// 밸브 본관
	ds_Faci.SetColumn(11,"TARGET"  , ds_ArFaci.GetColumn(0,"MPIPE_VALVE_CNT"		  ));// 밸브 공급관
	ds_Faci.SetColumn(12,"TARGET"  , ds_ArFaci.GetColumn(0,"INTO_VALVE_CNT"		    ));// 밸브 인입밸브
	ds_Faci.SetColumn(13,"TARGET"  , ds_ArFaci.GetColumn(0,"MPIPE_WTDR_CNT"		    ));// 수취기
	ds_Faci.SetColumn(14,"TARGET"  , ds_ArFaci.GetColumn(0,"RECTIFIER_CNT"			  ));// 정류기
	ds_Faci.SetColumn(15,"TARGET"  , ds_ArFaci.GetColumn(0,"DRAINAGE_CNT"			    ));// 배류기
	ds_Faci.SetColumn(16,"TARGET"  , ds_ArFaci.GetColumn(0,"BRIGE_ADD_CNT"			  ));// 교량첨가
	ds_Faci.SetColumn(17,"TARGET"  , ds_ArFaci.GetColumn(0,"RIVER_PASS_QTY"		    ));// 하상천통과
	ds_Faci.SetColumn(18,"TARGET"  , ds_ArFaci.GetColumn(0,"RAIL_PASS_PIPE_QTY"	  ));// 철길통과
	ds_Faci.SetColumn(19,"TARGET"  , ds_ArFaci.GetColumn(0,"SPECI_DIRE"           ));// 중압직공급
	
	if(plan_yn == 'Y'){ // 계획등록건 존재
		st_Reg.Value = ds_ArFaci.GetColumn(0, "CRT_DTM");
		st_Nm.Value = ds_ArFaci.GetColumn(0, "CRT_NM");

		for(var i=0; i<ds_Faci.GetRowCount(); i++){
			ds_Faci.SetColumn(i,"CHK_CYCLE", ds_Cycle.GetColumn(i,"CHK_CYCLE"));
			ds_Faci.SetColumn(i,"CYCLE_NM" , ds_Cycle.GetColumn(i,"CHK_CNT"  ));
		}
	}else{
		for(var i=0; i<ds_Faci.GetRowCount(); i++){		
		
			if(ds_Faci.GetColumn(i, "CHK_CYCLE") == "10" || ds_Faci.GetColumn(i, "CHK_CYCLE") == "11")
			{
				ds_Faci.SetColumn(i, "CYCLE_NM" , "");
				ds_Faci.SetColumn(i, "CYCLE_NM1", "");
			}
		}	
	}
	
	gfn_SetGrdComboBox_Comcode("grd_Multi",3,"D10222"); //코드요청 확인시 변경할 것
	grd_Multi.SetCellProp("body",3,"edit","none");
	
	grd_Multi.BindDataset = "ds_Faci";	
}

function ds_Faci_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	//대상 * 대상주기 = 물량을 계산한다
	if(strColumnID == "TARGET" || strColumnID == "CYCLE_NM")
	{
		var Sum =  round(toNumber(ds_Faci.GetColumn(nRow, "TARGET")) * toNumber(ds_Faci.GetColumn(nRow, "CYCLE_NM")));
		ds_Faci.SetColumn(nRow, "TOTAL", decode(Sum, '0', '', Sum));
	}	
}

function fn_D1_Save()
{
	ds_Cycle.ClearData();
	
	ds_ArFaci.UpdateControl = false;
	ds_ArFaci.SetRowType(0, 'insert');
	ds_ArFaci.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"  ));	//수정자사번
	ds_ArFaci.SetColumn(0, "UPD_IP"   , gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
	ds_ArFaci.SetColumn(0, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"  ));	//등록자사번
	ds_ArFaci.SetColumn(0, "CRT_IP"   , gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
	
	ds_Cycle.UpdateControl = false;
	var row;
	for(var i=0; i<ds_Faci.GetRowCount(); i++){	
		row = ds_Cycle.AddRow();
		ds_Cycle.SetRowType(row, 'insert');
		
		ds_Cycle.SetColumn(row, "UPD_EMPID"   , gfn_GetGlobalValue("G_USER_NO"  )); //수정자사번
		ds_Cycle.SetColumn(row, "UPD_IP"      , gfn_GetGlobalValue("G_IPADDRESS")); //수정자 IP
		ds_Cycle.SetColumn(row, "CRT_EMPID"   , gfn_GetGlobalValue("G_USER_NO"  )); //등록자사번
		ds_Cycle.SetColumn(row, "CRT_IP"      , gfn_GetGlobalValue("G_IPADDRESS")); //등록자 IP
		
		ds_Cycle.SetColumn(row, "CHK_YEAR"    , sp_PChkYear.Value);					 //점검년도
		ds_Cycle.SetColumn(row, "CHK_QUARTER" , cob_PChkQuarter.Value);					 //점검분기
		ds_Cycle.SetColumn(row, "BLOCK_CD"    , cob_PBlockCd.Value);					 //구간코드
		ds_Cycle.SetColumn(row, "CYCLE_CD"    , ds_Faci.GetColumn(i, "CYCLE_CD"));	 //주기코드	
		
		ds_Cycle.SetColumn(row, "BRANCH_CD" , cob_PBranchCd.Value);
		ds_Cycle.SetColumn(row, "TEAM_CD", cob_PTeamCd.Value);		

		ds_Cycle.SetColumn(row, "CHK_CYCLE"   , ds_Faci.GetColumn(i, "CHK_CYCLE")); //주기코드
		ds_Cycle.SetColumn(row, "CHK_CNT"     , decode(ds_Faci.GetColumn(i, "CYCLE_NM"), '', '0', ds_Faci.GetColumn(i, "CYCLE_NM")));	 //점검횟수			
	}			
	
	var strSvcID         = "save";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_QuarterPatroPlanRegisMgr-service";					
	var strInDatasets    = "ds_ArFaci=ds_ArFaci:u ds_Cycle=ds_Cycle:u";
	var strOutDatasets   = "";		
	var strArgument      = "save=1";

	gfn_syncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				);
	
	if(ErrorCode<0)
	{
		alert("저장 오류입니다... ");
		return false;
	}
		
	alert("저장을 완료하였습니다. ");
		
	fn_CommonSearch();
}


function cob_PBlockCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_CommonSearch();
}
function cob_PChkQuarter_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	fn_CommonSearch();
}

function sp_PChkYear_OnCharChanged(obj,strPreText,strPostText)
{
	fn_CommonSearch();
}

function sp_PChkYear_OnClickUpDown(obj,strOldText,strText,bUp)
{
	fn_CommonSearch();
}]]></Script>
</Window>