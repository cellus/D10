<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="875" Id="D1702010010F" Left="8" OnLoadCompleted="D1702010010F_OnLoadCompleted" PidAttrib="7" Title="D1702010010F_이설보수청구내역등록" Top="8" Ver="1.0" Width="1270" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocu" OnRowPosChanged="ds_MoveDocu_OnRowPosChanged">
				<Contents>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_nm1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_TYPE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULT_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReportList">
				<Contents>
					<colinfo id="SYSTEM_ID" size="256" type="STRING"/>
					<colinfo id="REPORT_ID" size="256" type="STRING"/>
					<colinfo id="REPORT_ARGS" size="256" type="STRING"/>
					<colinfo id="REPORT_TITLE" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Count1">
				<Contents>
					<colinfo id="NCOUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveAdj">
				<Contents>
					<colinfo id="BASE_WORK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_MASTER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM&#32;" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_OPER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_AMT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel">
				<Contents>
					<colinfo id="column0" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_TYPE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_STR_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_END_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BASE_WORK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_MASTER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_OPER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_PRICE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FileList">
				<Contents>
					<colinfo id="FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORIG_ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_FILE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocuU">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="RESULT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_TEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIPT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CLOSE_COST_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_OPER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BASE_WORK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_MASTER_AMT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocuV">
				<Contents>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="REASON_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_WORK_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="255" summ="default" type="STRING"/>
					<colinfo id="PROC_STS_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_TEAM" size="256" summ="default" type="STRING"/>
					<colinfo id="CONFERENCE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CONSULT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC_1" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ_1" size="256" summ="default" type="STRING"/>
					<colinfo id="FIRST_MOVE_DOCU" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG2" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG2" size="256" summ="default" type="STRING"/>
					<colinfo id="MATER_FLAG2" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD2" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_OPER_PRICE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD_3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ_3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN_3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN_1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveDocuH">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Radio">
				<Contents>
					<colinfo id="name" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<name>취소안함</name>
						<value>0</value>
					</record>
					<record>
						<name>취소</name>
						<value>1</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FileList1">
				<Contents>
					<colinfo id="FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORIG_ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_SIZE" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="USE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_FILE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDelete">
				<Contents>
					<colinfo id="COM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetailDelete"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillHeader">
				<Contents>
					<colinfo id="COM_ID" size="255" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" type="STRING"/>
					<colinfo id="UPD_IP" size="255" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" type="STRING"/>
					<colinfo id="CRT_IP" size="255" type="STRING"/>
					<colinfo id="APPRO_YN" size="255" type="STRING"/>
					<colinfo id="ACNT_YMD" size="255" type="STRING"/>
					<colinfo id="ACNT_BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="TOT_LN_NUM" size="255" type="DECIMAL"/>
					<colinfo id="FINL_LN_NUM" size="255" type="STRING"/>
					<colinfo id="DR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="CR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_WRITE_DEPT_CD" size="255" type="STRING"/>
					<colinfo id="BILL_KIND" size="255" type="STRING"/>
					<colinfo id="SYS_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_CRT_INFO" size="255" type="STRING"/>
					<colinfo id="ACNT_FLAG" size="255" type="STRING"/>
					<colinfo id="DEL_YN" size="255" type="STRING"/>
					<colinfo id="ADJ_CNT" size="255" type="DECIMAL"/>
					<colinfo id="OUTPUT_CNT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_OUTPUT_DTM" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Modify">
				<Contents>
					<colinfo id="BILL_APPRO_YN_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ_1" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC_1" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ_1" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN_3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD_3" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM_3" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ_3" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Com">
				<Contents>
					<colinfo id="LOAN_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNC_PROD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_TAX_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Radio1">
				<Contents>
					<colinfo id="name" size="256" summ="default" type="STRING"/>
					<colinfo id="value" size="256" summ="default" type="STRING"/>
					<record>
						<name>예</name>
						<value>0</value>
					</record>
					<record>
						<name>아니요</name>
						<value>1</value>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ACNT_CD">
				<Contents>
					<colinfo id="ACNT_TITACNT_CD_CR" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR4" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR5" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ACNT_CD1">
				<Contents>
					<colinfo id="ACNT_TITACNT_CD_CR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ACNT_CD2">
				<Contents>
					<colinfo id="ACNT_TITACNT_CD_CR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR4" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR5" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR2" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR3" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR4" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail2">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_MoveAdj_Select">
				<Contents>
					<colinfo id="BASE_WORK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_MASTER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM&#32;" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_OPER_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DESIGN_AMT1" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static35" Left="110" Style="table" TabOrder="99" Top="614" VAlign="Middle" Width="1148" WordWrap="TRUE"></Static>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="PIPE_OPER_PRICE_YEAR" Enable="FALSE" Height="18" Id="edt_PIPE_OPER_PRICE_YEAR" ImeMode="none" Left="781" MaxLength="8" Number="TRUE" Readonly="TRUE" Style="edit" TabOrder="186" Top="616" Width="130"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static34" Left="5" Style="table" TabOrder="174" Top="700" VAlign="Middle" Width="1255" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static49" Left="617" Style="table" TabOrder="126" Text="거래처명" Top="700" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static32" Left="927" Style="table" TabOrder="107" Text="순수공사비(원)" Top="614" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static14" Left="110" Style="table" TabOrder="98" Top="635" VAlign="Middle" Width="1148" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static25" Left="6" Style="table" TabOrder="173" Top="781" VAlign="Middle" Width="1255" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static65" Left="5" Style="table" TabOrder="176" Top="721" VAlign="Middle" Width="1255" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_REVIEW_OPINI" ImageID="btn_5_Amendment" Left="1172" LeftMargin="21" OnClick="btn_REVIEW_OPINI_OnClick" Style="button" TabOrder="10" Text="품의서작성" Top="369" Visible="FALSE" Width="87"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Closed_Tube" ImageID="btn_8_reg" Left="1131" LeftMargin="21" OnClick="btn_Closed_Tube_OnClick" Style="button" TabOrder="142" Text="&#32;잔존가&#32;폐관&#32;내역" Top="369" Width="128"></Button>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static62" Left="118" Style="table" TabOrder="159" Top="847" VAlign="Middle" Width="1140" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static58" Left="94" Style="table" TabOrder="143" Top="456" VAlign="Middle" Width="1165" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static43" Left="632" Style="table" TabOrder="114" Text="조치일자" Top="584" VAlign="Middle" Visible="FALSE" Width="130" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static54" Left="94" Style="table" TabOrder="132" Top="477" VAlign="Middle" Width="1165" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static44" Left="101" Style="table" TabOrder="119" Top="561" VAlign="Middle" Width="1158" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static5" Left="101" Style="table" TabOrder="116" Top="393" VAlign="Middle" Width="1158" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static22" Left="93" Style="table" TabOrder="92" Top="519" VAlign="Middle" Width="1166" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static23" Left="93" Style="table" TabOrder="93" Top="540" VAlign="Middle" Width="1166" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static0" Left="94" Style="table" TabOrder="91" Top="498" VAlign="Middle" Width="1165" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static2" Left="94" Style="table" TabOrder="90" Top="435" VAlign="Middle" Width="1165" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static1" Left="5" Style="table" TabOrder="89" Top="414" VAlign="Middle" Width="1254" WordWrap="TRUE"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Excel" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="263" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="146" Id="grd_excel" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnExpandEdit="grd_MultiSave_OnExpandEdit" Right="2704" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="96" TabStop="FALSE" Top="117" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="2699">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="170"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="120"/>
						<col width="350"/>
						<col width="300"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="150"/>
						<col width="80"/>
						<col width="80"/>
						<col width="150"/>
						<col width="92"/>
						<col width="97"/>
						<col width="100"/>
						<col width="113"/>
					</columns>
					<head>
						<cell col="0" display="text" text="이설보수번호"/>
						<cell col="1" display="text" text="이설보수공사명"/>
						<cell align="center" col="2" display="text" text="지사"/>
						<cell align="center" col="3" display="text" text="시/구"/>
						<cell align="center" col="4" display="text" text="접수일자"/>
						<cell align="center" col="5" display="text" text="의뢰자명"/>
						<cell align="center" col="6" display="text" text="의뢰자&#32;전화번호"/>
						<cell col="7" display="text" text="의뢰자&#32;주소"/>
						<cell col="8" display="text" text="의뢰자&#32;요청내용"/>
						<cell align="center" col="9" display="text" text="유형"/>
						<cell align="center" col="10" display="text" text="담당자명"/>
						<cell col="11" display="text" text="청구일자"/>
						<cell col="12" display="text" text="청구금액(원)"/>
						<cell col="13" display="text" text="입금일자"/>
						<cell col="14" display="text" text="입금액(원)"/>
						<cell col="15" display="text" text="공사명"/>
						<cell col="16" display="text" text="공사시작일"/>
						<cell col="17" display="text" text="공사완료일"/>
						<cell col="18" display="text" text="시공업체명"/>
						<cell col="19" display="text" text="순수공사비(원)"/>
						<cell col="20" display="text" text="설계감독비(원)"/>
						<cell col="21" display="text" text="도관운영비(원)"/>
						<cell col="22" display="text" text="공사비용합계(원)"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MOVE_REPAIR_NUM" display="text"/>
						<cell align="left" col="1" colid="MOVE_REPAIR_WORK_NM" display="text"/>
						<cell align="center" col="2" colid="BRANCH_NM" display="text"/>
						<cell align="center" col="3" colid="ZIP_NO1_NM" display="text"/>
						<cell align="center" col="4" colid="RECEIVE_YMD" display="date"/>
						<cell align="center" col="5" colid="REASON_NM" display="text"/>
						<cell align="center" col="6" colid="TEL" display="text"/>
						<cell col="7" colid="ADDRESS" display="text"/>
						<cell col="8" colid="MOVE_REPAIR_DESC" display="text"/>
						<cell align="center" col="9" colid="MOVE_REPAIR_TYPE_NM" display="text"/>
						<cell align="center" col="10" colid="TAKER_NAME" display="text"/>
						<cell align="center" col="11" colid="REQ_YMD" display="date"/>
						<cell align="right" col="12" colid="REQ_AMT" display="number"/>
						<cell align="center" col="13" colid="RECEIPT_YMD" display="date"/>
						<cell align="right" col="14" colid="RECEIPT_AMT" display="number"/>
						<cell col="15" colid="WORK_NM" display="text"/>
						<cell align="center" col="16" colid="WORK_STR_YMD" display="date"/>
						<cell align="center" col="17" colid="WORK_END_YMD" display="date"/>
						<cell align="center" col="18" colid="WORK_FIRM_NM" display="text"/>
						<cell align="right" col="19" colid="BASE_WORK_AMT" display="number"/>
						<cell align="right" col="20" colid="DESIGN_MASTER_AMT" display="number"/>
						<cell align="right" col="21" colid="PIPE_OPER_AMT" display="number"/>
						<cell align="right" col="22" colid="WORK_PRICE" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape1" Left="5" LineColor="user7" Right="1258" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="49" Top="30" Type="RoundRect" Width="1253"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape2" Left="10" LineWidth="0" Right="1253" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="50" Top="35" Type="Rectangle" Width="1243"></Shape>
		<Static Height="13" Id="Static126" Left="1169" Style="static" TabOrder="43" Text="총&#32;건수&#32;:&#32;&#32;&#32;&#32;&#32;&#32;&#32;건" Top="75" Width="90"></Static>
		<Static Align="Right" Height="13" Id="st_Cnt" Left="1218" Style="static" TabOrder="44" Text="0000" Top="75" Width="25"></Static>
		<Image Align="Left" Height="9" Id="Image9" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="45" Text="이설보수내역" Top="75" Width="127"></Image>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="48" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1257">
			<Contents></Contents>
		</Div>
		<Image Align="Left" Color="blue" Height="18" Id="Image5" ImageID="blt" Left="21" LeftMargin="12" Style="blt_search_1" TabOrder="46" Text="지사" Top="40" Width="59"></Image>
		<Combo Border="Flat" Height="18" Id="cob_ObjectFlag" Left="61" OnChanged="cob_BranchCd_OnChanged" Style="combo_indis" TabOrder="2" Top="40" Width="114"></Combo>
		<Image Align="Left" Color="blue" Height="18" Id="Image3" ImageID="blt" Left="187" LeftMargin="12" Style="blt_search_1" TabOrder="47" Text="시/구" Top="40" Width="59"></Image>
		<Combo Border="Flat" Height="18" Id="cob_CountyFlag" ImeMode="none" Left="232" Style="combo_indis" TabOrder="3" Top="40" Width="114"></Combo>
		<Image Align="Left" Color="user1" Height="18" Id="Image8" ImageID="blt" Left="355" LeftMargin="12" Style="blt_search_1" TabOrder="52" Text="이설보수유형" Top="40" Width="90"></Image>
		<Combo Border="Flat" Height="18" Id="cob_ConstructFlag" ImeMode="none" Left="443" Style="combo" TabOrder="4" Top="40" Width="80"></Combo>
		<Image Align="Left" Color="user1" Height="18" Id="Image1" ImageID="blt" Left="683" LeftMargin="12" Style="blt_search_1" TabOrder="53" Text="접수일자" Top="41" Width="59"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReceiveStart" Left="748" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="6" Top="41" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Height="13" Id="Static10" Left="837" Style="static" TabOrder="51" Text="~" Top="44" Width="10"></Static>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReceiveEnd" Left="847" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="7" Top="41" WeeksFont="Default,-1" Width="88"></Calendar>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="EVIDENCE_YN" Enable="FALSE" Height="18" Id="cob_TaxFlag" Left="136" Style="combo" TabOrder="54" Top="478" Width="113"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static36" Left="5" Style="table" TabOrder="55" Text="부가세구분" Top="477" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_WORK_NM" Enable="FALSE" Height="18" Id="edt_MoveRepairWorkNm" ImeMode="none" Left="755" MaxLength="50" Style="edit" TabOrder="56" Top="479" Width="501"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static24" Left="623" Style="table" TabOrder="57" Text="이설공사명" Top="477" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_NUM" Enable="FALSE" Height="18" Id="edt_MOVE_REPAIR_NUM" ImeMode="none" Left="137" MaxLength="10" Style="edit" TabOrder="58" Top="395" Width="175"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static13" Left="315" Style="table" TabOrder="59" Text="접수일자" Top="393" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="CONFERENCE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="Calendar0" Left="447" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="60" Top="416" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static12" Left="623" Style="table" TabOrder="61" Text="의뢰자" Top="393" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="TAKER_NAME" Enable="FALSE" Height="18" Id="Edit2" ImeMode="none" Left="755" MaxLength="9" Style="edit" TabOrder="62" Top="416" Width="86"></Edit>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="TAKER_TEAM" Enable="FALSE" Height="18" Id="Edit1" ImeMode="none" Left="842" MaxLength="9" Style="edit" TabOrder="63" Top="416" Width="68"></Edit>
		<Button Cursor="HAND" Enable="FALSE" Height="17" Id="Button0" ImageID="search" Left="911" OnClick="Button4_OnClick" TabOrder="64" Text="Button8" Top="416" Width="17"></Button>
		<Static Height="13" Id="Static11" Left="189" Style="static" TabOrder="65" Text="-" Top="419" Width="10"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_DDD" Enable="FALSE" Height="18" Id="cob_ReasonTelDDD" Left="136" Style="combo" TabOrder="66" Top="415" Width="53"></Combo>
		<Static Height="13" Id="Static9" Left="235" Style="static" TabOrder="67" Text="-" Top="419" Width="10"></Static>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_NUM" Enable="FALSE" Height="18" Id="edt_ReasonTel_NUM" ImeMode="none" Left="243" MaxLength="4" Number="TRUE" Style="edit" TabOrder="68" Top="416" Width="36"></Edit>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_TEL_EXN" Enable="FALSE" Height="18" Id="edt_ReasonTel_EXN" ImeMode="none" Left="197" MaxLength="4" Number="TRUE" Style="edit" TabOrder="69" Top="416" Width="38"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static7" Left="5" Style="table" TabOrder="70" Text="요청사항" Top="519" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static6" Left="5" Style="table" TabOrder="71" Text="이설위치" Top="498" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static4" Left="5" Style="table" TabOrder="72" Text="의뢰자&#32;연락처" Top="414" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="5" Style="table" TabOrder="73" Text="이설번호" Top="393" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="REASON_NM" Enable="FALSE" Height="18" Id="edt_Reason" ImeMode="none" Left="755" MaxLength="10" Style="edit" TabOrder="74" Top="395" Width="173"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static16" Left="315" Style="table" TabOrder="75" Text="협의일자" Top="414" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static128" Left="931" Style="table" TabOrder="76" Text="지사" Top="393" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="RECEIVE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_ReceiveYmd" Left="447" OnChanged="cal_ReceiveYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="77" Top="395" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static21" Left="623" Style="table" TabOrder="78" Text="협의자" Top="414" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static130" Left="931" Style="table" TabOrder="79" Text="이설보수유형" Top="414" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="TAKER_EMPID" Enable="FALSE" Height="18" Id="edt_TakerEmpid" ImeMode="none" Left="465" MaxLength="9" Style="edit_Indis" TabOrder="80" Top="437" Width="0"></Edit>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="BRANCH_CD" Enable="FALSE" Height="18" Id="cob_ObjectFlag1" Left="1062" Style="combo_indis" TabOrder="81" Top="394" Width="114"></Combo>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="edt_ZipNo1" ImeMode="none" Left="137" Style="edit_Indis" TabOrder="82" Top="500" Width="38"></Edit>
		<Edit Align="CENTER" BindDataset="ds_MoveDocuV" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="edt_ZipNo2" ImeMode="none" Left="184" Style="edit_Indis" TabOrder="83" Top="500" Width="38"></Edit>
		<Button Cursor="HAND" Enable="FALSE" Height="17" Id="btn_DZip" ImageID="search" Left="223" OnClick="fn_ZipSearch" TabOrder="84" Text="Button8" Top="501" Width="17"></Button>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="ADDR_UNION" Enable="FALSE" Height="18" Id="edt_DetailAddr" ImeMode="none" Left="241" MaxLength="150" Style="edit" TabOrder="85" Top="500" Width="1015"></Edit>
		<Static Height="13" Id="C2502030010F" Left="176" Style="static" TabOrder="86" Text="-" Top="503" Width="10"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_TYPE" Enable="FALSE" Height="18" Id="cob_MoveRepairType" Left="1062" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="87" Top="415" Width="114"></Combo>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="MOVE_REPAIR_DESC" Enable="FALSE" Height="18" Id="edt_DiscuDesc" ImeMode="none" Left="137" MaxLength="60" Style="edit" TabOrder="88" Top="521" Width="1119"></Edit>
		<Grid AutoEnter="TRUE" BindDataset="ds_MoveDocu" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="365" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="272" Id="grd_list" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" OnHeadClick="grd_list_OnHeadClick" Right="1259" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="8" TabStop="true" Top="93" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1254">
			<contents>
				<format id="Default">
					<columns>
						<col width="50"/>
						<col width="50"/>
						<col width="80"/>
						<col width="80"/>
						<col width="90"/>
						<col width="90"/>
						<col width="80"/>
						<col width="70"/>
						<col width="80"/>
						<col width="80"/>
						<col width="60"/>
						<col width="346"/>
						<col width="280"/>
					</columns>
					<head>
						<cell col="0" display="text" text="구분"/>
						<cell align="center" col="1" display="text" text="진행상태"/>
						<cell col="2" display="text" text="이설보수번호"/>
						<cell col="3" display="text" text="품의번호"/>
						<cell col="4" display="text" text="검토의견서번호"/>
						<cell col="5" display="text" text="정비보수번호"/>
						<cell col="6" display="text" text="접수일자"/>
						<cell col="7" display="text" text="지사"/>
						<cell col="8" display="text" text="시/구"/>
						<cell col="9" display="text" text="의뢰자"/>
						<cell col="10" display="text" text="담당자"/>
						<cell col="11" display="text" text="이설위치"/>
						<cell col="12" display="text" text="요청사항"/>
					</head>
					<body>
						<cell align="center" col="0" colid="MOVE_REPAIR_TYPE_NM" display="text"/>
						<cell align="center" col="1" colid="PROC_STS_NM" display="text"/>
						<cell align="center" col="2" colid="MOVE_REPAIR_NUM" display="text" edit="normal"/>
						<cell align="center" col="3" colid="CONSULT_NUM" display="text"/>
						<cell align="center" col="4" colid="REVIEW_OPINI_NUM" display="text"/>
						<cell align="center" col="5" colid="MAINTER_NUM" display="text"/>
						<cell align="center" col="6" colid="RECEIVE_YMD" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="7" colid="BRANCH_NM" display="text"/>
						<cell col="8" colid="ZIP_NO1_NM" display="text"/>
						<cell col="9" colid="REASON_NM" display="text"/>
						<cell align="center" col="10" colid="TAKER_NAME" display="text"/>
						<cell col="11" colid="ADDRESS" display="text"/>
						<cell col="12" colid="MOVE_REPAIR_DESC" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Review" ImageID="btn_7_reg" Left="1060" LeftMargin="21" OnClick="btn_Review_OnClick" Style="button" TabOrder="9" Text="검토의견서작성" Top="369" Visible="FALSE" Width="112"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_RECEIPT" ImageID="btn_4_Confirmation" Left="1058" LeftMargin="21" OnClick="btn_RECEIPT_OnClick" Style="button" TabOrder="40" Text="입금확인" Top="760" Width="76"></Button>
		<Image Align="Left" Height="9" Id="Image0" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="94" Text="접수내역&#32;" Top="377" Width="127"></Image>
		<Shape BKColor="#6cbae1" Bottom="94" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1259" TabOrder="95" Top="91" Type="Rectangle" Width="1254"></Shape>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static41" Left="118" Style="table" TabOrder="97" Top="826" VAlign="Middle" Width="1140" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveAdj" Border="Flat" Column="WORK_FIRM_NM" Height="18" Id="edt_WORK_FIRM_NM" ImeMode="none" Left="449" MaxLength="11" Style="edit" TabOrder="17" Text="0" Top="587" Visible="FALSE" Width="174"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static42" Left="316" Style="table" TabOrder="100" Text="시공업체명" Top="584" VAlign="Middle" Visible="FALSE" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuV" Border="Flat" Column="x" Enable="FALSE" Height="18" Id="edt_MAINTER_NUM" ImeMode="none" Left="137" MaxLength="11" Style="edit" TabOrder="13" Top="616" Visible="FALSE" Width="173"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="stMAINTER_NUM" Left="5" Style="table" TabOrder="101" Text="정비보수번호" Top="614" VAlign="Middle" Visible="FALSE" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static39" Left="313" Style="table" TabOrder="102" Text="예수금대체_세금계산서" Top="826" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static38" Left="5" Style="table" TabOrder="103" Text="예수금대체전표" Top="826" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static37" Left="5" Style="table" TabOrder="104" Text="미수금전표" Top="721" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Button Cursor="HAND" Height="18" Id="btn_PIPE_OPER_AMT" ImageID="search" Left="601" OnClick="btn_PIPE_OPER_AMT_OnClick" TabOrder="15" Text="Button8" Top="616" Width="18"></Button>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static30" Left="313" Style="table" TabOrder="105" Text="도관운영비(원)" Top="614" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="st_CONSULT_NUM" Left="5" Style="table" TabOrder="106" Text="품의번호" Top="614" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuU" Border="Flat" Column="RECEIPT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_RECEIPT_YMD" Left="445" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="27" Top="783" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static31" Left="5" Style="table" TabOrder="108" Text="입금금액(원)" Top="781" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static19" Left="313" Style="table" TabOrder="109" Text="입금일자" Top="781" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static15" Left="313" Style="table" TabOrder="111" Text="청구일자" Top="700" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="11" Id="Image2" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="112" Text="청구.입금내역" Top="599" Width="127"></Image>
		<Static Align="Right" Border="Flat" Height="22" Id="Static33" Left="5" Style="table" TabOrder="113" Text="공사감독비(원)" Top="635" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveAdj" Border="Flat" Column="ACT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="Calendar4" Left="763" OnChanged="Calendar4_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="19" Top="587" Value="20090817" Visible="FALSE" WeeksFont="Default,-1" Width="87"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static29" Left="5" Style="table" TabOrder="115" Text="첨부문서" Top="847" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_File_20" ImeMode="none" Left="137" Readonly="TRUE" Style="edit" TabOrder="37" Top="849" Width="1042"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="btn_file_20" ImageID="btn_4_fileadd" Left="1180" LeftMargin="21" OnClick="btn_Upload_OnClick" Style="button" TabOrder="38" Text="파일첨부&#32;" Top="849" Width="76"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static8" Left="5" Style="table" TabOrder="117" Text="취소여부" Top="561" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static20" Left="315" Style="table" TabOrder="118" Text="취소사유" Top="561" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuU" Border="Flat" Column="CANCEL_DESC" Height="18" Id="edt_CANCEL_DESC" ImeMode="none" Left="447" MaxLength="50" Style="edit" TabOrder="12" Top="563" Width="809"></Edit>
		<Radio BindDataset="ds_MoveDocuU" Border="None" CodeColumn="value" Color="user17" Column="CANCEL_YN" ColumnCount="2" DataColumn="name" Height="13" Id="Radio" INDEX="0" InnerDataset="ds_Radio" Left="138" OnClick="Radio_OnClick" Style="radio" TabOrder="11" Top="567" Width="116">
			<Contents>
				<Layout Height="20" left="0" text="명" width="80"/>
				<Layout Height="20" left="80" text="코드" width="80"/>
			</Contents>
		</Radio>
		<Static Align="Right" Border="Flat" Height="22" Id="Static27" Left="5" Style="table" TabOrder="121" Text="첨부문서" Top="540" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_File_10" ImeMode="none" Left="137" Readonly="TRUE" Style="edit" TabOrder="122" Top="542" Width="1041"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="btn_file_10" ImageID="btn_4_fileadd" Left="1180" LeftMargin="21" OnClick="btn_Upload_OnClick" Style="button" TabOrder="120" Text="파일첨부&#32;" Top="542" Width="78"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static45" Left="927" Style="table" TabOrder="123" Text="부가세(원)" Top="633" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static40" Left="621" Style="table" TabOrder="124" Text="입금처리자" Top="781" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuU" Border="Flat" Column="RECEIPT_NAME" Enable="FALSE" Height="18" Id="edt_ReceiptName" ImeMode="none" Left="753" MaxLength="9" Readonly="TRUE" Style="edit" TabOrder="28" Top="783" Width="70"></Edit>
		<Button Cursor="HAND" Height="17" Id="btn_ReceiptName" ImageID="search" Left="911" OnClick="btn_ReceiptName_OnClick" TabOrder="30" Text="Button8" Top="784" Width="17"></Button>
		<Edit BindDataset="ds_MoveDocuU" Border="Flat" Column="RECEIPT_TEAM" Enable="FALSE" Height="18" Id="edt_ReceiptTeam" ImeMode="none" Left="824" MaxLength="9" Readonly="TRUE" Style="edit" TabOrder="29" Top="783" Width="86"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static48" Left="5" Style="table_indis" TabOrder="125" Text="청구금액(원)" Top="700" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static51" Left="623" Style="table" TabOrder="127" Text="압력1" Top="435" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="PRESS_FLAG" Enable="FALSE" Height="18" Id="Combo1" Left="754" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="130" Top="436" Width="90"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static52" Left="5" Style="table" TabOrder="128" Text="재질1" Top="435" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="MATER_FLAG" Enable="FALSE" Height="18" Id="Combo2" Left="136" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="131" Top="436" Width="91"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static53" Left="931" Style="table" TabOrder="129" Text="연장1(m)" Top="435" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_MoveDocuU" Border="Flat" Column="DEAL_CD" Enable="FALSE" Height="18" Id="edt_DEAL_CD" ImeMode="none" Left="620" MaxLength="8" Readonly="TRUE" Style="edit" TabOrder="133" Top="702" Width="65"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="DEAL_NM" Enable="FALSE" Height="18" Id="edt_DEAL_NM" ImeMode="none" Left="749" MaxLength="8" Readonly="TRUE" Style="edit" TabOrder="25" Top="702" Width="155"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="19" Id="btn_Bill" ImageID="btn_4_billreg" Left="252" LeftMargin="21" OnClick="btn_bill_OnClick" Style="button" TabOrder="41" Text="전표등록" Top="680" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="19" Id="btn_BillDel" ImageID="btn_4_Close&#32;cancellation" Left="329" LeftMargin="21" OnClick="btn_billDel_OnClick" Style="button" TabOrder="42" Text="전표취소" Top="680" Width="76"></Button>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_BillYmd" Left="162" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="39" Top="680" WeeksFont="Default,-1" Width="88"></Calendar>
		<Image Align="Left" Height="16" Id="Image4" ImageID="blt" Left="75" LeftMargin="12" Style="blt_search" TabOrder="134" Text="전표발행일자" Top="682" Width="84"></Image>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_SEQ_1" Enable="FALSE" Height="18" Id="edt_BILL_SEQ_1" ImeMode="none" Left="226" MaxLength="4" Number="TRUE" Style="edit" TabOrder="34" Top="828" Width="67"></Edit>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="TXBILL_PUBL_SEQ_1" Enable="FALSE" Height="18" Id="edt_TXBILL_PUBL_SEQ_1" ImeMode="none" Left="534" MaxLength="4" Number="TRUE" Style="edit" TabOrder="36" Top="828" Width="65"></Edit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveAdj" Border="Flat" Column="PIPE_OPER_AMT" Enable="FALSE" Height="18" Id="edt_PIPE_OPER_AMT" Left="445" Mask="#,###" OnCharChanged="edt_CostAmt_OnCharChanged" Readonly="TRUE" Style="edit" TabOrder="14" Top="616" Width="155"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="RECEIPT_AMT" Height="18" Id="edt_RECEIPT_AMT" Left="137" Mask="#,###" MaxLength="15" Style="edit" TabOrder="26" Top="783" Value="MaskEdit0" Width="174"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="VAT" Enable="FALSE" Height="19" Id="edt_VAT" Left="1059" Mask="#,###" Style="edit" TabOrder="22" Top="636" Width="197"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="RESULT_AMT" Enable="FALSE" Height="18" Id="edt_RESULT_AMT" Left="137" Mask="#,###" Style="edit" TabOrder="23" Top="702" Width="174"></MaskEdit>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_NUM" Enable="FALSE" Height="18" Id="edt_BILL_NUM" ImeMode="none" Left="1150" MaxLength="4" Number="TRUE" Style="edit" TabOrder="32" Top="783" Width="89"></Edit>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_BILL_YMD" Left="1061" OnChanged="cal_BILL_YMD_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="31" Top="783" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="TXBILL_PUBL_YM_1" Dateformat="yyyy-MM" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_TXBILL_PUBL_YM_1" Left="445" OnChanged="cal_TXBILL_PUBL_YM_1_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="35" Top="828" WeeksFont="Default,-1" Width="88"></Calendar>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" BorderColor="user2" Column="LENG" DisableColor="user1" Enable="FALSE" Height="18" Id="Edit19" Left="1063" Mask="###,###" MaxLength="6" TabOrder="135" Top="437" Value="MaskEdit0" Width="112"></MaskEdit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static50" Left="315" Style="table" TabOrder="136" Text="관경1" Top="435" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="PIPE_DIAM_CD" Enable="FALSE" Height="18" Id="Combo0" Left="446" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="137" Top="436" Width="114"></Combo>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveAdj" Border="Flat" Column="DESIGN_MASTER_AMT" Height="18" Id="edt_DESIGN_MASTER_AMT" Left="136" Mask="#,###" MaxLength="10" OnCharChanged="edt_CostAmt_OnCharChanged" Style="edit" TabOrder="18" Top="637" Width="174"></MaskEdit>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_YMD_1" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_BILL_YMD_1" Left="137" OnChanged="Calendar3_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="33" Top="828" WeeksFont="Default,-1" Width="88"></Calendar>
		<Image Align="Left" Color="user1" Height="18" Id="Image6" ImageID="blt" Left="532" LeftMargin="12" Style="blt_search_1" TabOrder="138" Text="진행상태" Top="41" Width="58"></Image>
		<Combo Border="Flat" Height="18" Id="cob_MoveStsCD" ImeMode="none" Left="595" Style="combo" TabOrder="5" Top="40" Width="80"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static55" Left="315" Style="table" TabOrder="140" Text="선공사여부" Top="477" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Radio BindDataset="ds_MoveDocuV" Border="None" CodeColumn="value" Color="user17" Column="FIRST_MOVE_DOCU" ColumnCount="2" DataColumn="name" Enable="FALSE" Height="13" Id="rdo_FIRST_MOVE_DOCU" INDEX="0" InnerDataset="ds_Radio1" Left="450" OnChanged="rdo_FIRST_MOVE_DOCU_OnChanged" Style="radio" TabOrder="139" Top="483" Value="1" Width="92">
			<Contents>
				<Layout Height="20" left="0" text="명" width="80"/>
				<Layout Height="20" left="80" text="코드" width="80"/>
			</Contents>
		</Radio>
		<Calendar BindDataset="ds_MoveDocuU" Border="Flat" Column="REQ_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReceiptYmd" Left="445" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="24" Top="702" WeeksFont="Default,-1" Width="87"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static56" Left="313" Style="table" TabOrder="141" Text="폐관비용금액(원)" Top="635" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="CLOSE_COST_AMT" Height="18" Id="edt_CostAmt" Left="445" Mask="#,###" MaxLength="10" OnCharChanged="edt_CostAmt_OnCharChanged" Style="edit" TabOrder="20" Top="637" Width="174"></MaskEdit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static57" Left="5" Style="table" TabOrder="145" Text="재질2" Top="456" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="MATER_FLAG2" Enable="FALSE" Height="18" Id="Combo3" Left="136" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="148" Top="457" Width="91"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static59" Left="315" Style="table" TabOrder="150" Text="관경2" Top="456" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="PIPE_DIAM_CD2" Enable="FALSE" Height="18" Id="Combo4" Left="446" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="151" Top="457" Width="114"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static60" Left="623" Style="table" TabOrder="144" Text="압력2" Top="456" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_MoveDocuV" Border="Flat" Column="PRESS_FLAG2" Enable="FALSE" Height="18" Id="Combo5" Left="754" OnChanged="cob_MoveRepairType_OnChanged" Style="combo_indis" TabOrder="147" Top="457" Width="90"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static61" Left="931" Style="table" TabOrder="146" Text="연장2(m)" Top="456" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" BorderColor="user2" Column="LENG2" DisableColor="user1" Enable="FALSE" Height="18" Id="MaskEdit0" Left="1063" Mask="###,###" MaxLength="6" TabOrder="149" Top="458" Value="MaskEdit0" Width="112"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="PIPE_OPER_PRICE_YEAR" Height="18" Id="MaskEdit1" Left="437" Mask="#,###,###,###,###" Readonly="TRUE" Style="edit" TabOrder="152" Top="704" Value="MaskEdit0" Visible="FALSE" Width="0"></MaskEdit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static46" Left="929" Style="table" TabOrder="153" Text="예수금전표" Top="781" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static63" Left="313" Style="table" TabOrder="154" Text="미수금_세금계산서" Top="721" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_YMD_3" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_BILL_YMD_3" Left="137" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="155" Top="723" WeeksFont="Default,-1" Width="88"></Calendar>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="BILL_SEQ_3" Enable="FALSE" Height="18" Id="edt_BILL_SEQ_3" ImeMode="none" Left="227" MaxLength="4" Number="TRUE" Style="edit" TabOrder="156" Top="723" Width="65"></Edit>
		<Calendar BindDataset="ds_MoveDocuV" Border="Flat" Column="TXBILL_PUBL_YM_3" Dateformat="yyyy-MM" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_TXBILL_PUBL_YM_3" Left="445" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="157" Top="723" WeeksFont="Default,-1" Width="88"></Calendar>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="TXBILL_PUBL_SEQ_3" Enable="FALSE" Height="18" Id="edt_TXBILL_PUBL_SEQ_3" ImeMode="none" Left="534" MaxLength="4" Number="TRUE" Style="edit" TabOrder="158" Top="723" Width="62"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static64" Left="619" Style="table" TabOrder="160" Top="826" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="19" Id="btn_BillReg" ImageID="btn_4_billreg" Left="252" LeftMargin="21" OnClick="btn_bill_OnClick" Style="button" TabOrder="161" Text="전표등록" Top="806" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Enable="FALSE" Height="19" Id="btn_BillRegDel" ImageID="btn_4_Close&#32;cancellation" Left="329" LeftMargin="21" OnClick="btn_billDel_OnClick" Style="button" TabOrder="162" Text="전표취소" Top="806" Width="76"></Button>
		<Button Cursor="HAND" Height="19" Id="Button9" ImageID="printer" Left="293" OnClick="fn_E5_print2" TabOrder="163" Text="Button8" Top="723" Width="18"></Button>
		<Button Cursor="HAND" Height="19" Id="Button10" ImageID="printer" Left="597" OnClick="fn_E5_print1" TabOrder="164" Text="Button8" Top="723" Width="18"></Button>
		<Button Cursor="HAND" Height="19" Id="Button11" ImageID="printer" Left="1240" OnClick="Button11_OnClick" TabOrder="165" Text="Button8" Top="783" Width="18"></Button>
		<Button Cursor="HAND" Height="19" Id="Button12" ImageID="printer" Left="294" OnClick="Button12_OnClick" TabOrder="166" Text="Button8" Top="828" Width="18"></Button>
		<Button Cursor="HAND" Height="19" Id="btn_TXBILL_PUBL" ImageID="printer" Left="600" OnClick="fn_E5_print" TabOrder="167" Text="Button8" Top="828" Width="18"></Button>
		<Grid BindDataset="ds_MoveAdj" BkColor2="default" BoldHead="true" Bottom="288" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="48" Id="Grid0" InputPanel="FALSE" Left="1280" LineColor="default" Right="2152" TabOrder="168" TabStop="true" Top="240" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="872">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" display="text" text="BASE_WORK_AMT"/>
						<cell col="2" display="text" text="DESIGN_AMT"/>
						<cell col="3" display="text" text="DESIGN_MASTER_AMT"/>
						<cell col="4" display="text" text="MOVE_REPAIR_NUM&#32;"/>
						<cell col="5" display="text" text="WORK_NUM"/>
						<cell col="6" display="text" text="PIPE_OPER_AMT"/>
						<cell col="7" display="text" text="ACT_YMD"/>
						<cell col="8" display="text" text="WORK_FIRM_NM"/>
						<cell col="9" display="text" text="DESIGN_AMT1"/>
					</head>
					<body>
						<cell col="0" display="text" expr="rowtype"/>
						<cell col="1" colid="BASE_WORK_AMT" display="text"/>
						<cell col="2" colid="DESIGN_AMT" display="text"/>
						<cell col="3" colid="DESIGN_MASTER_AMT" display="text"/>
						<cell col="4" colid="MOVE_REPAIR_NUM&#32;" display="text"/>
						<cell col="5" colid="WORK_NUM" display="text"/>
						<cell col="6" colid="PIPE_OPER_AMT" display="text"/>
						<cell col="7" colid="ACT_YMD" display="text"/>
						<cell col="8" colid="WORK_FIRM_NM" display="text"/>
						<cell col="9" colid="DESIGN_AMT1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_MoveDocuU" BkColor2="default" BoldHead="true" Bottom="344" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="56" Id="Grid1" InputPanel="FALSE" Left="1280" LineColor="default" Right="2504" TabOrder="169" TabStop="true" Top="288" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1224">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" display="text" text="UPD_EMPID"/>
						<cell col="2" display="text" text="UPD_IP"/>
						<cell col="3" display="text" text="REQ_YMD"/>
						<cell col="4" display="text" text="REQ_AMT"/>
						<cell col="5" display="text" text="RECEIPT_YMD"/>
						<cell col="6" display="text" text="RECEIPT_AMT"/>
						<cell col="7" display="text" text="PROC_STS_CD"/>
						<cell col="8" display="text" text="RECEIPT_YN"/>
						<cell col="9" display="text" text="MOVE_REPAIR_NUM"/>
						<cell col="10" display="text" text="CONSULT_NUM"/>
						<cell col="11" display="text" text="CANCEL_DESC"/>
						<cell col="12" display="text" text="CANCEL_YN"/>
						<cell col="13" display="text" text="VAT"/>
						<cell col="14" display="text" text="RESULT_AMT"/>
						<cell col="15" display="text" text="RECEIPT_NAME"/>
						<cell col="16" display="text" text="RECEIPT_TEAM"/>
						<cell col="17" display="text" text="RECEIPT_EMPID"/>
						<cell col="18" display="text" text="DEAL_CD"/>
						<cell col="19" display="text" text="DEAL_NM"/>
						<cell col="20" display="text" text="DEAL_FLAG"/>
						<cell col="21" display="text" text="CLOSE_COST_AMT"/>
					</head>
					<body>
						<cell col="0" display="text" expr="rowtype"/>
						<cell col="1" colid="UPD_EMPID" display="text"/>
						<cell col="2" colid="UPD_IP" display="text"/>
						<cell col="3" colid="REQ_YMD" display="text"/>
						<cell col="4" colid="REQ_AMT" display="text"/>
						<cell col="5" colid="RECEIPT_YMD" display="text"/>
						<cell col="6" colid="RECEIPT_AMT" display="text"/>
						<cell col="7" colid="PROC_STS_CD" display="text"/>
						<cell col="8" colid="RECEIPT_YN" display="text"/>
						<cell col="9" colid="MOVE_REPAIR_NUM" display="text"/>
						<cell col="10" colid="CONSULT_NUM" display="text"/>
						<cell col="11" colid="CANCEL_DESC" display="text"/>
						<cell col="12" colid="CANCEL_YN" display="text"/>
						<cell col="13" colid="VAT" display="text"/>
						<cell col="14" colid="RESULT_AMT" display="text"/>
						<cell col="15" colid="RECEIPT_NAME" display="text"/>
						<cell col="16" colid="RECEIPT_TEAM" display="text"/>
						<cell col="17" colid="RECEIPT_EMPID" display="text"/>
						<cell col="18" colid="DEAL_CD" display="text"/>
						<cell col="19" colid="DEAL_NM" display="text"/>
						<cell col="20" colid="DEAL_FLAG" display="text"/>
						<cell col="21" colid="CLOSE_COST_AMT" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid BindDataset="ds_MoveDocuV" BkColor2="default" BoldHead="true" Bottom="388" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="60" Id="Grid2" InputPanel="FALSE" Left="1280" LineColor="default" Right="2464" TabOrder="170" TabStop="true" Top="328" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1184">
			<contents>
				<format id="Default">
					<columns>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" display="text" text="MOVE_REPAIR_NUM"/>
						<cell col="2" display="text" text="BRANCH_CD"/>
						<cell col="3" display="text" text="ZIP_NO1"/>
						<cell col="4" display="text" text="ZIP_NO2"/>
						<cell col="5" display="text" text="RECEIVE_YMD"/>
						<cell col="6" display="text" text="REASON_NM"/>
						<cell col="7" display="text" text="REASON_TEL_DDD"/>
						<cell col="8" display="text" text="REASON_TEL_EXN"/>
						<cell col="9" display="text" text="REASON_TEL_NUM"/>
						<cell col="10" display="text" text="MOVE_REPAIR_DESC"/>
						<cell col="11" display="text" text="MOVE_REPAIR_TYPE"/>
						<cell col="12" display="text" text="SECOND_ADDR"/>
						<cell col="13" display="text" text="ADDR_UNION"/>
						<cell col="14" display="text" text="TAKER_EMPID"/>
						<cell col="15" display="text" text="MOVE_REPAIR_WORK_NM"/>
						<cell col="16" display="text" text="TAKER_NAME"/>
						<cell col="17" display="text" text="PROC_STS_CD"/>
						<cell col="18" display="text" text="TAKER_TEAM"/>
						<cell col="19" display="text" text="CONFERENCE_YMD"/>
						<cell col="20" display="text" text="CONSULT_NUM"/>
						<cell col="21" display="text" text="TXBILL_VAT_BIZPLC_1"/>
						<cell col="22" display="text" text="TXBILL_PUBL_YM_1"/>
						<cell col="23" display="text" text="BILL_YMD"/>
						<cell col="24" display="text" text="BILL_NUM"/>
						<cell col="25" display="text" text="MAINTER_NUM"/>
						<cell col="26" display="text" text="REVIEW_OPINI_NUM"/>
						<cell col="27" display="text" text="NEW_ADDR_UNION"/>
						<cell col="28" display="text" text="EVIDENCE_YN"/>
						<cell col="29" display="text" text="PRESS_FLAG"/>
						<cell col="30" display="text" text="LENG"/>
						<cell col="31" display="text" text="MATER_FLAG"/>
						<cell col="32" display="text" text="PIPE_DIAM_CD"/>
						<cell col="33" display="text" text="BILL_YMD_1"/>
						<cell col="34" display="text" text="BILL_SEQ_1"/>
						<cell col="35" display="text" text="BRANCH_NM"/>
						<cell col="36" display="text" text="TXBILL_PUBL_SEQ_1"/>
						<cell col="37" display="text" text="FIRST_MOVE_DOCU"/>
						<cell col="38" display="text" text="PRESS_FLAG2"/>
						<cell col="39" display="text" text="LENG2"/>
						<cell col="40" display="text" text="MATER_FLAG2"/>
						<cell col="41" display="text" text="PIPE_DIAM_CD2"/>
						<cell col="42" display="text" text="PIPE_OPER_PRICE_YEAR"/>
						<cell col="43" display="text" text="BILL_YMD_3"/>
						<cell col="44" display="text" text="BILL_SEQ_3"/>
						<cell col="45" display="text" text="TXBILL_VAT_BIZPLC_3"/>
						<cell col="46" display="text" text="TXBILL_PUBL_YM_3"/>
						<cell col="47" display="text" text="TXBILL_PUBL_SEQ_3"/>
						<cell col="48" display="text" text="BILL_APPRO_YN_3"/>
						<cell col="49" display="text" text="BILL_APPRO_YN_1"/>
					</head>
					<body>
						<cell col="0" display="text" expr="rowtype"/>
						<cell col="1" colid="MOVE_REPAIR_NUM" display="text"/>
						<cell col="2" colid="BRANCH_CD" display="text"/>
						<cell col="3" colid="ZIP_NO1" display="text"/>
						<cell col="4" colid="ZIP_NO2" display="text"/>
						<cell col="5" colid="RECEIVE_YMD" display="text"/>
						<cell col="6" colid="REASON_NM" display="text"/>
						<cell col="7" colid="REASON_TEL_DDD" display="text"/>
						<cell col="8" colid="REASON_TEL_EXN" display="text"/>
						<cell col="9" colid="REASON_TEL_NUM" display="text"/>
						<cell col="10" colid="MOVE_REPAIR_DESC" display="text"/>
						<cell col="11" colid="MOVE_REPAIR_TYPE" display="text"/>
						<cell col="12" colid="SECOND_ADDR" display="text"/>
						<cell col="13" colid="ADDR_UNION" display="text"/>
						<cell col="14" colid="TAKER_EMPID" display="text"/>
						<cell col="15" colid="MOVE_REPAIR_WORK_NM" display="text"/>
						<cell col="16" colid="TAKER_NAME" display="text"/>
						<cell col="17" colid="PROC_STS_CD" display="text"/>
						<cell col="18" colid="TAKER_TEAM" display="text"/>
						<cell col="19" colid="CONFERENCE_YMD" display="text"/>
						<cell col="20" colid="CONSULT_NUM" display="text"/>
						<cell col="21" colid="TXBILL_VAT_BIZPLC_1" display="text"/>
						<cell col="22" colid="TXBILL_PUBL_YM_1" display="text"/>
						<cell col="23" colid="BILL_YMD" display="text"/>
						<cell col="24" colid="BILL_NUM" display="text"/>
						<cell col="25" colid="MAINTER_NUM" display="text"/>
						<cell col="26" colid="REVIEW_OPINI_NUM" display="text"/>
						<cell col="27" colid="NEW_ADDR_UNION" display="text"/>
						<cell col="28" colid="EVIDENCE_YN" display="text"/>
						<cell col="29" colid="PRESS_FLAG" display="text"/>
						<cell col="30" colid="LENG" display="text"/>
						<cell col="31" colid="MATER_FLAG" display="text"/>
						<cell col="32" colid="PIPE_DIAM_CD" display="text"/>
						<cell col="33" colid="BILL_YMD_1" display="text"/>
						<cell col="34" colid="BILL_SEQ_1" display="text"/>
						<cell col="35" colid="BRANCH_NM" display="text"/>
						<cell col="36" colid="TXBILL_PUBL_SEQ_1" display="text"/>
						<cell col="37" colid="FIRST_MOVE_DOCU" display="text"/>
						<cell col="38" colid="PRESS_FLAG2" display="text"/>
						<cell col="39" colid="LENG2" display="text"/>
						<cell col="40" colid="MATER_FLAG2" display="text"/>
						<cell col="41" colid="PIPE_DIAM_CD2" display="text"/>
						<cell col="42" colid="PIPE_OPER_PRICE_YEAR" display="text"/>
						<cell col="43" colid="BILL_YMD_3" display="text"/>
						<cell col="44" colid="BILL_SEQ_3" display="text"/>
						<cell col="45" colid="TXBILL_VAT_BIZPLC_3" display="text"/>
						<cell col="46" colid="TXBILL_PUBL_YM_3" display="text"/>
						<cell col="47" colid="TXBILL_PUBL_SEQ_3" display="text"/>
						<cell col="48" colid="BILL_APPRO_YN_3" display="text"/>
						<cell col="49" colid="BILL_APPRO_YN_1" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Cursor="HAND" Height="17" Id="btn_BizCd" ImageID="search" Left="905" OnClick="btn_BizCd_OnClick" TabOrder="171" Text="Button8" Top="703" Width="18"></Button>
		<Grid AutoFit="TRUE" BindDataset="ds_MoveAdj_Select" BkColor2="default" BoldHead="true" Bottom="240" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="48" Id="Grid4" InputPanel="FALSE" Left="1280" LineColor="default" MinWidth="100" Right="2176" TabOrder="172" TabStop="true" Top="192" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="896">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="BASE_WORK_AMT"/>
					<cell col="1" display="text" text="DESIGN_AMT"/>
					<cell col="2" display="text" text="DESIGN_MASTER_AMT"/>
					<cell col="3" display="text" text="MOVE_REPAIR_NUM&#32;"/>
					<cell col="4" display="text" text="WORK_NUM"/>
					<cell col="5" display="text" text="PIPE_OPER_AMT"/>
					<cell col="6" display="text" text="ACT_YMD"/>
					<cell col="7" display="text" text="WORK_FIRM_NM"/>
					<cell col="8" display="text" text="DESIGN_AMT1"/>
				</head>
				<body>
					<cell col="0" colid="BASE_WORK_AMT" display="text"/>
					<cell col="1" colid="DESIGN_AMT" display="text"/>
					<cell col="2" colid="DESIGN_MASTER_AMT" display="text"/>
					<cell col="3" colid="MOVE_REPAIR_NUM&#32;" display="text"/>
					<cell col="4" colid="WORK_NUM" display="text"/>
					<cell col="5" colid="PIPE_OPER_AMT" display="text"/>
					<cell col="6" colid="ACT_YMD" display="text"/>
					<cell col="7" colid="WORK_FIRM_NM" display="text"/>
					<cell col="8" colid="DESIGN_AMT1" display="text"/>
				</body>
			</contents>
		</Grid>
		<Image Align="Left" Height="11" Id="Image7" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="175" Text="청구" Top="684" Width="69"></Image>
		<Image Align="Left" Height="11" Id="Image10" ImageID="blt_8" Left="6" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="177" Text="입금" Top="765" Width="66"></Image>
		<Edit BindDataset="ds_MoveDocuU" Border="Flat" Column="RECEIPT_EMPID" Enable="FALSE" Height="18" Id="edt_ReceiptEmpId" ImeMode="none" Left="623" MaxLength="9" Readonly="TRUE" Style="edit" TabOrder="178" Top="783" Width="61"></Edit>
		<Static Height="13" Id="Static18" Left="141" TabOrder="179" Text="※&#32;청구진행&#32;후&#32;데이터를&#32;변경하실&#32;수&#32;없습니다." Top="599" Width="366"></Static>
		<Image Align="Left" Height="16" Id="Image11" ImageID="blt" Left="75" LeftMargin="12" Style="blt_search" TabOrder="181" Text="전표발행일자" Top="808" Width="84"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_BillYmdReg" Left="162" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="180" Top="806" WeeksFont="Default,-1" Width="88"></Calendar>
		<Image Align="Left" Height="11" Id="Image12" ImageID="blt_8" Left="6" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="182" Text="전표" Top="811" Width="66"></Image>
		<Static Height="13" Id="Static26" Left="135" TabOrder="183" Text="※&#32;입금진행&#32;후&#32;데이터를&#32;변경하실&#32;수&#32;없습니다." Top="766" Width="366"></Static>
		<Button Cursor="HAND" Height="19" Id="Button1" ImageID="printer" Left="620" OnClick="Button1_OnClick" TabOrder="184" Text="Button8" Top="616" Width="18"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static17" Left="621" Style="table" TabOrder="110" Text="산정금액(원)" Top="635" VAlign="Middle" Width="158" WordWrap="TRUE"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveDocuU" Border="Flat" Column="REQ_AMT" Enable="FALSE" Height="18" Id="edt_REQ_AMT" Left="781" Mask="#,###" Style="edit" TabOrder="21" Top="637" Width="144"></MaskEdit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static47" Left="619" Style="table" TabOrder="185" Text="도관운영비&#32;적용년도" Top="614" VAlign="Middle" Width="160" WordWrap="TRUE"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_MoveAdj" Border="Flat" Column="BASE_WORK_AMT" Enable="FALSE" Height="18" Id="edt_BASE_WORK_AMT" Left="1059" Mask="#,###" MaxLength="10" OnCharChanged="edt_CostAmt_OnCharChanged" Style="edit" TabOrder="16" Top="616" Width="197"></MaskEdit>
		<Edit AutoSelect="TRUE" BindDataset="ds_MoveDocuV" Border="Flat" Column="CONSULT_NUM" Enable="FALSE" Height="18" Id="edt_CONSULT_NUM" ImeMode="none" Left="136" MaxLength="8" Number="TRUE" Readonly="TRUE" Style="edit" TabOrder="1" Top="616" Width="174"></Edit>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static28" Left="885" Style="table" TabOrder="187" Text="년" Top="614" VAlign="Middle" Width="43" WordWrap="TRUE"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1702010010F.xml
* Form 설명  : 이설보수 청구내역 등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 정주혜 
* 작성일     : 2008-12-29
* 변경내용   : 
****************************************************************************************************/
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONA10005.js";
#include "JS::COMMONE20001.js";
#include "JS::COMMONE30001.js";
#include "JS::COMMONE50001.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var str_Bill_Flag = ''; // 전표상태 

var fv_Bill_YMD = ''; // 전표발행일자

var fv_FindRow_ShowRow = -1; 		  // 조회후 보여줄 컬럼 체크변수
var fv_FindRow_ShowKey = -1;          // KEY 번호
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
//--------------------------------------------------------------------------------------------------
//	OnLoadCompletedF
//--------------------------------------------------------------------------------------------------
function D1702010010F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	
	fn_Init();
	
	if (IsExistVar("PORTLET_FLAG", true)) {
	    if (PORTLET_FLAG == "p") {			
			cob_ObjectFlag.value = BRANCH_CD;
			
			cob_BranchCd_OnChanged();
			//cob_MoveRepairType_OnChanged();
			
			fn_CommonSearch();
	    }
	}else{
		
		 if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") {
			cob_ObjectFlag.Enable = true;
			cob_ObjectFlag.Value = "";
		 } else {
			 cob_ObjectFlag.Value = gfn_GetGlobalValue("G_BRANCH_CD");
			 cob_ObjectFlag.Enable = false;
		 }
	
		cob_BranchCd_OnChanged();
		//cob_MoveRepairType_OnChanged();
	}
}

//---------------------------------------------------------
//	초기 설정
//---------------------------------------------------------
function fn_Init()
{
	
	gfn_D1_All_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_ObjectFlag" ));
	gfn_D1_All_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_ObjectFlag1"));
	gfn_D1_All_SetComboBox_Comcode("D10130",gfn_setDsObject_Comcode("cob_ConstructFlag" ));
	gfn_SetComboBox_Comcode("D10130",gfn_setDsObject_Comcode("cob_MoveRepairType"));	
	gfn_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_ReasonTelDDD"  ));
	gfn_SetComboBox_Comcode("D10224",gfn_setDsObject_Comcode("cob_TaxFlag"       ));
	//gfn_D1_All_SetComboBox_Comcode("",gfn_setDsObject_Comcode(""));
	gfn_D1_SetComboBox_Comcode1("D10132",gfn_setDsObject_Comcode("cob_MoveStsCD"),"40#50#60");
	
	gfn_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("Combo0"            ));
	gfn_SetComboBox_Comcode("D10308",gfn_setDsObject_Comcode("Combo1"            ));
	gfn_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("Combo2"            ));
	
	gfn_D1_NULL_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("Combo3"));
	gfn_D1_NULL_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("Combo4"));
	gfn_D1_NULL_SetComboBox_Comcode("D10308",gfn_setDsObject_Comcode("Combo5"));
	 
	cal_ReceiveStart.Value = substr(today(), 0, 6) + '01';
	cal_ReceiveEnd.Value   = today();
	
	//-----------------------------------------
	//  콤보박스의 초기 설정 : 기준년도, 지사
	//-----------------------------------------
	cob_CountyFlag.Index    = 0;
	cob_ConstructFlag.Index = 4;
	cob_TaxFlag.Index       = 0;	
	cob_MoveStsCD.Index     = 1;
	fn_GetSysList();
	
	grd_list.NoDataText = gfn_GetMessage("M000009","%AAA%","조회를");
	
}

/*===============================================================================
 * 전표관련 계정 조회
===============================================================================*/
function fn_GetSysList()
{
	// 미수금관련 계정
	// 미수금대체 관련 계정
	// 예수금대체 관련 계정
	
	var strSvcID        = "init";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_ACNT_CD=ds_ACNT_CD ds_ACNT_CD1=ds_ACNT_CD1 ds_ACNT_CD2=ds_ACNT_CD2";
	var strArgument     = "init=1";
	 	 
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}
/********************************************************************************
* 기      능   :  지사별 구를 조회하여 콤보박스에 셋팅
********************************************************************************/
function cob_BranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

     // 지사별 구 콤보 셋팅 시
    fn_SetComboBox_Comcode("1", cob_ObjectFlag.value, fn_setDsObject_Comcode("1", "cob_CountyFlag"));
    cob_CountyFlag.Value = "";
    /*
    if (IsExistVar("PORTLET_FLAG", true)) {	   
		if (PORTLET_FLAG == "p") { 
			cob_CountyFlag.Value = ZIP_NO1;
		}
	}else{	cob_CountyFlag.Value = ""; }    
	*/
}


/*===============================================================================
 * 공통 div_ComHead 에서 버튼 이벤트
		추가	fn_CommonAddRow
		삭제	fn_CommonDeleteRow
		저장	fn_CommonSave
		조회	fn_CommonSearch
		엑셀	fn_CommonExcelExport
		인쇄	fn_CommonPrint
		닫기	공통에서 처리
===============================================================================*/ 

///-------------------------------------------------------------------------------
// 함수명: fn_CommonSearch()
// 설명: DB에 값을 조회한다.
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonSearch()
{

	fn_DateCheck(cal_ReceiveStart, cal_ReceiveEnd);

	ds_MoveDocu.ClearData();
	ds_Excel.ClearData();
	
	ds_MoveDocuV.ClearData();
	ds_MoveDocuU.ClearData();
	ds_MoveAdj.ClearData();
	
    var strSvcID        = "svc_CommonSearch";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_MoveDocu=ds_MoveDocu ds_Excel=ds_Excel";
	var strArgument     = "search=1";
		strArgument		+= " BRANCH_CD="          + quote(cob_ObjectFlag.Value);
		strArgument		+= " ZIP_NO1="            + quote(cob_CountyFlag.Value);
		strArgument		+= " MOVE_REPAIR_TYPE="   + quote(cob_ConstructFlag.Value);
		strArgument		+= " RECEIVE_YMD_START="  + quote(cal_ReceiveStart.Value);
		strArgument		+= " RECEIVE_YMD_END="    + quote(cal_ReceiveEnd.Value);
		strArgument		+= " PROC_STS_CD="        + quote(cob_MoveStsCD.Value);	
	var strCallbackFunc = "fn_D1_Save_CallBack";	
								 	 
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallbackFunc
			   );
			   

	
	/*
	if (IsExistVar("PORTLET_FLAG", true)) {
	    if (PORTLET_FLAG == "p") {
				ds_MoveDocu.SelectRow(0, false);
				
				for(var i=0; i<ds_MoveDocu.GetRowCount(); i++){
					if(ds_MoveDocu.GetColumn(i, "MOVE_REPAIR_NUM") == replace(MOVE_REPAIR_NUM, "%$", "")){
						ds_MoveDocu.SelectRow(i);
						ds_MoveDocu.row = i;
					}
				}
	    }
	}*/
}
//--------------------------------------------------------------------------------------------------
// 로우 변경시
//--------------------------------------------------------------------------------------------------
function ds_MoveDocu_OnRowPosChanged(obj,nOldRow,nRow)
{
	
	if(nRow < 0) return;
	
	
	var strMOVE_REPAIR_NUM = ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_NUM");
	var strPROC_STS_CD     = ds_MoveDocu.GetColumn(nRow, "PROC_STS_CD"); // 진행상태
	trace("ds_MoveDocu_OnRowPosChanged:MOVE_REPAIR_NUM:"+strMOVE_REPAIR_NUM);
	
	ds_MoveDocuV.ClearData();
	ds_MoveDocuU.ClearData();
	ds_MoveAdj.ClearData();
	
	var strSvcID        = "findDetail";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_MoveDocuV=ds_MoveDocuV ds_MoveDocuH=ds_MoveDocuH ds_MoveDocuU=ds_MoveDocuU ds_MoveAdj=ds_MoveAdj";
	var strArgument     = "";
	
		strArgument  = "view=1"; 		
		strArgument	+= " MOVE_REPAIR_NUM=" + quote(strMOVE_REPAIR_NUM);
		 
		gfn_SyncCall( 
					 strSvcID
					, strPart
					, strURL
					, strInDatasets
					, strOutDatasets
					, strArgument
					);	
						
	// 2010-04-05추가
	// 청구일자가 없을경우 데이터 끌어오기
	//if( gfn_IsNull (cal_ReceiptYmd.Value) )
	
	// 2013.06.20. 이건민 - 권기철 과장님 추가요청사항 (도관운영비 미산출 시 도관운영비 년도 공란표시)
	if(edt_PIPE_OPER_AMT.Value == 0)
	{
		edt_PIPE_OPER_PRICE_YEAR.Text = "";
	}

	if(strPROC_STS_CD == '10') // 진행상태가 접수(10)이면
	{

		trace("ds_MoveDocu_OnRowPosChanged: cal_ReceiptYmd.Value:"+cal_ReceiptYmd.Value);

		ds_MoveAdj_Select.ClearData();
		var strSvcID        = "findDetail2";
		var strPart         = "D10";	
		var strURL          = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";
		var strInDatasets   = "";
		var strOutDatasets  = "ds_MoveAdj_Select=ds_MoveAdj_Select";
		var strArgument     = "";
	
		// 이설보수 유형 (10-이설) , (20-보수),(30-잔존가)
		if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '10')
		{
	
			// 품의번호가 없으면 그냥 조회
			if(gfn_IsNull ( ds_MoveDocu.GetColumn(nRow, "CONSULT_NUM"))) 
			{
				// strArgument = "view=1"; 
			}else{
			
				trace("ds_MoveDocu_OnRowPosChanged:CONSULT_NUM:" + ds_MoveDocu.GetColumn(nRow, "CONSULT_NUM"));
				// 이설 보수 공사 내역 조회
				strArgument = "view10=1";
				strArgument	+= " MOVE_REPAIR_NUM=" + quote(strMOVE_REPAIR_NUM);
				 
				gfn_SyncCall( 
							 strSvcID
							, strPart
							, strURL
							, strInDatasets
							, strOutDatasets
							, strArgument
							);
			}
			
		}
		else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '20')
		{ 
			// 정비보수에서 계산
			// strArgument = "view=1"; 
		}
		else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '30')
		{	
			// 폐관 잔존가
			strArgument = "view30=1"; 
			strArgument	+= " MOVE_REPAIR_NUM=" + quote(strMOVE_REPAIR_NUM);
			 
			gfn_SyncCall( 
						 strSvcID
						, strPart
						, strURL
						, strInDatasets
						, strOutDatasets
						, strArgument
						);
		}
		
		if( ds_MoveAdj_Select.GetRowCount() > 0)
		{
			alert(" 순수공사비, 공사감독비 데이터를 조회하였습니다. ");
			//gfn_SetStatusMsg("도관운영비 순수공사비 공사감독비 데이터를 조회하였습니다.","black",true); 			
			//ds_MoveAdj.SetColumn(0, "PIPE_OPER_AMT", ds_MoveAdj_Select.GetColumn(0, "PIPE_OPER_AMT"));         // 도관운영비
			ds_MoveAdj.SetColumn(0, "BASE_WORK_AMT", ds_MoveAdj_Select.GetColumn(0, "BASE_WORK_AMT"));         // 순수공사비
			ds_MoveAdj.SetColumn(0, "DESIGN_MASTER_AMT", ds_MoveAdj_Select.GetColumn(0, "DESIGN_MASTER_AMT")); // 공사감독비
			
			// 자동계산
			edt_CostAmt_OnCharChanged();
		}
		
	} // end if

	cob_MoveRepairType_OnChanged();

	//file Search
	fn_d1_FileSearch();
		  
		  
	edt_BASE_WORK_AMT.Enable = false;     // 순수공사비
	edt_DESIGN_MASTER_AMT.Enable = false; // 공사감독비(기타비용)
	edt_CostAmt.Enable = false;           // 폐관비용금액


	// 버튼설정
	btn_Review.Visible = false;        // 검토의견서작성
	btn_REVIEW_OPINI.Visible = false;  // 품의서작성
	btn_Closed_Tube.Visible = false;   // 잔존가폐관내역

	
	
	btn_PIPE_OPER_AMT.Enable = false; // 도관운영비버튼
	Button1.Enable = false; // 도관운영비프린트버튼

	cal_ReceiptYmd.Enable = false; // 청구일자
	btn_BizCd.Enable      = false; // 거래처버튼
				
	edt_RECEIPT_AMT.Enable = false; // 입금금액
	cal_RECEIPT_YMD.Enable = false; // 입금일자
	edt_ReceiptName.Enable = false; // 입금처리자
	edt_ReceiptTeam.Enable = false; // 소속부서
	btn_ReceiptName.Enable = false; // 입금자검색 버튼
			
	//btn_RECEIPT.Enable 	   = false;	// 입금확인 버튼	
	
	
	cal_BillYmd.Enable    = false ; // 전표발행일자
	btn_Bill.Enable	      = false ; // 전표등록
	btn_BillDel.Enable    = false ; // 전표취소
	
	btn_BillReg.Enable    = false; // 전표등록 
	btn_BillRegDel.Enable = false; // 전표취소
						  
	// 이설보수 유형 (10-이설) , (20-보수),(30-잔존가)
	// 이설보수유형에 따른 화면 visible
	if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '10')
	{
		// 버튼설정
		btn_Review.Visible = true;        // 검토의견서작성
		btn_REVIEW_OPINI.Visible = true;  // 품의서작성
		
		// 이설
		st_CONSULT_NUM.Visible = true;
		edt_CONSULT_NUM.Visible = true;
				
		// 보수
		stMAINTER_NUM.Visible = false;	
		edt_MAINTER_NUM.Visible = false;	
		
		// 입력
		edt_CostAmt.Enable = true;        // 폐관비용금액
		
		Static33.text = '공사감독비(원)';
		Static56.text = '기타 비용';

	}
	else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '20')
	{
		// 이설
		st_CONSULT_NUM.Visible = false;
		edt_CONSULT_NUM.Visible = false;

		// 보수			
		stMAINTER_NUM.Visible = true;	
		edt_MAINTER_NUM.Visible = true;	

		// 입력 
		edt_BASE_WORK_AMT.Enable = true;     // 순수공사비- 입력
	    edt_DESIGN_MASTER_AMT.Enable = true; // 공사감독비(기타비용)
		edt_CostAmt.Enable = true;           // 폐관비용금액
		
		Static33.text = '기타 비용';		
		Static56.text = '폐관비용금액(원)';

	}
	else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '30')
	{
		// 버튼설정
		btn_Closed_Tube.Visible = true;      // 잔존가폐관내역
		
		// 입력 
	    edt_DESIGN_MASTER_AMT.Enable = true; // 공사감독비(기타비용)
	    edt_CostAmt.Enable = true;           // 폐관비용금액
	    
	    Static33.text = '기타 비용';		
	    Static56.text = '폐관비용금액(원)';
	}  


/*
진행상태(PROC_STS_CD)

10-접수
20-청구
30-입금
40-공사
50-정산
60-환불
70-취소
*/
	 
	 
	// 이설보수 접수상태에서는 입금정보 비활성화
	if(strPROC_STS_CD == '10') // 접수
	{		
			
		btn_PIPE_OPER_AMT.Enable = true; // 도관운영비버튼
		Button1.Enable = false; // 도관운영비프린트버튼
		
		cal_ReceiptYmd.Enable    = true; // 청구일자
		btn_BizCd.Enable         = true; // 거래처버튼

		// edt_RECEIPT_AMT.Enable = true; // 입금금액
		// cal_RECEIPT_YMD.Enable = true; // 입금일자
		// btn_ReceiptName.Enable = true; // 입금자검색 버튼
		// btn_ReceiptName.Enable = true; // 입금자버튼		
		
	}
	else if(strPROC_STS_CD == '20') // 청구
	{		
		
		btn_PIPE_OPER_AMT.Enable     = false; 	// 도관운영비버튼
		Button1.Enable               = true; 	// 도관운영비프린트버튼
		edt_BASE_WORK_AMT.Enable     = false; 	// 순수공사비- 입력
	    edt_DESIGN_MASTER_AMT.Enable = false; 	// 공사감독비(기타비용)
		edt_CostAmt.Enable           = false; 	// 폐관비용금액
					
		// 2013.05.03. 이건민 - 권기철 과장님 추가요청		
		if( ! gfn_IsNull( cal_BILL_YMD_3.Value)) // 미수금전표가 등록되어있으면
		{
			// 전표취소
			cal_BillYmd.Enable 		= false;
			btn_Bill.Enable 		= false;
			btn_BillDel.Enable 		= true;
						
			// 2013.05.03. 이건민 - 권기철 과장님 추가요청
			btn_BizCd.Enable		= false;	// 거래처버튼
			cal_ReceiptYmd.Enable	= false;	// 청구일자	
		}
		else
		{
			// 전표발행가능
			cal_BillYmd.Enable 		= true;
			btn_Bill.Enable 		= true;
			btn_BillDel.Enable 		= false;

			// 2013.05.03. 이건민 - 권기철 과장님 요청사항
			btn_BizCd.Enable		= true;
			cal_ReceiptYmd.Enable	= true;
			
			if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '10')
			{
				btn_PIPE_OPER_AMT.Enable 		= true;	// 도관운영비
				edt_CostAmt.Enable	 			= true;	// 기타비용
			}
			else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '20')
			{
				btn_PIPE_OPER_AMT.Enable		= true;	// 도관운영비
				edt_BASE_WORK_AMT.Enable		= true;	// 순수공사비
				edt_DESIGN_MASTER_AMT.Enable	= true; // 기타비용
				edt_CostAmt.Enable				= true; // 폐관비용
				
			}
			else if(ds_MoveDocu.GetColumn(nRow, "MOVE_REPAIR_TYPE") == '30')
			{
				btn_PIPE_OPER_AMT.Enable		= true;	// 도관운영비
				edt_DESIGN_MASTER_AMT.Enable	= true;	// 기타비용
				edt_CostAmt.Enable				= true;	// 폐관비용
			}
		}
				
		edt_RECEIPT_AMT.Enable = true; // 입금금액
		cal_RECEIPT_YMD.Enable = true; // 입금일자
		btn_ReceiptName.Enable = true; // 입금자검색 버튼

		btn_ReceiptName.Enable = true; 	// 입금자버튼
		//btn_RECEIPT.Enable 	   = false;	// 입금확인 버튼
		
		cal_BILL_YMD.Enable = true; // 예수금전표일자
		edt_BILL_NUM.Enable = true; // 예수금전표번호
		
	}
	
	// 2013.05.03. 이건민 - 권기철 과장님 요청으로 주석처리
	/*
	else if(strPROC_STS_CD == '20') // 청구
	{		
		
		btn_PIPE_OPER_AMT.Enable     = false; // 도관운영비버튼
		Button1.Enable               = true; // 도관운영비프린트버튼
		edt_BASE_WORK_AMT.Enable     = false; // 순수공사비- 입력
	    edt_DESIGN_MASTER_AMT.Enable = false; // 공사감독비(기타비용)
		edt_CostAmt.Enable           = false; // 폐관비용금액
		cal_ReceiptYmd.Enable  	     = false; // 청구일자
		btn_BizCd.Enable 		     = false; // 거래처버튼
		
		// 2013.05.03. 이건민 - 권기철 과장님 추가요청		
		if( ! gfn_IsNull( cal_BILL_YMD_3.Value)) // 미수금전표가 등록되어있으면
		{
			// 전표취소
			cal_BillYmd.Enable = false;	
			btn_Bill.Enable = false;	
			btn_BillDel.Enable = true;
		}
		else
		{
			// 전표발행가능
			cal_BillYmd.Enable = true;	
			btn_Bill.Enable = true;	
			btn_BillDel.Enable = false;		
		}
		
		edt_RECEIPT_AMT.Enable = true; // 입금금액
		cal_RECEIPT_YMD.Enable = true; // 입금일자
		btn_ReceiptName.Enable = true; // 입금자검색 버튼

		btn_ReceiptName.Enable = true; 	// 입금자버튼
		//btn_RECEIPT.Enable 	   = false;	// 입금확인 버튼
		
		cal_BILL_YMD.Enable = true; // 예수금전표일자
		edt_BILL_NUM.Enable = true; // 예수금전표번호
		
	}
	*/
	else if(strPROC_STS_CD == '30') // 입금
	{
	
		//btn_RECEIPT.Enable = true; // 입금확인 버튼
	
		// 입력 
		btn_PIPE_OPER_AMT.Enable = false;     // 도관운영비버튼
		Button1.Enable           = true; // 도관운영비프린트버튼
		edt_BASE_WORK_AMT.Enable = false;     // 순수공사비- 입력
	    edt_DESIGN_MASTER_AMT.Enable = false; // 공사감독비(기타비용)
		edt_CostAmt.Enable = false;           // 폐관비용금액
			
		cal_BILL_YMD.Enable = true; // 예수금전표일자
		edt_BILL_NUM.Enable = true; // 예수금전표번호
		
		if( ! gfn_IsNull( cal_BILL_YMD.Value)) 
		{
			cal_BILL_YMD.Enable = false; // 예수금전표
			edt_BILL_NUM.Enable = false;
		}
		else
		{
			cal_BILL_YMD.Enable = true; // 예수금전표
			edt_BILL_NUM.Enable = true;
		}
		
		if( ! gfn_IsNull( cal_BILL_YMD_1.Value)) // 미수금대체전표가 등록되어있으면
		{
			// 전표취소
			cal_BillYmdReg.Enable = false;	
			btn_BillReg.Enable = false;	
			btn_BillRegDel.Enable = true;
			
			// 2013.05.07. 이건민 - 권기철 과장님 추가요청
			edt_RECEIPT_AMT.Enable = false;
			cal_RECEIPT_YMD.Enable = false;
			btn_ReceiptName.Enable = false;
		}
		else
		{
			// 전표발행가능
			cal_BillYmdReg.Enable = true;	
			btn_BillReg.Enable = true;	
			btn_BillRegDel.Enable = false;
					
			// 2013.05.07. 이건민 - 권기철 과장님 추가요청
			edt_RECEIPT_AMT.Enable = true;
			cal_RECEIPT_YMD.Enable = true;
			btn_ReceiptName.Enable = true;
		}
		
		
		
			
	}else if(strPROC_STS_CD == '50' ||
			 strPROC_STS_CD == '60')
	{
	
// 50-정산
// 60-환불
	
	}
	else if(strPROC_STS_CD == '70' && Radio.Value == 1) // 취소
	{
		Radio.Enable = false;
	}else{
		Radio.Enable = true;
	}
	
	var str_First = rdo_FIRST_MOVE_DOCU.Value;
	
	// 선공사일 경우임
	//if(str_First == 0)
	//미수금전표 발행여부로 미수금 대체 및 예수금 대체 전표처리 2010.06.30권기철
	if(length(cal_BILL_YMD_3.value) > 0)
	{	
		Static38.Text = '미수금대체전표';
		Static39.Text = '';
		cal_TXBILL_PUBL_YM_1.Visible = false;
		edt_TXBILL_PUBL_SEQ_1.Visible = false;
		btn_TXBILL_PUBL.Visible = false;				
		
	}
	else
	{
		Static38.Text = '예수금대체전표';
		Static39.Text = '예수금대체_세금계산서';
		cal_TXBILL_PUBL_YM_1.Visible = true;
		edt_TXBILL_PUBL_SEQ_1.Visible = true;
		btn_TXBILL_PUBL.Visible = true;
	}
		
	//Radio_OnClick();
	
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonSave()
// 설명: 등록된 내용을 저장한다.
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonSave()
{
	// 진행상태
	var strPROC_STS_CD = ds_MoveDocu.GetColumn(ds_MoveDocu.row, "PROC_STS_CD");
	
	if( strPROC_STS_CD != '10' && strPROC_STS_CD != '20' && strPROC_STS_CD != '30')
	{
		alert("진행상태가 접수, 청구, 입금인 건만 수정가능합니다. ");
		return;
	}
	
/*
진행상태(PROC_STS_CD)

10-접수
20-청구
30-입금
40-공사
50-정산
60-환불
70-취소
*/
	
	var strSaveRow = ds_MoveDocu.row;
	
	// 취소안함
	if(Radio.Value == '0')
	{
		// 10-접수
		if(ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") == '10')
		{
		
			// 이설보수 유형 (10-이설) , (20-보수),(30-잔존가)
			var strMOVE_REPAIR_TYPE = ds_MoveDocu.GetColumn(strSaveRow, "MOVE_REPAIR_TYPE");
			
			if( strMOVE_REPAIR_TYPE == '10')
			{
			}	
			//이설건에 한해 도관운영비가 필수.--정우현과장 20100622
			if(strMOVE_REPAIR_TYPE == '10')
			{		
				if( gfn_IsNull(edt_PIPE_OPER_AMT.Value) || edt_PIPE_OPER_AMT.Value == 0)
				{			
					alert("도관운영비는 0보다 큰 금액으로 입력하세요.");
					return;
				}
			}	
			//정비보수건일 경우 순수공사비는 0이어도 된다.--정우현과장 20100528
			if(strMOVE_REPAIR_TYPE != '20')
			{
				if( gfn_IsNull(edt_BASE_WORK_AMT.Value) || edt_BASE_WORK_AMT.Value == 0)
				{			
					alert("순수공사비는 0보다 큰 금액으로 입력하세요.");
					return;
				}
				// if( gfn_IsNull(edt_DESIGN_MASTER_AMT.Value)  || edt_PIPE_OPER_AMT.Value == 0)
				// {			
					// alert("공사감독비는 0보다 큰 금액으로 입력하세요. ");
					// return;
				// }
			}
			if( gfn_IsNull(edt_RESULT_AMT.Value) || edt_RESULT_AMT.Value == 0)
			{			
				alert("청구금액은 0보다 큰 금액이여야 합니다.");
				return;
			}
			
			if( gfn_IsNull(cal_ReceiptYmd.Value))
			{			
				alert("청구일자는 필수입력사항입니다.");
				cal_ReceiptYmd.SetFocus();
				return;
			}	
			
			if( gfn_IsNull(ds_MoveDocuU.GetColumn(0, "DEAL_CD")))
			{
				alert("거래처정보는 필수입력사항입니다.");
				return;
			}
			
			
			
		}
		else if(ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") == '20') // 20-청구
		{
			if(ds_MoveDocuU.GetRowType(0)=='normal' && ds_MoveDocuV.GetRowType(0)=='normal')
			{
				alert("변경할 데이터가 존재하지 않습니다.");
				return; 
			}
			
			// 2013.05.06. 이건민 - 권기철 과장님 요청사항 (청구일자, 거래처명 필수입력)
			if( gfn_IsNull(cal_ReceiptYmd.Value))
			{			
				alert("청구일자는 필수입력사항입니다.");
				cal_ReceiptYmd.SetFocus();
				return;
			}
			
			if( gfn_IsNull(ds_MoveDocuU.GetColumn(0, "DEAL_CD")))
			{
				alert("거래처정보는 필수입력사항입니다.");
				return;
			}
						
			if( gfn_IsNull(edt_RESULT_AMT.Value) || edt_RESULT_AMT.Value == 0)
			{
				alert("청구금액은 0보다 큰 금액이여야 합니다.");
				return;
			}
			
			// 2013.05.07. 이건민 - 권기철 과장님 추가요청 사항 (입금 내역 체크)
			if( (edt_RECEIPT_AMT.Value != 0 && edt_RECEIPT_AMT.Value != "") || cal_RECEIPT_YMD.Value != "" || edt_ReceiptEmpId.Text != "" )
			{
				if( gfn_IsNull(edt_RECEIPT_AMT.Value))
				{
					alert("입금금액은 필수입력사항입니다.");
					return false;
				}
				
				var strRESULT_AMT  = parseFloat(edt_RESULT_AMT.Value);
				var strRECEIPT_AMT = parseFloat(edt_RECEIPT_AMT.Value);
				
				var strDiffAMT = strRESULT_AMT - strRECEIPT_AMT;
				
				//trace("strDiffAMT:"+strDiffAMT);
				
				if( strDiffAMT > 999 || strDiffAMT < -999 )
				{
					alert("청구금액과 입금금액 +-1000원미만 이여야 합니다. (" + strDiffAMT+")");
					return;
				}
				
				if( gfn_IsNull(cal_RECEIPT_YMD.Value) )
				{
					alert("입금일자는 필수입력사항입니다.");
					return false;
				}
				
				if(gfn_IsNull(edt_ReceiptEmpId.Value))
				{
					alert("입금처리자는 필수입력사항입니다.");
					edt_ReceiptName.SetFocus();
					return false;
				}
				
			}
			
			/*if(edt_RESULT_AMT.Value != edt_RECEIPT_AMT.Value){	
				alert("청구금액과 입금금액이 동일하지 않습니다. ");
				return false;
			}*/
			
			/*
			if( gfn_IsNull(edt_RECEIPT_AMT.Value))
			{
				alert("입금금액은 필수입력사항입니다. ");
				return false;
			}
			

			
			var strRESULT_AMT  = parseFloat(edt_RESULT_AMT.Value);
			var strRECEIPT_AMT = parseFloat(edt_RECEIPT_AMT.Value);
			
			var strDiffAMT = strRESULT_AMT - strRECEIPT_AMT;
			
			//trace("strDiffAMT:"+strDiffAMT);
			
			if( strDiffAMT > 999 || strDiffAMT < -999 )
			{
				alert("청구금액과 입금금액 +-1000원미만 이여야 합니다. (" + strDiffAMT+")");
				return;
			}
						
			if(gfn_IsNull( cal_RECEIPT_YMD.Value))
			{
				alert("입금일자는 필수입력사항입니다. ");
				return false;
			}
			
			if(gfn_IsNull(edt_ReceiptEmpId.Value))
			{
				alert("입금처리자는 필수입력사항입니다. ");
				edt_ReceiptName.SetFocus();
				return false;
			}
			*/
			
		}
		
		// 2013.05.07. 이건민 - 권기철 과장님 추가요청 (입금)
		else if(ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") == '30') // 30-입금
		{
			if(ds_MoveDocuU.GetRowType(0)=='normal' && ds_MoveDocuV.GetRowType(0)=='normal')
			{
				alert("변경할 데이터가 존재하지 않습니다.");
				return; 
			}
			
			if( gfn_IsNull(edt_RECEIPT_AMT.Value))
			{
				alert("입금금액은 필수입력사항입니다.");
				return false;
			}
			
			var strRESULT_AMT  = parseFloat(edt_RESULT_AMT.Value);
			var strRECEIPT_AMT = parseFloat(edt_RECEIPT_AMT.Value);
			
			var strDiffAMT = strRESULT_AMT - strRECEIPT_AMT;
			
			//trace("strDiffAMT:"+strDiffAMT);
			
			if( strDiffAMT > 999 || strDiffAMT < -999 )
			{
				alert("청구금액과 입금금액 +-1000원미만 이여야 합니다. (" + strDiffAMT+")");
				return;
			}
			
			if( gfn_IsNull(cal_RECEIPT_YMD.Value) )
			{
				alert("입금일자는 필수입력사항입니다.");
				return false;
			}
			
			if(gfn_IsNull(edt_ReceiptEmpId.Value))
			{
				alert("입금처리자는 필수입력사항입니다.");
				edt_ReceiptName.SetFocus();
				return false;
			}
			
		}

	}
	else // 취소 Radio.Value == '1'
	{	
		if(ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") == '70' && Radio.Value == 1)
		{
			alert("취소된 데이터는 저장을 하실 수 없습니다. ");
			return false;
		}
		
		if(gfn_IsNull(edt_CANCEL_DESC.Value))
		{
			alert("취소사유는 필수입력사항입니다. ");
			return false;
		}
	}
	
	
	var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;            // SESSION ID
	var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");            // SESSION IP

	ds_MoveDocuU.AddColumn("UPD_EMPID"    , "STRING", 256 );	// ID
	ds_MoveDocuU.AddColumn("UPD_IP"       , "STRING", 256 );	// IP
	ds_MoveDocuU.AddColumn("PIPE_OPER_AMT"       , "STRING", 256 );	// 도관운영비
	ds_MoveDocuU.AddColumn("BASE_WORK_AMT"       , "STRING", 256 );	// 순수공사비
	ds_MoveDocuU.AddColumn("DESIGN_MASTER_AMT"   , "STRING", 256 );	// 설계감독비
	
	ds_MoveDocuU.SetColumn(0, "UPD_EMPID" , USER_ID       );
	ds_MoveDocuU.SetColumn(0, "UPD_IP"    , USER_IP       );
		
	// 진행상태결정 
	if( ! gfn_IsNull(cal_ReceiptYmd.Value) ) // 청구일자
	{
		ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "20"); // 청구 진행 코드
		ds_MoveDocuU.SetColumn(0, "RECEIPT_YN", 'N');

		if( ! gfn_IsNull( cal_RECEIPT_YMD.Value) ) // 입금일자
		{
			ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "30"); // 입금 진행 코드
			ds_MoveDocuU.SetColumn(0, "RECEIPT_YN", 'Y');
		}
	}
	
	// 취소
	if( Radio.Value == '1')
	{
		ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "70");
	}
	
	/*
	for(var i=0; i<ds_MoveDocuU.GetRowCount(); i++)
	{
		// 입금일자
		if(ds_MoveDocuU.GetColumn(i, "RECEIPT_YMD") != ''   && 
		   ds_MoveDocuU.GetColumn(i, "RECEIPT_YMD") != null && 
		  (ds_MoveDocuU.GetColumn(i, "RECEIPT_AMT") != '0'  ||
		   ds_MoveDocuU.GetColumn(i, "RECEIPT_AMT") != ''
		  )                                                 && 
		   ds_MoveDocuU.GetColumn(i, "RECEIPT_AMT") != null
		  )
		{
			if(edt_RESULT_AMT.Value != edt_RECEIPT_AMT.Value)
			{	
				ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "20"); // 청구 진행 코드
				ds_MoveDocuU.SetColumn(0, "RECEIPT_YN", 'N');
			}
			else
			{
				ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "30"); // 입금 진행 코드
				ds_MoveDocuU.SetColumn(0, "RECEIPT_YN", 'Y');
			}			
		}
		else
		{
			ds_MoveDocuU.SetColumn(0, "PROC_STS_CD", "20"); // 청구 진행 코드
			ds_MoveDocuU.SetColumn(0, "RECEIPT_YN", 'N');
		}
	}
	*/
	
	fn_D1_save();
}

//------------------------------------------------------------------------------- 
//   함수명 : fn_D1_SAVE
//   설명  : 이설 보수 청구 내역 저장한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_save()
{	

	// #####################################################################################
	// 이설보수시공사정산 등록
	// #####################################################################################
	/*
	ds_MoveAdj.UpdateControl = false;
	
	var result = fn_D1_Check(ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "MOVE_REPAIR_NUM"));
	
	var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;            // SESSION ID
	var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");            // SESSION IP
		
	ds_MoveAdj.AddColumn("UPD_EMPID","STRING",256);
	ds_MoveAdj.AddColumn("UPD_IP"   ,"STRING",256);
	ds_MoveAdj.AddColumn("CRT_EMPID","STRING",256);
	ds_MoveAdj.AddColumn("CRT_IP"   ,"STRING",256);
	
	ds_MoveAdj.SetColumn(0, "UPD_EMPID" , USER_ID );		
	ds_MoveAdj.SetColumn(0, "UPD_IP"    , USER_IP );
	ds_MoveAdj.SetColumn(0, "CRT_EMPID" , USER_ID );
	ds_MoveAdj.SetColumn(0, "UPD_IP"    , USER_IP );

	// 이설보수번호 임시 셋팅
	ds_MoveAdj.SetColumn(0, "MOVE_REPAIR_NUM" , ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "MOVE_REPAIR_NUM"));
			
	if(result == '0'){
		ds_MoveAdj.SetRowType(0, 'insert');
	}else{
		ds_MoveAdj.SetRowType(0, 'update');
	}	
	*/
	var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;            // SESSION ID
	var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");            // SESSION IP
		
	// #####################################################################################
	ds_MoveDocuV.AddColumn("UPD_EMPID"    , "STRING", 256 );	// ID
	ds_MoveDocuV.AddColumn("UPD_IP"       , "STRING", 256 );	// IP
	ds_MoveDocuV.AddColumn("BILL_APPRO_YN", "STRING", 256 );	
	
	ds_MoveDocuV.SetColumn(0, "UPD_IP"       , USER_IP       );
	ds_MoveDocuV.SetColumn(0, "UPD_EMPID"    , USER_ID       );
	ds_MoveDocuV.SetColumn(0, "BILL_APPRO_YN", 'N'           );

	ds_MoveDocuU.SetColumn(0, "PIPE_OPER_AMT", ds_MoveAdj.GetColumn(0, "PIPE_OPER_AMT")); //도관운영비
	ds_MoveDocuU.SetColumn(0, "BASE_WORK_AMT", ds_MoveAdj.GetColumn(0, "BASE_WORK_AMT")); //순수공사비
	ds_MoveDocuU.SetColumn(0, "DESIGN_MASTER_AMT", ds_MoveAdj.GetColumn(0, "DESIGN_MASTER_AMT")); //공사감독비
	// #####################################################################################
	
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "MOVE_REPAIR_NUM");     //KEY번호
		
	var strSvcID         = "CommonSave";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";	
	//var strInDatasets    = "ds_MoveDocuU=ds_MoveDocuU:u ds_MoveAdj=ds_MoveAdj:u ds_MoveDocuV=ds_MoveDocuV:u";
	var strInDatasets    = "ds_MoveDocuU=ds_MoveDocuU:u ds_MoveDocuV=ds_MoveDocuV:u";
	var strOutDatasets   = "";		
	var strArgument      = "update=1";
	var strCallbackFunc = "fn_D1_Save_CallBack";		
	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallbackFunc
			    );
			   
}
//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Check()
//   설명  :  이설보수 공사내역 등록 여부 확인
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Check(i)
{	
    var strSvcID        = "search_Count";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Count1=ds_Count1";
	var strArgument     = "search_Count=1";
		strArgument	   += " MOVE_REPAIR_NUM=" + quote(i);
							 	 
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
			   
		
	return ds_Count1.GetColumn(0, "NCOUNT");
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonExcelExport()
// 설명: 엑셀 button 실행, 조회된데이터를 엑셀형식으로변환한다
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonExcelExport()
{
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 : "     + RPad(cob_ObjectFlag.Text   ," ",20);
    SearchCondition = SearchCondition + "시/구 : "    + RPad(cob_CountyFlag.Text   ," ",20);
    SearchCondition = SearchCondition + "유형 : "     + RPad(cob_ConstructFlag.Text," ",20);
    SearchCondition = SearchCondition + "접수일자 : " + RPad(cal_ReceiveStart.Value + ' ~ ' + cal_ReceiveEnd.Value," ",20);
        
    gfn_ExportExcel("이설보수 청구내역 등록", 5, SearchCondition, "grd_excel");
}

function grd_list_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_SetGridSort(obj, nCell);	
}


//------------------------------------------------------------------------------- 
// 화면입력시 계산
//------------------------------------------------------------------------------- 
function edt_CostAmt_OnCharChanged(obj,strPreText,strPostText)
{
	
     // 2010.02.04 수정 

	// 2010-04-07- 산정금액 100원단위 까지 절사 - 권기철, 정우현과장 협의완료 수정
	// 산정금액 
	var strREQ_AMT = toNumber(edt_BASE_WORK_AMT.Value ) 
			   + toNumber(edt_DESIGN_MASTER_AMT.Value) 
			   + toNumber(edt_PIPE_OPER_AMT.Value )
			   + toNumber(edt_CostAmt.Value)
			   ;
			   
	//edt_REQ_AMT.Value = Truncate( strREQ_AMT / 100 ) * 100;
	// 2010-04-12 최종 - 원단위 청구
	
	edt_REQ_AMT.Value = strREQ_AMT;
    
    /*
	if(cob_MoveRepairType.Value =="10")  // 이설일경우 
	{
		// 임시임   이설일 경우로 변경 바람 !!!
		edt_REQ_AMT.Text = toNumber(edt_BASE_WORK_AMT.Value ) 
				   + toNumber(edt_DESIGN_MASTER_AMT.Value) 
				   + toNumber(edt_PIPE_OPER_AMT.Value )
				   + toNumber(edt_CostAmt.Value)
				   ;
	}
	else if(cob_MoveRepairType.Value =="20") //  보수일 경우 
	{
		// 임시임   보수일 경우로 변경 바람 !!!
		edt_REQ_AMT.Text = toNumber(edt_BASE_WORK_AMT.Value ) 
				   + toNumber(edt_DESIGN_MASTER_AMT.Value) 
				   + toNumber(edt_PIPE_OPER_AMT.Value )
				   + toNumber(edt_CostAmt.Value)
				   ;
	}
	else if(cob_MoveRepairType.Value =="30") //  잔존가일경우 
	{
	
		edt_REQ_AMT.Text = toNumber(edt_BASE_WORK_AMT.Value ) 
				   + toNumber(edt_DESIGN_MASTER_AMT.Value) 
				   + toNumber(edt_PIPE_OPER_AMT.Value )
				   + toNumber(edt_CostAmt.Value)
				   ;
		//edt_REQ_AMT.Text = ds_MoveDocu.GetColumn(nRow,"REQ_AMT"); // 하나의 이설보수번호에 폐관비용관리번호가 여러개로 되어있어서  SUM 한 값임. 
	}
	*/
	
	// 부가세 계산로직
	
	//10 일반 : 부가세 있음    , 세금계산서발행 Y
	//20 면세 : 부가세 면제    , 세금계산서발행 N
	//30 영세 : 부가세 있으나 0, 세금계산서발행 Y
	//alert(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN"));
	var vat = 0;

	if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '10'){
		
		vat         = toNumber(edt_REQ_AMT.Value) * 0.1 ;
	}	
	else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '20'){
		//부가세		
		vat         = 0;
	}else if (ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '30'){
		//부가세		
		vat         = 0 ;
	}

	edt_VAT.Text = truncate(vat);
	//부가세 절사(단단위 미만) 권기철 2010.4.19
	//edt_RESULT_AMT.Text = round(toNumber(vat) + toNumber(edt_REQ_AMT.Value));	
	edt_RESULT_AMT.Text = strREQ_AMT + truncate(vat);
	
}



//------------------------------------------------------------------------------- 
//   설명  :  입금확인 버튼
//------------------------------------------------------------------------------- 
function btn_RECEIPT_OnClick(obj)
{
	 var strPrefix = "E50";
	 var strFormid = "E5204080011F";
	 var strArg    = "" ;
	 
	gfn_NewWindow(strPrefix, strFormid, strArg, "입금확인", strFormid, "", 0, "");
}


//------------------------------------------------------------------------------- 
//   설명  :  검토의견서 영업공사 연결
//------------------------------------------------------------------------------- 
function btn_Review_OnClick(obj)
{	 
	 var strPrefix = "B10";
	 var strFormid = "B1202010020F";
	 var strArg    = "" ;
	     strArg    = strArg + "fn_MOVE_REPAIR_NUM=" + quote(ds_MoveDocu.GetColumn(ds_MoveDocu.currow, "MOVE_REPAIR_NUM" )) + " ";
		 strArg    = strArg + "fa_ReviewOpiniNum="  + quote(ds_MoveDocu.GetColumn(ds_MoveDocu.currow, "REVIEW_OPINI_NUM")) + " ";
		 strArg    = strArg + "fa_Openflag="  + "MOV"     ;
	 
	 gfn_NewWindow(strPrefix, strFormid, strArg, "검토의견서 등록", strFormid, "", 0, "");
}
//------------------------------------------------------------------------------- 
//   설명  :  품의서 영업공사 연결
//------------------------------------------------------------------------------- 
function btn_REVIEW_OPINI_OnClick(obj)
{	
	// 검토의견서 번호가 없을경우에는 
	 if( ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "REVIEW_OPINI_NUM") == '' || ds_MoveDocuV.GetColumn(ds_MoveDocuV.currow, "REVIEW_OPINI_NUM") == null){
		alert("검토의견번호가 존재하지 않습니다. ");
		return;
	 }

	 var strPrefix = "B10";
	 var strFormid = "B1202010030F";
	 var strArg    = "" ;
	     strArg    = strArg + "fn_MOVE_REPAIR_NUM=" + quote(ds_MoveDocu.GetColumn(ds_MoveDocu.currow, "MOVE_REPAIR_NUM")) + " ";
	     strArg    = strArg + "fn_ConsultNum="      + quote(ds_MoveDocu.GetColumn(ds_MoveDocu.currow, "CONSULT_NUM"    ))      ;
	     
	 gfn_NewWindow(strPrefix, strFormid, strArg, "투자품의 등록", strFormid, "", 0, "");
}
//------------------------------------------------------------------------------- 
//   설명  :  잔존가 폐관 내역
//------------------------------------------------------------------------------- 
function btn_Closed_Tube_OnClick(obj)
{
	var args  = "MOVE_REPAIR_NUM=" + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_NUM")+"%$";
		args += " BRANCH_CD="      + ds_MoveDocuV.GetColumn(0, "BRANCH_CD")+"%$";
		args += " ZIP_NO1="        + ds_MoveDocuV.GetColumn(0, "ZIP_NO1")+"%$";
		gfn_Dialog("D10","D1705010012U",args,536,742,true,-1,-1);
}

//-------------------------------------------------------------------------------
// 함수명: Button0_OnClick()
//   설명: 첨부파일 popup화면 로딩
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_Upload_OnClick(obj)
{
	if(ds_MoveDocuV.GetRowCount() <= 0 )
	{
		alert(gfn_GetMessage("M000040","%AAA%","이설보수내역을 "));
		return;
	}
	
	// 접수
	if(obj == btn_file_10){
	
		var arg  = "fa_Url=handle.do?ServiceName=D1_MoveingRepairSpecMgr-service"
		         + "&MOVE_REPAIR_NUM="   + ds_MoveDocu.GetColumn(ds_MoveDocu.row, "MOVE_REPAIR_NUM") 
		         + "&ATTACH_FILE_FLAG="  + "10" 
		         + "&ATTACH_GROUP_FLAG=" + "10"
		         + " fa_Part=D10"
		         ;
		var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
		
		edt_File_10.text = "";
		
		for(var i=0; i<arrList.length; i++)
		{
			edt_File_10.text += arrList[i];
			if(arrList.length-1 != i) edt_File_10.text += "/";
		}
	}
	
	// 청구
	if(obj == btn_file_20){
	
		var arg  = "fa_Url=handle.do?ServiceName=D1_MoveingRepairSpecMgr-service"
		         + "&MOVE_REPAIR_NUM="   + ds_MoveDocu.GetColumn(ds_MoveDocu.row, "MOVE_REPAIR_NUM") 
		         + "&ATTACH_FILE_FLAG="  + "20" 
		         + "&ATTACH_GROUP_FLAG=" + "20"
		         + " fa_Part=D10"
		         ;
		var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
		
		edt_File_20.text = "";
		
		for(var i=0; i<arrList.length; i++)
		{
			edt_File_20.text += arrList[i];
			if(arrList.length-1 != i) edt_File_20.text += "/";
		}
	}
}

//-------------------------------------------------------------------------------
//  첨부파일 조회
//------------------------------------------------------------------------------- 
function fn_d1_FileSearch()
{
	edt_File_10.text = "";
	edt_File_20 .text = "";

	var strSvcID = "findFile10";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_MoveingRepairSpecMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_FileList=ds_FileList";
	var strArgument     = "findFile=1";
	    strArgument    += " MOVE_REPAIR_NUM="    + quote(ds_MoveDocuV.GetColumn(0,"MOVE_REPAIR_NUM"));
	    strArgument    += " ATTACH_GROUP_FLAG="  + "10";
		
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
			   
	var strSvcID = "findFile20";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1_MoveingRepairSpecMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_FileList1=ds_FileList";
	var strArgument     = "findFile=1";
	    strArgument    += " MOVE_REPAIR_NUM="    + quote(ds_MoveDocuV.GetColumn(0,"MOVE_REPAIR_NUM"));
	    strArgument    += " ATTACH_GROUP_FLAG=" + "20";		

	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );		   
	
	if(ErrorCode < 0)
	{
		return;
	}
	
	// 접수 첨부파일
	for(var i=0; i<ds_FileList.RowCount(); i++)
	{
		edt_File_10.text += ds_FileList.GetColumn(i,"ORG_FILE_NAME");
		if(ds_FileList.RowCount()-1 != i) edt_File_10.text += "/";
	}
	
	// 청구 첨부파일
	for(var i=0; i<ds_FileList1.RowCount(); i++)
	{
		edt_File_20.text += ds_FileList1.GetColumn(i,"ORG_FILE_NAME");
		if(ds_FileList1.RowCount()-1 != i) edt_File_20.text += "/";
	}
	

}


function  cob_MoveRepairType_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 잔존가일 경우에는
	if(cob_MoveRepairType.Value == '30' && ds_MoveDocuV.GetRowType(0) == 'insert')
	{
		alert(gfn_GetMessage("M000004","%AAA%","폐관비용 산정을"));
		cob_MoveRepairType.index = 0;
		return;
	}
	
	// 상태값 변화 : 이설
	if(cob_MoveRepairType.Value == '10')
	{
		Static3 .Text = '이설번호';
		Static6 .Text = '이설위치';
		Static24.Text = '이설공사명';
		
		// 이설일경우 협의자 활성화
  	    Static21.Enable = true;		
		Static16.Enable = true;
	}

	// 상태값 변화 : 보수
	if(cob_MoveRepairType.Value == '20')
	{
		Static3 .Text = '보수번호';
		Static6 .Text = '보수위치';
		Static24.Text = '보수공사명';
		
		//보수일경우 협의자 비활성화
		Static21.Enable = false;		
		Static16.Enable = false;	
	}
	
	// 상태값 변화 : 잔존가
	if(cob_MoveRepairType.Value == '30')
	{
    	 Static3 .Text = '잔존가번호';
		 Static6 .Text = '잔존가위치';
		 Static24.Text = '잔존가공사명';
		
		//잔존가일경우 협의자 비활성화
		 Static21 .Enable = false;		
		 Static16 .Enable = false;
	}
}

//------------------------------------------------------------------------------- 
//   함수명: Grd_MoveAdj_OnExpandEdit()
//   설명  :  도관운영비 산출 팝업
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_PIPE_OPER_AMT_OnClick(obj)
{
	var vat        = 0 ; 
	var result     = 0 ;
	var pipeResult = 0 ;
	var chai       = 0 ;
	
	var args  = '';		
		args  = "WORK_NUM="         + ds_MoveAdj.GetColumn(ds_MoveAdj.row, "WORK_NUM")+"%$";
		args += " MOVE_REPAIR_NUM=" + ds_MoveDocu.GetColumn(ds_MoveDocu.row, "MOVE_REPAIR_NUM")+"%$";
		args += " PRESS_FLAG="      + quote(ds_MoveDocuV.GetColumn(0, "PRESS_FLAG"   ));
		args += " PRESS_FLAG2="     + quote(ds_MoveDocuV.GetColumn(0, "PRESS_FLAG2"  ));
		args += " PIPE_DIAM_CD="    + quote(ds_MoveDocuV.GetColumn(0, "PIPE_DIAM_CD" ));
		args += " PIPE_DIAM_CD2="   + quote(ds_MoveDocuV.GetColumn(0, "PIPE_DIAM_CD2"));
		args += " LENG="   		    + quote(ds_MoveDocuV.GetColumn(0, "LENG"         ));
		args += " LENG2="   		+ quote(ds_MoveDocuV.GetColumn(0, "LENG2"        ));
		args += " PIPE_OPER_PRICE_YEAR=" + quote(ds_MoveDocuV.GetColumn(0, "PIPE_OPER_PRICE_YEAR"));
		args += " PIPE_OPER_AMT=" + quote(ds_MoveAdj.GetColumn(0, "PIPE_OPER_AMT"));
					
	var arrList = gfn_Dialog("D10","D1702010010U",args,705,520,true,-1,-1);
	
	if( length(arrList) > 0)
	{
		ds_MoveDocuV.SetColumn(0, "PIPE_OPER_PRICE_YEAR", arrList[1]);			
		ds_MoveAdj.SetColumn(0, "PIPE_OPER_AMT", arrList[0]);
		
		edt_CostAmt_OnCharChanged();
	}
}

// 예수금 대체전표
function Button10_OnClick(obj)
{
	if(edt_REQ_AMT.Text != edt_RECEIPT_AMT.Text && (edt_REQ_AMT.Text != '0' || edt_RECEIPT_AMT.Text == '0')){
		alert("청구금액과 입금금액이 동일한 경우에만 전표가 발행됩니다. ");
		return;
	}
	
	// 품의서 번호가 없을경우 전표발행할 수 없다
	if((edt_CONSULT_NUM.Text == '' || edt_CONSULT_NUM.Text == null) && edt_REQ_AMT.Text == '0' && edt_RECEIPT_AMT.Text == '0'){
			alert("전표 발행 가능한 데이터가 아닙니다. "); 
			return;
	}
}

//-------------------------------------------------------------------------------
// 함수명: Radio_OnClick()
//   설명: 취소/취소안함
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function Radio_OnClick(obj)
{		
	
	// 취소
	if(Radio.Value == '1'){
		if(
			ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") != 10 &&
			ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") != 20 &&
			ds_MoveDocuV.GetColumn(0, "PROC_STS_CD") != 70 
		){
			alert("이설보수 진행상태가 접수, 청구 경우에만 취소가 가능합니다. ");
			Radio.Value = '0';
			return;
		}

		edt_CANCEL_DESC.Enable = true;
		
	}else{	
		
		edt_CANCEL_DESC.Enable = false;
	}
	
	//rdo_FIRST_MOVE_DOCU_OnChanged();
}

// 선공사여부 (2010-04-16 Mr.H 사용안함)
function rdo_FIRST_MOVE_DOCU_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

	/*
	var str_First = rdo_FIRST_MOVE_DOCU.Value;
		
	if(str_First == 0){ // 선공사일 경우임
		Static38.Text = '미수금대체전표';
		Static39.Text = '';
		cal_TXBILL_PUBL_YM_1.Visible = false;
		edt_TXBILL_PUBL_SEQ_1.Visible = false;
		btn_TXBILL_PUBL.Visible = false;				
	}else{
		Static38.Text = '예수금대체전표';
		Static39.Text = '예수금대체_세금계산서';
		cal_TXBILL_PUBL_YM_1.Visible = true;
		edt_TXBILL_PUBL_SEQ_1.Visible = true;
		btn_TXBILL_PUBL.Visible = true;
	}
	*/
			
	/*
	var str_Type  = ds_MoveDocuV.GetColumn(0, "PROC_STS_CD");

	if(str_Type == '10')
	{
		
		cal_BillYmd.Enable      = false; // 전표발행일자
		btn_Bill.Visible		= true;  // 전표등록
		btn_BillDel.Enable	    = false; // 전표취소
		btn_BillDel.Visible	    = true;

		btn_BillReg.Enable	    = false; // 전표등록 
		btn_BillRegDel.Enable	= false; // 전표취소
		
		btn_BillReg.Visible	    = false;
		btn_BillRegDel.Visible	= false;
		
	}
	else if(str_Type == '20')
	{
		
		
		if(Radio.Value == 0){	

			if(str_First == 0){ // 선공사일 경우
				cal_BillYmd.Enable    = true ; // 전표발행일자
				btn_Bill.Enable	      = true ; // 전표등록
				btn_BillDel.Enable    = true ; // 전표취소
				btn_BillReg.Enable    = false; // 전표등록 
				btn_BillRegDel.Enable = false; // 전표취소
				
			}else{
				cal_BillYmd.Enable    = false;
				btn_Bill.Enable	      = false;
				btn_BillDel.Enable    = false;
				btn_BillReg.Enable    = false;
				btn_BillRegDel.Enable = false;

			}
		}else{

			cal_BillYmd.Enable    = false;
			btn_Bill.Enable	      = false;
			btn_BillDel.Enable    = false;
			btn_BillReg.Enable    = false;
			btn_BillRegDel.Enable = false;
		}
						
		btn_Bill.Visible		   = true ;
		btn_BillDel.Visible	       = true ;
		btn_BillReg.Visible	       = false;
		btn_BillRegDel.Visible	   = false;
				
	}
	else if(str_Type == '30')
	{
		
		cal_BillYmd.Enable     = true ;
		btn_Bill.Enable		   = false;
		btn_BillDel.Enable	   = false;
		btn_BillReg.Enable     = true ;
		btn_BillRegDel.Enable  = true ;
		btn_BillReg.Visible	   = true ;
		btn_BillRegDel.Visible = true ;
		btn_Bill.Visible	   = false;
		btn_BillDel.Visible	   = false;
	}	
	*/

}
//-------------------------------------------------------------------------------
// 입금자버튼 
//------------------------------------------------------------------------------- 
function btn_ReceiptName_OnClick(obj)
{
	 var retValue = gfn_E2_SearchEmplDialog();
	 
	 if( length(retValue) > 0 )
	 {
		 edt_ReceiptEmpId.Text = retValue[0];
		 edt_ReceiptName .Text = retValue[1];
		 edt_ReceiptTeam .Text = retValue[3];	 
	 } 
}

//-------------------------------------------------------------------------------
// 함수명   : btn_BizCd()
// 설명     : 거래처코드 팝업
// return 내용 : 없음
//-------------------------------------------------------------------------------
function btn_BizCd_OnClick(obj)
{
	var retValue = gfn_E5_CodePopup("","","DEAL_CD"); 
	
	if(length(retValue) > 0)
	{
		edt_DEAL_CD.Text=retValue[0]; 
		edt_DEAL_NM.Text=retValue[1];	 
	}
}

/*===============================================================================
 * 전표처리
===============================================================================*/ 
//--------------------------------------------------------------------------------------------------
//	전표등록 버튼 클릭시
//--------------------------------------------------------------------------------------------------
function btn_bill_OnClick(obj)
{	
	// 1 : 미수금 2 : 미수금 대체 3 : 예수금 대체
	
	if(obj == btn_Bill)
	{ 
		// 미수금 전표 버튼
		str_Bill_Flag = 1;
		
		fv_Bill_YMD = cal_BillYmd.Value;
	}
	else if(obj == btn_BillReg)
	{	
	
		var str_First = rdo_FIRST_MOVE_DOCU.Value;
		
		//alert(length(cal_BILL_YMD_3.value));
		//if(str_First == 0){ // 선공사일 경우임
		//미수금전표 발행여부로 미수금 대체 및 예수금 대체 전표처리 2010.06.30권기철
		if(length(cal_BILL_YMD_3.value) > 0)
		{
			str_Bill_Flag = 2;
		}else{
			str_Bill_Flag = 3;
		}
		
		fv_Bill_YMD = cal_BillYmdReg.Value;
	}

	//-------------------------------------------------------------------------------
	// 함수명   : btn_bill_OnClick()
	// 설명     : 저장 트렌젝션을 처리 fn_E4_CallBack으로 결과를 넘김.
	// return 내용 : 없음
	//-------------------------------------------------------------------------------	
	
	// 2009-12-21 마감체크 추가 
	var strComId = gfn_GetGlobalValue("G_COM_ID");
	var strBizplc = gfn_GetGlobalValue("G_BIZPLACE");
	var strClsYmd = fv_Bill_YMD;
	var massageYn = "Y";
	
	var Result  = gfn_E5_checkClsYn( strComId , strBizplc , strClsYmd , massageYn);
	
	if(Result == "1")
	{
		return;
	}
	
	if(!fn_D1_PreBill(str_Bill_Flag))
	{
		return false;
	}	
		
	var strSvcID = "btn_bill_OnClick";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_AutoBillCreateMgr-service";
	var strInDatasets   = "ds_Multi=ds_BillDetail:u ds_Single=ds_BillHeader:u";
	var strOutDatasets  = "ds_BillDetail2=ds_Multi ds_BillHeader=ds_Single";
	var strArgument     = "insert=1";
	var strCallbackFunc = "fn_D1_CallBack";
	
	gfn_AsyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument,
	              strCallbackFunc
	              );	
	
	if(ErrorCode < 0)
	{    
		return false;
	}
	
	return true;
		
}
//--------------------------------------------------------------------------------------------------
//	
//--------------------------------------------------------------------------------------------------
function fn_D1_PreBill(str_Bill_Flag)
{     
    var ccnt  = 0;
	
	if(str_Bill_Flag == 1)
	{
		if(
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_CR" )) ||
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR1")) ||
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR2")) ||
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR3")) ||
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR4")) ||
			gfn_IsNull(ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR5"))
		){
			alert("전표 계정코드 데이터가 없습니다. ");
			return false;
		}
	}else{	
		if(ds_MoveDocuU.GetRowType(0) == 'update'){
			alert("변경된 데이터를 저장 후 전표를 발행하세요. ");
			return;		
		}
		
		if(cal_RECEIPT_YMD.Value == '' ||  cal_RECEIPT_YMD.Value = null){
			alert("입금일자는 필수입력사항입니다. ");
			return false;
		}
		
		/*
		if(edt_RESULT_AMT.Value != edt_RECEIPT_AMT.Value){
			alert("청구금액과 입금금액이 동일한 경우에만 전표 발행이 가능합니다. ");
			return false;
		}
		*/
	}
	
	if(fv_Bill_YMD == '' ||  fv_Bill_YMD = null){
			alert("전표발행일자를 지정하세요. ");
			return false;
	}
	
	if(!gfn_IsNull(ds_MoveDocuV.GetColumn(0,"BILL_YMD_1"))){
			alert("이미 전표생성된 자료입니다");
			return false;	
	}
		
	fn_D1_MakeBillData(str_Bill_Flag);
	return true;
}
//--------------------------------------------------------------------------------------------------
//	
//--------------------------------------------------------------------------------------------------
function fn_D1_MakeBillData(str_Bill_Flag)
{

	var comId		= gfn_GetGlobalValue("G_COM_ID"  );
	var bizplcCd 	= gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  	= fv_Bill_YMD;
	var billSeq  	= fn_D1_Tr_getBillSeq (comId,bizplcCd,billYmd);
	
	fn_D1_MakeBillDetail(comId,bizplcCd,billYmd,billSeq, str_Bill_Flag);
    fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq, str_Bill_Flag);
}
//-------------------------------------------------------------------------------
// 함수명   : fn_D1_getBillSeq(ComId,bizplcCd,billYmd)
// 설명     : 전표번호를 리턴.
// return 내용 : 4자리 문자형태의 전표번호 
//-------------------------------------------------------------------------------
function fn_D1_Tr_getBillSeq(ComId,bizplcCd,billYmd)
{	
	ds_Com.ClearData();
		
	var strSvcID = "fn_D1_Tr_find";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_NonBillCreateMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Com=ds_Multi";
	var strArgument     = "seqSelect=1";
        strArgument    += " COM_ID="	+ quote(ComId);			//회사구분
	    strArgument    += " BIZPLC_CD="	+ quote(bizplcCd);		//사업장코드
	    strArgument    += " NUMB_YMD=" 	+ quote(billYmd);		//전표일자
	    strArgument    += " NUMB_FLAG=" + "10";			
	             
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	              
	if (  ErrorCode < 0 )
	{
		alert(ErrorCode);
		return false;
		
	}else{
		if(ds_Com.RowCount()==0)
		{
			return "0001";	
		}
		else
		{
			return ds_Com.GetColumn(0,"BILL_SEQ");
		}
	}
}
//---------------------------------------------------------
//	
//---------------------------------------------------------
function fn_D1_MakeBillDetail(strComId,strBizplcCd,strBillYmd,strBillSeq,strBillFlag)
{
	ds_BillDetail.ClearData();  // 데이터셋 초기화
	
	var EVIDENCE_FLAG    = '';	// 증빙구분
	var BUY_SALES_VAT_CD = '';
	
	var str_BranchCd = ds_MoveDocuV.GetColumn(0, "BRANCH_CD");
	
	trace("fn_D1_MakeBillDetail:strBillFlag:"+strBillFlag);
	
	if(strBillFlag == 1)
	{ 
		// 미수금전표
	
		var str_ACNT_TITACNT_CD_CR   = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_CR" ); // A16199  (미수금)		
		var str_ACNT_TITACNT_CD_DR   = "";				
		var str_ACNT_TITACNT_CD_DR1  = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_DR5"); // J33534  (예수금 부가세)			
				
		if(str_BranchCd == '100664'){ // 감북
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_DR1"); // J3359877 (예수금 - 강북지사)
		
		}else if(str_BranchCd == '100584'){ // 서부
			
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_DR2"); // J3359833 (예수금 - 서부지사)
		
		}else if(str_BranchCd == '100591'){ // 남부
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_DR3"); // J3359844 (예수금 - 남부지사)
	
		}else if(str_BranchCd == '101500'){ // 경기
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD.GetColumn(0, "ACNT_TITACNT_CD_DR4"); // J3359811 (예수금 - 경기지사)
		}
		
		var str_Original_Price  = edt_RESULT_AMT.Value; // 청구금액
	    var str_Vat_Price       = edt_VAT.Value;     // 부가세
	    var str_Price           = edt_REQ_AMT.Value; // 공급가액
						
		//-------------------------------------------------------------------------------
		//공통(차변) -- 미수금 A16199
		gfn_E5_DatasetAddRow(ds_BillDetail);
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0001"     );			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,str_ACNT_TITACNT_CD_CR);											   //계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"1"        );													       //차변
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																	   + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Original_Price			   );	     						   //미승인전표금액(청구금액)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			                   );				                   //부가세사업장
		//공통(차변)
		//계정별관리항목에서 가져오는 선택값(차변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(차변) END
		//-------------------------------------------------------------------------------
		
		//-------------------------------------------------------------------------------											
		// 공통(대변) -- 예수금 지사별
		gfn_E5_DatasetAddRow(ds_BillDetail);
					
		ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId              );	 //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd           );	 //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd            );    //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq            );    //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0002"                );	 //전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                   );	 //대변으로 세팅
		ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", str_ACNT_TITACNT_CD_DR);	 //계정코드		
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																	  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,""		                       );	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Price 				   );
		//공통(대변)
		//계정별관리항목에서 가져오는 선택값(대변: 예수금통장지사) START
		 ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"  ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		 ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"    ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(대변: 예수금통장지사) END
		//-------------------------------------------------------------------------------
		
		//-------------------------------------------------------------------------------											
		// 공통(대변) -- 예수금 부가세 : J33534
		gfn_E5_DatasetAddRow(ds_BillDetail);
					
		ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId               );	 //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd            );	 //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd             );    //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq             );    //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0003"                 );	 //전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                    );	 //대변으로 세팅
		ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", str_ACNT_TITACNT_CD_DR1);	 //계정코드		
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																	  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,"1098131605"                     );	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Vat_Price				   );
		//공통(대변)
		//계정별관리항목에서 가져오는 선택값(대변: 예수금 부가세) START
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG"  )); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"    )); // 101 거래처
			 
			  if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '10'){ EVIDENCE_FLAG = '01';}
		 else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '20'){ EVIDENCE_FLAG = '09';}
		 else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '30'){ EVIDENCE_FLAG = '02';}
		
			  // if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '10'){ BUY_SALES_VAT_CD = '11';}
		 // else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '20'){ BUY_SALES_VAT_CD = '50';}
		 // else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '30'){ BUY_SALES_VAT_CD = '12';}	
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"      , EVIDENCE_FLAG                         ); // 증빙구분(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"   , 11                        			   ); //
		ds_BillDetail.SetColumn(ds_BillDetail.row,"SALES_VAT_CLASS_CD" , 602                       			   ); // 매출부가세분류코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"         , cal_ReceiptYmd.Value                    ); // 거래일자(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"  , str_Price 			        		   ); // 원금액/공급가액(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"QTY_PERS"         , "1"                                     ); // 수량/인원(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"		     , "400"								   ); // 단위(필수)
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CHG_TAX_YN"		 , "N"								       ); // 수정세금계산서 여부항목
		
		
		//계정별관리항목에서 가져오는 선택값(대변: 원인자이설비부가세) END										
		//-------------------------------------------------------------------------------			
	
	}
	else if(strBillFlag == 2)
	{ 
		// 미수금 대체 전표
				
		var str_ACNT_TITACNT_CD_CR   = "";
		var str_ACNT_TITACNT_CD_DR   = ds_ACNT_CD1.GetColumn(0, "ACNT_TITACNT_CD_DR" ); // A16199  (미수금)		   
		
		      if(str_BranchCd == '100664'){
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD1.GetColumn(0, "ACNT_TITACNT_CD_CR1"); // J3357777 (예수금 통장 - 강북지사)
		
		}else if(str_BranchCd == '100584'){
			
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD1.GetColumn(0, "ACNT_TITACNT_CD_CR2"); // J3357733 (예수금 통장 - 서부지사)
		
		}else if(str_BranchCd == '100591'){
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD1.GetColumn(0, "ACNT_TITACNT_CD_CR3"); // J3357744 (예수금 통장 - 남부지사)
	
		}else if(str_BranchCd == '101500'){ // 경기
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD1.GetColumn(0, "ACNT_TITACNT_CD_CR4"); // J3357711 (예수금 통장 - 경기지사)
		}
		
		var str_Original_Price  = edt_RESULT_AMT.Value;	 // 청구금액					
		var str_RECEIPT_AMT		= edt_RECEIPT_AMT.Value; // 입금액
		
	    // 입금금액이 많으면 이익 , 적으면 손실
	    // 대변-V5119441(잡이익) / 차변-V5246914(잡손실) =  입금금액 - 청구금액
	    var str_Diff_Price = parseFloat(edt_RECEIPT_AMT.Value) - parseFloat(edt_RESULT_AMT.Value);  // 잡이익 및 잡손실
	    
		//-------------------------------------------------------------------------------
		//공통(차변) -- 예수금 통장 지사별
		gfn_E5_DatasetAddRow(ds_BillDetail);
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0001"     );			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,str_ACNT_TITACNT_CD_CR);											   //계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"1"        );													       //차변
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																			+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_RECEIPT_AMT   			   );	     						   //미승인전표금액(청구금액)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			                   );				                   //부가세사업장
		//공통(차변)
		//계정별관리항목에서 가져오는 선택값(차변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(차변) END
		//-------------------------------------------------------------------------------
		
		//-------------------------------------------------------------------------------
		//공통(대변) -- 미수금 A16199
		gfn_E5_DatasetAddRow(ds_BillDetail);
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0002"     );			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,str_ACNT_TITACNT_CD_DR);											   //계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"2"        );													       //차변
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																			+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Original_Price			   );	     						   //미승인전표금액(청구금액)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			                   );				                   //부가세사업장
		//공통(대변)
		//계정별관리항목에서 가져오는 선택값(대변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(대변) END
		//-------------------------------------------------------------------------------		
		
		
		if(str_Diff_Price > 0)
		{
			
			//-------------------------------------------------------------------------------											
			// 공통(대변) -- 대변-V5119441(잡이익)
			gfn_E5_DatasetAddRow(ds_BillDetail);
			ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId               );	 //회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd            );	 //사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd             );   //전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq             );   //전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0003"                 );	 //전표lINE
			ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                    );	 //대변으로 세팅
			ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", "V5119441");	 //계정코드		
			ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																		  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
			ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,""                    );	
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Diff_Price	);
			//공통(대변)
		}
		else if(str_Diff_Price < 0)
		{
		
			str_Diff_Price = eval(str_Diff_Price) * (-1);
			//-------------------------------------------------------------------------------
			//공통(차변) -- 차변-V5246914(잡손실)
			gfn_E5_DatasetAddRow(ds_BillDetail);
			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0003"     );			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,"V5246914");											   //계정코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"1"        );													       //차변
			ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																				+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Diff_Price	);	     						   //미승인전표금액(청구금액)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			    );				                   //부가세사업장
			//공통(차변)
		}		
		
		
	
	}else if(strBillFlag == 3){ // 예수금 대체 전표
		var str_ACNT_TITACNT_CD_CR   = "";
		var str_ACNT_TITACNT_CD_DR   = "";		
		var str_ACNT_TITACNT_CD_DR1   = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_DR5" ); // J33534  (예수금  - 부가세)
				
		      if(str_BranchCd == '100664'){
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_CR1"); // J3357777 (예수금 통장 - 강북지사)
		
		}else if(str_BranchCd == '100584'){
			
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_CR2"); // J3357733 (예수금 통장 - 서부지사)
		
		}else if(str_BranchCd == '100591'){
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_CR3"); // J3357744 (예수금 통장 - 남부지사)
	
		}else if(str_BranchCd == '101500'){ // 경기
		
			str_ACNT_TITACNT_CD_CR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_CR4"); // J3357711 (예수금 통장 - 경기지사)
		}
		
		if(str_BranchCd == '100664'){
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_DR1"); // J3359877  (예수금 - 강북지사)
		
		}else if(str_BranchCd == '100584'){
			
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_DR2"); // J3359833  (예수금 - 서부지사)
		
		}else if(str_BranchCd == '100591'){
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_DR3"); // J3359844  (예수금 - 남부지사)
	
		}else if(str_BranchCd == '101500'){// 경기
		
			str_ACNT_TITACNT_CD_DR = ds_ACNT_CD2.GetColumn(0, "ACNT_TITACNT_CD_DR4"); // J3359811  (예수금 - 경기지사)
		}		
		
		var str_Original_Price  = edt_RECEIPT_AMT.Value; // 청구금액
	    var str_Vat_Price       = edt_VAT.Value;         // 부가세 
	    var str_Price           = edt_REQ_AMT.Value;     // 공급가액
	    
	    // 입금금액이 많으면 이익 , 적으면 손실
	    // 대변-V5119441(잡이익) / 차변-V5246914(잡손실) =  입금금액 - 청구금액
	    var str_Diff_Price = parseFloat(edt_RECEIPT_AMT.Value) - parseFloat(edt_RESULT_AMT.Value);  // 잡이익 및 잡손실
		
		//-------------------------------------------------------------------------------
		//공통(차변) -- 예수금 통장 지사별
		gfn_E5_DatasetAddRow(ds_BillDetail);
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0001"     );			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,str_ACNT_TITACNT_CD_CR);											   //계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"1"        );													       //차변
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																			+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Original_Price			   );	     						   //미승인전표금액(청구금액)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			                   );				                   //부가세사업장
		//공통(차변)
		//계정별관리항목에서 가져오는 선택값(차변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(차변) END
		//-------------------------------------------------------------------------------
		
		//-------------------------------------------------------------------------------											
		// 공통(대변) -- 예수금 지사별
		gfn_E5_DatasetAddRow(ds_BillDetail);
					
		ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId              );	 //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd           );	 //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd            );    //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq            );    //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0002"                );	 //전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                   );	 //대변으로 세팅
		ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", str_ACNT_TITACNT_CD_DR);	 //계정코드		
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																	  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,""		                       );	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Price 				   );
		//공통(대변)
		//계정별관리항목에서 가져오는 선택값(대변: 예수금통장지사) START
		 ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"  ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG")); // 100 거래처구분
		 ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"    ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"  )); // 101 거래처
		//계정별관리항목에서 가져오는 선택값(대변: 예수금통장지사) END
		//-------------------------------------------------------------------------------
		
		//-------------------------------------------------------------------------------											
		// 공통(대변) -- 예수금 부가세 : J33534
		gfn_E5_DatasetAddRow(ds_BillDetail);
					
		ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId               );	 //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd            );	 //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd             );    //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq             );    //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0003"                 );	 //전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                    );	 //대변으로 세팅
		ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", str_ACNT_TITACNT_CD_DR1);	 //계정코드		
		ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																	  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,"1098131605"                     );	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Vat_Price				   );
		//공통(대변)
		//계정별관리항목에서 가져오는 선택값(대변: 예수금 부가세) START
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"      ,  ds_MoveDocuU.GetColumn(0, "DEAL_FLAG"  )); // 100 거래처구분
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"        ,  ds_MoveDocuU.GetColumn(0, "DEAL_CD"    )); // 101 거래처
			 
			  if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '10'){ EVIDENCE_FLAG = '01';}
		 else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '20'){ EVIDENCE_FLAG = '09';}
		 else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '30'){ EVIDENCE_FLAG = '02';}
		
			  // if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '10'){ BUY_SALES_VAT_CD = '11';}
		 // else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '20'){ BUY_SALES_VAT_CD = '50';}
		 // else if(ds_MoveDocuV.GetColumn(0, "EVIDENCE_YN") == '30'){ BUY_SALES_VAT_CD = '12';}	
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"      , EVIDENCE_FLAG                         ); // 증빙구분(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"   , 11                        			   ); //
		ds_BillDetail.SetColumn(ds_BillDetail.row,"SALES_VAT_CLASS_CD" , 602                       			   ); // 매출부가세분류코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"         , cal_RECEIPT_YMD.Value                    ); // 거래일자(필수)
		//alert(cal_RECEIPT_YMD.Value);
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"  , str_Price 					           ); // 원금액/공급가액(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"QTY_PERS"         , "1"                                     ); // 수량/인원(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"		     , "400"								   ); // 단위(필수)
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CHG_TAX_YN"		 , "N"								       ); // 수정세금계산서 여부항목
		//계정별관리항목에서 가져오는 선택값(대변: 원인자이설비부가세) END										
		//-------------------------------------------------------------------------------			
		
		if(str_Diff_Price > 0)
		{
			
			//-------------------------------------------------------------------------------											
			// 공통(대변) -- 대변-V5119441(잡이익)
			gfn_E5_DatasetAddRow(ds_BillDetail);
			ds_BillDetail.SetColumn(ds_BillDetail.row, "COM_ID"    , strComId               );	 //회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BIZPLC_CD" , strBizplcCd            );	 //사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_YMD"  , strBillYmd             );   //전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_SEQ"  , strBillSeq             );   //전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row, "BILL_LINE" , "0004"                 );	 //전표lINE
			ds_BillDetail.SetColumn(ds_BillDetail.row, "DRCR_FLAG" , "2"                    );	 //대변으로 세팅
			ds_BillDetail.SetColumn(ds_BillDetail.row, "TITACNT_CD", "V5119441");	 //계정코드		
			ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"     , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																		  + ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM")); //적요																																		
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));         
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE"));
			ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"   ,""                    );	
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Diff_Price	);
			//공통(대변)
		}
		else if(str_Diff_Price < 0)
		{
		
			str_Diff_Price = eval(str_Diff_Price) * (-1);
			//-------------------------------------------------------------------------------
			//공통(차변) -- 차변-V5246914(잡손실)
			gfn_E5_DatasetAddRow(ds_BillDetail);
			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           										       //회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         										       //사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            										       //전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            										       //전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,"0004"     );			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,"V5246914");											   //계정코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"1"        );													       //차변
			ds_BillDetail.SetColumn(ds_BillDetail.row, "APPLY"           , substr(ds_MoveDocuV.GetColumn(0, "BRANCH_NM"), 0, 2) + ', 원인자 이설비용 - '
																				+ ds_MoveDocuV.GetColumn(0, "MOVE_REPAIR_WORK_NM"));		   //적요
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_Diff_Price	);	     						   //미승인전표금액(청구금액)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"" 			    );				                   //부가세사업장
			//공통(차변)
		}
		
	}
}

function fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq,strBillFlag)
{
	//헤더추가
    ds_BillHeader.ClearData();

	if(strBillFlag == 1){ // 미수금전표
		gfn_E5_DatasetAddRow(ds_BillHeader);
		
		// 공통
		ds_BillHeader.SetColumn(ds_BillHeader.row,"COM_ID"    , comId   );  //회사구분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BIZPLC_CD" , bizplcCd);  //사업장
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_YMD"  , billYmd );  //전표일자 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_SEQ"  , billSeq );  //전표번호                        
		ds_BillHeader.SetColumn(ds_BillHeader.row,"APPRO_YN"  , "N"     );  //승인여부
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_WRITE_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE")); 
																			//입력부서코드
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_KIND" ,"1");        //전표종류 1:입금
		 // 공통
		
		 //변경되는부분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"SYS_FLAG"      ,"D1");              //시스템구분 D1:안전공급 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_FLAG"     ,"605");             //전표구분   000:수전표		
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_CRT_INFO" ,"D1702010010F");    //전표생성정보 D1702010010F : 전표등록프로그램
		ds_BillHeader.SetColumn(ds_BillHeader.row,"ACNT_FLAG"     ,'30'           );    //회계구분 3:공통         
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DEL_YN"        ,"N");               //삭제구분 
		//여기까지변경되는부분
	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"TOT_LN_NUM"  ,ds_BillDetail.rowcount		   ); //총행수
		ds_BillHeader.SetColumn(ds_BillHeader.row,"FINL_LN_NUM" ,ds_BillDetail.Max("BILL_LINE")); //최종행수	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DR_SUM_AMT"  ,edt_RESULT_AMT.Value                  ); //차변합계금액
		ds_BillHeader.SetColumn(ds_BillHeader.row,"CR_SUM_AMT"  ,edt_RESULT_AMT.Value				   ); //대변합계금액

	}else if(strBillFlag == 2){ // 미수금 대체 전표
		gfn_E5_DatasetAddRow(ds_BillHeader);
		
		// 공통
		ds_BillHeader.SetColumn(ds_BillHeader.row,"COM_ID"    , comId   );  //회사구분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BIZPLC_CD" , bizplcCd);  //사업장
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_YMD"  , billYmd );  //전표일자 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_SEQ"  , billSeq );  //전표번호                        
		ds_BillHeader.SetColumn(ds_BillHeader.row,"APPRO_YN"  , "N"     );  //승인여부
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_WRITE_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE")); 
																			//입력부서코드
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_KIND" ,"3");        //전표종류 1:입금
		 // 공통
		
		 //변경되는부분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"SYS_FLAG"      ,"D1");              //시스템구분   D1:안전공급 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_FLAG"     ,"606");             //전표구분     000:수전표		
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_CRT_INFO" ,"D1702010010F");    //전표생성정보 D1702010010F : 전표등록프로그램
		ds_BillHeader.SetColumn(ds_BillHeader.row,"ACNT_FLAG"     ,'30'           );    //회계구분 3:공통         
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DEL_YN"        ,"N");               //삭제구분 
		//여기까지변경되는부분
	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"TOT_LN_NUM"  ,ds_BillDetail.rowcount		   ); //총행수
		ds_BillHeader.SetColumn(ds_BillHeader.row,"FINL_LN_NUM" ,ds_BillDetail.Max("BILL_LINE")); //최종행수	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DR_SUM_AMT"  ,edt_RESULT_AMT.Value                  ); //차변합계금액
		ds_BillHeader.SetColumn(ds_BillHeader.row,"CR_SUM_AMT"  ,edt_RESULT_AMT.Value				   ); //대변합계금액
	}else{
		gfn_E5_DatasetAddRow(ds_BillHeader);
		
		// 공통
		ds_BillHeader.SetColumn(ds_BillHeader.row,"COM_ID"    , comId   );  //회사구분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BIZPLC_CD" , bizplcCd);  //사업장
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_YMD"  , billYmd );  //전표일자 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_SEQ"  , billSeq );  //전표번호                        
		ds_BillHeader.SetColumn(ds_BillHeader.row,"APPRO_YN"  , "N"     );  //승인여부
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_WRITE_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE")); 
																			//입력부서코드
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_KIND" ,"3");        //전표종류 1:입금
		 // 공통
		
		 //변경되는부분
		ds_BillHeader.SetColumn(ds_BillHeader.row,"SYS_FLAG"      ,"D1");              //시스템구분   D1:안전공급 
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_FLAG"     ,"401");             //전표구분     000:수전표		
		ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_CRT_INFO" ,"D1702010010F");    //전표생성정보 D1702010010F : 전표등록프로그램
		ds_BillHeader.SetColumn(ds_BillHeader.row,"ACNT_FLAG"     ,'30'           );    //회계구분 3:공통         
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DEL_YN"        ,"N");               //삭제구분 
		//여기까지변경되는부분
	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"TOT_LN_NUM"  ,ds_BillDetail.rowcount		   ); //총행수
		ds_BillHeader.SetColumn(ds_BillHeader.row,"FINL_LN_NUM" ,ds_BillDetail.Max("BILL_LINE")); //최종행수	
		ds_BillHeader.SetColumn(ds_BillHeader.row,"DR_SUM_AMT"  ,edt_RESULT_AMT.Value                  ); //차변합계금액
		ds_BillHeader.SetColumn(ds_BillHeader.row,"CR_SUM_AMT"  ,edt_RESULT_AMT.Value				   ); //대변합계금액	
	}
}

//--------------------------------------------------------------------------------------------------
//	전표취소 버튼 클릭시
//--------------------------------------------------------------------------------------------------
function btn_BillDel_OnClick(obj)
{
    // 1 : 미수금 2 : 미수금 대체 3 : 예수금 대체
	if(obj == btn_BillDel){ // 미수금 전표 버튼
		str_Bill_Flag = 1;
	}
	
	if(obj == btn_BillRegDel){	
		var str_First = rdo_FIRST_MOVE_DOCU.Value;
		
		if(str_First == 0){ // 선공사일 경우임
			str_Bill_Flag = 2;
		}else{
			str_Bill_Flag = 3;
		}
	}
        
    if(!confirm("발행된 전표를를 정말로 취소하시겠습니까? ")){
		return false;
	}
	
	fn_D1_billDelete(str_Bill_Flag);
	
	return true;           
}

function fn_D1_billDelete(str_Bill_Flag){
	
	var comId		= gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd 	= gfn_GetGlobalValue("G_BIZPLACE");
    
	ds_BillDelete.ClearData();
	
	ds_BillDelete.AddColumn("COM_ID"    	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("BIZPLC_CD"    	   , "STRING"   , 256);	
	ds_BillDelete.AddColumn("BILL_YMD"     	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("BILL_SEQ"     	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("SYS_FLAG"     	   , "STRING"   , 256);

	ds_BillDelete.AddRow();
	
	if(str_Bill_Flag != 1){
		if(gfn_IsNull(trim(ds_MoveDocuV.GetColumn(0,"BILL_YMD_1")))){
			alert("전표가 발행되지 않아 취소 할 수 없습니다.");
			return;
		}else if(ds_MoveDocuV.GetColumn(0,"BILL_APPRO_YN_1") == '1'){
			alert("전표가 승인되어] 취소 할 수 없습니다");
			return;
		}else{		
			ds_BillDelete.SetColumn(ds_BillDelete.row,"COM_ID"    , comId);         							//회사구분
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BIZPLC_CD" , bizplcCd);         							//사업장
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_YMD"  , ds_MoveDocuV.GetColumn(0,"BILL_YMD_1"));	//전표일자 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_SEQ"  , ds_MoveDocuV.GetColumn(0,"BILL_SEQ_1"));	//전표번호 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"SYS_FLAG"  ,"D1");   									//지급여부
		}		
	}else{
		if(gfn_IsNull(trim(ds_MoveDocuV.GetColumn(0,"BILL_YMD_3")))){
			alert("전표가 발행되지 않아 취소 할 수 없습니다.");
			return;
		}else if(ds_MoveDocuV.GetColumn(0,"BILL_APPRO_YN_3") == '1'){
			alert("전표가 승인되어 취소 할 수 없습니다. ");
			return;
		}else{		
			ds_BillDelete.SetColumn(ds_BillDelete.row,"COM_ID"    , comId);         							//회사구분
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BIZPLC_CD" , bizplcCd);         							//사업장
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_YMD"  , ds_MoveDocuV.GetColumn(0,"BILL_YMD_3"));	//전표일자 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_SEQ"  , ds_MoveDocuV.GetColumn(0,"BILL_SEQ_3"));	//전표번호 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"SYS_FLAG"  ,"D1");   									//지급여부
		}
	}
	
	var strSvcID = "fn_D1_Tr_delete";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_AutoBillCreateMgr-service&delete=1";	 
	var strInDatasets   = "ds_Single=ds_BillDelete:u ";
	var strOutDatasets  = "";
	var strArgument     = "";
	var strCallbackFunc = "fn_D1_CallBack";	
	
	gfn_AsyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument,
	              strCallbackFunc
	);
	
	if(ErrorCode<0)
	{
		return false;
	}
		return true;
}

function fn_D1_billUpdate(value)
{
		var Flag = value;
		
		ds_Modify.ClearData();
		
		var USER_ID = gfn_GetGlobalValue("G_USER_NO")  ;            // SESSION ID
		var USER_IP = gfn_GetGlobalValue("G_IPADDRESS");            // SESSION IP
		
		if(str_Bill_Flag == 1){ // 1 : 미수금 
		
			ds_Modify.AddColumn("UPD_EMPID"		     );
			ds_Modify.AddColumn("UPD_IP"	         );
			ds_Modify.AddColumn("BILL_APPRO_YN_3"    );
			ds_Modify.AddColumn("BILL_YMD_3"	     );
			ds_Modify.AddColumn("BILL_SEQ_3"	     );
			ds_Modify.AddColumn("TXBILL_VAT_BIZPLC_3");
			ds_Modify.AddColumn("TXBILL_PUBL_YM_3"   );
			ds_Modify.AddColumn("TXBILL_PUBL_SEQ_3"  );
			ds_Modify.AddColumn("MOVE_REPAIR_NUM"    );
			
			ds_Modify.UpdateControl = false;
				
			ds_Modify.AddRow();
			
			ds_Modify.SetColumn(ds_Modify.row, "UPD_EMPID"      , USER_ID);
			ds_Modify.SetColumn(ds_Modify.row, "UPD_IP"         , USER_IP);
	
			if(Value =='update'){
				ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN_3", 'N' );
				ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD_3"         , ds_BillDetail2.GetColumn(0, "BILL_YMD"    ));
				ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ_3"         , ds_BillDetail2.GetColumn(0, "BILL_SEQ"    ));
				
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC_3", ds_BillDetail2.GetColumn(2, "VAT_BIZPLC"  ));
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM_3"   , ds_BillDetail2.GetColumn(2, "PUBL_YM"     ));
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ_3"  , ds_BillDetail2.GetColumn(2, "PUBL_SEQ"    ));
			}else{
				ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN_3"    , '');
				ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD_3"         , '');
				ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ_3"         , );
				
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC_3", '');
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM_3"   , '');
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ_3"  , '');
			}
		}else{// 2 : 미수금 대체 3 : 예수금 대체
			
			ds_Modify.AddColumn("UPD_EMPID"		     );
			ds_Modify.AddColumn("UPD_IP"	         );
			ds_Modify.AddColumn("BILL_APPRO_YN_1"    );
			ds_Modify.AddColumn("BILL_YMD_1"	     );
			ds_Modify.AddColumn("BILL_SEQ_1"	     );
			ds_Modify.AddColumn("TXBILL_VAT_BIZPLC_1");
			ds_Modify.AddColumn("TXBILL_PUBL_YM_1"   );
			ds_Modify.AddColumn("TXBILL_PUBL_SEQ_1"  );
			ds_Modify.AddColumn("MOVE_REPAIR_NUM"    );
			
			ds_Modify.UpdateControl = false;
				
			ds_Modify.AddRow();
			
			ds_Modify.SetColumn(ds_Modify.row, "UPD_EMPID"      , USER_ID);
			ds_Modify.SetColumn(ds_Modify.row, "UPD_IP"         , USER_IP);
					
			if(Value = 'update'){
				ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN_1", 'N' );
				ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD_1"         , ds_BillDetail2.GetColumn(0, "BILL_YMD"    ));
				ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ_1"         , ds_BillDetail2.GetColumn(0, "BILL_SEQ"    ));
				
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC_1", ds_BillDetail2.GetColumn(2, "VAT_BIZPLC"  ));
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM_1"   , ds_BillDetail2.GetColumn(2, "PUBL_YM"     ));
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ_1"  , ds_BillDetail2.GetColumn(2, "PUBL_SEQ"    ));
			}else{
				ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN_1"    , '');
				ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD_1"         , '');
				ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ_1"         , );
				
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC_1", '');
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM_1"   , '');
				ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ_1"  , '');
			}
		}
				
		ds_Modify.SetColumn(ds_Modify.row, "MOVE_REPAIR_NUM", ds_MoveDocu.GetColumn(ds_MoveDocu.row, "MOVE_REPAIR_NUM"));		
		ds_Modify.SetRowType(ds_Modify.row, "update");
		
		fv_FindRow_ShowRow = 1;
		fv_FindRow_ShowKey = ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "MOVE_REPAIR_NUM");     //KEY번호
		
		var strSvcID         = "";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1_MoveingRepairRequeMgr-service" ;					
		var strInDatasets    = "ds_Modify=ds_Modify:u";
		var strOutDatasets   = "";		
		var strArgument      = "";
		
		if(str_Bill_Flag == 1){ // 1 : 미수금
			strArgument      = "bill_2update";  
		}else{
			strArgument      = "bill_1update";
		}
				
		gfn_SyncCall( 
						 strSvcID
					   , strPart  	 
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );

	if(ErrorCode<0)
	{
		return false;
	}
		return true;
	
}

function fn_D1_CallBack(svcId, ErrorCode, ErrorMsg)
{    
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_CallBack(svcid, errcd, errmsg)
	// 설명     : 각 트렌젝션의 결과를 처리 .
	// return 내용 : 없음
	//-------------------------------------------------------------------------------
	if ( ErrorCode <0 )
	{
		alert(ErrorMsg);
		return;
	}
	switch(svcId){	
	    case "fn_D1_Tr_find":	    
			//조회 성공메세지 출력
			if (ds_Receipt.RowCount() > 0) {
				gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true);				//"조회를 완료하였습니다."
			} else {
				gfn_SetStatusMsg(gfn_GetMessage("M000008","%AAA%","조회결과 데이터가"),"black",true);	//"조회결과데이터가없습니다."
			}
			break;	
			
			
		case "btn_bill_OnClick":

			if(ErrorMsg == "SUCC"){
				alert("전표가 정상적으로 발행되었습니다. ");			
				fn_D1_billUpdate("update"); 
				cal_BillYmd.Value = "";
				cal_BillYmdReg.Value = "";
				fv_Bill_YMD = "";
				fn_CommonSearch();
				
				
			}else{
				alert("전표를 정상적으로 발행하지 못했습니다. ");			
			}
						
			break;	
			
		case "fn_D1_Tr_delete": //업데이트 성공시 조회가 들어가므로 조회와 똑같이 처리 
			alert("전표가 정상적으로 취소되었습니다");
			fn_D1_billUpdate("delete"); 			
			fn_CommonSearch();
			break;							
	}
}

function Calendar4_OnChanged(obj,strOldText,strNewText)
{ 
	fn_DateCheckTodayGrid(Calendar4, "조치일자"); 
}

function cal_BILL_YMD_OnChanged(obj,strOldText,strNewText)
{ 
	fn_DateCheckTodayOver(cal_BILL_YMD, "예수금전표"); 
}

function cal_BILL_YMD_1_OnChanged(obj,strOldText,strNewText)
{ 
	fn_DateCheckTodayOver(cal_BILL_YMD_1, "예수금대체전표"); 
}

function cal_TXBILL_PUBL_YM_1_OnChanged(obj,strOldText,strNewText){ 														
	if (substr(obj.Value, 0, 6) < substr(today(), 0, 6)) 
	{	
		alert("세금계산서 년월이 현재 년월보다 작습니다. ");
		obj.SetFocus();		
		return false;
	}
	return true;
}


function ds_MoveDocuU_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex){
	/*
	if(strColumnID == 'RECEIPT_YMD'){
		fn_DateCheckTodayOver(cal_ReceiptYmd, "입금일자");
	}
	*/
}



// 예수금 대체 세금 계산서
function fn_E5_print()
{
	ds_ReportList.ClearData();
	
	var comId = gfn_GetGlobalValue("G_COM_ID");
	
	var vatBizplc      = ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_VAT_BIZPLC_1");  //발행순번      
	var publYm         = substr(ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_PUBL_YM_1"), 0, 6);  //발행년월          
	var publSeq        = ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_PUBL_SEQ_1"  );  //발행순번  
	
	var strTitle     ; 				// 출력물 제목
    var strPart      ;        		// 시스템 명 
	var strReport    ; 				// 출력물 ID 
	var strParameter ;      		// 파라미터구문 (단 ',' 로구분할것 )	
	var selChk       ;
	var reportNm     ;
	var reportId     ;
	
	ds_ReportList.addRow();
	
	//각 파라미터 세팅 
	strTitle= vatBizplc+"-"+publYm +"-"+publSeq ;  	    // 출력물 제목
	
	//strTitle="미승인 전표출력";
	strPart   = "E50";           		// 시스템 명 
	strReport = "E5301010010P" ;    	// 출력물 ID 			
		            
	strParameter =  "COM_ID="     + comId     
	             + ",VAT_BIZPLC=" + vatBizplc      
				 + ",PUBL_YM="    + publYm 
				 + ",PUBL_SEQ="   + publSeq 
				 ;          			// 파라미터구문 (단 ',' 로구분할것 )
	
	ds_ReportList.SetColumn(ds_ReportList.row, "SYSTEM_ID",strPart);     	// 시스템 명 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ID",strReport);  	// 출력물 ID 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ARGS",strParameter); // 파라미터구문 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_TITLE",strTitle);   	// 출력물 제목

	gfn_MultiReportPopup("세금계산서출력",ds_ReportList, "true");
}

// 미수금 세금계산서
function fn_E5_print1()
{
	ds_ReportList.ClearData();
	
	var comId = gfn_GetGlobalValue("G_COM_ID");
	
	var vatBizplc     = ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_VAT_BIZPLC_3");  //발행순번      
	var publYm        = substr(ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_PUBL_YM_3"), 0, 6);  //발행년월          
	var publSeq       = ds_MoveDocuV.GetColumn(ds_MoveDocuV.row, "TXBILL_PUBL_SEQ_3"  );  //발행순번  
	
	var strTitle     ; 				// 출력물 제목
    var strPart      ;        		// 시스템 명 
	var strReport    ; 				// 출력물 ID 
	var strParameter ;      		// 파라미터구문 (단 ',' 로구분할것 )	
	var selChk ;
	var reportNm;
	var reportId;
	
	ds_ReportList.addRow();
	
	//각 파라미터 세팅 
	strTitle= vatBizplc+"-"+publYm +"-"+publSeq ;  	    // 출력물 제목
	
	//strTitle="미승인 전표출력";
	strPart   = "E50";           	// 시스템 명 
	strReport = "E5301010010P" ;    // 출력물 ID 			
		            
	strParameter =  "COM_ID="     + comId     
	             + ",VAT_BIZPLC=" + vatBizplc      
				 + ",PUBL_YM="    + publYm 
				 + ",PUBL_SEQ="   + publSeq 
				 ;          			
	
	ds_ReportList.SetColumn(ds_ReportList.row, "SYSTEM_ID",strPart);     	// 시스템 명 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ID",strReport);  	// 출력물 ID 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ARGS",strParameter); // 파라미터구문 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_TITLE",strTitle);   	// 출력물 제목

	gfn_MultiReportPopup("세금계산서출력",ds_ReportList, "true");
}



function fn_E5_print2(obj)
{
	ds_ReportList.ClearData();
	
	var comId    = gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd = gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  = cal_BILL_YMD_3.Value;
	var billSeq  = edt_BILL_SEQ_3.text;
		
	var strTitle ;  				// 출력물 제목
    var strPart  ;          		// 시스템 명 
	var strReport ;  				// 출력물 ID 
	var strParameter ;      		// 파라미터구문 (단 ',' 로구분할것 )	
	var selChk ;
	var reportNm;
	var reportId;
	
	ds_ReportList.addRow();
	
	//각 파라미터 세팅 
	strTitle  = bizplcCd+"-"+billYmd+"-"+billSeq;  	    // 출력물 제목
	//strTitle="미승인 전표출력";
	strPart   = "E50";           	// 시스템 명 
	strReport = "E5102010010P" ;    // 출력물 ID 			
		            
	strParameter = "COM_ID=" + comId     
				 + ",BIZPLC_CD=" + bizplcCd
				 + ",BILL_YMD=" + billYmd 
				 + ",BILL_SEQ=" + billSeq 
				 ;        			// 파라미터구문 (단 ',' 로구분할것 )
	
	//gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
	ds_ReportList.SetColumn(ds_ReportList.row,"SYSTEM_ID",strPart);     	// 시스템 명 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ID",strReport);  	// 출력물 ID 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ARGS",strParameter); // 파라미터구문 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_TITLE",strTitle);   	// 출력물 제목

	gfn_E5_MultiReportPopup("미승인 전표출력",ds_ReportList, "true");
}

function Button11_OnClick(obj)
{
	ds_ReportList.ClearData();
	
	var comId=gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd = gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  = cal_BILL_YMD.Value;
	var billSeq  = edt_BILL_NUM.text;
	
	
	var strTitle ;  				// 출력물 제목
    var strPart  ;          		// 시스템 명 
	var strReport ;  				// 출력물 ID 
	var strParameter ;      		// 파라미터구문 (단 ',' 로구분할것 )	
	var selChk ;
	var reportNm;
	var reportId;
	
	ds_ReportList.addRow();
	
	//각 파라미터 세팅 
	strTitle  = bizplcCd+"-"+billYmd+"-"+billSeq;  	    // 출력물 제목
	//strTitle="미승인 전표출력";
	strPart   = "E50";           	// 시스템 명 
	strReport = "E5102010010P" ;    // 출력물 ID 			
		            
	strParameter = "COM_ID=" + comId     
				 + ",BIZPLC_CD=" + bizplcCd
				 + ",BILL_YMD=" + billYmd 
				 + ",BILL_SEQ=" + billSeq 
				 ;        			// 파라미터구문 (단 ',' 로구분할것 )
	
	//gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
	ds_ReportList.SetColumn(ds_ReportList.row,"SYSTEM_ID",strPart);     	// 시스템 명 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ID",strReport);  	// 출력물 ID 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ARGS",strParameter); // 파라미터구문 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_TITLE",strTitle);   	// 출력물 제목

	gfn_E5_MultiReportPopup("미승인 전표출력",ds_ReportList, "true");
}

function Button12_OnClick(obj)
{
	ds_ReportList.ClearData();
	
	var comId=gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd = gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  = cal_BILL_YMD_1.Value;
	var billSeq  = edt_BILL_SEQ_1.text;
		
	var strTitle ;  				// 출력물 제목
    var strPart  ;          		// 시스템 명 
	var strReport ;  				// 출력물 ID 
	var strParameter ;      		// 파라미터구문 (단 ',' 로구분할것 )	
	var selChk ;
	var reportNm;
	var reportId;
	
	ds_ReportList.addRow();
	
	//각 파라미터 세팅 
	strTitle  = bizplcCd+"-"+billYmd+"-"+billSeq;  	    // 출력물 제목
	//strTitle="미승인 전표출력";
	strPart   = "E50";           	// 시스템 명 
	strReport = "E5102010010P" ;    // 출력물 ID 			
		            
	strParameter = "COM_ID=" + comId     
				 + ",BIZPLC_CD=" + bizplcCd
				 + ",BILL_YMD=" + billYmd 
				 + ",BILL_SEQ=" + billSeq 
				 ;        			// 파라미터구문 (단 ',' 로구분할것 )
	
	//gfn_ReportPopup(strTitle,strPart,strReport,strParameter);
	ds_ReportList.SetColumn(ds_ReportList.row,"SYSTEM_ID",strPart);     	// 시스템 명 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ID",strReport);  	// 출력물 ID 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_ARGS",strParameter); // 파라미터구문 
	ds_ReportList.SetColumn(ds_ReportList.row, "REPORT_TITLE",strTitle);   	// 출력물 제목

	gfn_E5_MultiReportPopup("미승인 전표출력",ds_ReportList, "true");
}

//--------------------------------------------------------------------------------------------------
//	서비스 CallBack
//--------------------------------------------------------------------------------------------------
function fn_D1_Save_CallBack(SrvID,ErrorCode,ErrorMsg)
{

	if(ErrorCode < 0) {
	
		alert(ErrorMsg);
		
		//에러시 초기화
		fv_FindRow_ShowRow = -1;
		return;
	}
	
    switch(SrvID){
        
        
        case "svc_CommonSearch":
        
			// 로우선택하기
			if(fv_FindRow_ShowRow > 0)
			{
				var nFocusRow = ds_MoveDocu.FindRow("MOVE_REPAIR_NUM",fv_FindRow_ShowKey);
				if (nFocusRow != -1)
				{
					ds_MoveDocu.row = nFocusRow;
				}	
				fv_FindRow_ShowRow = -1;
			}
			st_Cnt.Value = 	ds_MoveDocu.GetRowCount();
			
			break;
        // 저장 
        case "CommonSave":
			alert(gfn_GetMessage("M000009", "%AAA%", "저장을"));
			fn_CommonSearch();
			break;

        default:

    }
}


function Button1_OnClick(obj)
{
	var strTitle    = "도관운영비 및 가스방출비 산출내역서" ;  		// 출력물 제목
    var strPart     = "D10" ;         	    		  				// 시스템 명 
	var strReport   = "D1702010010P" ;  	    	 				// 출력물 ID 
	var strParameter= "MOVE_REPAIR_NUM="     + replace(ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "MOVE_REPAIR_NUM"),"%$","")
				    + ",BASE_YEAR="		     + ds_MoveDocu.GetColumn(ds_MoveDocu.Row, "BASE_YEAR")
				    + ",PIPE_OPER_AMT="      + ds_MoveAdj.GetColumn(0, "PIPE_OPER_AMT");
				   
	//공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);	
}
]]></Script>
</Window>