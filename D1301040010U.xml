<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="376" Id="D1301040010U" Left="8" OnLoadCompleted="D1301040010U_OnLoadCompleted" OnUnloadCompleted="D1301040010U_OnUnloadCompleted" PidAttrib="7" Title="개선권고관리_D1301040010U" Top="8" Ver="1.0" Width="680" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_HouseImp1">
				<Contents>
					<colinfo id="INSPECT_YEAR" size="256" type="STRING"/>
					<colinfo id="INSPECT_FLAG" size="256" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_ADVICE_YMD" size="256" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" type="STRING"/>
					<colinfo id="UPD_IP" size="256" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" type="STRING"/>
					<colinfo id="CRT_IP" size="256" type="STRING"/>
					<colinfo id="WORK_FIRM" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_END_YMD" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_RSLT" size="256" type="STRING"/>
					<colinfo id="ACT_RSLT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HouseImp2">
				<Contents>
					<colinfo id="INSPECT_YEAR" size="256" type="STRING"/>
					<colinfo id="INSPECT_FLAG" size="256" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_ADVICE_YMD" size="256" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" type="STRING"/>
					<colinfo id="UPD_IP" size="256" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" type="STRING"/>
					<colinfo id="CRT_IP" size="256" type="STRING"/>
					<colinfo id="WORK_FIRM" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_END_YMD" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_RSLT" size="256" type="STRING"/>
					<colinfo id="ACT_RSLT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HouseImp3">
				<Contents>
					<colinfo id="INSPECT_YEAR" size="256" type="STRING"/>
					<colinfo id="INSPECT_FLAG" size="256" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_ADVICE_YMD" size="256" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" type="STRING"/>
					<colinfo id="UPD_IP" size="256" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" type="STRING"/>
					<colinfo id="CRT_IP" size="256" type="STRING"/>
					<colinfo id="WORK_FIRM" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_YMD" size="256" type="STRING"/>
					<colinfo id="BETTER_END_YMD" size="256" type="STRING"/>
					<colinfo id="RE_INSPECT_RSLT" size="256" type="STRING"/>
					<colinfo id="ACT_RSLT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HouseImpFlag">
				<Contents>
					<colinfo id="BETTER_ADVICE_YMD" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FileList">
				<Contents>
					<colinfo id="FILE_ID" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_NUM" size="256" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" type="STRING"/>
					<colinfo id="UPD_IP" size="256" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" type="STRING"/>
					<colinfo id="CRT_IP" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_FLAG" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_KIND" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_ID" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_NM" size="256" type="STRING"/>
					<colinfo id="ORIG_ATTACH_FILE_NM" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_PATH" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_SIZE" size="256" type="STRING"/>
					<colinfo id="ATTACH_FILE_TYPE" size="256" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" type="STRING"/>
					<colinfo id="USE_YN" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static5" Left="5" Style="table" TabOrder="57" Top="70" VAlign="Middle" Width="670" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="39" Id="Image0" ImageID="popup_top" LeftMargin="33" Style="popup_title" TabOrder="1" Text="개선권고관리" Transparent="TRUE" Width="680"></Image>
		<Button Cursor="HAND" Height="17" Id="Button1" ImageID="search" Left="-152" OnClick="Button8_OnClick" TabOrder="2" Text="Button8" Top="-134" Width="92"></Button>
		<Div Height="24" Id="Div0" TabOrder="3" Text="Div0" Top="39" Url="globals::ComButton.xml" Width="675">
			<Contents></Contents>
		</Div>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static62" Left="62" Style="table" TabOrder="9" Top="159" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static64" Left="62" Style="table" TabOrder="7" Top="180" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static65" Left="62" Style="table" TabOrder="8" Top="201" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static66" Left="5" LineSpacing="10" Style="table_1" TabOrder="4" Text="1차개선&#32;권고일" Top="159" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static68" Left="5" Style="table_1" TabOrder="6" Text="재검결과" Top="201" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static70" Left="5" Style="table_1" TabOrder="5" Text="개선&#32;완료일" Top="180" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static0" Left="228" Style="table_1" TabOrder="10" Text="시공업체" Top="180" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static1" Left="488" Style="table_1" TabOrder="11" Text="재검일자" Top="180" VAlign="Middle" Width="58" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_HouseImp1" Border="Flat" Column="ACT_RSLT" Height="18" Id="edt_ActRslt1" Left="326" MaxLength="30" Style="edit" TabOrder="12" Top="203" Width="345"></Edit>
		<Calendar BindDataset="ds_HouseImp1" Border="Flat" Column="BETTER_ADVICE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterAdviceYmd1" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="13" Top="161" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp1" Border="Flat" Column="BETTER_END_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterEndYmd1" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="14" Top="182" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp1" Border="Flat" Column="RE_INSPECT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReInspectYmd1" Left="549" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="15" Top="182" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static2" Left="228" Style="table_1" TabOrder="16" Text="조치결과" Top="201" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_HouseImp1" Border="Flat" Column="RE_INSPECT_RSLT" Height="18" Id="cob_ReInspectRslt1" Left="102" Style="combo" TabOrder="17" Top="202" Width="124"></Combo>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static4" Left="62" Style="table" TabOrder="19" Top="348" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="5" Style="table_1" TabOrder="18" Text="첨부파일" Top="348" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edtFileList1" Left="103" Style="edit" TabOrder="20" Top="350" Width="492"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="18" Id="Button23" ImageID="btn_4_fileadd" Left="596" LeftMargin="21" OnClick="Button5_OnClick" Style="button" TabOrder="21" Text="파일첨부&#32;" Top="350" Width="75"></Button>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static8" Left="62" Style="table" TabOrder="27" Top="222" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static10" Left="62" Style="table" TabOrder="25" Top="243" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static11" Left="62" Style="table" TabOrder="26" Top="264" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static12" Left="5" LineSpacing="10" Style="table_1" TabOrder="22" Text="2차개선&#32;권고일" Top="222" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static13" Left="5" Style="table_1" TabOrder="24" Text="재검결과" Top="264" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static14" Left="5" Style="table_1" TabOrder="23" Text="개선&#32;완료일" Top="243" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static15" Left="228" Style="table_1" TabOrder="28" Text="시공업체" Top="243" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static16" Left="488" Style="table_1" TabOrder="29" Text="재검일자" Top="243" VAlign="Middle" Width="58" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_HouseImp2" Border="Flat" Column="ACT_RSLT" Height="18" Id="edt_ActRslt2" Left="326" MaxLength="30" Style="edit" TabOrder="30" Top="266" Width="345"></Edit>
		<Calendar BindDataset="ds_HouseImp2" Border="Flat" Column="BETTER_ADVICE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterAdviceYmd2" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="31" Top="224" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp2" Border="Flat" Column="BETTER_END_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterEndYmd2" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="32" Top="245" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp2" Border="Flat" Column="RE_INSPECT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReInspectYmd2" Left="549" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="33" Top="245" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static19" Left="228" Style="table_1" TabOrder="34" Text="조치결과" Top="264" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_HouseImp2" Border="Flat" Column="RE_INSPECT_RSLT" Height="18" Id="cob_ReInspectRslt2" Left="101" Style="combo" TabOrder="35" Top="265" Width="125"></Combo>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static20" Left="62" Style="table" TabOrder="41" Top="285" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static21" Left="62" Style="table" TabOrder="39" Top="306" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static22" Left="62" Style="table" TabOrder="40" Top="327" VAlign="Middle" Width="613" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static23" Left="5" LineSpacing="10" Style="table_1" TabOrder="36" Text="공급중단일" Top="285" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static24" Left="5" Style="table_1" TabOrder="38" Text="재검결과" Top="327" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static25" Left="5" Style="table_1" TabOrder="37" Text="개선&#32;완료일" Top="306" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static26" Left="228" Style="table_1" TabOrder="42" Text="시공업체" Top="306" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static27" Left="488" Style="table_1" TabOrder="43" Text="재검일자" Top="306" VAlign="Middle" Width="58" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_HouseImp3" Border="Flat" Column="ACT_RSLT" Height="18" Id="edt_ActRslt3" Left="326" MaxLength="30" Style="edit" TabOrder="44" Top="329" Width="345"></Edit>
		<Calendar BindDataset="ds_HouseImp3" Border="Flat" Column="BETTER_ADVICE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterAdviceYmd3" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="45" Top="287" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp3" Border="Flat" Column="BETTER_END_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BetterEndYmd3" Left="103" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="46" Top="308" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar BindDataset="ds_HouseImp3" Border="Flat" Column="RE_INSPECT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReInspectYmd3" Left="548" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="47" Top="308" WeeksFont="Default,-1" Width="88"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static30" Left="228" Style="table_1" TabOrder="48" Text="조치결과" Top="327" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_HouseImp3" Border="Flat" Column="RE_INSPECT_RSLT" Height="18" Id="cob_ReInspectRslt3" Left="102" Style="combo" TabOrder="49" Top="328" Width="124"></Combo>
		<Edit BindDataset="ds_HouseImp1" Border="Flat" Column="WORK_FIRM" Enable="FALSE" Height="18" Id="edt_WorkFirm1" ImeMode="none" Left="326" Style="edit" TabOrder="50" Top="182" Width="141"></Edit>
		<Button Cursor="HAND" Height="17" Id="Button4" ImageID="search" Left="469" OnClick="Button4_OnClick" TabOrder="51" Text="Button8" Top="182" Width="17"></Button>
		<Edit BindDataset="ds_HouseImp2" Border="Flat" Column="WORK_FIRM" Enable="FALSE" Height="18" Id="edt_WorkFirm2" ImeMode="none" Left="326" Style="edit" TabOrder="52" Top="245" Width="141"></Edit>
		<Button Cursor="HAND" Height="17" Id="Button0" ImageID="search" Left="469" OnClick="Button0_OnClick" TabOrder="53" Text="Button8" Top="245" Width="17"></Button>
		<Edit BindDataset="ds_HouseImp3" Border="Flat" Column="WORK_FIRM" Enable="FALSE" Height="18" Id="edt_WorkFirm3" ImeMode="none" Left="326" Style="edit" TabOrder="54" Top="308" Width="141"></Edit>
		<Button Cursor="HAND" Height="17" Id="Button2" ImageID="search" Left="469" OnClick="Button2_OnClick" TabOrder="55" Text="Button8" Top="308" Width="17"></Button>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static6" Left="5" Style="table" TabOrder="56" Top="91" VAlign="Middle" Width="670" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static79" Left="5" Style="table_1" TabOrder="58" Text="주소" Top="91" VAlign="Middle" Width="104" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static71" Left="5" Style="table_1" TabOrder="59" Text="공동주택명" Top="70" VAlign="Middle" Width="104" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static76" Left="467" Style="table_1" TabOrder="60" Text="검사일자" Top="70" VAlign="Middle" Width="104" WordWrap="TRUE"></Static>
		<Static Align="Right" BKColor="white" Border="Flat" Height="22" Id="Static9" Left="108" Style="table" TabOrder="61" Top="70" VAlign="Middle" Width="360" WordWrap="TRUE"></Static>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_InspectYmd" Left="575" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="62" Top="72" WeeksFont="Default,-1" Width="96"></Calendar>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_CoLiveNm" Left="112" Style="edit" TabOrder="63" Top="72" Width="352"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_LotNumUnion" Left="112" Style="edit" TabOrder="64" Top="93" Width="559"></Edit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1301040010U.xml
* Form 설명  : 개선권고 관리를 등록 및 조회
* 시스템 명  : 안전공급 (D1)
* 작성자     : 김태화 
* 작성일     : 2008-12-31
* 변경내용   : 
****************************************************************************************************/

#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";

var strInspectYear = "";
var strFaciNum = "";
var strInspectYmd = "";
var strRstImp = 0;

function D1301040010U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
}

function fn_CommonPrint()
{
	PrintScreen(true);
}

//---------------------------------------------------------
//	초기 설정
//---------------------------------------------------------
function fn_Init()
{
	// 넘어온 파라메터가 있으면
	if(IsExistVar("INSPECT_YEAR"))
	{
		strInspectYear = INSPECT_YEAR;
	}
	if(IsExistVar("FACI_NUM"))
	{
		strFaciNum = FACI_NUM;
	}
	if(IsExistVar("INSPECT_YMD"))
	{
		strInspectYmd = INSPECT_YMD;
		cal_InspectYmd.Value = strInspectYmd;
	}
	if(IsExistVar("LOT_NUM_UNION"))
	{
		edt_LotNumUnion = LOT_NUM_UNION;
	}
	if(IsExistVar("CO_LIVE_NM"))
	{
		edt_CoLiveNm = CO_LIVE_NM;
	}
	
	fn_CommonSearch();
}


//---------------------------------------------------------
// 함수명: fn_CommonSearch()
//   설명: 개선권고관리 내용을 조회하는 함수
// arguments   
//   return 내용: 없음
//---------------------------------------------------------
function fn_CommonSearch()
{
		strRstImp = 0;
		fn_D1_SearchHouseImp();
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_HouseImp()
//   설명:  공동주택 개선권고내용을 조회한다.
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_SearchHouseImp()
{	
	++strRstImp;
	var strSvcID = "fn_D1_Find" +ToString(strRstImp) ;
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_BetterAdvicMangeMgr-service&INSPECT_YEAR="+strInspectYear+"&INSPECT_FLAG="+INSPECT_FLAG+"&FACI_NUM="+strFaciNum+"&INSPECT_YMD="+strInspectYmd+"&ROWNUM="+strRstImp;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_HouseImp" +ToString(strRstImp)+ "=ds_HouseImp";
	var strArgument  = "searchBetterAdvice";
	var strCallbackFunc = "fn_CallBack";
	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallbackFunc
			   );
}

//------------------------------------------------------------------------------- 
// 함수명: fn_CommonSave()
//   설명: 개선권고관리 내역을 저장하는 함수
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_CommonSave()
{
	fn_D1_SaveHouseImp();
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_SaveHouseImp()
//   설명: 개선권고관리 내역을 저장하는 함수
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_SaveHouseImp()
{
	var strChkFlag = fn_D1_CheckReg();
		
	if(!strChkFlag) 
	{
		alert('이미 등록된 개선권고일자입니다.');
		return;
	}

	
	if(eval("cal_BetterAdviceYmd" +strRstImp).Value == "")
	{
		if(strRstImp != 3)
		{
			alert(gfn_GetMessage("M000011","%AAA%",strRstImp+"차 개선권고일을"));
		}else if(strRstImp == 3)
		{
			alert(gfn_GetMessage("M000011","%AAA%","공급중단일을"));
		}
		return;
	}
	
	if(strRstImp != 1 )
	{
		var strPreRstImp = strRstImp-1;
		if(!fn_DateCheckGrid(eval("cal_BetterAdviceYmd" +strPreRstImp).Value,eval("cal_BetterAdviceYmd" +strRstImp).Value,strPreRstImp+"차 개선권고일",strRstImp+"차 개선권고일"))
		{
			return;
		}
	}
	
	if(eval("cal_BetterEndYmd" +strRstImp).Value == "")
	{
		alert(gfn_GetMessage("M000011","%AAA%",strRstImp+"차 개선완료일을"));
		return;
	}
	//if(eval("edt_WorkFirm" +strRstImp).Text == "")
	//{
	//	alert(gfn_GetMessage("M000011","%AAA%",strRstImp+"차 시공업체를"));
	//	return;
	//}
	if(eval("cal_ReInspectYmd" +strRstImp).Value == "")
	{
		alert(gfn_GetMessage("M000011","%AAA%",strRstImp+"차 재검사일자를"));
		return;
	}
	if(eval("cob_ReInspectRslt" +strRstImp).Value == "" || eval("cob_ReInspectRslt" +strRstImp).Value == null)
	{
		alert(gfn_GetMessage("M000011","%AAA%",strRstImp+"차 재검결과를"));
		return;
	}

	eval("ds_HouseImp"+strRstImp).SetColumn(0, "INSPECT_YEAR", strInspectYear);
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "INSPECT_FLAG", INSPECT_FLAG);
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "FACI_NUM", strFaciNum);
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "INSPECT_YMD", strInspectYmd);
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));
	eval("ds_HouseImp"+strRstImp).SetColumn(0, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));
	
	var strSvcID = "savaBetterAdvice";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_BetterAdvicMangeMgr-service";
	var strInDatasets  = "ds_HouseImp=ds_HouseImp" +ToString(strRstImp)+ ":u";
	var strOutDatasets  = "";
	var strArgument  = "savaBetterAdvice";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	strRstImp = 0;
	
	alert(gfn_GetMessage("M000009","%AAA%","저장을"));
	fn_CommonSearch();
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_CheckReg()
//   설명: 개선권고관리를 등록 하기 전 기 등록 여부 확인
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_CheckReg()
{	
	var strAdviceYmd = "";
	if(strRstImp == 1)
	{
		strAdviceYmd = ds_HouseImp1.GetColumn(0,"BETTER_ADVICE_YMD");
	}else if(strRstImp == 2)
	{
		strAdviceYmd = ds_HouseImp2.GetColumn(0,"BETTER_ADVICE_YMD");
	}else if(strRstImp == 3)
	{
		strAdviceYmd = ds_HouseImp3.GetColumn(0,"BETTER_ADVICE_YMD");
	}
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List;
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------
    var strSvcID     = "fn_D1_CheckReg";
    var strPart     = "D10";
    var strURL             = "handle.do?ServiceName=D1_BetterAdvicMangeMgr-service&INSPECT_YEAR="+strInspectYear+"&INSPECT_FLAG="+INSPECT_FLAG+"&FACI_NUM="+strFaciNum+"&INSPECT_YMD="+strInspectYmd+"&BETTER_ADVICE_YMD="+strAdviceYmd;
    var strInDatasets     = "";
    var strOutDatasets = "ds_HouseImpFlag=ds_HouseImpFlag";
    var strArgument      = "findRstFlag";   
    gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ds_HouseImpFlag.RowCount() != 0) return false;
	return true;
}

//------------------------------------------------------------------------------- 
// 함수명: fn_CallBack()
//   설명:  비동기 트랜잭션 후 실행할 함수
// arguments
//			svcid : 서비스 아이디
//			errcd : 에러 코드
//			errmsg : 에러 메세지
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_CallBack(svcid, errcd, errmsg)
{

	switch(svcid)
	{	
		case "fn_D1_Find1": 
			//-----------------------------------------
			//  콤보박스의 내용을 셋팅한다.
			//-----------------------------------------
			gfn_SetComboBox_Comcode("D10176",gfn_setDsObject_Comcode("cob_ReInspectRslt1"));

			if(ds_HouseImp1.GetRowCount() == 0)
			{
				ds_HouseImp1.AddRow();
				
			}else if(ds_HouseImp1.GetRowCount() == 1)
			{
				if(ds_HouseImp1.GetColumn(0,"RE_INSPECT_RSLT") == "20")
				{
					fn_D1_SearchHouseImp();
				}
			}
			break;	
		case "fn_D1_Find2": 			
			//-----------------------------------------
			//  콤보박스의 내용을 셋팅한다.
			//-----------------------------------------
			gfn_SetComboBox_Comcode("D10176",gfn_setDsObject_Comcode("cob_ReInspectRslt2"));
			
			if(ds_HouseImp2.GetRowCount() == 0)
			{
				ds_HouseImp2.AddRow();
				
			}else if(ds_HouseImp2.GetRowCount() == 1)
			{
				if(ds_HouseImp2.GetColumn(0,"RE_INSPECT_RSLT") == "20")
				{
					fn_D1_SearchHouseImp();
				}
			}
			break;	
		case "fn_D1_Find3": 	
			//-----------------------------------------
			//  콤보박스의 내용을 셋팅한다.
			//-----------------------------------------
			gfn_SetComboBox_Comcode("D10176",gfn_setDsObject_Comcode("cob_ReInspectRslt3"));
			
			if(ds_HouseImp3.GetRowCount() == 0)
			{
				ds_HouseImp3.AddRow();
				
			}else if(ds_HouseImp2.GetRowCount() == 1)
			{
				strRstImp = 4;
			}
			break;	
	}
	fn_D1_StateInit();
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_StateInit()
//   설명:  조회후 enable 관련 함수
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_StateInit()
{
	if((strRstImp == 1 && ds_HouseImp1.GetColumn(0,"RE_INSPECT_RSLT") == "10")|| strRstImp == 2)
	{
		cal_BetterAdviceYmd1.Enable = false;
		cal_BetterEndYmd1.Enable = false;
		edt_WorkFirm1.Enable = false;
		cal_ReInspectYmd1.Enable = false;
		cob_ReInspectRslt1.Enable = false;
		edt_ActRslt1.Enable = false;
	}
	
	if((strRstImp == 2 && ds_HouseImp2.GetColumn(0,"RE_INSPECT_RSLT") == "10")|| strRstImp == 3)
	{
		cal_BetterAdviceYmd2.Enable = false;
		cal_BetterEndYmd2.Enable = false;
		edt_WorkFirm2.Enable = false;
		cal_ReInspectYmd2.Enable = false;
		cob_ReInspectRslt2.Enable = false;
		edt_ActRslt2.Enable = false;
	}
	
	if(strRstImp == 4)
	{
		cal_BetterAdviceYmd3.Enable = false;
		cal_BetterEndYmd3.Enable = false;
		edt_WorkFirm3.Enable = false;
		cal_ReInspectYmd3.Enable = false;
		cob_ReInspectRslt3.Enable = false;
		edt_ActRslt3.Enable = false;
	}
}


function D1301040010U_OnUnloadCompleted(obj)
{
	// if(ds_HouseImp1.GetUpdate() || ds_HouseImp2.GetUpdate() || ds_HouseImp3.GetUpdate()){
		// if(!confirm(gfn_GetMessage("M000016","%AAA%","변경된 내용이 있습니다.종료")))
		// {
			// return false;
		// }
	// }
}

function Button4_OnClick(obj)
{
	if(ds_HouseImp1.RowCount() > 0)
	{
		var retValue = gfn_Dialog("B20","B2203050011U","",450,400,true,-1,-1);
		if(retValue != null)
		{
			ds_HouseImp1.SetColumn(0,"WORK_FIRM",retValue[1]);
		}
	}
}

function Button0_OnClick(obj)
{
	if(ds_HouseImp2.RowCount() > 0)
	{
		var retValue = gfn_Dialog("B20","B2203050011U","",450,400,true,-1,-1);
		if(retValue != null)
		{
			ds_HouseImp2.SetColumn(0,"WORK_FIRM",retValue[1]);
		}
	}
}

function Button2_OnClick(obj)
{
	if(ds_HouseImp3.RowCount() > 0)
	{
		var retValue = gfn_Dialog("B20","B2203050011U","",450,400,true,-1,-1);
		if(retValue != null)
		{
			ds_HouseImp3.SetColumn(0,"WORK_FIRM",retValue[1]);
		}
	}
}

function Button5_OnClick(obj)
{
	var arg = "fa_Url=handle.do?ServiceName=D1_BetterAdvicMangeMgr-service&INSPECT_YEAR="+strInspectYear+"&FACI_NUM="+strFaciNum+"&INSPECT_YMD="+strInspectYmd+"&INSPECT_FLAG=20 fa_Part=D10";
	var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
	edtFileList1.text = "";
	for(var i=0; i<arrList.length; i++)
	{
		edtFileList1.text += arrList[i];
		if(arrList.length-1 != i) edtFileList1.text += "/";
	}
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_FileListNm()
//   설명: 시설물  파일명을 조회 하는 함수
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_FileListNm()
{	
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List;
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------
    var ServiceId     = "search1";
    var ServicePart     = "D10";
    var Url             = "handle.do?ServiceName=D1_BetterAdvicMangeMgr-service&INSPECT_YEAR="+strInspectYear+"&FACI_NUM="+strFaciNum+"&INSPECT_YMD="+strInspectYmd+"&INSPECT_FLAG=20";
    var InputDsList     = "";
    var OutputDsList = "ds_FileList=ds_FileList";
    var Argument      = "findFile";
    
    gfn_SyncCall(ServiceId, ServicePart, Url, InputDsList, OutputDsList, Argument);
    
    if(ErrorCode < 0)
	{    
		return;
	}
	
	edtFileList1.text = "";
	for(var i=0; i<ds_FileList.RowCount(); i++)
	{
		edtFileList1.text += ds_FileList.GetColumn(i,"ATTACH_FILE_NM");
		if(ds_FileList.RowCount()-1 != i) edtFileList1.text += "/";
	}
}
]]></Script>
</Window>