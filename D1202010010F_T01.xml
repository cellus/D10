<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="584" Id="D1202010010F_T01" Left="8" OnLoadCompleted="D1202010010F_T01_OnLoadCompleted" PidAttrib="7" Title="배관순찰점검등록_D1202010010F_T01" Top="8" Ver="1.0" Width="1256" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Rst_Walk">
				<Contents>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SMALL_BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAK_YN_MP" size="256" summ="default" type="STRING"/>
					<colinfo id="PONDSIDE_SINK_MP" size="256" summ="default" type="STRING"/>
					<colinfo id="LINEMARK_MP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_DESC_MP" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAK_YN_SP" size="256" summ="default" type="STRING"/>
					<colinfo id="PONDSIDE_SINK_SP" size="256" summ="default" type="STRING"/>
					<colinfo id="LINEMARK_SP" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_DESC_SP" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG_MP" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG_SP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel_Car"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Excel"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Car">
				<Contents>
					<colinfo id="LEAK_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PONDSIDE_SINK" size="256" summ="default" type="STRING"/>
					<colinfo id="LINEMARK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="UPD_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="UPD_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="CRT_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="CRT_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_CHK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_LENG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_PlanCar">
				<Contents>
					<colinfo id="PIPE_CAR_TOT_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Walk_plan" OnRowPosChanged="ds_Walk_plan_OnRowPosChanged">
				<Contents>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SMALL_BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SMALL_BLOCK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="END_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD_BE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static5" Left="5" Style="table" TabOrder="64" Top="553" VAlign="Middle" Width="1244" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static29" Left="6" Style="table" TabOrder="37" Top="511" VAlign="Middle" Width="1244" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static50" Left="70" Style="table" TabOrder="14" Top="69" VAlign="Middle" Width="1181" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static51" Left="5" Style="table" TabOrder="13" Text="점검자&#32;1" Top="69" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static52" Left="110" Style="table" TabOrder="16" Top="27" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static53" Left="232" Style="table" TabOrder="15" Text="연장(m)" Top="27" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static54" Left="110" Style="table" TabOrder="19" Top="48" VAlign="Middle" Width="1141" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static55" Left="5" Style="table" TabOrder="17" Text="특이사항" Top="48" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static57" Left="487" Style="table_indis" TabOrder="18" Text="가스누출" Top="27" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static60" Left="741" Style="table_indis" TabOrder="20" Text="지반침하" Top="27" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static62" Left="194" Style="table" TabOrder="21" Text="점검자&#32;2" Top="69" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static64" Left="384" Style="table" TabOrder="22" Text="점검자&#32;3" Top="69" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Car" Border="Flat" Column="TAKER_EMPID3_NM" Enable="FALSE" Height="18" Id="edt_TakerEmpid3" ImeMode="none" Left="464" Style="edit" TabOrder="23" Top="71" Width="107"></Edit>
		<Combo BindDataset="ds_Car" Border="Flat" Column="LEAK_YN" Height="18" Id="cob_LeakYn" Left="568" Style="combo_indis" TabOrder="1" Top="28" Width="172"></Combo>
		<Combo BindDataset="ds_Car" Border="Flat" Column="PONDSIDE_SINK" Height="18" Id="cob_PondsideSink" Left="822" Style="combo_indis" TabOrder="2" Top="28" Width="172"></Combo>
		<Edit Align="CENTER" BindDataset="ds_Car" Border="Flat" Column="TAKER_EMPID1_NM" Enable="FALSE" Height="18" Id="edt_TakerEmpid1" ImeMode="none" Left="85" Style="edit" TabOrder="24" Top="71" Width="107"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Car" Border="Flat" Column="TAKER_EMPID2_NM" Enable="FALSE" Height="18" Id="edt_TakerEmpid2" ImeMode="none" Left="274" Style="edit" TabOrder="25" Top="71" Width="107"></Edit>
		<Edit BindDataset="ds_Car" Border="Flat" Column="CHK_DESC" Height="18" Id="edt_ChkDesc" ImeMode="none" Left="143" MaxLength="50" Style="edit" TabOrder="4" Top="50" Width="848"></Edit>
		<Image Align="Left" Height="13" Id="Image9" ImageID="blt_8" Left="10" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="26" Text="도보순찰구간선택" Top="96" Width="125"></Image>
		<Shape BKColor="user15" Bottom="115" Height="3" Id="Shape2" Left="5" LineWidth="0" Right="1251" TabOrder="27" Top="112" Type="Rectangle" Width="1246"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Walk_plan" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="453" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="338" Id="grd_Multi" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" NoDataText="도보순찰구간내역&#32;정보가&#32;없습니다." Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="28" TabStop="true" Top="115" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col width="40"/>
						<col width="152"/>
						<col width="73"/>
						<col width="200"/>
						<col width="200"/>
						<col width="100"/>
						<col width="100"/>
						<col width="0"/>
						<col width="94"/>
					</columns>
					<head>
						<cell col="0" display="text" text="NO"/>
						<cell col="1" display="text" text="구간명"/>
						<cell col="2" display="text" text="소구간명"/>
						<cell col="3" display="text" text="소구간시점"/>
						<cell col="4" display="text" text="소구간종점"/>
						<cell col="5" display="text" text="도보본관(m)"/>
						<cell col="6" display="text" text="공급관(m)"/>
						<cell col="7" display="text" text="계획일자"/>
						<cell col="8" display="text" text="최근점검일자"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="rowindex+1"/>
						<cell align="center" col="1" colid="BLOCK_NM" display="text"/>
						<cell align="left" col="2" colid="SMALL_BLOCK_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="left" col="3" colid="STR_LOT_NUM_UNION" display="text" edit="normal" expandsize="18" wordwrap="word"/>
						<cell col="4" colid="END_LOT_NUM_UNION" display="text" expandsize="18" wordwrap="word"/>
						<cell align="right" col="5" colid="KOPIPE_LENG" display="normal" expandsize="18" wordwrap="word"/>
						<cell align="right" col="6" colid="MPIPE_LENG" display="normal" expandsize="18" wordwrap="word"/>
						<cell col="7" display="date"/>
						<cell col="8" colid="PATROL_YMD_BE" display="date"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Right" Border="Flat" Height="22" Id="Static15" Left="995" Style="table_indis" TabOrder="29" Text="라인마크" Top="27" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Car" Border="Flat" Column="LINEMARK" Height="18" Id="cob_Linemark" Left="1076" Style="combo_indis" TabOrder="3" Top="28" Width="172"></Combo>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static16" Left="7" Style="table" TabOrder="30" Top="467" VAlign="Middle" Width="1090" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Rst_Walk" Border="Flat" CheckLength="Byte" Column="CHK_DESC_SP" Height="18" Id="edt_ChkDescSp" ImeMode="none" Left="812" MaxLength="50" Style="edit" TabOrder="12" Top="555" Width="435"></Edit>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="LINEMARK_SP" Height="18" Id="cob_LinemarkSp" Left="631" Style="combo_indis" TabOrder="11" Top="554" Width="99"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static22" Left="550" Style="table_indis" TabOrder="31" Text="라인마크" Top="553" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="PONDSIDE_SINK_SP" Height="18" Id="cob_PondsideSinkSp" Left="449" Style="combo_indis" TabOrder="10" Top="554" Width="99"></Combo>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="LEAK_YN_SP" Height="18" Id="cob_LeakYnSp" Left="269" Style="combo_indis" TabOrder="9" Top="554" Width="99"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static19" Left="368" Style="table_indis" TabOrder="32" Text="지반침하" Top="553" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static18" Left="188" Style="table_indis" TabOrder="33" Text="가스누출" Top="553" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static17" Left="731" Style="table" TabOrder="34" Text="특이사항" Top="553" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static14" Left="5" Style="table" TabOrder="35" Text="연장(m)" Top="553" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="None" Height="12" Id="Static24" Left="4" Style="table" TabOrder="36" Text="도보공급관" Top="539" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="PONDSIDE_SINK_MP" Height="18" Id="cob_PondsideSinkMp" Left="449" Style="combo_indis" TabOrder="6" Top="512" Width="99"></Combo>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="LEAK_YN_MP" Height="18" Id="cob_LeakYnMp" Left="269" Style="combo_indis" TabOrder="5" Top="512" Width="99"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static9" Left="731" Style="table" TabOrder="38" Text="특이사항" Top="511" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static10" Left="5" Style="table" TabOrder="39" Text="연장(m)" Top="511" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="None" Height="12" Id="Static26" Left="4" Style="table" TabOrder="40" Text="도보공급관" Top="498" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="None" Height="12" Id="Static27" Left="4" Style="table" TabOrder="41" Text="도보본관" Top="498" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Rst_Walk" Border="Flat" CheckLength="Byte" Column="CHK_DESC_MP" Height="18" Id="edt_ChkDescMp" ImeMode="none" Left="812" MaxLength="50" Style="edit" TabOrder="8" Top="513" Width="435"></Edit>
		<Combo BindDataset="ds_Rst_Walk" Border="Flat" Column="LINEMARK_MP" Height="18" Id="cob_LinemarkMp" Left="631" Style="combo_indis" TabOrder="7" Top="512" Width="99"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static30" Left="189" Style="table_indis" TabOrder="44" Text="가스누출" Top="511" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static34" Left="368" Style="table_indis" TabOrder="43" Text="지반침하" Top="511" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static35" Left="550" Style="table_indis" TabOrder="42" Text="라인마크" Top="511" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Delete" ImageID="btn_delete" Left="1200" LeftMargin="20" OnClick="btn_Delete_OnClick" Style="button" TabOrder="45" Text="삭제" Top="490" Width="50"></Button>
		<Button ButtonStyle="TRUE" Height="19" Id="btn_Save" ImageID="btn_popsave" Left="1147" LeftMargin="21" OnClick="fn_D1_Save_OnClick" Style="button" TabOrder="46" Text="저장" Top="490" Width="50"></Button>
		<Image Align="Left" Height="13" Id="Image0" ImageID="blt_8" Left="10" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="47" Text="차량순찰점검" Top="12" Width="101"></Image>
		<Static Align="Right" Border="Flat" Height="22" Id="Static0" Left="573" Style="table" TabOrder="48" Text="구간명" Top="69" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Excel_Car" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="821" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="66" Id="grd_Excel_Car" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellClick="grd_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="49" TabStop="true" Top="755" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="차량&#32;연장(m)"/>
						<cell col="1" display="text" text="차량&#32;가스누출"/>
						<cell col="2" display="text" text="차량&#32;지반침하"/>
						<cell col="3" display="text" text="차량&#32;라인마크"/>
						<cell col="4" display="text" text="차량&#32;점검사항"/>
						<cell col="5" display="text" text="차량&#32;점검자1"/>
						<cell col="6" display="text" text="차량&#32;점검자2"/>
						<cell col="7" display="text" text="차량&#32;점검자3"/>
					</head>
					<body>
						<cell align="right" col="0" colid="PIPE_CAR_TOT_LENG" display="text"/>
						<cell align="center" col="1" colid="LEAK_YN" display="text"/>
						<cell align="center" col="2" colid="PONDSIDE_SINK" display="text"/>
						<cell align="center" col="3" colid="LINEMARK" display="text"/>
						<cell align="left" col="4" colid="CHK_DESC" display="text"/>
						<cell col="5" colid="TAKER_EMPID1" display="text"/>
						<cell align="center" col="6" colid="TAKER_EMPID2" display="text"/>
						<cell align="center" col="7" colid="TAKER_EMPID3" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" BindDataset="ds_excel" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="909" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="66" Id="grd_Excel" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" OnCellClick="grd_OnCellClick" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="50" TabStop="true" Top="843" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="200"/>
						<col width="200"/>
						<col width="100"/>
						<col width="100"/>
						<col width="97"/>
						<col width="107"/>
						<col width="109"/>
						<col width="113"/>
						<col width="109"/>
						<col width="114"/>
						<col width="109"/>
						<col width="120"/>
						<col width="116"/>
						<col width="125"/>
						<col width="124"/>
						<col width="120"/>
						<col width="119"/>
						<col width="128"/>
						<col width="126"/>
						<col width="115"/>
					</columns>
					<head>
						<cell col="0" display="text" text="소구간명"/>
						<cell col="1" display="text" text="소구간시점"/>
						<cell col="2" display="text" text="소구간종점"/>
						<cell col="3" display="text" text="도보본관"/>
						<cell col="4" display="text" text="공급관"/>
						<cell col="5" display="text" text="도보본관&#32;연장(m)"/>
						<cell col="6" display="text" text="도보본관&#32;가스누출"/>
						<cell col="7" display="text" text="도보본관&#32;지반침하"/>
						<cell col="8" display="text" text="도보본관&#32;라인마크"/>
						<cell col="9" display="text" text="도보본관&#32;점검사항"/>
						<cell col="10" display="text" text="도보본관&#32;점검자1"/>
						<cell col="11" display="text" text="도보본관&#32;점검자2"/>
						<cell col="12" display="text" text="도보본관&#32;점검자3"/>
						<cell col="13" display="text" text="도보공급관&#32;연장(m)"/>
						<cell col="14" display="text" text="도보공급관&#32;가스누출"/>
						<cell col="15" display="text" text="도보공급관&#32;지반침하"/>
						<cell col="16" display="text" text="도보공급관&#32;라인마크"/>
						<cell col="17" display="text" text="도보공급관&#32;점검사항"/>
						<cell col="18" display="text" text="도보공급관&#32;점검자1"/>
						<cell col="19" display="text" text="도보공급관&#32;점검자2"/>
						<cell col="20" display="text" text="도보공급관&#32;점검자3"/>
					</head>
					<body>
						<cell align="left" col="0" colid="SMALL_BLOCK_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="left" col="1" colid="STR_LOT_NUM_UNION" display="text" edit="normal" expandsize="18" wordwrap="word"/>
						<cell col="2" colid="END_LOT_NUM_UNION" display="text" expandsize="18" wordwrap="word"/>
						<cell align="right" col="3" colid="KOPIPE_LENG" display="text" edit="number" expandsize="18" wordwrap="word"/>
						<cell align="right" col="4" colid="MPIPE_LENG" display="text" edit="number" expandsize="18" wordwrap="word"/>
						<cell align="right" col="5" colid="KOPIPE_LENG" display="text"/>
						<cell align="center" col="6" colid="LEAK_YN_MP" display="text"/>
						<cell align="center" col="7" colid="PONDSIDE_SINK_MP" display="text"/>
						<cell align="center" col="8" colid="LINEMARK_MP" display="text"/>
						<cell align="left" col="9" colid="CHK_DESC_MP" display="text"/>
						<cell col="10" colid="TAKER_EMPID1" display="text"/>
						<cell align="center" col="11" colid="TAKER_EMPID2" display="text"/>
						<cell align="center" col="12" colid="TAKER_EMPID3" display="text"/>
						<cell align="left" col="13" colid="MPIPE_LENG" display="text"/>
						<cell align="center" col="14" colid="LEAK_YN_SP" display="text"/>
						<cell align="center" col="15" colid="PONDSIDE_SINK_SP" display="text"/>
						<cell align="center" col="16" colid="LINEMARK_SP" display="text"/>
						<cell align="left" col="17" colid="CHK_DESC_SP" display="text"/>
						<cell align="center" col="18" colid="TAKER_EMPID1" display="text"/>
						<cell align="center" col="19" colid="TAKER_EMPID2" display="text"/>
						<cell align="center" col="20" colid="TAKER_EMPID3" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Excel" ImageID="btn_8_Excel&#32;File&#32;creation" Left="968" LeftMargin="21" OnClick="btn_Excel_OnClick" Style="button" TabOrder="51" Text="엑셀&#32;다운&#32;(차량)" Top="5" Width="121"></Button>
		<Edit BindDataset="ds_Car" Border="Flat" Column="BLOCK_NM" Enable="FALSE" Height="18" Id="edt_BlockCd" ImeMode="none" Left="654" Style="edit" TabOrder="52" Top="71" Width="228"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static1" Left="5" Style="table" TabOrder="53" Text="순찰일자" Top="27" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Car" Border="Flat" Column="PATROL_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_Ymd" Left="143" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="54" Top="29" WeeksFont="Default,-1" Width="87"></Calendar>
		<Static Align="Right" Border="Flat" Height="22" Id="Static2" Left="7" Style="table" TabOrder="55" Text="도보순찰일자" Top="467" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Rst_Walk" Border="Flat" Column="PATROL_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_ymd1" Left="88" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="56" Top="469" WeeksFont="Default,-1" Width="99"></Calendar>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button50" ImageID="btn_11_Inquiry" Left="1091" LeftMargin="21" OnClick="btn_Pipe_OnClick" Style="button" TabOrder="57" Text="배관&#32;순찰점검&#32;이력조회" Top="5" Width="156"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static4" Left="883" Style="table_indis" TabOrder="58" Text="등록일시" Top="69" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static7" Left="1093" Style="table_indis" TabOrder="59" Text="등록자" Top="69" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Car" Border="Flat" Column="UPD_DTM" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="964" Style="edit" TabOrder="60" Top="71" Width="127"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Car" Border="Flat" Column="UPD_EMPID_NM" Enable="FALSE" Height="18" Id="Edit1" ImeMode="none" Left="1174" Style="edit" TabOrder="61" Top="71" Width="74"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static8" Left="995" Style="table_indis" TabOrder="63" Text="결재상태" Top="48" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Car" Border="Flat" Column="DECIDE_PROC_STS" Enable="FALSE" Height="18" Id="cob_DecideProcSts" Left="1076" Style="combo_indis" TabOrder="62" Top="49" Width="172"></Combo>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="731" Style="table_indis" TabOrder="65" Text="등록일시" Top="467" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Rst_Walk" Border="Flat" Column="UPD_DTM" Enable="FALSE" Height="18" Id="Edit2" ImeMode="none" Left="812" Style="edit" TabOrder="67" Top="469" Width="127"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static6" Left="940" Style="table_indis" TabOrder="66" Text="등록자" Top="467" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Rst_Walk" Border="Flat" Column="UPD_EMPID_NM" Enable="FALSE" Height="18" Id="Edit3" ImeMode="none" Left="1021" Style="edit" TabOrder="68" Top="469" Width="74"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static11" Left="189" Style="table" TabOrder="69" Text="점검자&#32;1" Top="467" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Rst_Walk" Border="Flat" Column="TAKER_EMPID1_NM" Enable="FALSE" Height="18" Id="Edit4" ImeMode="none" Left="269" Style="edit" TabOrder="73" Top="469" Width="99"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static12" Left="368" Style="table" TabOrder="70" Text="점검자&#32;2" Top="467" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Rst_Walk" Border="Flat" Column="TAKER_EMPID2_NM" Enable="FALSE" Height="18" Id="Edit5" ImeMode="none" Left="449" Style="edit" TabOrder="74" Top="469" Width="99"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static13" Left="550" Style="table" TabOrder="71" Text="점검자&#32;3" Top="467" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Rst_Walk" Border="Flat" Column="TAKER_EMPID3_NM" Enable="FALSE" Height="18" Id="Edit6" ImeMode="none" Left="631" Style="edit" TabOrder="72" Top="469" Width="99"></Edit>
		<MaskEdit BindDataset="ds_Rst_Walk" Border="Flat" Column="LENG_MP" DecimalLen="1" DisableColor="user0" Height="18" Id="edt_Leng_Mp" Left="88" MaxLength="11" OnCharChanged="edt_ACROSS_A_OnCharChanged" Style="edit" TabOrder="75" Top="512" Width="99"></MaskEdit>
		<MaskEdit BindDataset="ds_Rst_Walk" Border="Flat" Column="LENG_SP" DecimalLen="1" DisableColor="user0" Height="18" Id="edt_Leng_Sp" Left="87" MaxLength="11" OnCharChanged="edt_ACROSS_A_OnCharChanged" Style="edit" TabOrder="76" Top="555" Width="99"></MaskEdit>
		<MaskEdit BindDataset="ds_Car" Border="Flat" Column="PATROL_LENG" DecimalLen="1" DisableColor="user2" Height="18" Id="edt_Patrol_Leng" Left="314" MaxLength="11" OnCharChanged="edt_ACROSS_A_OnCharChanged" Style="edit" TabOrder="77" Top="29" Width="171"></MaskEdit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1201010010F_T01.xml
* Form 설명   : 배관 순찰점검등록 조회,등록,수정,삭제
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2009-01-16
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";

var Quarter = '';

//---------------------------------------------------------
//	화면 OnLoadCompleted 이벤트처리 발생하는 함수( 화면ID_OnLoadCompleted )
//---------------------------------------------------------
function D1202010010F_T01_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	gfn_D1_SetGrid_Sort(grd_Multi);
	
	gfn_SetComboBox_Comcode("D10151",gfn_setDsObject_Comcode("cob_LeakYn"));			//누설여부
	gfn_SetComboBox_Comcode("D10203",gfn_setDsObject_Comcode("cob_PondsideSink"));		//지반침하
	gfn_SetComboBox_Comcode("D10204",gfn_setDsObject_Comcode("cob_Linemark"));			//라인마크
	
	gfn_SetComboBox_Comcode("D10151",gfn_setDsObject_Comcode("cob_LeakYnMp"));			//가스누설
	gfn_SetComboBox_Comcode("D10203",gfn_setDsObject_Comcode("cob_PondsideSinkMp"));	//지반침하
	gfn_SetComboBox_Comcode("D10204",gfn_setDsObject_Comcode("cob_LinemarkMp"));		//라인마크
	
	gfn_SetComboBox_Comcode("D10151",gfn_setDsObject_Comcode("cob_LeakYnSp"));			//가스누설
	gfn_SetComboBox_Comcode("D10203",gfn_setDsObject_Comcode("cob_PondsideSinkSp"));	//지반침하
	gfn_SetComboBox_Comcode("D10204",gfn_setDsObject_Comcode("cob_LinemarkSp"));		//라인마크
	gfn_SetComboBox_Comcode("A10411",gfn_setDsObject_Comcode("cob_DecideProcSts"));		//결재상태

}

function fn_chkQuarter()
{
	if(SubStr(cal_PPatrolYmd.Value,4,2)=="01"||SubStr(cal_PPatrolYmd.Value,4,2)=="02"||SubStr(cal_PPatrolYmd.Value,4,2)=="03")
	{
		Quarter = '1';
		Patrol_Str_ymd = SubStr(cal_PPatrolYmd.Value,0,4) + "0101";
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="04"||SubStr(cal_PPatrolYmd.Value,4,2)=="05"||SubStr(cal_PPatrolYmd.Value,4,2)=="06")
	{
		Quarter = '2';
		Patrol_Str_ymd = SubStr(cal_PPatrolYmd.Value,0,4) + "0401";
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="07"||SubStr(cal_PPatrolYmd.Value,4,2)=="08"||SubStr(cal_PPatrolYmd.Value,4,2)=="09")
	{
		Quarter = '3';
		Patrol_Str_ymd = SubStr(cal_PPatrolYmd.Value,0,4) + "0701";
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="10"||SubStr(cal_PPatrolYmd.Value,4,2)=="11"||SubStr(cal_PPatrolYmd.Value,4,2)=="12")
	{
		Quarter = '4';
		Patrol_Str_ymd = SubStr(cal_PPatrolYmd.Value,0,4) + "1001";
	}    
}   

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_ExcelExport()
//  설명: 특별관리시설 엑셀로 저장
// arguments   
//  return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_ExcelExport()
{ 
	alert("엑셀 보완중입니다...");
	return;
	
	var SearchCondition= "";
   
    SearchCondition = SearchCondition + "지사 :"     + RPad(cob_PBranchCd.Text," ",20);
    SearchCondition = SearchCondition + "팀 :"       + RPad(cob_PTeamCd.Text," ",20);
    SearchCondition = SearchCondition + "조 :"       + RPad(cob_PShiftWorkCd.Text," ",20);
    SearchCondition = SearchCondition + "구간 :"       + RPad(cob_block.Text," ",20);
    SearchCondition = SearchCondition + "순찰일자 :" + RPad(cal_PPatrolYmd.Text," ",20);
	gfn_ExportExcel("배관 순찰점검등록", 5, SearchCondition, "grd_Excel");
}

function btn_Excel_OnClick(obj)
{
	alert("엑셀 보완중입니다...");
	return;
	
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 :"     + RPad(cob_PBranchCd.Text," ",20);
    SearchCondition = SearchCondition + "팀 :"       + RPad(cob_PTeamCd.Text," ",20);
    SearchCondition = SearchCondition + "조 :"       + RPad(cob_PShiftWorkCd.Text," ",20);
    SearchCondition = SearchCondition + "구간 :"     + RPad(cob_block.Text," ",20);
    SearchCondition = SearchCondition + "순찰일자 :" + RPad(cal_PPatrolYmd.Text," ",20);
	gfn_ExportExcel("배관 순찰점검등록", 5, SearchCondition, "grd_Excel_Car");
}
//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Find()
// 설명     : 순찰점검 계획을 조회한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------
function fn_D1_Find()
{ 
	fn_chkQuarter();

	ds_Car.ClearData();
	ds_Walk_plan.ClearData();
	ds_Rst_Walk.ClearData();
	
	ds_Search.ClearData();
	
	ds_Search.AddRow();

	ds_Search.SetColumn(0,"CHK_YEAR",SubStr(cal_PPatrolYmd.Value,0,4));
	ds_Search.SetColumn(0,"CHK_QUARTER",Quarter);	
	ds_Search.SetColumn(0,"BRANCH_CD",cob_PBranchCd.Value);
	ds_Search.SetColumn(0,"TEAM_CD",cob_PTeamCd.Value);
	ds_Search.SetColumn(0,"BLOCK_CD",cob_block.Value);
	ds_Search.SetColumn(0,"PATROL_YMD",cal_PPatrolYmd.Value);
		              
	var strSvcID = "rst_car";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Search=ds_Search";
	var strOutDatasets  = "ds_Car=ds_Car ds_Walk_plan=ds_Walk_plan";
	//엑셀출력 제외함 임시
	//var strOutDatasets  = "ds_Walk_plan=ds_Walk_plan ds_Car=ds_Car ds_Excel_Car=ds_Excel_Car ds_Excel=ds_Excel";

	var strArgument  = "rst_car=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );						   			      	              

//권기철 2011.1.21	
	//fn_D1_Find_Taker_BlockCd();		//담당자별 구간코드를 조회해 오기 위한 함수(화면에 보여지기만 함)

	// alert(ds_Car.GetColumn(0, "TAKER_EMPID1"));
	// alert(edt_blocknm.text);

//    edt_TakerEmpid1.Text = ds_Car.GetColumn(0, "TAKER_EMPID1");
//    edt_TakerEmpid2.Text = ds_Car.GetColumn(0, "TAKER_EMPID2");
//    edt_TakerEmpid3.Text = ds_Car.GetColumn(0, "TAKER_EMPID3");
//    edt_BlockCd.Text = edt_blocknm.text;

}

//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Save()
// 설명     : 순찰실적_차량을 등록 및 수정한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------
function fn_D1_Save()
{
	if(ds_Car.RowCount() == 0)
	{
		return;
	}	
	
	if(ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '0' || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '1'  || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '2') 	
	{
		alert(substr(cal_PPatrolYmd.Value,0,4) + "년" + substr(cal_PPatrolYmd.Value,4,2) + "월" + substr(cal_PPatrolYmd.Value,6,2) + "일은 결재(진행/완료)중으로 수정이 불가합니다...");
		return;
	}	

	if(cob_LeakYn.Text == "")
	{
		alert(gfn_GetMessage("M000011","%AAA%","가스누설을"));
		return;
	}
	
	if(cob_PondsideSink.Text == "")
	{
		alert(gfn_GetMessage("M000011","%AAA%","지반침하를"));
		return;
	}
	
	if(cob_Linemark.Text == "")
	{
		alert(gfn_GetMessage("M000011","%AAA%","라인마크를"));
		return;
	}
	
	if(ds_Car.GetRowType(0) == "insert")
	{
		ds_Car.SetColumn(0, "CRT_EMPID" , gfn_GetGlobalValue("G_USER_NO")         );		//등록자사번
		ds_Car.SetColumn(0, "CRT_IP"    , gfn_GetGlobalValue("G_IPADDRESS")       );		//등록자 IP
		ds_Car.SetColumn(0, "UPD_EMPID" , gfn_GetGlobalValue("G_USER_NO")         );		//등록자사번
		ds_Car.SetColumn(0, "UPD_IP"    , gfn_GetGlobalValue("G_IPADDRESS")       );		//등록자 IP		
	}else if(ds_Car.GetRowType(0) == "update")
	{
		ds_Car.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));		//수정자사번
		ds_Car.SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//수정자 IP
	}
	
	var strSvcID = "save_rst";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Car=ds_Car:u";
	var strOutDatasets  = "";
	var strArgument  = "save_rst=1";
	
	gfn_SyncCall(
						 strSvcID
					   , strPart  	 
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );

	if(ErrorCode < 0)
	{
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"));
	}	              
}

//-------------------------------------------------------------------------------
// 함수명   : fn_E4_Addrowm()
// 설명     : 그리드의 라인추가를 실행 .
// return 내용 : 없음
//-------------------------------------------------------------------------------
function fn_D1_Addrowm()
{   
	fn_chkQuarter();
	
	if (fn_decide(cal_PPatrolYmd.Value, cob_PBranchCd.Value,cob_PTeamCd.Value) == false)
	{
		alert(substr(cal_PPatrolYmd.Value,0,4) + "년" + substr(cal_PPatrolYmd.Value,4,2) + "월" + substr(cal_PPatrolYmd.Value,6,2) + "일은 결재(진행/완료)중으로 등록이 불가합니다...");
		return;	
	}
					
	ds_Search.ClearData();	
	ds_Search.AddRow();

	ds_PlanCar.ClearData();

	ds_Search.SetColumn(0,"CHK_YEAR",SubStr(cal_PPatrolYmd.Value,0,4));
	ds_Search.SetColumn(0,"CHK_QUARTER",Quarter);	
	ds_Search.SetColumn(0,"PATROL_YMD",cal_PPatrolYmd.Value);
	ds_Search.SetColumn(0,"BRANCH_CD",cob_PBranchCd.Value);
	ds_Search.SetColumn(0,"TEAM_CD",cob_PTeamCd.Value);
	ds_Search.SetColumn(0,"BLOCK_CD",cob_block.Value);
		              
	var strSvcID = "plan_car";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Search=ds_Search";
	var strOutDatasets  = "ds_PlanCar=ds_PlanCar";
	var strArgument  = "plan_car=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );	
			   					   			      	              
	if(ds_PlanCar.rowcount == 0 || ds_PlanCar.GetColumn(0,"PIPE_CAR_TOT_LENG") == 0)
	{
		alert("해당분기 차량연장이 등록되지 않았습니다...");
		ds_Car.SetColumn(0,"PIPE_CAR_TOT_LENG",0);
		return;
	}

	ds_Car.ClearData();
    ds_Car.AddRow();
 
    ds_Car.SetColumn(0,"TAKER_EMPID1_NM",edt_empnm1.text);
    ds_Car.SetColumn(0,"TAKER_EMPID2_NM",edt_empnm2.text);
    ds_Car.SetColumn(0,"TAKER_EMPID3_NM",edt_empnm3.text);
    
    ds_Car.SetColumn(0,"TAKER_EMPID1",edt_empid1.text);
    ds_Car.SetColumn(0,"TAKER_EMPID2",edt_empid2.text);
    ds_Car.SetColumn(0,"TAKER_EMPID3",edt_empid3.text);
    
    ds_Car.SetColumn(0,"BLOCK_CD",cob_block.Value);
    ds_Car.SetColumn(0,"BLOCK_NM",cob_block.Text);
    
    ds_Car.SetColumn(0,"BRANCH_CD",cob_PBranchCd.Value);
    ds_Car.SetColumn(0,"TEAM_CD",cob_PTeamCd.Value);
                
    cal_Ymd.Value = cal_PPatrolYmd.value;
	
	ds_Car.SetColumn(0,"PATROL_LENG",ds_PlanCar.GetColumn(0,"PIPE_CAR_TOT_LENG"));
}

// 차량순찰삭제 
function fn_D1_Delete()
{   
	if (ds_Car.GetRowCount() == 0)
	{
		return;
	}
		
	if(ds_Car.GetRowType(ds_Car.row) == "insert")
	{
		ds_Car.DeleteRow(ds_Car.row);
		return;
	}

	if (ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '0' || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '1'  || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '2') 
	{	
		alert(substr(cal_PPatrolYmd.Value,0,4) + "년" + substr(cal_PPatrolYmd.Value,4,2) + "월" + substr(cal_PPatrolYmd.Value,6,2) + "일은 결재(진행/완료)중으로 삭제가 불가합니다...");
		return;
    }else if(confirm("차량 순찰내역을 삭제하시겠습니까?"))
    {
		ds_Car.DeleteRow(0);

		var strSvcID         = "del_rst";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1202010010F-service";					
		var strInDatasets    = "ds_Car=ds_Car:u";
		var strOutDatasets   = "";		
		var strArgument      = "del_rst=1";
	
		gfn_SyncCall(
						 strSvcID
					   , strPart  	 
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
	
		if(ErrorCode < 0)
		{
			return;
		}
		else
		{
			alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"));
		}		
			
	}	
}

//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Save_B_OnClick()
// 설명     : 순찰실적_도보를 저장 및 수정한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------

function fn_D1_Save_OnClick(obj)
{
	if (fn_decide(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"), ds_Rst_Walk.GetColumn(0, "BRANCH_CD"), ds_Rst_Walk.GetColumn(0, "TEAM_CD")) == false)
	{
		alert(substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),0,4) + "년" + substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),4,2) + "월" + substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),6,2) + "일은 결재(진행/완료)중으로 등록 및 수정이 불가합니다...");
		return;	
	}
	
	// if(cob_LeakYnMp.Text == "" && cob_LeakYnMp.Enable=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","가스누설을"));		//도보본관
		// return;
	// }
	
	// if(cob_PondsideSinkMp.Text == "" && cob_PondsideSinkMp.Enable=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","지반침하를"));		//도보본관
		// return;
	// }
	
	// if(cob_LinemarkMp.Text == "" && cob_LinemarkMp.Value=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","라인마크를"));		//도보본관
		// return;
	// }	
	
	// if(cob_LeakYnSp.Text == "" && cob_LeakYnSp.Value=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","가스누설을"));		//도보공급관
		// return;
	// }
	
	// if(cob_PondsideSinkSp.Text == "" && cob_PondsideSinkSp.Value=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","지반침하를"));		//도보공급관
		// return;
	// }
	
	// if(cob_LinemarkSp.Text == "" && cob_LinemarkSp.Value=true)
	// {
		// alert(gfn_GetMessage("M000011","%AAA%","라인마크를"));		//도보공급관
		// return;
	// }	
	
	if(ds_Rst_Walk.GetRowType(0) == "insert")
	{
		ds_Rst_Walk.SetColumn(0, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));		//등록자사번
		ds_Rst_Walk.SetColumn(0, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//등록자 IP
		ds_Rst_Walk.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));		//수정자사번
		ds_Rst_Walk.SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//수정자 IP
	}else if(ds_Rst_Walk.GetRowType(0) == "update")
	{
		ds_Rst_Walk.SetColumn(0, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));		//수정자사번
		ds_Rst_Walk.SetColumn(0, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));		//수정자 IP
	}
	
	var strSvcID = "save_walk_rst";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Rst_Walk=ds_Rst_Walk:u";
	var strOutDatasets  = "";
	var strArgument  = "save_walk_rst=1";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);

	if(ErrorCode < 0)
	{
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009","%AAA%","저장을"));
	}
}

//---------------------------------------------------------------------------------
//  배관 순찰점검 이력조회 popup
//---------------------------------------------------------------------------------
function btn_Pipe_OnClick(obj)
{
	var args = "BLOCK_CD=" 	  +quote(cob_block.value)		//구간코드(차량)
			 + " SMALL_BLOCK_CD=" +quote(ds_Walk_plan.GetColumn(grd_Multi.ClickedRow,"SMALL_BLOCK_CD"))	//소구간코드(도보)
			 ;
	gfn_Dialog("D10","D1203010019U",args,800,500,true,-1,-1);
}
	
function ds_Walk_plan_OnRowPosChanged(obj,nOldRow,nRow)
{
	ds_Rst_Walk.ClearData();

	var strSvcID = "rst_walk";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1202010010F-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_Rst_Walk=ds_Rst_Walk";
	var strArgument    = "rst_walk=1";
		strArgument	  += " BLOCK_CD=" + quote(ds_Walk_plan.GetColumn(nRow,"BLOCK_CD"));
		strArgument	  += " SMALL_BLOCK_CD=" + quote(ds_Walk_plan.GetColumn(nRow,"SMALL_BLOCK_CD"));	
		strArgument	  += " PATROL_YMD=" + quote(cal_PPatrolYmd.value);			
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	
	if(ErrorCode < 0)
	{
		return;
	}
	
	// alert(ds_Rst_Walk.GetRowCount());
	
	if(ds_Walk_plan.GetColumn(nRow,"KOPIPE_LENG") == 0)			//도보본관 0과 같다면
	{
		cob_LeakYnMp.Enable = false;
		cob_PondsideSinkMp.Enable = false;
		cob_LinemarkMp.Enable = false;
		edt_ChkDescMp.Enable = false;
		edt_Leng_Mp.Enable = false;
	}
	else
	{
		cob_LeakYnMp.Enable = true;
		cob_PondsideSinkMp.Enable = true;
		cob_LinemarkMp.Enable = true;
		edt_ChkDescMp.Enable = true;
		edt_Leng_Mp.Enable = true;
	}
	
	if(ds_Walk_plan.GetColumn(nRow,"MPIPE_LENG") == 0)			//도보공급관 0과 같다면
	{		
		cob_LeakYnSp.Enable = false;
		cob_PondsideSinkSp.Enable = false;
		cob_LinemarkSp.Enable = false;
		edt_ChkDescSp.Enable = false;
		edt_Leng_Sp.Enable = false;
	}	
	else
	{
		cob_LeakYnSp.Enable = true;
		cob_PondsideSinkSp.Enable = true;
		cob_LinemarkSp.Enable = true;
		edt_ChkDescSp.Enable = true;
		edt_Leng_Sp.Enable = true;
	}

	if(ds_Rst_Walk.GetRowCount()==0) 
	{
		ds_Rst_Walk.ClearData();
		if (ds_Walk_plan.GetColumn(nRow,"KOPIPE_LENG") > 0 || ds_Walk_plan.GetColumn(nRow,"MPIPE_LENG") > 0)
		{
			ds_Rst_Walk.AddRow();
			ds_Rst_Walk.SetColumn(0,"BRANCH_CD", ds_Walk_plan.GetColumn(nRow,"BRANCH_CD"));		
			ds_Rst_Walk.SetColumn(0,"TEAM_CD", ds_Walk_plan.GetColumn(nRow,"TEAM_CD"));
			ds_Rst_Walk.SetColumn(0,"BLOCK_CD", ds_Walk_plan.GetColumn(nRow,"BLOCK_CD"));
			ds_Rst_Walk.SetColumn(0,"SMALL_BLOCK_CD", ds_Walk_plan.GetColumn(nRow,"SMALL_BLOCK_CD"));
			ds_Rst_Walk.SetColumn(0,"PATROL_YMD", cal_PPatrolYmd.value);
			ds_Rst_Walk.SetColumn(0,"LENG_MP", ds_Walk_plan.GetColumn(nRow,"KOPIPE_LENG"));
			ds_Rst_Walk.SetColumn(0,"LENG_SP", ds_Walk_plan.GetColumn(nRow,"MPIPE_LENG"));
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID1", edt_empid1.text);
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID2", edt_empid2.text);
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID3", edt_empid3.text);       
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID1_NM", edt_empnm1.text);
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID2_NM", edt_empnm2.text);
			ds_Rst_Walk.SetColumn(0,"TAKER_EMPID3_NM", edt_empnm3.text);               
			btn_Save.Enable = true;
			btn_Delete.Enable = true;
		}	
		else
		{
			btn_Save.Enable = false;
			btn_Delete.Enable = false;		
		}
	}	
}


function btn_Delete_OnClick(obj)
{
	if(ds_Rst_Walk.GetRowType(0) == "insert")
	{
		ds_Rst_Walk.DeleteRow(0);
		return;
	}

	if (fn_decide(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"), ds_Rst_Walk.GetColumn(0, "BRANCH_CD"), ds_Rst_Walk.GetColumn(0, "TEAM_CD")) == false)
	{
		alert(substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),0,4) + "년" + substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),4,2) + "월" + substr(ds_Rst_Walk.GetColumn(0, "PATROL_YMD"),6,2) + "일은 결재(진행/완료)중으로 삭제가 불가합니다...");
		return;	
	}

	// if (ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '0' || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '1'  || ds_Car.GetColumn(0, "DECIDE_PROC_STS") == '2') 
	// {	
		// alert(substr(cal_PPatrolYmd.Value,0,4) + "년" + substr(cal_PPatrolYmd.Value,4,2) + "월" + substr(cal_PPatrolYmd.Value,6,2) + "일은 결재(진행/완료)중으로 삭제가 불가합니다...");
		// return;
    // }else if(confirm("차량 순찰내역을 삭제하시겠습니까?"))

	if(!confirm("도보순찰내역을 삭제하시겠습니까?"))
    {
		return;
	}	

    ds_Rst_Walk.UpdateControl=false;
    ds_Rst_Walk.SetRowType(0,"delete");
	var strSvcID = "del_walk";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Rst_Walk=ds_Rst_Walk:u";
	var strOutDatasets  = "";
	var strArgument  = "del_walk=1";
	
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);

	if(ErrorCode < 0)
	{
		return;
	}
	else
	{   
		ds_Rst_Walk.ClearData();
		alert(gfn_GetMessage("M000009","%AAA%","삭제를"));
	}
}

function fn_decide(PATROL_YMD, BRANCH_CD, TEAM_CD)
{
	ds_Decide.ClearData();
	
	var strSvcID        = "decide";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Decide=ds_Decide";
	var strArgument     = "decide=1";
		strArgument		+= " PATROL_YMD="  + PATROL_YMD;
		strArgument		+= " BRANCH_CD=" + BRANCH_CD;
		strArgument		+= " TEAM_CD="  + TEAM_CD;

	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );


	if(ds_Decide.RowCount() == 0) return true;

	if(ds_Decide.GetColumn(0,"DECIDE_PROC_STS") == '0' || ds_Decide.GetColumn(0,"DECIDE_PROC_STS") == '1' || ds_Decide.GetColumn(0,"DECIDE_PROC_STS") == '2')
	{
		return false;
	}	
	else
	{
		return true;
	}	
}]]></Script>
</Window>