<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="595" Id="D1302060010U" Left="8" OnLoadCompleted="D1302060010U_OnLoadCompleted" PidAttrib="7" Title="사용자공급관자율검사서_D1302060010U" Top="8" Ver="1.0" Width="738" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_FreeHouse" OnColumnChanged="ds_FreeHouse_OnColumnChanged">
				<Contents>
					<colinfo id="ROW_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_LIVE_INSPECT_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_NOT_PASS" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_NONE" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_2" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_RSLT_CD" size="256" summ="default" type="STRING"/>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>10</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶배관의&#32;전위측정&#32;및&#32;측정용&#32;터미널&#32;설치상태</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>10</INSPECT_ITEM>
						<INSPECT_KITEM>배관</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>1</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>11</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶사용가스명,&#32;최고사용압력,&#32;가스흐름방향표시</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>11</INSPECT_ITEM>
						<INSPECT_KITEM>배관의&#32;표시</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>2</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>12</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶화기와&#32;2M이상&#32;거리유지&#32;및&#32;분리가능한&#32;차단밸브&#32;설치상태</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>12</INSPECT_ITEM>
						<INSPECT_KITEM>입상관의&#32;설치</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>3</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>13</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶밸브의&#32;설치&#32;높이&#32;적정여부(1.6M~2M)</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>12</INSPECT_ITEM>
						<INSPECT_KITEM>입상관의&#32;설치</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>3</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>14</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶매설배관은&#32;용접으로&#32;하고&#32;나사접합은&#32;KS기준에&#32;따르고&#32;이음쇠가&#32;주조품인&#32;경우&#32;KS또는&#32;동등이상의&#32;제품사용여부</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>13</INSPECT_ITEM>
						<INSPECT_KITEM>배관의&#32;접합</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>4</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>15</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶고정부착&#32;장치상태&#32;및&#32;고정개소의&#32;거리&#32;유지상태</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>14</INSPECT_ITEM>
						<INSPECT_KITEM>배관의&#32;고정</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>5</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>16</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶인입밸브&#32;및&#32;지하실등의&#32;가스공급을&#32;지상에서&#32;차단할&#32;수&#32;있는&#32;기타밸브의&#32;설치여부</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>15</INSPECT_ITEM>
						<INSPECT_KITEM>가스차단&#32;장치</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>6</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>17</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶밸브박스의&#32;부식상태&#32;및&#32;침수여부</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>15</INSPECT_ITEM>
						<INSPECT_KITEM>가스차단&#32;장치</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>6</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>18</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶카트식&#32;검지기&#32;및&#32;가스누설검지기로&#32;점검</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>16</INSPECT_ITEM>
						<INSPECT_KITEM>누출검사</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>7</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>19</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶밸브,수취기는&#32;가스누설검지기로&#32;점검</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>16</INSPECT_ITEM>
						<INSPECT_KITEM>누출검사</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>7</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>20</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶도시가스&#32;사용에&#32;적합한&#32;것일것</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>17</INSPECT_ITEM>
						<INSPECT_KITEM>가스계량기</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>8</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>21</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶설치상태&#32;높이&#32;및&#32;이격거리&#32;적정유지&#32;여부</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>17</INSPECT_ITEM>
						<INSPECT_KITEM>가스계량기</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>8</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>22</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶사용압력&#32;이상의&#32;압력으로&#32;누출검사&#32;실시</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>18</INSPECT_ITEM>
						<INSPECT_KITEM>기밀시험</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1>누출검사로&#32;대체</RMK1>
						<RMK2></RMK2>
						<ROW_NUM>9</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>23</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶노출된&#32;배관은&#32;건축물&#32;내부&#32;또는&#32;기초&#32;밑에&#32;설치하지&#32;아니할것</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>19</INSPECT_ITEM>
						<INSPECT_KITEM>배관의&#32;설치장소</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>10</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
					<record>
						<CHK_NONE></CHK_NONE>
						<CHK_NOT_PASS></CHK_NOT_PASS>
						<CHK_PASS></CHK_PASS>
						<CO_LIVE_INSPECT_ITEM>24</CO_LIVE_INSPECT_ITEM>
						<CRT_EMPID></CRT_EMPID>
						<CRT_IP></CRT_IP>
						<DESC>▶실외에&#32;설치하되,&#32;실내에서&#32;설치된&#32;경우&#32;수시환기&#32;가능한지&#32;여부</DESC>
						<FACI_NUM></FACI_NUM>
						<INSPECT_ITEM>20</INSPECT_ITEM>
						<INSPECT_KITEM>압력조정기</INSPECT_KITEM>
						<INSPECT_NM_1></INSPECT_NM_1>
						<INSPECT_NM_2></INSPECT_NM_2>
						<INSPECT_RSLT_CD></INSPECT_RSLT_CD>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<RMK1></RMK1>
						<RMK2></RMK2>
						<ROW_NUM>11</ROW_NUM>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FreeHouseList" OnColumnChanged="ds_FreeHouse_OnColumnChanged">
				<Contents>
					<colinfo id="CO_LIVE_INSPECT_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_RSLT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_2" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SignView">
				<Contents>
					<colinfo encrypt="base64" id="SIGN_1" size="256" summ="default" type="BLOB"/>
					<colinfo encrypt="base64" id="SIGN_2" size="256" summ="default" type="BLOB"/>
					<colinfo id="INSPECT_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CO_LIVE_INSPECT_ITEM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Sign">
				<Contents>
					<colinfo encrypt="base64" id="SIGN" size="256" summ="default" type="BLOB"/>
					<colinfo id="INSPECT_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" summ="default" type="STRING"/>
					<record>
						<FACI_NUM></FACI_NUM>
						<INSPECT_YEAR></INSPECT_YEAR>
						<INSPECT_YMD></INSPECT_YMD>
						<SIGN></SIGN>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HouseRstFlag1"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_HouseResult" OnColumnChanged="ds_FreeHouse_OnColumnChanged">
				<Contents>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_1" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_NM_2" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="INSPECT_RSLT_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static19" Left="47" Style="table" TabOrder="6" Top="68" VAlign="Middle" Width="683" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="39" Id="Image1" ImageID="popup_top" LeftMargin="33" OnClick="Image1_OnClick" Style="popup_title" TabOrder="1" Text="사용자공급관자율검사서" Transparent="TRUE" Width="737"></Image>
		<Static Align="Right" Border="Flat" Height="22" Id="Static78" Left="417" Style="table_1" TabOrder="2" Text="검사일자" Top="68" VAlign="Middle" Width="59" WordWrap="TRUE"></Static>
		<Grid AutoEnter="TRUE" BindDataset="ds_FreeHouse" BkColor2="user19" BoldHead="FALSE" Border="Flat" Bottom="453" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Face3dColor="user6" HeadBorder="Flat" HeadHeight="20" Height="338" Id="grd_FreeHouse" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" Right="733" SelColor="MENU" Style="grid_pop" TabOrder="4" TabStop="true" Top="115" UseAutoSizing="Row" UseDBuff="true" UseExSizing="Row" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="728">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="40"/>
						<col width="90"/>
						<col width="361"/>
						<col width="44"/>
						<col width="45"/>
						<col width="49"/>
						<col width="97"/>
					</columns>
					<head>
						<cell col="0" display="normal" rowspan="2" text="번호"/>
						<cell col="1" display="text" rowspan="2" text="검사항목"/>
						<cell col="2" display="text" rowspan="2" text="세부사항"/>
						<cell col="3" colspan="2" display="text" text="판정"/>
						<cell col="5" display="text" rowspan="2" text="해당없음"/>
						<cell col="6" display="text" rowspan="2" text="비고"/>
						<cell col="3" display="text" row="1" text="적"/>
						<cell col="4" display="text" row="1" text="부"/>
					</head>
					<body>
						<cell align="center" bkcolor="user12" col="0" colid="ROW_NUM" display="text" expandsize="18" suppress="1" SuppressAlign="Middle" wordwrap="word"/>
						<cell bkcolor="user12" col="1" colid="INSPECT_KITEM" display="text" expandsize="18" suppress="1" SuppressAlign="Middle" wordwrap="word"/>
						<cell bkcolor="user12" col="2" colid="DESC" display="text" expandsize="18" SuppressAlign="Middle" wordwrap="word"/>
						<cell bkcolor="user12" col="3" colid="CHK_PASS" display="checkbox" edit="checkbox" expandsize="18" wordwrap="word"/>
						<cell bkcolor="user12" col="4" colid="CHK_NOT_PASS" display="checkbox" edit="checkbox" expandsize="18" wordwrap="word"/>
						<cell bkcolor="user12" col="5" colid="CHK_NONE" display="checkbox" edit="checkbox" expandsize="18" wordwrap="word"/>
						<cell bkcolor="user12" col="6" colid="RMK1" display="text" edit="normal" expandsize="18" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user16" Bottom="115" Height="3" Id="Shape1" Left="5" LineWidth="0" Right="733" TabOrder="5" Top="112" Type="Rectangle" Width="728"></Shape>
		<Static Align="Right" Border="Flat" Height="22" Id="Static71" Left="5" Style="table_1" TabOrder="3" Text="시설명" Top="68" VAlign="Middle" Width="43" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static10" Left="568" Style="table_1" TabOrder="7" Text="전검사일자" Top="68" VAlign="Middle" Width="67" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static11" Left="156" Style="table_1" TabOrder="8" Text="시설내역" Top="68" VAlign="Middle" Width="59" WordWrap="TRUE"></Static>
		<Div DisableBKColor="white" Height="27" Id="Div0" Left="385" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="9" Text="Div0" Top="40" Url="globals::ComButton.xml" Visible="FALSE" Width="345">
			<Contents></Contents>
		</Div>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_CoLiveNm" Left="49" Style="edit" TabOrder="10" Top="70" Width="106"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_FaciRmk" Left="216" Style="edit" TabOrder="11" Top="70" Width="199"></Edit>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_InspectYmd" Left="477" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="12" Top="70" WeeksFont="Default,-1" Width="90"></Calendar>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_InspectYmdPri1" Left="636" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="13" Top="70" WeeksFont="Default,-1" Width="90"></Calendar>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_HouseProc" ImageID="btn_4" Left="139" LeftMargin="21" OnClick="btn_HouseProc_OnClick" Style="button" TabOrder="14" Text="전자결재" Top="92" Width="76"></Button>
		<Static Align="Center" BKColor="white" Border="Flat" Height="137" Id="edt_SiteChiefNm" Left="3" Style="table" TabOrder="15" Top="454" VAlign="Middle" Width="730" WordWrap="TRUE"></Static>
		<TextArea Border="Flat" Height="132" Id="ta_Rmk2" Left="42" MaxLength="50" Style="textarea" TabOrder="15" Top="456" VScroll="TRUE" Width="291"></TextArea>
		<Edit Align="CENTER" Border="Flat" DisableBKColor="user8" Height="21" Id="edt_InspectNm1" Left="397" MaxLength="160" Style="edit" TabOrder="16" Top="456" Width="108"></Edit>
		<Edit Align="CENTER" Border="Flat" DisableBKColor="user8" Height="21" Id="edt_InspectNm2" Left="623" MaxLength="160" Style="edit" TabOrder="17" Top="456" Width="108"></Edit>
		<Static Align="Center" Border="Flat" Height="132" Id="Static5" Left="5" Style="pop_table" TabOrder="18" Text="특기사항" Top="456" VAlign="Middle" Width="36" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user6" Border="Flat" Height="21" Id="Static2" Left="336" Style="table" TabOrder="20" Text="검사원1" Top="456" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Static Align="Center" BKColor="user6" Border="Flat" Height="21" Id="Static13" Left="562" Style="table" TabOrder="21" Text="검사원2" Top="456" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Image BindDataset="ds_SignView" Border="Flat" Column="SIGN_2" Height="111" Id="SignImg1" Left="562" TabOrder="22" Top="478" Width="169"></Image>
		<Sign BindDataset="ds_SignView" Border="FLAT" Column="SIGN_1" Height="111" Id="sign" Left="336" TabOrder="23" Text="(서명)" Top="478" Width="169"></Sign>
		<Sign BindDataset="ds_SignView" Border="FLAT" Column="SIGN_2" Height="111" Id="sign1" Left="562" TabOrder="24" Text="(서명)" Top="478" Width="169"></Sign>
		<Image BindDataset="ds_SignView" Border="Flat" Column="SIGN_1" Height="111" Id="SignImg" Left="336" TabOrder="25" Top="478" Width="169"></Image>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Sign" ImageID="btn_4_Close&#32;cancellation" Left="507" LeftMargin="21" OnClick="btn_Sign_OnClick" Style="button" TabOrder="19" Text="취소" Top="479" Width="52"></Button>
		<File Bottom="128" Height="24" Id="File0" Left="768" Right="792" TabOrder="30" Top="104" Width="24"></File>
		<Image Align="Left" Height="18" Id="Image2" ImageID="blt" Left="10" LeftMargin="12" Style="blt_search" TabOrder="29" TabStop="FALSE" Text="등록자&#32;:&#32;" Top="45" Width="67"></Image>
		<Static Height="13" Id="st_CRTNM" Left="72" Style="static" TabOrder="30" Top="48" Width="62"></Static>
		<Image Align="Left" Height="18" Id="Image6" ImageID="blt" Left="138" LeftMargin="12" Style="blt_search" TabOrder="27" TabStop="FALSE" Text="등록일자&#32;:&#32;" Top="45" Width="67"></Image>
		<Static Height="13" Id="st_CRTTIME" Left="213" Style="static" TabOrder="28" Top="48" Width="112"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button80" ImageID="btn_4_copy" Left="58" LeftMargin="21" OnClick="fn_D1_Print1" Style="button" TabOrder="31" Text="장표출력" Top="92" Width="76"></Button>
		<Edit Align="CENTER" Border="Flat" DisableColor="red" Enable="FALSE" Height="18" Id="edt_Decide_proc_sts" Left="353" Style="edit" TabOrder="35" Top="92" Width="63"></Edit>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="280" LeftMargin="12" Style="blt_search" TabOrder="32" TabStop="FALSE" Text="결재상태&#32;:&#32;" Top="92" Width="67"></Image>
		<Image Align="Left" Height="18" Id="Image4" ImageID="blt" Left="421" LeftMargin="12" Style="blt_search" TabOrder="33" TabStop="FALSE" Text="결재일자&#32;:&#32;" Top="92" Width="67"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_DecideYmd" Left="491" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="34" Top="92" WeeksFont="Default,-1" Width="100"></Calendar>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1302060010U.xml
* Form 설명  : 자율 검사 공동주택장표를 등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 김태화 
* 작성일     : 2009-01-06
* 변경내용   : 
****************************************************************************************************/
//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10008.js";

var strFaciNum     = "";
var strInspectYear = "";
var strRowType     = "";
var strMaterFlag   = "";
function D1302060010U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	
	fn_Init();
}

//---------------------------------------------------------
//	초기 설정
//---------------------------------------------------------
function fn_Init()
{
	cal_DecideYmd.Text = DECIDE_YMD;
	edt_Decide_proc_sts.Text = DECIDE_PROC_STS;
	
	// 넘어온 파라메터가 있으면
	if(IsExistVar("INSPECT_YMD"))
	{
		cal_InspectYmd.Text = INSPECT_YMD;
	}
	
	if(IsExistVar("INSPECT_YMD_PRI1"))
	{
		cal_InspectYmdPri1.Text = INSPECT_YMD_PRI1;
	}
	
	if(IsExistVar("CO_LIVE_NM"))
	{
		edt_CoLiveNm.Text = CO_LIVE_NM;
	}
	
	if(IsExistVar("FACI_RMK"))
	{
		edt_FaciRmk.Text = FACI_RMK;
	}
	
	if(IsExistVar("FACI_NUM"))
	{
		strFaciNum = FACI_NUM;
	}
	if(IsExistVar("INSPECT_YEAR"))
	{
		strInspectYear = INSPECT_YEAR;
	}
	
	if(IsExistVar("CRT_EMPID"))
	{
		st_CRTNM.text = CRT_EMPID;
	}
	else
	{
		st_CRTNM.text = "1111";
	}
	if(IsExistVar("CRT_DTM"))
	{
		st_CRTTIME.text = CRT_DTM;
	}
	
	if(IsExistVar("ROWTYPE"))
	{
		strRowType = ROWTYPE;
		if(strRowType == "search" || strRowType == "update")
		{
			fn_D1_FindHouse();
		}
	//}//권기철 2010.11.10
	//if(IsExistVar("MATER_FLAG"))
	//{
		//strMaterFlag = MATER_FLAG;
		
		//if(strMaterFlag == "1" && strRowType == "insert")
		//{
		//	ds_FreeHouse.SetColumn(0,"CHK_NONE",1);
		//}
		if(strRowType == "search" )
		{
			/*
			grd_FreeHouse.Editable = "false";
			edt_InspectNm1.Enable = "false";
			edt_InspectNm2.Enable = "flase";
			*/
			
			// 2012.04.05 이건민 수정
			grd_FreeHouse.Editable = "true";
			edt_InspectNm1.Enable = "true";
			edt_InspectNm2.Enable = "true";
			strRowType = "update";
		}
	}
	
	grd_FreeHouse.BindDataset = "ds_FreeHouse";
	fn_D1_SignSearch();
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_FindHouse()
//   설명:  자율 검사 대상 공동주택장표를 조회한다.
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_FindHouse()
{	
	var strSvcID = "fn_D1_Find";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveListMgr-service&INSPECT_YEAR="+strInspectYear+"&FACI_NUM="+strFaciNum+"&INSPECT_YMD="+cal_InspectYmd.Value;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_FreeHouseList=ds_FreeHouseList";
	var strArgument  = "findHouse";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );	
			   
	fn_D1_FreeHouseInit();
}

function fn_CommonSearch(){
	fn_D1_FindHouse();
	fn_D1_SignSearch();
}

function fn_CommonSelect(){
	
	fn_D1_FindHouse();
	
	var strType = "";
	var strNotPass = "";
		
	if(strRowType == "update")
	{
		strType = "update";
		
	}else if(strRowType == "insert")
	{
		strType = "insert";
	
	}else if(strRowType == "search")
	{
		strType = "search";
	}
	
	for(var i=0; i<ds_FreeHouse.RowCount(); i++)
	{
		var strRstCd = 0;
		
		if(ds_FreeHouse.GetColumn(i, "INSPECT_ITEM") != '90'){
			if(ds_FreeHouse.GetColumn(i,"CHK_PASS") == 1)
			{
				strRstCd   = 1;
			}else if(ds_FreeHouse.GetColumn(i,"CHK_NOT_PASS") == 1)
			{
				strRstCd   = 2;
				strNotPass = "Y";
			}else if(ds_FreeHouse.GetColumn(i,"CHK_NONE") == 1)
			{
				strRstCd = 3;
			}
		}
	}
	
	var nCount = 0;
	
	for(var i=0; i<ds_FreeHouse.RowCount(); i++)
	{	
		if(ds_FreeHouse.GetColumn(i, "INSPECT_ITEM") != '90'){
			if(ds_FreeHouse.GetColumn(i,"CHK_NOT_PASS") == 1)
			{
				nCount = toNumber(nCount) + 1;
			}
		}
	}
	
	var arrList = array();
	
	arrList[0] = edt_InspectNm1.Text;
	arrList[1] = edt_InspectNm2.Text;
	
	var str_FACI_NUM     = strFaciNum;
	var str_INSPECT_YEAR = strInspectYear;
	var str_INSPECT_YMD  = cal_InspectYmd.Value;

	var strChkFlag = fn_D1_CheckReg1(str_INSPECT_YEAR, str_INSPECT_YMD, str_FACI_NUM);
	
	if(!strChkFlag) 
	{
		if(nCount > 0){
			arrList[2] = "saveNotPass";
			Close(arrList);
		}else{			
			
			arrList[2] = "savePass";
			Close(arrList);
		}
	}else{
		arrList[2] = "none";
		Close(arrList);
	}
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_FreeHouseInit()
//   설명:  자율 검사 대상 공동주택장표 해당 내용을 셋팅한다.
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_FreeHouseInit()
{	
	for(var i=0;i<ds_FreeHouseList.RowCount();i++)
	{
		if(ds_FreeHouseList.GetColumn(i,"INSPECT_RSLT_CD") == "1")
		{
			ds_FreeHouse.SetColumn(i,"CHK_PASS",1);
		}else if(ds_FreeHouseList.GetColumn(i,"INSPECT_RSLT_CD") == "2")
		{
			ds_FreeHouse.SetColumn(i,"CHK_NOT_PASS",1);
		}else if(ds_FreeHouseList.GetColumn(i,"INSPECT_RSLT_CD") == "3")
		{
			ds_FreeHouse.SetColumn(i,"CHK_NONE",1);
		}
		ds_FreeHouse.SetColumn(i,"RMK1",ds_FreeHouseList.GetColumn(i,"RMK1"));
		edt_InspectNm1.Text = ds_FreeHouseList.GetColumn(i,"INSPECT_NM_1");
		edt_InspectNm2.Text = ds_FreeHouseList.GetColumn(i,"INSPECT_NM_2");
		ta_Rmk2.Text = ds_FreeHouseList.GetColumn(i,"RMK2");
	}
}

//------------------------------------------------------------------------------- 
// 함수명: btn_HouseProc_OnClick()
//   설명: 정압기장표에 관한 내용을 저장
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_HouseProc_OnClick(obj)
{
	if(edt_Decide_proc_sts.text == '승인' || edt_Decide_proc_sts.text == '결재중')
	{
		alert("현재 " + edt_Decide_proc_sts.text + " 상태입니다.");
		return;
	}
	
	var InspectYmd = cal_InspectYmd.Value;
	var InspectFlag = '20';
	var InspectYear = strInspectYear;
	var Faci_num = strFaciNum;

	//그룹웨어에서 차량번호(한글)파라메터 전달 불가로 로그인자 사번넘겨 차량번호 참조 오즈로 넘겨줌 
	gfv_callGWInfo("fmD12","D10","D1302060010P",4,InspectYear+","+InspectFlag+","+Faci_num+","+InspectYmd);
   // 1번 : 화면명칭   2번 : 업무그룹 (b10,b20... OZ 인경우 필수), 3번: 프로그램ID (oz인경우 필수) 4: 아규먼트 갯수 (1....5)
   // 5번 : 아규먼트 목록 (형식 , 표시로 각 아규먼트 구분자 사용)		
}


function fn_D1_Print1(obj)
{
	var strTitle    = "사용자공급관 자율검사서" ;  		// 출력물 제목
    var strPart     = "D10" ;         	    		  				// 시스템 명 
	var strReport   = "D1302060010P" ;  	    	 				// 출력물 ID 
	var strParameter= "INSPECT_YMD="     + cal_InspectYmd.Value
				    + ",INSPECT_YEAR="	 + strInspectYear
				    + ",INSPECT_FLAG="	 + '20'
				    + ",FACI_NUM="		 + strFaciNum
				    ;	   
				   
	//공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);	
}


/*===============================================================================
 * 함수명: fn_CommonSave()
   설명:  배관장표에 관한 내용을 저장
   return 내용: 없음
===============================================================================*/ 
function fn_CommonSave()
{
	if(edt_Decide_proc_sts.text == '승인' || edt_Decide_proc_sts.text == '결재중')
	{
		alert("현재 " + edt_Decide_proc_sts.text + " 상태입니다.");
		return;
	}
		
	var str_FACI_NUM     = strFaciNum;
	var str_INSPECT_YEAR = strInspectYear;
	var str_INSPECT_YMD  = cal_InspectYmd.Value;

	// var strChkFlag = fn_D1_CheckReg1(str_INSPECT_YEAR, str_INSPECT_YMD, str_FACI_NUM);
	
		// if(!strChkFlag) 
		// {
			// var str_CRTDTM = ds_HouseRstFlag1.GetColumn(0, "CRT_TIME" );
			// var str_CRTNM  = ds_HouseRstFlag1.GetColumn(0, "CRT_EMPNM");
		
			// var str_INSPECT_YMD1  = substr(str_INSPECT_YMD, 0, 4);
				// str_INSPECT_YMD1 += "년 ";
				// str_INSPECT_YMD1 += substr(str_INSPECT_YMD, 4, 2);
				// str_INSPECT_YMD1 += "월 ";
				// str_INSPECT_YMD1 += substr(str_INSPECT_YMD, 6, 2);
				// str_INSPECT_YMD1 += "일";
		
			// alert("검사일자 " + str_INSPECT_YMD1 + "에 대한 결과 데이터는 \n" + str_CRTNM + "님께서 " + str_CRTDTM + "에 이미 등록하신 데이터입니다. \n데이터를 조회해 주십시오. ");
			// return;
		// }	
	
	var strType = "";
	var strNotPass = "";

	if(strRowType == "update")
	{
		strType = "update";
	}else if(strRowType == "insert")
	{
		strType = "insert";
	}else {
		close();
	}
	
	for(var i=0; i<ds_FreeHouse.RowCount(); i++)
	{
		var strRstCd = 0;
		
		if(ds_FreeHouse.GetColumn(i,"CHK_PASS") == 1)
		{
			strRstCd = 1;
		}else if(ds_FreeHouse.GetColumn(i,"CHK_NOT_PASS") == 1)
		{
			strRstCd = 2;
			strNotPass = "Y";
		}else if(ds_FreeHouse.GetColumn(i,"CHK_NONE") == 1)
		{
			strRstCd = 3;
		}else 
		{
			if(ds_FreeHouse.GetColumn(i, "INSPECT_ITEM") != '90'){
				alert('검사항목을 모두 체크해 주세요');
				return;
			}
		}
		
		if(edt_InspectNm1.Text == "")
		{
			alert(gfn_GetMessage("M000011","%AAA%","검사원1을"));
			return;
		}
		// if(edt_InspectNm2.Text == "")
		// {
			// alert(gfn_GetMessage("M000011","%AAA%","검사원2을"));
			// return;
		// }
		
		ds_FreeHouse.UpdateControl = false;
		ds_FreeHouse.SetRowType(i, strType);
		
		ds_FreeHouse.SetColumn(i, "INSPECT_RSLT_CD", strRstCd            );
		ds_FreeHouse.SetColumn(i, "INSPECT_YMD"    , cal_InspectYmd.Value);
		ds_FreeHouse.SetColumn(i, "RMK2"           , ta_Rmk2.Text        );
		ds_FreeHouse.SetColumn(i, "INSPECT_NM_1"   , edt_InspectNm1.Text );
		ds_FreeHouse.SetColumn(i, "INSPECT_NM_2"   , edt_InspectNm2.Text );
		ds_FreeHouse.SetColumn(i, "FACI_NUM"       , strFaciNum          );
		ds_FreeHouse.SetColumn(i, "INSPECT_YEAR"   , strInspectYear      );
		
		//수정 등록시 셋팅할 사용자 정보
		ds_FreeHouse.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"  ));
		ds_FreeHouse.SetColumn(i, "UPD_IP"   , gfn_GetGlobalValue("G_IPADDRESS"));
		ds_FreeHouse.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"  ));
		ds_FreeHouse.SetColumn(i, "CRT_IP"   , gfn_GetGlobalValue("G_IPADDRESS"));
	}	
	
	ds_HouseResult.ClearData();
	ds_HouseResult.AddRow();
	
	if(strNotPass = "Y"){
		ds_HouseResult.SetColumn(0, "INSPECT_RSLT_CD", 20);
	}else{
		ds_HouseResult.SetColumn(0, "INSPECT_RSLT_CD", 10);
	}
	
	ds_HouseResult.SetColumn(0, "UPD_EMPID"		  , gfn_GetGlobalValue("G_USER_NO"  ));
	ds_HouseResult.SetColumn(0, "UPD_IP"		  , gfn_GetGlobalValue("G_IPADDRESS"));
	ds_HouseResult.SetColumn(0, "INSPECT_YMD"     , ds_FreeHouse.GetColumn(0, "INSPECT_YMD"    ));
	ds_HouseResult.SetColumn(0, "RMK2"			  , ds_FreeHouse.GetColumn(0, "RMK2"           ));
	ds_HouseResult.SetColumn(0, "INSPECT_NM_1"	  , ds_FreeHouse.GetColumn(0, "INSPECT_NM_1"   ));
	ds_HouseResult.SetColumn(0, "INSPECT_NM_2"	  , ds_FreeHouse.GetColumn(0, "INSPECT_NM_2"   ));
	ds_HouseResult.SetColumn(0, "FACI_NUM"		  , ds_FreeHouse.GetColumn(0, "FACI_NUM"       ));
	ds_HouseResult.SetColumn(0, "INSPECT_YEAR"    , ds_FreeHouse.GetColumn(0, "INSPECT_YEAR"   ));
				
	ds_HouseResult.UpdateControl = false;
	ds_HouseResult.SetRowType(0, "update");
	
	var strSvcID 		= "saveHouse";
	var strPart 		= "D10";
	var strURL 	        = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveListMgr-service";
	var strInDatasets   = "ds_FreeHouse=ds_FreeHouse:u ds_HouseResult=ds_HouseResult:u";
	var strOutDatasets  = "";
	var strArgument     = "savaHouseRst";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	fn_D1_SignSave();
	
	if(strRowType == "update")
	{	
		// 2012.04.05 이건민 추가
		if(edt_Decide_proc_sts.text == '반려' || edt_Decide_proc_sts.text == '요청취소')
		{
			alert("데이터가 정상적으로 변경되었습니다. 재결재 해주세요.");
			return;
		}else{
			alert("데이터가 정상적으로 변경되었습니다. ");
		}
	}else if(strRowType == "insert")
	{
		strType = "insert";
		alert("데이터가 정상적으로 저장되었습니다. ");
	}
}

function ds_FreeHouse_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{

	if(varOldValue != varNewValue)
	{	
		ds_FreeHouse.FireEvent = false;
		//확인 필요 권기철	2010.01.11
		//=================
		if(strColumnID == "CHK_PASS"){
			 if( ds_FreeHouse.GetColumn(nRow, "CHK_PASS") == '1'){
				 ds_FreeHouse.SetColumn(nRow,"CHK_NOT_PASS", 0);
				 ds_FreeHouse.SetColumn(nRow,"CHK_NONE"    , 0);
			 }
		}
		
		if(strColumnID == "CHK_NOT_PASS"){
			if( ds_FreeHouse.GetColumn(nRow, "CHK_NOT_PASS") == '1'){
				ds_FreeHouse.SetColumn(nRow,"CHK_PASS"    , 0);
				ds_FreeHouse.SetColumn(nRow,"CHK_NONE"    , 0);
			}
		}
		
		if(strColumnID == "CHK_NONE"){
			if( ds_FreeHouse.GetColumn(nRow, "CHK_NONE") == '1'){
				ds_FreeHouse.SetColumn(nRow,"CHK_PASS"    , 0);
				ds_FreeHouse.SetColumn(nRow,"CHK_NOT_PASS", 0);
			}
		}
		ds_FreeHouse.FireEvent = true;
	}
}
/*===============================================================================
 * 함수명: fn_D11_SignSave()
   설명:  배관장표에 관한 서명을 조회
   return 내용: 없음
===============================================================================*/ 
function fn_D1_SignSearch()
{
	var strSvcID = "";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveListMgr-service&SignSearch=1"
				 + "&INSPECT_YEAR="		+strInspectYear
                 + "&FACI_NUM="			+strFaciNum
                 + "&INSPECT_YMD="		+cal_InspectYmd.Value
                 ; 
			
	var strInDatasets  = "";
	var strOutDatasets  = "ds_SignView=ds_SignView";
	var strArgument  = "";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );	   		   
	
	if(ds_SignView.GetCount() < 1){
		ds_SignView.AddRow();
	}
	
	if(ds_SignView.GetColumn(0, "SIGN_1") == null || ds_SignView.GetColumn(0, "SIGN_1") == ''){
		 SignImg.Visible = false;
		 sign.Visible    = true;
		 sign.Enable     = true;
	}else{
		 SignImg.Visible = true;
		 sign.Visible    = false;
	}
			   
	 if(ds_SignView.GetColumn(0, "SIGN_2") == null || ds_SignView.GetColumn(0, "SIGN_2") == ''){
		 SignImg1.Visible = false;
		 sign1.Visible    = true;
		 sign1.Enable     = true;
	 }else{
		 SignImg1.Visible = true;
		 sign1.Visible    = false;
	 }
}

function fn_D1_SignSave()
{		
		ds_Sign.UpdateControl = false;
		ds_Sign.SetRowType(0, "update");
		
		sign.SaveFile("JPG", "C:\\test.jpg");
		File0.FileName = "C:\\test.jpg";
		
		if (File0.open('rb'))
		{
			var sbuff;
			sbuff = File0.ReadBinary();
			File0.Close();
			ds_Sign.SetColumn(0, "SIGN", sbuff);
		}
			
		ds_Sign.SetColumn(0, "INSPECT_YEAR" , ds_FreeHouse.GetColumn(ds_FreeHouse.row, "INSPECT_YEAR"     ));
		ds_Sign.SetColumn(0, "FACI_NUM"     , ds_FreeHouse.GetColumn(ds_FreeHouse.row, "FACI_NUM"         ));
		ds_Sign.SetColumn(0, "INSPECT_YMD"  , ds_FreeHouse.GetColumn(ds_FreeHouse.row, "INSPECT_YMD"      ));
		
		var strSvcID       = "";
		var strPart        = "D10";
		var strURL         = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveListMgr-service&sign=1";
		var strInDatasets  = "ds_Sign=ds_Sign:u";
		var strOutDatasets = "";
		var strArgument    = "";
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
					  );
					  
		if ( ErrorCode > 0 ){ return false ;}
		
		ds_Sign.UpdateControl = false;
		ds_Sign.SetRowType(0, "update");
		
		sign1.SaveFile("JPG", "C:\\test.jpg");
		File0.FileName = "C:\\test.jpg";
		
		if (File0.open('rb'))
		{
			var sbuff;
			sbuff = File0.ReadBinary();
			File0.Close();
			ds_Sign.SetColumn(0, "SIGN", sbuff);
		}
		
		var strSvcID       = "";
		var strPart        = "D10";
		var strURL         = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveListMgr-service&sign1=1";
		var strInDatasets  = "ds_Sign=ds_Sign:u";
		var strOutDatasets = "";
		var strArgument    = "";
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
					  );
					  
		if ( ErrorCode > 0 ){ return false ;}
}

function btn_Sign_OnClick(obj)
{
	// if(ds_FreeHouseList.GetRowCount() > 1){
		// return false;
	// }
	if(edt_Decide_proc_sts.text == '승인' || edt_Decide_proc_sts.text == '결재중')
	{
		alert("현재 " + edt_Decide_proc_sts.text + " 상태입니다.");
		return;
	}

	if(strRowType == 'search') 
	{
		strRowType = 'update';
	}

	ds_Sign.ClearData();
	ds_Sign.AddRow();
	ds_SignView.ClearData();
	ds_SignView.AddRow();
	
	SignImg.Visible = false;
	sign.Visible    = true;
	sign.Enable     = true;
	
	SignImg1.Visible = false;
	sign1.Visible    = true;
	sign1.Enable     = true;
		
}

//------------------------------------------------------------------------------- 
// 함수명: fn_D1_CheckReg()
//   설명: 자율검사 결과등록을 하기 전 기 등록 여부 확인
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_CheckReg1(str_INSPECT_YEAR, str_INSPECT_YMD, str_FACI_NUM)
{	
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List;
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------
    var strSvcID       = "fn_D1_CheckReg1";
    var strPart        = "D10";
    var strURL         = "handle.do?ServiceName=D1_SelfTestRsltRegisCoLiveMgr-service"
					   + "&FACI_NUM="     + str_FACI_NUM
					   + "&INSPECT_YEAR=" + str_INSPECT_YEAR
					   + "&INSPECT_YMD="  + str_INSPECT_YMD;
    var strInDatasets  = "";
    var strOutDatasets = "ds_HouseRstFlag1=ds_HouseRstFlag1";
    var strArgument    = "findRstFlag1";   
    gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	if(ds_HouseRstFlag1.RowCount() != 0) return false;
	return true;
}]]></Script>
</Window>