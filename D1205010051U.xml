<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="853" Id="D1205010051F" Left="8" OnLoadCompleted="D1205010051U_OnLoadCompleted" PidAttrib="7" Title="그래프_D1205010051U" Top="8" Ver="1.0" Width="1270" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Area">
				<Contents>
					<colinfo id="CODE_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_KNAME" size="256" summ="default" type="STRING"/>
					<colinfo id="ITEM_ENAME" size="256" summ="default" type="STRING"/>
					<colinfo id="C_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="N_VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="N_VALUE2" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_ID" size="256" summ="default" type="STRING"/>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>1</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>분극량</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>2</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>소요전류</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>3</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>방식연장</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>4</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>방식면적</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>5</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>전류밀도</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>6</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>코팅저항</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
					<record>
						<C_VALUE></C_VALUE>
						<CODE_ID></CODE_ID>
						<CODE_ITEM>7</CODE_ITEM>
						<ITEM_ENAME></ITEM_ENAME>
						<ITEM_KNAME>토양비저항</ITEM_KNAME>
						<N_VALUE></N_VALUE>
						<N_VALUE2></N_VALUE2>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape3" Left="5" LineColor="user7" Right="1265" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="6" Top="30" Type="RoundRect" Width="1260"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape4" Left="12" LineWidth="0" Right="1258" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="7" Top="35" Type="Rectangle" Width="1246"></Shape>
		<Image Align="Left" Color="user0" Height="18" Id="Image10" ImageID="blt" Left="25" LeftMargin="12" Style="blt_search_1" TabOrder="9" Text="기간" Top="40" Width="40"></Image>
		<Shape BKColor="user15" Bottom="94" Height="4" Id="Shape0" Left="5" LineWidth="0" Right="1265" TabOrder="3" Top="90" Type="Rectangle" Width="1260"></Shape>
		<Image Align="Left" Color="user0" Height="18" Id="Image3" ImageID="blt" Left="273" LeftMargin="12" Style="blt_search_1" TabOrder="4" Text="영역종류" Top="40" Width="64"></Image>
		<Static Height="13" Id="Static3" Left="160" Style="static" TabOrder="5" Text="~" Top="44" Width="10"></Static>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="8" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1260">
			<Contents></Contents>
		</Div>
		<XChart AllowDrag="true" Bottom="799" Grid="ChartGrid_Horz" Height="700" Id="XChart" Left="6" MenuBar="true" NSeries="2" NValues="5" PointLabels="true" Right="1264" Scrollable="true" SerLegBox="true" ToolBar="true" Top="99" Visible="FALSE" Width="1258">
			<_PersistData>&#13;&#10;/6yEieLn30NGWDYA8vJNQ/9oYXJ0RlgsIP9WZXJzaW9uPf82LjIuMTM0Mv8uMCwgQ3VsdP91cmU9bmV1dP9yYWwsIFB1Yv9saWNL&#13;&#10;ZXlUb/9rZW49YTE4N/84ZTIwNTJjMP84ZGNlElNvZv90d2FyZUZYLlr59B/y8wAj8vAgXgR6aw0E8vABAf7/gQUqawUBawUCawYG&#13;&#10;pQSRBdUy8vAQ8vAD8vD//4f/f4JlAXwCvwKRBQG/BUFyaWFs8vBBpG8P8vIFjgWsBQBGD1h/Ei5IaWdobCkQ/3RTZXR0aW5nZ3MQ&#13;&#10;CZMIRR8AB3YFzwEBAAgCHRMfWAWfLkF4aXOVAX0CAPECOhDy82UWKDjgAAUKRxULRxmeB88f3BmVAYKeAQGABtwfdwuNDo8FAgkM&#13;&#10;mx+tEA2xH2IvdC/nHLB/B3wvEi/DLwAOWhgP6I4FvAHy8VL59C5CYUNzZQAPEg8kDzYNF3cf/vwiDS5JR2FsbH9lcnlUeXBllQHl&#13;&#10;FDIlEfoMfS8AAhKqiTUTAh0dSD8uYjRP/2JqBy5CdWJio2xliThxM/LwFY0GBFdoQEu/ABaJNRfkLfxHP/sjCS5MaW5lD0luZm/b&#13;&#10;Ar0s0wM6IUlCiT+XCAG4GoEBGGVFfRnlFw9EZWZhGDD/LldpbmRvd3M=&#13;&#10;</_PersistData>
		</XChart>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_InputYmdFrom" Left="67" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="1" Top="40" WeeksFont="Default,-1" Width="88"></Calendar>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_InputYmdTo" Left="177" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="2" Top="40" WeeksFont="Default,-1" Width="88"></Calendar>
		<Combo Border="Flat" CodeColumn="CODE_ITEM" DataColumn="ITEM_KNAME" Height="18" Id="cob_AreaGb" InnerDataset="ds_Area" Left="338" OnChanged="btn_chart_OnClick" Style="combo" TabOrder="14" Top="40" Width="90"></Combo>
		<Image Align="Left" Height="10" Id="Image4" ImageID="blt_8" Left="6" LeftMargin="12" Style="text_title" TabOrder="12" Top="75" Width="12"></Image>
		<Edit Border="None" DisableBKColor="white" DisableColor="user1" Enable="FALSE" Font="돋움,9,Bold" Height="12" Id="title_gb" Left="25" ShadowColor="user6" TabOrder="13" Top="73" Width="80"></Edit>
		<Edit Border="None" DisableBKColor="white" DisableColor="user1" Enable="FALSE" Font="돋움,9,Bold" Height="12" Id="Edit3" Left="106" ShadowColor="user6" TabOrder="13" Text="영역조사&#32;통계" Top="73" Width="85"></Edit>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1205010051U.xml
* Form 설명   : 측정전위통계-선그래프(분극량, 소요전류, 방식연장, 방식면적, 전류밀도, 코팅저항, 토양비저항)
* 시스템 명   : 안전공금(D1)
* 작성자      : 김도현  
* 작성일      : 2013-03-25
* 변경내용    : 변경내용없음
****************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONB30001.js";
#include "JS::COMMONE50001.js";

var fv_State_Fg = "S";         //화면상태플래그 S:조회전;U:업데이트

//---------------------------------------------------------
//	화면 OnLoadCompleted 이벤트처리 발생하는 함수( 화면ID_OnLoadCompleted )
//---------------------------------------------------------
function D1205010051U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
    gfn_E5_InitComponents(obj);
    gfn_SetButton("00010001");	
	fn_D1_On_load();
	gfn_InitChart(XChart);	
	cob_AreaGb.Index = INDEX;
	fn_CommonSearch();
}


//---------------------------------------------------------
//	공통 버튼 클릭 - 조회
//---------------------------------------------------------
function fn_CommonSearch()
{
	fn_D1_Tr_find();
}


function fn_D1_On_load()
{
	cal_InputYmdFrom = YMDFROM;
	cal_InputYmdTo = YMDTO;
}   


function fn_D1_Tr_find()
{
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_Tr_find()
	// 설명     : 조회 트렌젝션을 처리 fn_D1_CallBack으로 결과를 넘김.
	// return 내용 : 없음
	//-------------------------------------------------------------------------------
	var strSvcID = "fn_D1_Tr_find";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_GraphMgr-service&find01=1"
               + "&FACI_NUM="+FACI_NUM                 
	           + "&INPUT_YMD_FROM=" + cal_InputYmdFrom.Value	//기준일자FROM 
	           + "&INPUT_YMD_TO="+ cal_InputYmdTo.Value      	//기준일자TO   
	           ;
	var strInDatasets  = "";
	var strOutDatasets  = "";
	    strOutDatasets += "ds_Multi=ds_Multi";
	
	var strArgument  = "";
	
	var strCallbackFunc = "fn_D1_CallBack";
	              
	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	
	if ( ErrorCode <0 ) {
		
	} else {
		btn_chart_OnClick();
	}
}


function fn_D1_CallBack(svcId, ErrorCode, ErrorMsg)
{  
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_CallBack(svcid, errcd, errmsg)
	// 설명     : 각 트렌젝션의 결과를 처리 .
	// return 내용 : 없음
	//-------------------------------------------------------------------------------
	//-------------------------------------------------------------------------------
	// svcid, errcd, errmsg 값 Transaction 함수에서 넘겨받음
	//-------------------------------------------------------------------------------
  
	if ( ErrorCode <0 ){
		var tr_name;
		var tr_kname;
		
		switch(svcId){
			//조회 실패시
			case "fn_D1_Tr_find": 
				tr_name="find";
				tr_kname="조회";
			break;	
		}
		
		//트렌젝션 메세지 출력
		alert(gfn_E5_GetDBErrorMsg(tr_name, ErrorMsg,tr_kname));
		return;
	}
	
	switch(svcId){	
	    case "fn_D1_Tr_find": 
			//조회 성공시에 
			fv_State_Fg = "U";
			//조회 성공메세지 출력
			gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true);	//"조회를 완료하였습니다."
			break;	
	}
}


function btn_chart_OnClick(obj)
{
	var xObject = CreateObject("ChartFX.ClientServer.GradientBack.62");
	xObject.Type = "GradientType_Horizontal";
	xObject.Colors.Item(0) = "#B4B6F8";
	xObject.Colors.Item(1) = "#f5f5dc";
	XChart.InsideBackObject = xObject;	
	
	XChart.AxisY.LabelsFormat.Decimals = 0;
	XChart.ClearData(true);
	//ct01.Axis[2].Label(j)
	var style = "LINE";
	
	// SERIES LABEL을 ARRAY로 넘긴다.
	var arrLabelList = array();	
	arrLabelList[0] = "1섹터";
	arrLabelList[1] = "2섹터";
	arrLabelList[2] = "3섹터";
	arrLabelList[3] = "4섹터";
	arrLabelList[4] = "5섹터";
	arrLabelList[5] = "6섹터";
	arrLabelList[6] = "7섹터";
	arrLabelList[7] = "8섹터";
	arrLabelList[8] = "9섹터";
	arrLabelList[9] = "10섹터";
	arrLabelList[10] = "11섹터";
	arrLabelList[11] = "12섹터";
	arrLabelList[12] = "13섹터";
	arrLabelList[13] = "14섹터";
	arrLabelList[14] = "15섹터";

	// SERIES COLUMN을 ARRAY로 넘긴다.
	// Y 축
	var arrXColList = array();	

	if(cob_AreaGb.Value == '1'){		/*분극량(+)*/
		title_gb.Text = "[분극량]";
		arrXColList[0] = "POLAR_AMT_1";
		arrXColList[1] = "POLAR_AMT_2";
		arrXColList[2] = "POLAR_AMT_3";
		arrXColList[3] = "POLAR_AMT_4";
		arrXColList[4] = "POLAR_AMT_5";
		arrXColList[5] = "POLAR_AMT_6";
		arrXColList[6] = "POLAR_AMT_7";
		arrXColList[7] = "POLAR_AMT_8";
		arrXColList[8] = "POLAR_AMT_9";
		arrXColList[9] = "POLAR_AMT_10";
		arrXColList[10] = "POLAR_AMT_11";
		arrXColList[11] = "POLAR_AMT_12";
		arrXColList[12] = "POLAR_AMT_13";
		arrXColList[13] = "POLAR_AMT_14";
		arrXColList[14] = "POLAR_AMT_15";
	}else if(cob_AreaGb.Value == '2'){	/*소요전류(+)*/
		title_gb.Text = "[소요전류]";
		arrXColList[0] = "NEED_ELECT_1";
		arrXColList[1] = "NEED_ELECT_2";
		arrXColList[2] = "NEED_ELECT_3";
		arrXColList[3] = "NEED_ELECT_4";
		arrXColList[4] = "NEED_ELECT_5";
		arrXColList[5] = "NEED_ELECT_6";
		arrXColList[6] = "NEED_ELECT_7";
		arrXColList[7] = "NEED_ELECT_8";
		arrXColList[8] = "NEED_ELECT_9";
		arrXColList[9] = "NEED_ELECT_10";
		arrXColList[10] = "NEED_ELECT_11";
		arrXColList[11] = "NEED_ELECT_12";
		arrXColList[12] = "NEED_ELECT_13";
		arrXColList[13] = "NEED_ELECT_14";
		arrXColList[14] = "NEED_ELECT_15";
	}else if(cob_AreaGb.Value == '3'){	/*방식연장*/
		title_gb.Text = "[방식연장]";
		arrXColList[0] = "CATHODIC_LENG_1";
		arrXColList[1] = "CATHODIC_LENG_2";
		arrXColList[2] = "CATHODIC_LENG_3";
		arrXColList[3] = "CATHODIC_LENG_4";
		arrXColList[4] = "CATHODIC_LENG_5";
		arrXColList[5] = "CATHODIC_LENG_6";
		arrXColList[6] = "CATHODIC_LENG_7";
		arrXColList[7] = "CATHODIC_LENG_8";
		arrXColList[8] = "CATHODIC_LENG_9";
		arrXColList[9] = "CATHODIC_LENG_10";
		arrXColList[10] = "CATHODIC_LENG_11";
		arrXColList[11] = "CATHODIC_LENG_12";
		arrXColList[12] = "CATHODIC_LENG_13";
		arrXColList[13] = "CATHODIC_LENG_14";
		arrXColList[14] = "CATHODIC_LENG_15";
	}else if(cob_AreaGb.Value == '4'){	/*방식면적*/
		title_gb.Text = "[방식면적]";
		arrXColList[0] = "CATHODIC_SQUARE_1";
		arrXColList[1] = "CATHODIC_SQUARE_2";
		arrXColList[2] = "CATHODIC_SQUARE_3";
		arrXColList[3] = "CATHODIC_SQUARE_4";
		arrXColList[4] = "CATHODIC_SQUARE_5";
		arrXColList[5] = "CATHODIC_SQUARE_6";
		arrXColList[6] = "CATHODIC_SQUARE_7";
		arrXColList[7] = "CATHODIC_SQUARE_8";
		arrXColList[8] = "CATHODIC_SQUARE_9";
		arrXColList[9] = "CATHODIC_SQUARE_10";
		arrXColList[10] = "CATHODIC_SQUARE_11";
		arrXColList[11] = "CATHODIC_SQUARE_12";
		arrXColList[12] = "CATHODIC_SQUARE_13";
		arrXColList[13] = "CATHODIC_SQUARE_14";
		arrXColList[14] = "CATHODIC_SQUARE_15";
	}else if(cob_AreaGb.Value == '5'){	/*전류밀도*/
		title_gb.Text = "[전류밀도]";
		arrXColList[0] = "ELECT_DENSITY_1";
		arrXColList[1] = "ELECT_DENSITY_2";
		arrXColList[2] = "ELECT_DENSITY_3";
		arrXColList[3] = "ELECT_DENSITY_4";
		arrXColList[4] = "ELECT_DENSITY_5";
		arrXColList[5] = "ELECT_DENSITY_6";
		arrXColList[6] = "ELECT_DENSITY_7";
		arrXColList[7] = "ELECT_DENSITY_8";
		arrXColList[8] = "ELECT_DENSITY_9";
		arrXColList[9] = "ELECT_DENSITY_10";
		arrXColList[10] = "ELECT_DENSITY_11";
		arrXColList[11] = "ELECT_DENSITY_12";
		arrXColList[12] = "ELECT_DENSITY_13";
		arrXColList[13] = "ELECT_DENSITY_14";
		arrXColList[14] = "ELECT_DENSITY_15";
		XChart.AxisY.LabelsFormat.Decimals = 5;
	}else if(cob_AreaGb.Value == '6'){	/*코팅저항*/
		title_gb.Text = "[코팅저항]";
		arrXColList[0] = "COATING_RESIS_1";
		arrXColList[1] = "COATING_RESIS_2";
		arrXColList[2] = "COATING_RESIS_3";
		arrXColList[3] = "COATING_RESIS_4";
		arrXColList[4] = "COATING_RESIS_5";
		arrXColList[5] = "COATING_RESIS_6";
		arrXColList[6] = "COATING_RESIS_7";
		arrXColList[7] = "COATING_RESIS_8";
		arrXColList[8] = "COATING_RESIS_9";
		arrXColList[9] = "COATING_RESIS_10";
		arrXColList[10] = "COATING_RESIS_11";
		arrXColList[11] = "COATING_RESIS_12";
		arrXColList[12] = "COATING_RESIS_13";
		arrXColList[13] = "COATING_RESIS_14";
		arrXColList[14] = "COATING_RESIS_15";
	}else if(cob_AreaGb.Value == '7'){	/*토양비저항*/
		title_gb.Text = "[토양비저항]";
		arrXColList[0] = "SOIL_RESIS_1";
		arrXColList[1] = "SOIL_RESIS_2";
		arrXColList[2] = "SOIL_RESIS_3";
		arrXColList[3] = "SOIL_RESIS_4";
		arrXColList[4] = "SOIL_RESIS_5";
		arrXColList[5] = "SOIL_RESIS_6";
		arrXColList[6] = "SOIL_RESIS_7";
		arrXColList[7] = "SOIL_RESIS_8";
		arrXColList[8] = "SOIL_RESIS_9";
		arrXColList[9] = "SOIL_RESIS_10";
		arrXColList[10] = "SOIL_RESIS_11";
		arrXColList[11] = "SOIL_RESIS_12";
		arrXColList[12] = "SOIL_RESIS_13";
		arrXColList[13] = "SOIL_RESIS_14";
		arrXColList[14] = "SOIL_RESIS_15";
	}
	
	// Y TEXT COLUMN
	// X 축
	strYCol = "INPUT_YMD";
	XChart.AxisX.LabelAngle = 90;
	// Series,Y 
	XChart.OpenData("COD_Values",arrLabelList.length(),ds_Multi.RowCount());
	XChart.OpenData("COD_Colors",arrLabelList.length(),ds_Multi.RowCount());
	
	gfn_DrawChart(XChart,ds_Multi,style,arrLabelList,arrXColList,strYCol);
	
	XChart.CloseData("COD_Values");
	XChart.CloseData("COD_Colors");
	
	if(ds_Multi.RowCount() == 0){
		alert("조회한 내역이 없습니다.");
		XChart.ClearData(true);
	}
	
}
]]></Script>
</Window>