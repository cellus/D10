<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="536" Id="D1401010018U" Left="8" OnLoadCompleted="D1401010018U_OnLoadCompleted" PidAttrib="7" Title="엑셀업로드_D1401010018U" Top="8" Ver="1.0" Width="1005" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_ExcelData">
				<Contents>
					<colinfo id="EXCOL0" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL1" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL2" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL3" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL4" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL5" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL6" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL7" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL8" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL9" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL10" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL11" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL12" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL13" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL14" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL15" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL16" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL17" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL18" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL19" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL20" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL21" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL22" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL23" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL24" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL25" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL26" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL27" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL28" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL29" size="256" summ="default" type="STRING"/>
					<colinfo id="EXCOL30" size="256" summ="default" type="STRING"/>
					<record>
						<EXCOL0></EXCOL0>
						<EXCOL1></EXCOL1>
						<EXCOL10></EXCOL10>
						<EXCOL11></EXCOL11>
						<EXCOL12></EXCOL12>
						<EXCOL13></EXCOL13>
						<EXCOL14></EXCOL14>
						<EXCOL15></EXCOL15>
						<EXCOL16></EXCOL16>
						<EXCOL17></EXCOL17>
						<EXCOL18></EXCOL18>
						<EXCOL19></EXCOL19>
						<EXCOL2></EXCOL2>
						<EXCOL20></EXCOL20>
						<EXCOL21></EXCOL21>
						<EXCOL22></EXCOL22>
						<EXCOL23></EXCOL23>
						<EXCOL24></EXCOL24>
						<EXCOL25></EXCOL25>
						<EXCOL26></EXCOL26>
						<EXCOL27></EXCOL27>
						<EXCOL28></EXCOL28>
						<EXCOL29></EXCOL29>
						<EXCOL3></EXCOL3>
						<EXCOL30></EXCOL30>
						<EXCOL4></EXCOL4>
						<EXCOL5></EXCOL5>
						<EXCOL6></EXCOL6>
						<EXCOL7></EXCOL7>
						<EXCOL8></EXCOL8>
						<EXCOL9></EXCOL9>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_multi">
				<Contents>
					<colinfo id="DIG_WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="EOCS_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_TAKER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_TAKER_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_END_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="YES_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="END_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_EMPID_TEL" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_PROC_STS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_KIND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_GU" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_GU" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_TAKER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_CHK_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_DONG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_insert">
				<Contents>
					<colinfo id="EOCS_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_PATH_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="END_SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="END_LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_END_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_TAKER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_TAKER_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_TAKER_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_TAKER_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_TAKER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="ORDER_FIRM_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_WORK_PROC_STS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_KIND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_GU" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="STR_ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="END_ADDR_GU" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_CHK_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_addr">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_chk">
				<Contents>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="#6cbae1" Bottom="113" Height="19" Id="Shape0" Left="5" LineWidth="0" Right="1000" TabOrder="1" Top="94" Type="Rectangle" Width="995"></Shape>
		<Image Align="Left" Height="9" Id="Image9" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="2" Text="굴착공사" Top="78" Width="117"></Image>
		<Div DisableBKColor="white" Height="24" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="3" Text="Div0" Top="39" Url="globals::ComButton.xml" Visible="FALSE" Width="995">
			<Contents></Contents>
		</Div>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button130" ImageID="btn_4_excel" Left="921" LeftMargin="21" OnClick="btn_ExcelUp_OnClick" Style="button" TabOrder="4" Text="엑셀등록" Top="70" Width="76"></Button>
		<Grid AutoEnter="TRUE" BindDataset="ds_multi" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="529" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="432" Id="grd_list" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" Right="1000" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="5" TabStop="true" Top="97" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="995">
			<contents>
				<format id="Default">
					<columns>
						<col width="41"/>
						<col width="392"/>
						<col width="118"/>
						<col width="84"/>
						<col width="86"/>
						<col width="87"/>
						<col width="106"/>
						<col width="123"/>
						<col width="116"/>
						<col width="124"/>
						<col width="89"/>
						<col width="117"/>
						<col width="89"/>
						<col width="132"/>
						<col width="104"/>
						<col width="110"/>
						<col width="102"/>
						<col width="102"/>
						<col width="106"/>
						<col width="133"/>
						<col width="150"/>
						<col width="150"/>
						<col width="150"/>
						<col width="108"/>
						<col width="121"/>
						<col width="93"/>
						<col width="96"/>
						<col width="106"/>
						<col width="62"/>
						<col width="81"/>
						<col width="90"/>
						<col width="79"/>
					</columns>
					<head>
						<cell col="0" display="text" text="번호"/>
						<cell col="1" display="text" text="굴착공사명"/>
						<cell col="2" display="text" text="EOCS번호"/>
						<cell col="3" display="text" text="진행상태코드"/>
						<cell col="4" display="text" text="진행상태"/>
						<cell col="5" display="text" text="굴착종류코드"/>
						<cell col="6" display="text" text="굴착종류"/>
						<cell col="7" display="text" text="접수일시"/>
						<cell col="8" display="text" text="배관유무일시"/>
						<cell col="9" display="text" text="굴착업체"/>
						<cell col="10" display="text" text="굴착담당자"/>
						<cell col="11" display="text" text="연락처"/>
						<cell col="12" display="text" text="굴착연장"/>
						<cell col="13" display="text" text="굴착발주사"/>
						<cell col="14" display="text" text="발주담당자"/>
						<cell col="15" display="text" text="연락처"/>
						<cell col="16" display="text" text="굴착예정일"/>
						<cell col="17" display="text" text="굴착완료예정일"/>
						<cell col="18" display="text" text="도시가스사"/>
						<cell col="19" display="text" text="굴착시점코드"/>
						<cell col="20" display="text" text="시점구"/>
						<cell col="21" display="text" text="시점동"/>
						<cell col="22" display="text" text="시점본번"/>
						<cell col="23" display="text" text="시점부번"/>
						<cell col="24" display="text" text="굴착종점코드"/>
						<cell col="25" display="text" text="종점구"/>
						<cell col="26" display="text" text="종점동"/>
						<cell col="27" display="text" text="종점본번"/>
						<cell col="28" display="text" text="종점부번"/>
						<cell col="29" display="text" text="작업종류코드"/>
						<cell col="30" display="text" text="작업종류"/>
						<cell col="31" display="text" text="담당자"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="rowindex+1"/>
						<cell align="left" col="1" colid="DIG_WORK_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="2" colid="EOCS_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="DIG_WORK_PROC_STS" display="text" expandsize="18" wordwrap="word"/>
						<cell col="4" colid="DIG_WORK_PROC_STS_NM" display="text"/>
						<cell align="left" col="5" colid="DIG_KIND" display="text" expandsize="18" wordwrap="word"/>
						<cell col="6" colid="DIG_KIND_NM" display="text"/>
						<cell align="center" col="7" colid="RECEIVE_YMD" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="8" colid="PIPE_YN" display="text" expandsize="18" wordwrap="word"/>
						<cell align="left" col="9" colid="DIG_FIRM_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="10" colid="DIG_WORK_TAKER_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="11" colid="DIG_TAKER_TEL_DDD" display="text"/>
						<cell align="right" col="12" colid="LENG" display="text"/>
						<cell align="left" col="13" colid="ORDER_FIRM_NM" display="text"/>
						<cell col="14" colid="ORDER_TAKER_NM" display="text"/>
						<cell align="center" col="15" colid="ORDER_FIRM_TEL_DDD" display="text"/>
						<cell align="center" col="16" colid="DIG_PLAN_YMD" display="text"/>
						<cell align="center" col="17" colid="DIG_END_PLAN_YMD" display="text"/>
						<cell align="center" col="18" colid="SCG_NM" display="text"/>
						<cell align="left" col="19" colid="STR_ADDR_CD" display="text"/>
						<cell col="20" colid="STR_ADDR_GU" display="text"/>
						<cell col="21" colid="STR_ADDR_DONG" display="text"/>
						<cell col="22" colid="STR_ADDR_M" display="text"/>
						<cell col="23" colid="STR_ADDR_S" display="text"/>
						<cell align="left" col="24" colid="END_ADDR_CD" display="text"/>
						<cell col="25" colid="END_ADDR_GU" display="text"/>
						<cell col="26" colid="END_ADDR_DONG" display="text"/>
						<cell col="27" colid="END_ADDR_M" display="text"/>
						<cell col="28" colid="END_ADDR_S" display="text"/>
						<cell align="center" col="29" colid="JOB_CD" display="text"/>
						<cell col="30" colid="JOB_CD_NM" display="text"/>
						<cell align="center" col="31" colid="SCG_EMPID" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="39" Id="Image4" ImageID="popup_top" LeftMargin="33" Style="popup_title" TabOrder="6" Text="굴착공사&#32;엑셀업로드" Transparent="TRUE" Width="1003"></Image>
		<Grid BindDataset="ds_addr" BkColor2="default" BoldHead="true" Bottom="384" Enable="true" EndLineColor="default" Height="120" Id="Grid0" InputPanel="FALSE" Left="48" LineColor="default" Right="368" TabOrder="7" TabStop="true" Top="264" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="320">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="BRANCH_CD"/>
					<cell col="1" display="text" text="ADDR"/>
					<cell col="2" display="text" text="ZIP_NO1"/>
					<cell col="3" display="text" text="ZIP_NO2"/>
				</head>
				<body>
					<cell col="0" colid="BRANCH_CD" display="text"/>
					<cell col="1" colid="ADDR" display="text"/>
					<cell col="2" colid="ZIP_NO1" display="text"/>
					<cell col="3" colid="ZIP_NO2" display="text"/>
				</body>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/*******************************************************************************
* FormID     : D1401010018U.xml
* Form 설명  : 엑셀을 업로드한다.
* 시스템 명  : 안전공급(D1)
* 작성자     : 문달호
* 작성일     : 2009-02-26
* 변경내용   : 
*******************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";

var errorTotal=0;
var partCnt=0;
/*===============================================================================
 * 함수명: D1401010015U_OnLoadCompleted()
   설명: 화면 로드 후 조회 조건 기본 셋팅
   return 내용: 없음
===============================================================================*/ 
function D1401010018U_OnLoadCompleted(obj)
{
	
	gfn_LoadForm(obj);
	fn_Init();
	gfn_D1_SetGrid_Sort(grd_list);
}

function fn_Init()
{

}
// 공통 행 삭제 
function fn_CommonDeleteRow()
{
	ds_multi.DeleteRow(grd_list.ClickedRow);
}

//-------------------------------------------------------------------------------
//   함수명: fn_CommonExcelExport()
//   설명  :  엑셀다운 
//   arguments   
//   obj
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_CommonExcelExport()
{
	var SearchCondition= "";
    
    gfn_ExportExcel("EOCS굴착공사내역", 5, SearchCondition, "grd_list"); 
	
}


//-------------------------------------------------------------------------------
// 함수명: btn_ExcelUp_OnClick
// 설명: 엑셀 업로드 
// arguments
// 			없음
// return: 없음
//------------------------------------------------------------------------------- 
function btn_ExcelUp_OnClick(obj)
{
	var strColNms = "DIG_WORK_NM,EOCS_NUM,DIG_WORK_PROC_STS,DIG_WORK_PROC_STS_NM,DIG_KIND,DIG_KIND_NM,RECEIVE_YMD,PIPE_YN,DIG_FIRM_NM,DIG_WORK_TAKER_NM,DIG_TAKER_TEL_DDD,"
	              + "LENG,ORDER_FIRM_NM,ORDER_TAKER_NM,ORDER_FIRM_TEL_DDD,"
	              + "DIG_PLAN_YMD,DIG_END_PLAN_YMD,SCG_NM,STR_ADDR_CD,STR_ADDR_GU,STR_ADDR_DONG,STR_ADDR_M,STR_ADDR_S,END_ADDR_CD,END_ADDR_GU,END_ADDR_DONG,"
	              + "END_ADDR_M,END_ADDR_S,JOB_CD,JOB_CD_NM,SCG_EMPID";
	gfn_D1_UploadExcelData(ds_multi, grd_list, strColNms);
}


//-------------------------------------------------------------------------------
//   함수명: fn_CommonSave()
//   설명  :  저장 버튼 클릭시 
//   arguments   
//   obj
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_CommonSave()
{    
	partCnt=0;
	
	ds_insert.UpdateControl=false;	
	
	for(var i=0 ; i<ds_multi.GetRowCount();i++)
	{
		ds_insert.AddRow();
		var chkeocs = ds_multi.GetColumn(i,"EOCS_NUM");
		// if( gfn_IsNull(chkeocs) )
		// {
			// alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 공사번호 형식이 맞지 않습니다.");
			// ds_multi.row = i;
			// partCnt=partCnt+1;
			// return;
		// }
		
		if(length(chkeocs)!=12)
		{
			alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 공사번호 형식이 맞지 않습니다.");
			ds_multi.row = i;
			partCnt=partCnt+1;
			return;
		}

		// if( gfn_IsNull(ds_multi.GetColumn(i,"DIG_WORK_NM")) )
		// {
			// alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 공사명이 없습니다.");
			// ds_multi.row = i;
			// partCnt=partCnt+1;
			// return;
		// }

        // if( gfn_IsNull(ds_multi.GetColumn(i,"DIG_WORK_PROC_STS")))
        // {
			// alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 진행상태가 없습니다.");
			// ds_multi.row = i;
			// partCnt=partCnt+1;
			// return;
        // }
		
		//EOCS_NUM 형식이 바뀌어서 EOCS_NUM형태에 맞게 바꿔준다 2012.01.18 이상목 
		var EOCS_NUM = trim(ds_multi.GetColumn(i,"EOCS_NUM"));
		if ( length(EOCS_NUM) == 12 )
		{
			EOCS_NUM = substr(EOCS_NUM,0,9) + "-" + substr(EOCS_NUM,9,3);
		}
   
		ds_insert.SetColumn(i,"EOCS_NUM",EOCS_NUM);  // EOCS_NUM 
		ds_insert.SetColumn(i,"DIG_WORK_NM",ds_multi.GetColumn(i,"DIG_WORK_NM"));
		ds_insert.SetColumn(i,"DIG_WORK_PROC_STS",ds_multi.GetColumn(i,"DIG_WORK_PROC_STS"));  // 진행상태 
				
		//조건 체크 제외 권기철 2010.7.17
		//var kind =ds_multi.GetColumn(i,"DIG_KIND");
		// if(kind=="20"||kind=="30"||kind=="40")  // 일반굴착
		// {
		
		// }
		// else
		// {
			// alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 굴착종류 형식이 맞지 않습니다.");
			// ds_multi.row = i;
			// partCnt=partCnt+1;	
			// return;
		// }
		
		ds_insert.SetColumn(i,"DIG_KIND",ds_multi.GetColumn(i,"DIG_KIND")); //굴착종류 
		
		var re_ymd  = ds_multi.GetColumn(i,"RECEIVE_YMD");
			re_ymd  = subStr(Replace(re_ymd,"-",""),0,8);
		
		ds_insert.SetColumn(i,"RECEIVE_YMD",re_ymd);  //접수일자
		ds_insert.SetColumn(i,"RECEIVE_TIME","0000"); //접수시간
		
		// 2013.07.12. 이건민 - 비교 조건이 틀려 주석처리 (비교 시 무조건 Y로 들어감)
		/*
		var p_yn = ds_multi.GetColumn(i,"PIPE_YN");
		if(p_yn!=""||p_yn!=null)
		{
			p_yn="Y";
		}else 
		{ 
			p_yn="N";
		}
		*/
		
		// 2013.07.12. 이건민 - 비교 조건수정
		var p_yn = trim(ds_multi.GetColumn(i,"PIPE_YN"));
		if(p_yn == "" || p_yn == null)
		{
			p_yn="N";
		}else 
		{ 
			p_yn="Y";
		}
		
		ds_insert.SetColumn(i,"PIPE_YN",p_yn); // 배관유무
		if(p_yn=="Y")
		{
			ds_insert.SetColumn(i,"PIPE_CHK_YMD",substr(ds_multi.GetColumn(i,"PIPE_YN"),0,19));
		}
		ds_insert.SetColumn(i,"DIG_FIRM_NM",ds_multi.GetColumn(i,"DIG_FIRM_NM"));  //굴착업체명
		ds_insert.SetColumn(i,"DIG_WORK_TAKER_NM",ds_multi.GetColumn(i,"DIG_WORK_TAKER_NM")); //굴착업체 담당자명
     
        var tellist = Split(ds_multi.GetColumn(i,"DIG_TAKER_TEL_DDD"),"-");

		ds_insert.SetColumn(i,"DIG_TAKER_TEL_DDD",tellist[0]); //굴착담당전화_식별번호
		ds_insert.SetColumn(i,"DIG_TAKER_TEL_EXN",tellist[1]); //굴착담당전화_국번
		ds_insert.SetColumn(i,"DIG_TAKER_TEL_NUM",tellist[2]); //굴착담당전화_번호
		
		ds_insert.SetColumn(i,"LENG",ds_multi.GetColumn(i,"LENG")); // 연장 
		ds_insert.SetColumn(i,"ORDER_FIRM_NM",ds_multi.GetColumn(i,"ORDER_FIRM_NM")); //발주사명 
		ds_insert.SetColumn(i,"ORDER_TAKER_NM",ds_multi.GetColumn(i,"ORDER_TAKER_NM")); //발주담당자명 
		
		var ordertel = Split(ds_multi.GetColumn(i,"ORDER_FIRM_TEL_DDD"),"-");

		ds_insert.SetColumn(i,"ORDER_FIRM_TEL_DDD",ordertel[0]);  // 발주사전화_식별번호
		ds_insert.SetColumn(i,"ORDER_FIRM_TEL_EXN",ordertel[1]);  // 발주사전화_국번
		ds_insert.SetColumn(i,"ORDER_FIRM_TEL_NUM",ordertel[2]);  // 발주사전화_번호
        
        var DigPlanYmd = Replace(ds_multi.GetColumn(i,"DIG_PLAN_YMD"),"-","");
		ds_insert.SetColumn(i,"DIG_PLAN_YMD",DigPlanYmd);  //굴착예정일자
		
		var DigEndPlanYmd = Replace(ds_multi.GetColumn(i,"DIG_END_PLAN_YMD"),"-","");
		ds_insert.SetColumn(i,"DIG_END_PLAN_YMD",DigEndPlanYmd); //굴착완료예정일자
		
		//  주소 체계 
        var str_addr_m = ds_multi.GetColumn(i,"STR_ADDR_M");
        var str_addr_s = ds_multi.GetColumn(i,"STR_ADDR_S");
		var str_addr  = ds_multi.GetColumn(i,"STR_ADDR_GU") + ' ' + ds_multi.GetColumn(i,"STR_ADDR_DONG") + ' ' + str_addr_m + ' ' + str_addr_s;
		        
        
        fn_D1_addr(ds_multi.GetColumn(i,"STR_ADDR_CD"));  // 주소 체크 
        
        /**/
        if( gfn_IsNull(ds_addr.GetColumn(0,"BRANCH_CD")))
        {
			alert(ds_multi.GetColumn(i,"EOCS_NUM")+" 해당주소에 대한 지사 정보가 없습니다...");
			ds_multi.row = i;
			partCnt=partCnt+1;
			return;
        }
        
        if ( ds_addr.GetColumn(0,"ZIP_NO1") == '140' )
        {
			ds_addr.SetColumn(0,"BRANCH_CD", '100591');
        }
		ds_insert.SetColumn(i,"STR_ZIP_NO1",ds_addr.GetColumn(0,"ZIP_NO1"));                 //시점_우편번호1
		ds_insert.SetColumn(i,"STR_ZIP_NO2",ds_addr.GetColumn(0,"ZIP_NO2"));                 //시점_우편번호2
		ds_insert.SetColumn(i,"STR_LOT_NUM_UNION", str_addr);           // 시점_지번주소조합  
		
		ds_insert.SetColumn(i,"BRANCH_CD",ds_addr.GetColumn(0,"BRANCH_CD"));  // 지사 
		
	    ds_insert.SetColumn(i,"STR_ADDR_M",str_addr_m);  // 시점 본번
        ds_insert.SetColumn(i,"STR_ADDR_S",str_addr_s);  // 시점 부번 
        
                
        if (length(trim(ds_multi.GetColumn(i,"END_ADDR_CD"))) > 0) 
        {
			var end_addr_m  = ds_multi.GetColumn(i,"END_ADDR_M");
			var end_addr_s  = ds_multi.GetColumn(i,"END_ADDR_S");
			var end_addr  = ds_multi.GetColumn(i,"END_ADDR_GU") + ' ' + ds_multi.GetColumn(i,"END_ADDR_DONG") + ' ' + end_addr_m + ' ' + end_addr_s;

			ds_insert.SetColumn(i,"END_ZIP_NO1",ds_addr.GetColumn(0,"ZIP_NO1"));  //종점_우편번호1
			ds_insert.SetColumn(i,"END_ZIP_NO2",ds_addr.GetColumn(0,"ZIP_NO2"));  //종점_우편번호1     
			ds_insert.SetColumn(i,"END_LOT_NUM_UNION", end_addr);      //종점_지번주소조합
			
			ds_insert.SetColumn(i,"END_ADDR_M",end_addr_m); // 종점 본번 
			ds_insert.SetColumn(i,"END_ADDR_S",end_addr_s); // 종점 부번 
		}	
        //체크제외 권기철2010.7,17
        // var job = ds_multi.GetColumn(i,"JOB_CD");
        
        // if(job=="20"||job=="30"||job=="40"||job=="50"||job=="60"||job=="70"||job=="99") // 가스 
        // {
        
        // }
        // else
        // {
			// alert(ds_multi.GetColumn(i,"EOCS_NUM")+"공사의 작업종류 형식이 맞지 않습니다.");
			// ds_multi.row = i;
			// partCnt=partCnt+1;	
			// return;
        // }
                                       
        ds_insert.SetColumn(i,"JOB_CD",ds_multi.GetColumn(i,"JOB_CD"));
        ds_insert.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));
	    ds_insert.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));
        
        var Result = fn_D1_PkChk(i, EOCS_NUM); // 중복 체크 
       
		if(Result > 0)
		{ 
			ds_insert.SetRowType(i, "Update");
		}
		else
		{   
			ds_insert.SetRowType(i, "insert");
		}
	}
	
	if(partCnt==0)
	{
		fn_D1_ExcelSave();
		Close();
	}
	else
	{
		alert("엑셀자료를 다시 확인 하시고 업로드 하시기 바랍니다.");
	}

}


//-------------------------------------------------------------------------------
//   함수명: fn_D1_EecelSave()
//   설명  : 엑셀내용 저장
//   arguments   
//   obj
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_ExcelSave()
{
	
	var strSvcID = "save";
	var strPart = "D10";
	var strURL  = "handle.do?ServiceName=D1401010018U-service&save=1";
	var strInDatasets   = "ds_insert=ds_insert:u";
	var strOutDatasets  = "";
	var strArgument     = "";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  
			   );
			   
		
	if(ErrorCode < 0)
	{    
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009", "%AAA%", "정상적으로 저장을"));
	}
    
	
}




//************************************************
//* function : fn_D1_addr()
//* comment  : 우편번호로 주소및 지사 조회 
//* arg      : zipNo1,zipNo2
//* return   :
//************************************************
function fn_D1_addr(addr_cd)
{
	var strSvcID = "findaddr";
	var strPart = "D10";
	var strURL  = "handle.do?ServiceName=D1401010018U-service&addr=1";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_addr=ds_addr";
	var strArgument     = "LAW_ADDR_CD=" + quote(addr_cd);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  
			   );
			   
		
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}
	
}



//************************************************
//* function : fn_D1_PkChk()
//* comment  : 중복체크
//* arg      : 
//* return   : 0,1
//************************************************
function fn_D1_PkChk(i, EOCS_NUM)
{
    var strEOCS_NUM = EOCS_NUM;
    
	ds_chk.ClearData();
	
	var strSvcID = "findchk";
	var strPart = "D10";
	var strURL  = "handle.do?ServiceName=D1401010018U-service&chk=1";	       
	var strInDatasets   = "";
	var strOutDatasets  = "ds_chk=ds_chk";
	var strArgument     = "EOCS_NUM="+ quote(strEOCS_NUM);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  
			   );
			   
		
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}
	
	if(ds_chk.GetRowCount() > 0)
	{
		return 1;
	}else
	{
		return 0;
	}
	
}]]></Script>
</Window>