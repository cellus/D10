<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="864" Id="D1501010012F" Left="8" OnLoadCompleted="D1501010012F_OnLoadCompleted" PidAttrib="7" Title="위험작업요청등록_중폐지_D1501010012F" Top="8" Ver="1.0" Width="1270" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi" OnLoadCompleted="ds_Multi_OnLoadCompleted" OnRowPosChanged="ds_Multi_OnRowPosChanged">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_DANGER_JOB_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_YMD1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOIN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REUSE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Re" OnColumnChanged="ds_Multi_Re_OnColumnChanged">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TAKER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TASKMAST_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_YMD1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_ITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CLS_JOB_METHOD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_ADMIT_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_ADMIT_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_ADMIT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_BLD_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="NONPAY_EXIST_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_RMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Review">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_StopRst">
				<Contents>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOIN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="REUSE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="JOIN_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOIN_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPID_1" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPID_2" size="256" summ="default" type="STRING"/>
					<colinfo id="EMPID_3" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DecideReq">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_JobYn">
				<Contents>
					<colinfo id="NAME" size="256" type="STRING"/>
					<colinfo id="VALUE" size="256" type="STRING"/>
					<record>
						<NAME>유</NAME>
						<VALUE>Y</VALUE>
					</record>
					<record>
						<NAME>무</NAME>
						<VALUE>N</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ReuseYn">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<record>
						<NAME>재사용&#32;유</NAME>
						<VALUE>Y</VALUE>
					</record>
					<record>
						<NAME>재사용&#32;무</NAME>
						<VALUE>N</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerJobStsFlag">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<record>
						<NAME>전체</NAME>
						<VALUE></VALUE>
					</record>
					<record>
						<NAME>위험작업&#32;요청전</NAME>
						<VALUE>00</VALUE>
					</record>
					<record>
						<NAME>위험작업&#32;요청</NAME>
						<VALUE>01</VALUE>
					</record>
					<record>
						<NAME>검토&#32;승인</NAME>
						<VALUE>03</VALUE>
					</record>
					<record>
						<NAME>검토&#32;반려</NAME>
						<VALUE>02</VALUE>
					</record>
					<record>
						<NAME>결재&#32;승인</NAME>
						<VALUE>05</VALUE>
					</record>
					<record>
						<NAME>결재&#32;반려</NAME>
						<VALUE>04</VALUE>
					</record>
					<record>
						<NAME>작업&#32;결과&#32;등록</NAME>
						<VALUE>06</VALUE>
					</record>
					<record>
						<NAME>작업&#32;결과&#32;결재승인</NAME>
						<VALUE>08</VALUE>
					</record>
					<record>
						<NAME>작업&#32;결과&#32;결재반려</NAME>
						<VALUE>07</VALUE>
					</record>
					<record>
						<NAME>작업&#32;완료</NAME>
						<VALUE>10</VALUE>
					</record>
					<record>
						<NAME>작업&#32;취소</NAME>
						<VALUE>90</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_WorkFirmCd">
				<Contents>
					<colinfo id="DEAL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FileList">
				<Contents>
					<colinfo id="FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_FILE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Excel">
				<Contents></Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BranchCd">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_ITEM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Team_01">
				<Contents>
					<colinfo id="KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerYN">
				<Contents>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<record>
						<NAME>등록</NAME>
						<VALUE>Y</VALUE>
					</record>
					<record>
						<NAME>미등록</NAME>
						<VALUE>N</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Team">
				<Contents>
					<colinfo id="KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SearchTop">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_START" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_END" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<record>
						<BRANCH_CD></BRANCH_CD>
						<DANGER_JOB_STS_FLAG></DANGER_JOB_STS_FLAG>
						<DANGER_NUM></DANGER_NUM>
						<JOB_FLAG></JOB_FLAG>
						<REQ_YMD_END></REQ_YMD_END>
						<REQ_YMD_START></REQ_YMD_START>
						<TEAM_CD></TEAM_CD>
						<WORK_FIRM_CD></WORK_FIRM_CD>
						<ZIP_NO1></ZIP_NO1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_UnPay">
				<Contents>
					<colinfo id="BLD_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UNPAY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UNPAY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CONT_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_UnPay">
				<Contents>
					<colinfo id="BLD_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UNPAY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="UNPAY_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="CONT_YN" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Cancel">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="OK_HMPP_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_EMPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="26" Id="Static6" Left="5" Style="table" TabOrder="103" Top="728" VAlign="Middle" Width="1242" WordWrap="TRUE"></Static>
		<Button Cursor="HAND" Height="17" Id="btn_JoinNm" ImageID="search" Left="701" OnClick="btn_CardUserEmpNm_OnClick" TabOrder="56" Text="Button8" Top="732" Width="17"></Button>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static38" Left="912" Style="table" TabOrder="184" Top="781" VAlign="Middle" Width="259" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static37" Left="810" Style="table" TabOrder="183" Top="781" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static35" Left="708" Style="table" TabOrder="182" Top="781" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="379" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="259" Id="grd_DangerJob" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" OnHeadClick="grd_DangerJob_OnHeadClick" Right="1253" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="9" TabStop="true" Top="120" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1245">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col width="109"/>
						<col width="111"/>
						<col width="100"/>
						<col width="98"/>
						<col width="80"/>
						<col width="93"/>
						<col width="80"/>
						<col width="120"/>
						<col width="300"/>
						<col width="80"/>
						<col width="85"/>
						<col width="80"/>
						<col width="74"/>
						<col width="45"/>
						<col width="72"/>
						<col width="129"/>
					</columns>
					<head>
						<cell col="0" display="normal" text="NO"/>
						<cell col="1" display="text" text="중,폐지&#32;관리번호"/>
						<cell col="2" display="text" text="진행상태"/>
						<cell col="3" display="text" text="가정관&#32;작업번호"/>
						<cell col="4" display="text" text="가정관진행상태"/>
						<cell col="5" display="text" text="지사"/>
						<cell col="6" display="text" text="팀"/>
						<cell col="7" display="text" text="시/구"/>
						<cell col="8" display="text" text="시공회사"/>
						<cell col="9" display="text" text="작업위치"/>
						<cell col="10" display="text" text="작업요청일자"/>
						<cell col="11" display="text" text="작업요청시간"/>
						<cell col="12" display="text" text="작업결재일자"/>
						<cell col="13" display="text" text="SCG담당자"/>
						<cell col="14" display="text" text="재사용"/>
						<cell col="15" display="text" text="입회일자"/>
						<cell col="16" display="text" text="등록일시"/>
					</head>
					<body>
						<cell align="center" col="0" display="normal" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="1" colid="DANGER_NUM" display="text"/>
						<cell align="center" col="2" colid="DANGER_JOB_STS_FLAG" combocol="VALUE" combodataset="ds_DangerJobStsFlag" combotext="NAME" display="combo" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="OK_HMPP_DANGER_NUM" display="text"/>
						<cell align="center" col="4" colid="OK_HMPP_DANGER_JOB_STS_FLAG_NM" display="text"/>
						<cell align="center" col="5" colid="BRANCH_NM" display="text"/>
						<cell align="center" col="6" colid="TEAM_CD_NM" display="text"/>
						<cell align="center" col="7" colid="ZIP_NO1_NM" display="text"/>
						<cell col="8" colid="WORK_FIRM_NM" display="text"/>
						<cell col="9" colid="LOT_NUM_UNION" display="text" expandsize="18"/>
						<cell align="center" col="10" colid="JOB_REQ_YMD1" display="text" Mask="####-##-##"/>
						<cell align="center" col="11" colid="JOB_REQ_TIME" display="text"/>
						<cell align="center" col="12" colid="DECIDE_YMD" display="text" Mask="####-##-##"/>
						<cell col="13" colid="TAKER_EMPID_NM" display="text"/>
						<cell align="center" col="14" colid="REUSE_YN" display="text"/>
						<cell align="center" col="15" colid="JOIN_YMD" display="date"/>
						<cell align="left" col="16" colid="UPD_DTM" display="date"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="DIG_ADMIT_TO" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_DigAdmitTo" Left="869" OnChanged="cal_DigAdmitTo_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="149" Top="520" Visible="FALSE" WeeksFont="Default,-1" Width="85"></Calendar>
		<Static Height="13" Id="Static47" Left="859" Style="static" TabOrder="92" Text="~" Top="524" Visible="FALSE" Width="10"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="DIG_ADMIT_FROM" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_DigAdmitFrom" Left="773" OnChanged="cal_DigAdmitFrom_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="58" Top="520" Visible="FALSE" WeeksFont="Default,-1" Width="85"></Calendar>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static46" Left="662" Style="table_1" TabOrder="91" Text="굴착허가기간" Top="518" VAlign="Middle" Visible="FALSE" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static49" Left="397" Style="table_1" TabOrder="93" Text="굴착허가번호" Top="518" VAlign="Middle" Visible="FALSE" Width="110" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static61" Left="289" Style="table" TabOrder="72" Top="676" VAlign="Middle" Width="257" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static57" Left="187" Style="table" TabOrder="71" Top="676" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Review" Border="Flat" Column="REVIEW_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReviewYmd" Left="189" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="44" Top="678" WeeksFont="Default,-1" Width="99"></Calendar>
		<Edit BindDataset="ds_Review" Border="Flat" CheckLength="Byte" Column="REVIEW_OPINI" Height="18" Id="edt_ReviewOpini" ImeMode="none" Left="291" MaxLength="40" Style="edit" TabOrder="45" Top="678" Width="253"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static20" Left="5" Style="table" TabOrder="154" Top="450" VAlign="Middle" Width="1243" WordWrap="TRUE"></Static>
		<Shape BKColor="user6" Bottom="92" Height="62" Id="Shape1" Left="5" LineColor="user7" Right="1250" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="118" Top="30" Type="RoundRect" Width="1245"></Shape>
		<Shape BKColor="user8" Bottom="87" Height="52" Id="Shape2" Left="10" LineWidth="0" Right="1245" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="119" Top="35" Type="Rectangle" Width="1235"></Shape>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static21" Left="5" Style="table" TabOrder="155" Top="471" VAlign="Middle" Width="1243" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static14" Left="5" Style="table" TabOrder="156" Top="429" VAlign="Middle" Width="1243" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static30" Left="5" Style="table" TabOrder="75" Top="408" VAlign="Middle" Width="1243" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="edt_Zip2" Left="160" MaxLength="3" Readonly="TRUE" Style="edit" TabOrder="84" Top="519" Visible="FALSE" Width="40"></Edit>
		<Static Height="13" Id="Static9" Left="785" Style="static" TabOrder="139" Text="-" Top="728" Width="10"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="edt_Zip1" Left="116" MaxLength="3" Readonly="TRUE" Style="edit" TabOrder="83" Top="519" Visible="FALSE" Width="40"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static64" Left="85" Style="table" TabOrder="69" Top="676" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="61" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1245">
			<Contents></Contents>
		</Div>
		<Shape BKColor="#6cbae1" Bottom="122" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1250" TabOrder="62" Top="119" Type="Rectangle" Width="1245"></Shape>
		<Image Align="Left" Height="12" Id="Image6" ImageID="blt_8" Left="6" LeftMargin="12" Style="text_title" TabOrder="63" Text="중,폐지&#32;작업&#32;요청등록" Top="389" Width="210"></Image>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_approval" ImageID="btn_9_reg_01" Left="984" LeftMargin="21" OnClick="btn_approval_OnClick" Style="button" TabOrder="64" Text="검토/전자결재(입회)" Top="632" Width="144"></Button>
		<Static Align="Center" Border="Flat" Height="43" Id="Static58" Left="5" Style="table" TabOrder="65" Text="검토" Top="655" VAlign="Middle" Width="81" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="43" Id="Static59" Left="545" Style="table" TabOrder="67" Top="655" VAlign="Middle" Width="66" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static60" Left="85" Style="table" TabOrder="66" Text="검토/반려자" Top="655" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static63" Left="187" Style="table" TabOrder="68" Text="검토/반려일자" Top="655" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Checkbox Height="15" Id="chk_Change2" Left="555" OnClick="chk_Change2_OnClick" Style="checkbox" TabOrder="46" Text="반려" Top="679" Width="45"></Checkbox>
		<Static Align="Center" Border="Flat" Height="22" Id="Static56" Left="289" Style="table" TabOrder="70" Text="검토의견" Top="655" VAlign="Middle" Width="257" WordWrap="TRUE"></Static>
		<Shape Bottom="635" Height="14" Id="Shape7" Left="5" LineColor="user4" LineStyle="Dot" Right="1250" RoundHeight="10" RoundWidth="10" TabOrder="73" Top="621" Width="1245"></Shape>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static31" Left="5" Style="table_1" TabOrder="74" Text="중,폐지&#32;관리번호" Top="408" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_NUM" Enable="FALSE" Height="18" Id="edt_DangerNum" ImeMode="none" Left="116" MaxLength="10" Style="edit" TabOrder="10" Top="410" Width="100"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_DangerWork" ImageID="btn_8_Inquiry01" Left="990" LeftMargin="21" OnClick="btn_DangerWork_OnClick" Style="button" TabOrder="76" Text="위험작업&#32;허가기준" Top="385" Width="128"></Button>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static110" Left="217" Style="table_1" TabOrder="77" Text="진행상태" Top="408" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static4" Left="5" Style="table_1" TabOrder="78" Text="시공회사" Top="450" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static122" Left="751" Style="table_1" TabOrder="79" Text="작업요청일자" Top="408" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static32" Left="5" Style="table_1" TabOrder="81" Text="작업위치(기존)" Top="429" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_REQ_YMD1" Dateformat="LONGDATE" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_JobReqYmd1" Left="862" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="14" Top="410" WeeksFont="Default,-1" Width="154"></Calendar>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_JOB_STS_FLAG" Enable="FALSE" Height="18" Id="edt_DangerJobStsFlag" ImeMode="none" Left="977" MaxLength="2" Number="TRUE" Style="edit" TabOrder="82" Top="517" Visible="FALSE" Width="100"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="LOT_NUM_UNION" Enable="FALSE" Height="18" Id="edt_LotNumUnion" ImeMode="none" Left="116" Readonly="TRUE" Style="edit" TabOrder="17" Top="431" Width="478"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static34" Left="5" Style="table_1" TabOrder="85" Text="작업구분" Top="471" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static39" Left="503" Style="table_1" TabOrder="87" Text="공급압력" Top="471" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static40" Left="254" Style="table_1" TabOrder="86" Text="포장종류" Top="471" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static41" Left="5" Style="table" TabOrder="89" Top="492" VAlign="Middle" Width="1243" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static43" Left="1017" Style="table_1" TabOrder="90" Text="배관관경" Top="471" VAlign="Middle" Width="92" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static44" Left="751" Style="table_1" TabOrder="88" Text="배관재질" Top="471" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="DIG_ADMIT_NUM" Height="18" Id="edt_DigAdmitNum" ImeMode="none" Left="508" MaxLength="10" Style="edit_Indis" TabOrder="59" Top="520" Visible="FALSE" Width="137"></Edit>
		<Image Align="Left" Height="12" Id="Image11" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="94" Text="접수&#32;및&#32;검토&#32;내역&#32;등록" Top="637" Width="164"></Image>
		<Shape Bottom="711" Height="14" Id="Shape3" Left="5" LineColor="user0" LineStyle="Dash" Right="1250" RoundHeight="10" RoundWidth="10" TabOrder="95" Top="697" Width="1245"></Shape>
		<Image Align="Left" Height="12" Id="Image12" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="96" Text="중,폐지&#32;작업&#32;결과등록" Top="714" Width="210"></Image>
		<Static Align="Right" Border="Flat" Height="22" Id="Static1" Left="5" Style="table" TabOrder="97" Text="입회일자" Top="730" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static2" Left="187" Style="table" TabOrder="98" Text="작업유무" Top="730" VAlign="Middle" Width="63" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_approval_result" ImageID="btn_9_reg_01" Left="984" LeftMargin="21" OnClick="btn_approval_result_OnClick" Style="button" TabOrder="99" Text="입회결과등록/전자결재" Top="709" Width="160"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static3" Left="540" Style="table" TabOrder="101" Text="입회자" Top="730" VAlign="Middle" Width="65" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_StopRst" Border="Flat" Column="JOIN_NM" Enable="FALSE" Height="18" Id="edt_JoinNm" ImeMode="none" Left="607" Style="edit" TabOrder="55" Top="732" Width="93"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static5" Left="343" Style="table_indis" TabOrder="100" Text="재사용유무" Top="730" VAlign="Middle" Width="87" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_StopRst" Border="Flat" CheckLength="Byte" Column="RMK" Height="18" Id="edt_Rmk" ImeMode="none" Left="800" MaxLength="500" Style="edit" TabOrder="57" Top="732" Width="448"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="MATER_FLAG" Height="18" Id="cob_MaterFlag" ImeMode="none" Left="861" OnChanged="cob_MaterFlag_OnChanged" Style="combo_indis" TabOrder="33" Top="472" Width="156"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="PIPE_DIAM_CD" Height="18" Id="cob_PipeDiamCd" ImeMode="none" Left="1109" Style="combo_indis" TabOrder="34" Top="472" Width="138"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="PRESS_FLAG" Height="18" Id="cob_PressFlag" ImeMode="none" Left="613" Style="combo_indis" TabOrder="32" Top="472" Width="138"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="PAVEMENT_KIND" Height="18" Id="cob_PavementKind" ImeMode="none" Left="364" Style="combo_indis" TabOrder="31" Top="472" Width="139"></Combo>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static62" Left="912" Style="table" TabOrder="112" Top="676" VAlign="Middle" Width="259" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static66" Left="810" Style="table" TabOrder="111" Top="676" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static67" Left="708" Style="table" TabOrder="109" Top="676" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="43" Id="Static68" Left="1170" Style="table" TabOrder="106" Top="655" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Checkbox Height="15" Id="chk_Change3" Left="1194" Style="checkbox" TabOrder="50" Text="결재" Top="659" Width="45"></Checkbox>
		<Edit BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_RTURN_WHY_NM" Height="18" Id="edt_DecideRturnWhy" ImeMode="none" Left="916" Style="edit" TabOrder="49" Top="678" Width="252"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static69" Left="708" Style="table" TabOrder="105" Text="결재자" Top="655" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static70" Left="810" Style="table" TabOrder="107" Text="결재일자" Top="655" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_DecideYmd" Left="814" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="48" Top="678" WeeksFont="Default,-1" Width="95"></Calendar>
		<Edit BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_EMPID" Height="18" Id="edt_DecideEmpid" ImeMode="none" Left="712" Style="edit" TabOrder="108" Top="678" Width="95"></Edit>
		<Checkbox Height="15" Id="chk_Change4" Left="1194" Style="checkbox" TabOrder="51" Text="반려" Top="679" Width="45"></Checkbox>
		<Static Align="Center" Border="Flat" Height="22" Id="Static71" Left="912" Style="table" TabOrder="110" Text="결재반려사유" Top="655" VAlign="Middle" Width="259" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="43" Id="Static72" Left="629" Style="table" TabOrder="104" Text="결재/반려" Top="655" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_StopRst" Border="Flat" Column="JOIN_YMD" Dateformat="yyyy-MM-dd" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_JoinYmd" Left="85" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="52" Top="732" WeeksFont="Default,-1" Width="99"></Calendar>
		<Combo BindDataset="ds_StopRst" Border="Flat" CodeColumn="VALUE" Column="JOB_YN" DataColumn="NAME" Height="18" Id="cob_JobYn" ImeMode="none" InnerDataset="ds_JobYn" Left="250" Style="combo" TabOrder="53" Top="731" Width="91"></Combo>
		<Combo BindDataset="ds_StopRst" Border="Flat" CodeColumn="VALUE" Column="REUSE_YN" DataColumn="NAME" Height="18" Id="cob_ReuseYn" ImeMode="none" InnerDataset="ds_ReuseYn" Left="431" Style="combo_indis" TabOrder="54" Top="731" Width="107"></Combo>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static10" Left="409" Style="table_1" TabOrder="113" Text="지사" Top="408" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="BRANCH_CD" Enable="FALSE" Height="18" Id="cob_BranchCd01" Left="469" OnChanged="cob_BranchCd01_OnChanged" Style="combo_indis" TabOrder="12" Top="409" Width="80"></Combo>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static99" Left="1017" Style="table_1" TabOrder="114" Text="작업요청시간" Top="408" VAlign="Middle" Width="92" WordWrap="TRUE"></Static>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" ClipMode="IncludeSpace" Column="JOB_REQ_STR_TIME" DecimalLen="0" DigitLen="0" Height="18" Id="edt_JobReqStrTime" Left="1110" Mask="##:##" MaxLength="4" Style="edit_Indis" TabOrder="15" Top="410" Type="STRING" Width="45"></MaskEdit>
		<Image Align="Left" Height="18" Id="Image10" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search_Indis" TabOrder="115" Text="지사" Top="40" Width="60"></Image>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="157" LeftMargin="12" Style="blt_search" TabOrder="116" Text="시/구" Top="40" Width="60"></Image>
		<Combo Border="Flat" Height="18" Id="cob_BranchCd" INDEX="0" Left="56" OnChanged="cob_BranchCd_OnChanged" Style="combo_indis" TabOrder="1" Top="40" Width="90"></Combo>
		<Image Align="Left" Height="18" Id="Image5" ImageID="blt" Left="765" LeftMargin="12" Style="blt_search" TabOrder="117" Text="진행상태" Top="40" Width="60"></Image>
		<Combo Border="Flat" Height="18" Id="cob_ZipNo1" Left="205" Style="combo" TabOrder="2" Top="40" Width="93"></Combo>
		<Combo Border="Flat" CodeColumn="VALUE" DataColumn="NAME" Height="18" Id="cob_DangerJobStsFlag" INDEX="0" InnerDataset="ds_DangerJobStsFlag" Left="828" Style="combo" TabOrder="6" Top="41" Width="126"></Combo>
		<Image Align="Left" Height="18" Id="Image1" ImageID="blt" Left="478" LeftMargin="12" Style="blt_search" TabOrder="120" Text="작업요청일자" Top="41" Width="90"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdStart" Left="566" OnChanged="cal_ReqYmdStart_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="7" Top="41" WeeksFont="Default,-1" Width="90"></Calendar>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdEnd" Left="667" OnChanged="cal_ReqYmdEnd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="8" Top="41" WeeksFont="Default,-1" Width="90"></Calendar>
		<Static Height="13" Id="Static109" Left="657" Style="static" TabOrder="121" Text="~" Top="45" Width="10"></Static>
		<Image Align="Left" Height="12" Id="Image2" ImageID="blt_8" Left="8" LeftMargin="12" Style="text_title" TabOrder="122" Text="중,폐지&#32;작업내역" Top="101" Width="110"></Image>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_JOB_STS_FLAG_NM" Enable="FALSE" Height="18" Id="edt_DangerJobStsFlagNm" ImeMode="none" Left="308" Style="edit" TabOrder="11" Top="410" Width="100"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static25" Left="5" Style="table" TabOrder="123" Top="603" VAlign="Middle" Width="1245" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="18" Id="edtFileList" ImeMode="none" Left="8" Style="edit" TabOrder="42" Top="605" Width="1162"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_FileFolder" ImageID="btn_4_fileadd" Left="1172" LeftMargin="21" OnClick="btn_FileFolder_OnClick" Style="button" TabOrder="124" Text="파일첨부&#32;" Top="605" Width="76"></Button>
		<Edit BindDataset="ds_Review" Border="Flat" Column="REVIEW_EMPID_NM" Height="18" Id="edt_ReviewEmpidNm" ImeMode="none" Left="87" Style="edit_Indis" TabOrder="43" Top="678" Width="99"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_NM" Enable="FALSE" Height="18" Id="edt_WorkFirmNm" ImeMode="none" Left="116" Style="edit_Indis" TabOrder="19" Top="452" Width="137"></Edit>
		<Edit BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_EMPID_NM" Height="18" Id="edt_DecideEmpidNm" ImeMode="none" Left="712" Style="edit" TabOrder="47" Top="678" Width="95"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" EscapeButton="TRUE" Height="19" Id="btn_gis" ImageID="btn_5_gis" Left="890" LeftMargin="21" OnClick="btn_gis_OnClick" Style="button" TabOrder="125" TabStop="FALSE" Text="GIS&#32;위치보기" Top="385" Width="98"></Button>
		<Image Align="Left" Height="12" Id="Image4" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="126" Text="첨부문서" Top="763" Width="210"></Image>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static12" Left="5" Style="table" TabOrder="127" Top="780" VAlign="Middle" Width="614" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="18" Id="edtFileList01" ImeMode="none" Left="8" Style="edit" TabOrder="128" Top="782" Width="530"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_FileFolder01" ImageID="btn_4_fileadd" Left="540" LeftMargin="21" OnClick="btn_FileFolder01_OnClick" Style="button" TabOrder="60" Text="파일첨부&#32;" Top="782" Width="76"></Button>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi_Excel" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="428" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="332" Id="grd_ExcelList" InputPanel="FALSE" Left="1288" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" Right="2533" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="129" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1245">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="83"/>
						<col width="132"/>
						<col width="79"/>
						<col width="84"/>
						<col width="78"/>
						<col width="79"/>
						<col width="78"/>
						<col width="100"/>
						<col width="121"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="위험작업번호"/>
						<cell align="center" col="1" display="text" text="진행상태"/>
						<cell align="center" col="2" display="text" text="지사"/>
						<cell col="3" display="text" text="팀"/>
						<cell align="center" col="4" display="text" text="SCG담당자"/>
						<cell align="center" col="5" display="text" text="구청"/>
						<cell align="center" col="6" display="text" text="작업요청일자"/>
						<cell align="center" col="7" display="text" text="작업시작시간"/>
						<cell align="center" col="8" display="text" text="작업종료시간"/>
						<cell align="center" col="9" display="text" text="시공회사명"/>
						<cell align="center" col="10" display="text" text="요청자"/>
						<cell align="center" col="11" display="text" text="주소"/>
						<cell align="center" col="12" display="text" text="작업구분"/>
						<cell align="center" col="13" display="text" text="마감작업방법"/>
						<cell align="center" col="14" display="text" text="포장재질"/>
						<cell align="center" col="15" display="text" text="압력구분"/>
						<cell align="center" col="16" display="text" text="관경"/>
						<cell align="center" col="17" display="text" text="배관재질"/>
						<cell align="center" col="18" display="text" text="검토자명"/>
						<cell align="center" col="19" display="text" text="검토일자"/>
						<cell col="20" display="text" text="검토의견"/>
						<cell col="21" display="text" text="작업결재일"/>
						<cell align="center" col="22" display="text" text="건물번호"/>
						<cell align="center" col="23" display="text" text="입회일자"/>
						<cell align="center" col="24" display="text" text="작업유무"/>
						<cell align="center" col="25" display="text" text="재사용유무"/>
						<cell align="center" col="26" display="text" text="입회자"/>
						<cell align="center" col="27" display="text" text="특이사항"/>
						<cell align="center" col="28" display="text" text="작업결재일"/>
						<cell align="center" col="29" display="text" text="업체평가여부"/>
					</head>
					<body>
						<cell align="center" col="0" colid="DANGER_NUM" display="text" edit="normal" limit="10"/>
						<cell align="center" col="1" colid="DANGER_JOB_STS_FLAG_NM" display="text" edit="normal" limit="2"/>
						<cell align="center" col="2" colid="BRANCH_NM" display="text" edit="normal" limit="6"/>
						<cell col="3" colid="TEAM_NM" display="text"/>
						<cell align="center" col="4" colid="TAKER_EMPID_NM" display="text" edit="normal" limit="32"/>
						<cell align="center" col="5" colid="ZIP_NO1_NM" display="text" edit="normal" limit="9"/>
						<cell align="center" col="6" colid="JOB_REQ_YMD1" display="date" edit="normal" limit="8"/>
						<cell align="center" col="7" colid="JOB_REQ_STR_TIME" display="text" edit="normal" limit="1"/>
						<cell align="center" col="8" colid="JOB_REQ_END_TIME" display="text" edit="normal" limit="9"/>
						<cell align="center" col="9" colid="WORK_FIRM_NM" display="text" edit="normal" limit="8"/>
						<cell align="center" col="10" colid="WORK_FIRM_TAKER_NM" display="text" edit="normal" limit="80"/>
						<cell align="center" col="11" colid="LOT_NUM_UNION" display="text" edit="normal" limit="2"/>
						<cell align="center" col="12" colid="JOB_ITEM" display="text" edit="normal" limit="1"/>
						<cell align="center" col="13" colid="CLS_JOB_METHOD_CD" display="text" edit="normal" limit="8"/>
						<cell align="center" col="14" colid="PAVEMENT_KIND" display="text" edit="normal" limit="9"/>
						<cell align="center" col="15" colid="PRESS_FLAG" display="text" edit="normal" limit="160"/>
						<cell align="center" col="16" colid="PIPE_DIAM_CD" display="text" edit="normal" limit="1"/>
						<cell align="center" col="17" colid="MATER_FLAG" display="text" edit="normal" limit="3"/>
						<cell align="center" col="18" colid="REVIEW_EMPID_NM" display="text" edit="normal" limit="3"/>
						<cell align="center" col="19" colid="REVIEW_YMD" display="date" edit="normal" limit="4"/>
						<cell align="center" col="20" colid="REVIEW_OPINI" display="text"/>
						<cell align="center" col="21" colid="DECIDE_YMD" display="date"/>
						<cell align="center" col="22" colid="BLD_NUM" display="text" edit="normal" limit="9"/>
						<cell align="center" col="23" colid="JOIN_YMD" display="date" edit="normal" limit="300"/>
						<cell align="center" col="24" colid="JOB_YN" display="text" edit="normal" limit="1200"/>
						<cell align="center" col="25" colid="REUSE_YN" display="text" edit="normal" limit="1"/>
						<cell align="center" col="26" colid="JOIN_NM" display="text" edit="normal" limit="13"/>
						<cell align="center" col="27" colid="RMK" display="text" edit="normal" limit="160"/>
						<cell align="center" col="28" colid="RST_DECIDE_YMD" display="date" edit="normal" limit="320"/>
						<cell align="center" col="29" colid="CHK_YN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" ClipMode="IncludeSpace" Column="JOB_REQ_END_TIME" DecimalLen="0" DigitLen="0" Height="18" Id="edt_JobReqEndTime" Left="1174" Mask="##:##" MaxLength="4" Style="edit_Indis" TabOrder="16" Top="410" Type="STRING" Width="45"></MaskEdit>
		<Static Height="13" Id="Static13" Left="1160" Style="static" TabOrder="130" Text="~" Top="414" Width="10"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static16" Left="553" Style="table_1" TabOrder="131" Text="팀" Top="408" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" CodeColumn="CODE" Column="TEAM_CD" DataColumn="KITEM" Enable="FALSE" Height="18" Id="cob_TeamCd" InnerDataset="ds_Team_01" Left="613" Style="combo_indis" TabOrder="13" Top="409" Width="138"></Combo>
		<Static Align="Center" Border="Flat" Height="22" Id="Static23" Left="503" Style="table_1" TabOrder="80" Text="시공사요청자" Top="450" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_ITEM" Height="18" Id="cob_JobItem" ImeMode="none" Left="115" Style="combo" TabOrder="30" Top="472" Width="139"></Combo>
		<Image Align="Left" Height="12" Id="Image18" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="132" Text="특기사항" Top="524" Width="96"></Image>
		<TextArea BindDataset="ds_Multi_Re" Border="Flat" Column="RMK" Height="42" Id="edt_RmkMain" Left="5" Style="textarea" TabOrder="41" Text="TextArea0" Top="538" VScroll="TRUE" Width="1245"></TextArea>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static94" Left="254" Style="table_1" TabOrder="133" Text="시공회사번호" Top="450" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_DDD" Height="18" Id="cob_WorkFirmTelDdd" Left="364" Style="combo_indis" TabOrder="20" Top="451" Value="위험작업번호(중폐지)/정비보수번호" Width="50"></Combo>
		<Static Height="13" Id="Static11" Left="413" Style="static" TabOrder="134" Text="-" Top="455" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_EXN" Height="18" Id="work_firm_tel_exn" ImeMode="none" Left="420" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="21" Top="452" Width="35"></Edit>
		<Static Height="13" Id="Static116" Left="456" Style="static" TabOrder="135" Text="-" Top="455" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_NUM" Height="18" Id="work_firm_tel_num" ImeMode="none" Left="463" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="22" Top="452" Width="35"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="REQ_TEL_DDD" Height="18" Id="cob_ReqTelDdd" Left="861" Style="combo_indis" TabOrder="24" Top="451" Width="50"></Combo>
		<Static Height="13" Id="Static117" Left="910" Style="static" TabOrder="136" Text="-" Top="455" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="REQ_TEL_EXN" Height="18" Id="edt_ReqTelExn" ImeMode="none" Left="916" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="25" Top="452" Width="35"></Edit>
		<Static Height="13" Id="Static118" Left="951" Style="static" TabOrder="137" Text="-" Top="455" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="REQ_TEL_NUM" Height="18" Id="edt_ReqTelNum" ImeMode="none" Left="958" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="26" Top="452" Width="35"></Edit>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static17" Left="751" Style="table_1" TabOrder="138" Text="요청자번호" Top="450" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="BLD_NUM" Enable="FALSE" Height="18" Id="edt_BldNum" ImeMode="none" Left="365" MaxLength="9" Style="edit" TabOrder="36" Top="494" Width="120"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_SEQ" Height="18" Id="edt_Zip_Seq" Left="342" MaxLength="160" Style="edit" TabOrder="146" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ADDR_M" Height="18" Id="edt_Addr_M" Left="390" MaxLength="160" Style="edit" TabOrder="147" Top="352" Visible="FALSE" Width="56"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="HILL" Height="18" Id="edt_Hill" Left="390" MaxLength="160" Style="edit" TabOrder="140" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ADDR_S" Height="18" Id="edt_Addr_S" Left="438" MaxLength="160" Style="edit" TabOrder="141" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="SECOND_ADDR" Height="18" Id="edt_SecondAddr" Left="205" MaxLength="160" Style="edit" TabOrder="142" Top="519" Visible="FALSE" Width="106"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="BLD_DONG" Height="18" Id="edt_Bld_Ding" Left="534" MaxLength="160" Style="edit" TabOrder="143" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_ADDR_BLD_SEQ" Height="18" Id="edt_New_Addr_Bld_Seq" Left="582" MaxLength="160" Style="edit" TabOrder="144" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_HOSU" Height="18" Id="edt_New_Hosu" Left="630" MaxLength="160" Style="edit" TabOrder="145" Top="333" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="HOSU" Height="18" Id="edt_Hosu" Left="448" MaxLength="160" Style="edit" TabOrder="148" Top="352" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_ADDR_UNION" Enable="FALSE" Height="18" Id="edt_Addr_Union" ImeMode="none" Left="751" Readonly="TRUE" Style="edit" TabOrder="18" Top="431" Width="495"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static19" Left="613" Style="table_1" TabOrder="150" Text="작업위치(신주소)" Top="429" VAlign="Middle" Width="137" WordWrap="TRUE"></Static>
		<Button Cursor="HAND" Height="17" Id="btn_AddrSearch" ImageID="search" Left="595" OnClick="btn_AddrSearch_OnClick" TabOrder="151" Text="Button8" Top="432" Width="17"></Button>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static24" Left="1017" Style="table_1" TabOrder="152" Text="SCG담당자" Top="450" VAlign="Middle" Width="92" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="TAKER_EMPID_NM" Enable="FALSE" Height="18" Id="edt_Taker_EmpNm" ImeMode="none" Left="1110" Style="edit" TabOrder="28" Top="452" Width="118"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static36" Left="5" Style="table_1" TabOrder="153" Text="마감작업방법" Top="492" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static18" Left="254" Style="table_1" TabOrder="157" Text="건물번호" Top="492" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="12" Id="Image8" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="158" Text="첨부문서" Top="587" Width="210"></Image>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="CLS_JOB_METHOD_CD" Enable="FALSE" Height="18" Id="cob_ClsJobMethodCd" Left="115" Style="combo" TabOrder="35" Top="493" Width="139"></Combo>
		<Static Height="13" Id="Static104" Left="78" Style="static" TabOrder="159" Text="※&#32;위치도&#32;및&#32;도시가스사용중지,&#32;폐지,&#32;해지신청서&#32;사본&#32;등&#32;&#32;[진행상태가&#32;작업요청전/작업요청/검토반려인&#32;경우&#32;첨부가&#32;가능합니다.[시공사&#32;첨부가능])" Top="586" Width="812"></Static>
		<Edit AutoSelect="TRUE" BKColor="white" Border="None" Height="20" Id="Edit1" ImeMode="none" Left="126" MaxLength="10" Style="static" TabOrder="162" Text="(" Top="97" Width="7"></Edit>
		<Image Align="Left" Height="6" Id="Image9" ImageID="blt" Left="154" LeftMargin="12" Style="blt_search" TabOrder="163" Text="건" Top="103" Width="30"></Image>
		<Edit Align="CENTER" AutoSelect="TRUE" BKColor="white" Border="None" DisableBKColor="white" Height="20" Id="edt_Count" ImeMode="none" Left="136" MaxLength="10" Number="TRUE" Readonly="TRUE" Style="static" TabOrder="160" Top="99" Width="30"></Edit>
		<Edit AutoSelect="TRUE" BKColor="white" Border="None" Height="20" Id="Edit3" ImeMode="none" Left="183" MaxLength="10" Style="static" TabOrder="161" Text=")" Top="97" Width="7"></Edit>
		<Button Cursor="HAND" Height="17" Id="Button2" ImageID="search" Left="486" OnClick="Button2_OnClick" TabOrder="37" Text="Button8" Top="494" Width="17"></Button>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TAKER_NM" Height="18" Id="edt_WorkFirmTakerNm" ImeMode="none" Left="614" Style="edit" TabOrder="23" Top="452" Width="136"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Btn_Danger_Req" ImageID="btn_8_reg" Left="1119" LeftMargin="21" OnClick="Btn_Danger_Req_OnClick" Style="button" TabOrder="164" Text="중,폐지&#32;작업요청" Top="385" Width="128"></Button>
		<Button Cursor="HAND" Height="17" Id="btn_ScgCharge" ImageID="search" Left="1229" OnClick="btn_ScgCharge_OnClick" TabOrder="29" Text="Button8" Top="452" Width="17"></Button>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="TAKER_EMPID" Enable="FALSE" Height="18" Id="edt_Taker_EmpId" ImeMode="none" Left="1024" Style="edit" TabOrder="27" Top="452" Visible="FALSE" Width="60"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_Danger" ImageID="search" Left="1094" OnClick="btn_Danger_OnClick" TabOrder="39" Text="Button8" Top="495" Width="18"></Button>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_CD" Enable="FALSE" Height="18" Id="edt_WorkFirmCd" ImeMode="none" Left="10" MaxLength="11" Style="edit" TabOrder="165" Top="452" Visible="FALSE" Width="75"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static33" Left="862" Style="table_1" TabOrder="166" Text="위험작업번호(가정관)" Top="492" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static22" Left="503" Style="table_1" TabOrder="167" Text="요금미납여부" Top="492" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="KITEM" Height="18" Id="cob_TeamCdSearch" InnerDataset="ds_Team" Left="333" Style="combo_indis" TabOrder="3" Top="40" Width="140"></Combo>
		<Image Align="Left" Height="18" Id="Image19" ImageID="blt" Left="306" LeftMargin="12" Style="blt_search" TabOrder="168" Text="팀" Top="40" Width="60"></Image>
		<Image Align="Left" Height="18" Id="Image20" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search" TabOrder="169" Text="시공사" Top="65" Width="60"></Image>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_WorkFirmCdSearch" ImeMode="none" Left="70" Style="edit" TabOrder="4" Top="65" Width="85"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_WorkFirmNmSearch" ImeMode="none" Left="157" Style="edit" TabOrder="5" Top="65" Width="110"></Edit>
		<Edit BindDataset="ds_StopRst" Border="Flat" Column="JOIN_EMPID" Enable="FALSE" Height="18" Id="edt_JoinEmpid" ImeMode="none" Left="606" Style="edit" TabOrder="170" Top="708" Visible="FALSE" Width="60"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_NM" Enable="FALSE" Height="18" Id="edt_JobNm1" ImeMode="none" Left="1089" Readonly="TRUE" Style="edit" TabOrder="171" Top="517" Visible="FALSE" Width="156"></Edit>
		<Static Align="Center" Border="Flat" Height="43" Id="Static8" Left="629" Style="table" TabOrder="177" Text="결재/반려" Top="760" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static26" Left="708" Style="table" TabOrder="178" Text="결재자" Top="760" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_StopRst" Border="Flat" Column="DECIDE_EMPID_NM" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="712" Style="edit" TabOrder="174" Top="783" Width="95"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static27" Left="810" Style="table" TabOrder="180" Text="결재일자" Top="760" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_StopRst" Border="Flat" Column="DECIDE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="Calendar0" Left="814" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="175" Top="783" WeeksFont="Default,-1" Width="95"></Calendar>
		<Static Align="Center" Border="Flat" Height="22" Id="Static28" Left="912" Style="table" TabOrder="181" Text="결재반려사유" Top="760" VAlign="Middle" Width="259" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_StopRst" Border="Flat" Column="DECIDE_RTURN_WHY_NM" Enable="FALSE" Height="18" Id="Edit2" ImeMode="none" Left="916" Style="edit" TabOrder="176" Top="783" Width="252"></Edit>
		<Static BKColor="white" Border="Flat" Height="43" Id="Static29" Left="1170" Style="table" TabOrder="179" Top="760" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Checkbox Enable="FALSE" Height="15" Id="chk_Change5" Left="1194" OnClick="chk_Change5_OnClick" Style="checkbox" TabOrder="172" Text="결재" Top="764" Width="45"></Checkbox>
		<Checkbox Enable="FALSE" Height="15" Id="chk_Change6" Left="1194" Style="checkbox" TabOrder="173" Text="반려" Top="784" Width="45"></Checkbox>
		<Grid AutoFit="TRUE" BindDataset="GDS_VALUE" BkColor2="default" BoldHead="true" Bottom="296" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="96" Id="Grid0" InputPanel="FALSE" Left="64" LineColor="default" MinWidth="100" Right="360" TabOrder="185" TabStop="true" Top="200" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="296">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="ReqVariable"/>
					<cell col="1" display="text" text="ReqVariableValue"/>
					<cell col="2" display="text" text="Description"/>
				</head>
				<body>
					<cell col="0" colid="ReqVariable" display="text"/>
					<cell col="1" colid="ReqVariableValue" display="text"/>
					<cell col="2" colid="Description" display="text"/>
				</body>
			</contents>
		</Grid>
		<Edit Align="CENTER" BindDataset="ds_Multi_UnPay" Border="Flat" Color="red" Column="UNPAY_YN" Enable="FALSE" Height="18" Id="edt_Unpay_Yn" ImeMode="none" Left="614" Style="edit" TabOrder="38" Top="494" Width="39"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="OK_HMPP_DANGER_NUM" Enable="FALSE" Height="18" Id="edt_Ok_Hmpp_Danger_Num" ImeMode="none" Left="993" MaxLength="2" Number="TRUE" Style="edit" TabOrder="40" Top="494" Width="100"></Edit>
		<Button Height="21" Id="Button0" Left="272" OnClick="Button0_OnClick" TabOrder="186" Text="정비보수화면&#32;연결" Top="96" Visible="FALSE" Width="120"></Button>
		<Static Height="13" Id="Static15" Left="1120" TabOrder="187" Text="←&#32;가정관화면연계버튼" Top="498" Width="125"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="DECIDE_PROC_STS" Enable="FALSE" Height="17" Id="cob_state" Left="913" Style="combo" TabOrder="188" Top="632" Width="70"></Combo>
		<Combo BindDataset="ds_StopRst" Border="Flat" Column="DECIDE_PROC_STS" Enable="FALSE" Height="18" Id="cob_state_result" Left="913" Style="combo" TabOrder="189" Top="708" Width="70"></Combo>
		<Edit Align="RIGHT" BindDataset="ds_Multi_UnPay" Border="Flat" Column="UNPAY_AMT" Enable="FALSE" Height="18" Id="edt_Unpay_Amt" ImeMode="none" Left="654" Number="TRUE" Style="edit" TabOrder="190" Top="494" Width="96"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_Bldno" ImeMode="none" Left="249" MaxLength="9" Style="edit" TabOrder="191" Top="632" Width="80"></Edit>
		<Button Cursor="HAND" Height="17" Id="Button1" ImageID="search" Left="331" OnClick="Button3_OnClick" TabOrder="192" Text="Button8" Top="632" Width="17"></Button>
		<Static Align="Center" Border="Flat" Color="blue" Height="21" Id="Static45" Left="188" Style="table_1" TabOrder="193" Text="건물번호" Top="631" VAlign="Middle" Width="60" WordWrap="TRUE"></Static>
		<Static Color="red" Height="13" Id="Static42" Left="356" TabOrder="194" Text="건물번호&#32;확인,&#32;틀릴경우&#32;반려바람." Top="635" Width="200"></Static>
		<Static Align="Center" Border="Flat" BorderColor="red" Height="22" Id="Static48" Left="217" Style="table_1" TabOrder="196" Text="등록일시" Top="384" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="UPD_DTM" Enable="FALSE" Height="18" Id="Edit7" ImeMode="none" Left="308" Style="edit" TabOrder="195" Top="386" Width="164"></Edit>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static50" Left="751" Style="table_1" TabOrder="197" Text="계약해지여부" Top="492" VAlign="Middle" Width="86" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_UnPay" Border="Flat" Color="red" Column="CONT_YN" Enable="FALSE" Height="18" Id="edt_Cont_Yn" ImeMode="none" Left="838" Style="edit" TabOrder="198" Top="494" Width="22"></Edit>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static51" Left="551" Style="table_1" TabOrder="200" Text="미납존재여부(금액)" Top="631" VAlign="Middle" Width="110" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="18" Id="edt_Unpay_Ok" ImeMode="none" Left="662" OnChanged="edt_Unpay_Yn_OnChanged" Style="edit" TabOrder="199" Top="633" Width="26"></Edit>
		<Edit Align="RIGHT" Border="Flat" Enable="FALSE" Height="18" Id="edt_Unpay" ImeMode="none" Left="689" Number="TRUE" Style="edit" TabOrder="201" Top="633" Width="80"></Edit>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static52" Left="771" Style="table_1" TabOrder="202" Text="계약해지여부" Top="631" VAlign="Middle" Width="76" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" Border="Flat" Enable="FALSE" Height="18" Id="edt_Cont" ImeMode="none" Left="848" Style="edit" TabOrder="203" Top="633" Width="22"></Edit>
		<Static Align="Right" Border="Flat" Height="22" Id="Static7" Left="720" Style="table" TabOrder="102" Text="특기사항" Top="730" VAlign="Middle" Width="79" WordWrap="TRUE"></Static>
		<Static Color="red" Height="13" Id="Static0" Left="84" TabOrder="204" Text="진행상태가&#32;결재승인/결과등록/결과결재반려인&#32;경우&#32;첨부가&#32;가능합니다.[시공사&#32;첨부가능]" Top="763" Width="512"></Static>
		<Static Align="Center" Border="Flat" Color="red" Height="22" Id="Static121" Left="10" Style="table" TabOrder="205" Text="작업&#32;취소사유" Top="831" VAlign="Middle" Width="95" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="CANCEL_RMK" Height="18" Id="edt_cancel_rmk" ImeMode="none" Left="107" MaxLength="200" Style="edit" TabOrder="209" Top="833" Width="429"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" EscapeButton="TRUE" Height="19" Id="Btn_cancel" ImageID="btn_5_cal" Left="540" LeftMargin="21" OnClick="Btn_cancel_OnClick" Style="button" TabOrder="207" TabStop="FALSE" Text="취소처리" Top="834" Width="90"></Button>
		<Static Align="Center" Border="Flat" Color="red" Height="22" Id="Static127" Left="631" Style="table" TabOrder="206" Text="취소정보" Top="831" VAlign="Middle" Width="63" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="CANCEL_DTM" Enable="FALSE" Height="18" Id="Edit11" ImeMode="none" Left="696" Style="edit" TabOrder="208" Top="832" Width="126"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="CANCEL_NM" Enable="FALSE" Height="18" Id="Edit4" ImeMode="none" Left="824" Style="edit" TabOrder="210" Top="832" Width="57"></Edit>
		<Image Align="Left" Height="12" Id="Image0" ImageID="blt_8" Left="7" LeftMargin="12" Style="text_title" TabOrder="211" Text="작업취소" Top="814" Width="210"></Image>
		<Image Align="Left" Height="18" Id="Image7" ImageID="blt" Left="965" LeftMargin="12" Style="blt_search" TabOrder="212" Text="중폐지관리번호" Top="40" Width="100"></Image>
		<Edit Border="Flat" Height="18" Id="edt_DangerNumSearch" ImeMode="none" Left="1068" MaxLength="11" Style="edit" TabOrder="213" TabStop="FALSE" Top="41" UpperOnly="TRUE" Width="115"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_job_chg" ImageID="btn_6_reg" Left="472" LeftMargin="21" OnClick="btn_job_chg_OnClick" Style="button" TabOrder="214" Text="작업의뢰수정" Top="385" Width="100"></Button>
		<Static Color="red" Height="13" Id="st_chg_rmk" Left="576" Style="static" TabOrder="215" Text="&#32;작업내용&#32;수정&#32;후&#32;좌측의&#32;작업의뢰수정&#32;버튼&#32;반드시&#32;클릭." Top="388" Width="496"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
*  FormID     : D1501010012F.xml
*  Form 설명  : 위험작업 요청_등록 중폐지
*  시스템 명  : 안전공급 (D1)
*  작성자     : 권기철 
*  작성일     : 2011-05-10
*  변경내용   : 
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONE20001.js";
#include "js::COMMONA10008.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var fv_FindRow_ShowRow = -1; 		  // 조회후 보여줄 컬럼 체크변수
var fv_FindRow_ShowKey = -1;          // KEY값

var danger_num = "";							//위험작업번호
var danger_job_sts_flag = "";					//위험작업상태값 구분
var danger_job_flag = "";						//위험작업구분	

var fv_COOP_YN = false;  // 협력사여부

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
//--------------------------------------------------------------------------------------------------
//	OnLoadCompleted
//--------------------------------------------------------------------------------------------------
function D1501010012F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
	
	if(gfn_GetGlobalValue("G_COM_ID") == "92") // 시공사-협력사 여부
	{
		fv_COOP_YN = true;		
		Image20.Visible = true;
		edt_WorkFirmCdSearch.Visible = true;
		edt_WorkFirmNmSearch.Visible = true;
		
		cob_BranchCd.Enable = true;
		cob_BranchCd.Value = "";
		cob_BranchCd_OnChanged();
		
		// 팀설정	
		cob_TeamCdSearch.Enable = true;	
		cob_TeamCdSearch.Value = "";
		// 시공사 설정
		edt_WorkFirmCdSearch.Text = gfn_GetGlobalValue("G_DEAL_CD");
		edt_WorkFirmNmSearch.Text = gfn_GetGlobalValue("G_COM_NAME");
		
		btn_job_chg.Visible = false;
		Btn_cancel.Visible = false;
		st_chg_rmk.Visible = false;
	}	
	else
	{
		Image20.Visible = false;
		edt_WorkFirmCdSearch.Visible = false;
		edt_WorkFirmNmSearch.Visible = false;	
		
		if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") 
		{
			// 지사설정
			cob_BranchCd.Enable = true;
			cob_BranchCd.Value = "";
			cob_BranchCd_OnChanged();
			// 팀설정	
			cob_TeamCdSearch.Enable = true;	
			cob_TeamCdSearch.Value = "";
		
		} 
		else 
		{
			// 지사설정
			cob_BranchCd.Enable = false;
			cob_BranchCd.Value = gfn_GetGlobalValue("G_BRANCH_CD");
			cob_BranchCd_OnChanged();
			
			// 팀설정 //상황팀 관계로 팀 해제 2010.3.4 권기철
			//cob_TeamCdSearch.Enable = false;					
			cob_TeamCdSearch.Enable = true;	
			cob_TeamCdSearch.Value = gfn_GetGlobalValue("G_DEPT_CODE");
			
			btn_job_chg.Visible = true;
			Btn_cancel.Visible = true;			
			st_chg_rmk.Visible = true;
		}				
	}
	
	edt_DangerNum.Text = "";
	fn_D10_Common1();
	fn_D10_Common4();
	fn_D10_Common5();
	fn_D10_Common6();
	
	btn_gis.Enable = false;

	
	//cal_ReqYmdStart.Value = substr(today(),0,6)+"01";		// 작업의뢰일자 default 이번달 1일부터 오늘까지 
	cal_ReqYmdStart.Value = AddDate(today(),-20);
	//cal_ReqYmdEnd.Value = today();	 	
	// 해당날의 마지막날 구하기
	//cal_ReqYmdEnd.Value = adddate(addMonth(substr(today(),0,6)+"01", 1),-1);
	cal_ReqYmdEnd.Value = AddDate(today(),+10);
	
	cob_DangerJobStsFlag.Value = ""; // 진행상태
	
	// ###############################################################################
	// 최종파라미터에 따라 화면을 다르게 구성
	// ###############################################################################
	// BPM 
	if(IsExistVar("FLAG",true))
	{

		// BPM에서 넘어온 화면
		if(FLAG == "BPM")
		{
			fv_FindRow_ShowRow = 1;
			fv_FindRow_ShowKey = DANGER_NUM; //위험작업번호
	
			//fn_D1_FindListOne(DANGER_NUM, DANGER_JOB_FLAG);
			
		}
		
	}
	
	//포틀릿 EP화면에서 넘어온것
    if (IsExistVar("dangerNumPK", true)) 				
    {
		//alert("dangerNumPK:"+dangerNumPK);
		//alert("dangerJobFlag:"+dangerJobFlag);

		fv_FindRow_ShowRow = 1;
		fv_FindRow_ShowKey = dangerNumPK; //위험작업번호

		//fn_D1_FindListOne(dangerNumPK, dangerJobFlag);

	} 
	
}

//--------------------------------------------------------------------------------------------------
//	fn_Init
//--------------------------------------------------------------------------------------------------
function fn_Init()
{

	grd_DangerJob.NoDataText = gfn_GetMessage("M000022","%AAA%","조회결과가");	
	
	//gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd"));			//지사코드
	gfn_D1_All_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd"));		//지사코드
	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd01"));			//지사코드
	gfn_SetComboBox_Comcode("D10034",gfn_setDsObject_Comcode("cob_PressFlag")); 		//압력구분
	gfn_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("cob_MaterFlag")); 		//배관재질코드
	//gfn_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("cob_PipeDiamCd")); 		//배관관경코드
	gfn_SetComboBox_Comcode("D10040",gfn_setDsObject_Comcode("cob_PavementKind")); 		//도로포장종류
	gfn_D1_NULL_SetComboBox_Comcode("D10226",gfn_setDsObject_Comcode("cob_JobItem"));			//작업구분
	gfn_SetComboBox_Comcode("D10227",gfn_setDsObject_Comcode("cob_ClsJobMethodCd"));		//마감작업방법
	gfn_D1_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_WorkFirmTelDdd"),"010#011#016#017#018#019"); 	//식별번호(시공회사전화)
	gfn_D1_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_ReqTelDdd"),"0130#02#031#032#033#041#042#043#0502#0505#051#052#053#054#055#061#062#063#064");  //식별번호(시공요청자전화)
	
	
	gfn_SetComboBox_Comcode("A10411",gfn_setDsObject_Comcode("cob_state")); 				//결재진행상태 
	gfn_SetComboBox_Comcode("A10411",gfn_setDsObject_Comcode("cob_state_result")); 				//결재진행상태 	
	
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",12,"D10226");	    //작업구분
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",13,"D10227");		//마감작업방법
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",14,"D10040");		//포장재질
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",15,"D10034");		//압력
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",16,"B30007");	//관경
	gfn_SetGrdComboBox_Comcode("grd_ExcelList",17,"D10002");	//배관재질
	
	btn_job_chg.Enable = false;
	Btn_cancel.Enable = false;
	
}
/********************************************************************************
* 기      능   :  지사_구 콤보 
********************************************************************************/
function cob_BranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) 
{

    fn_SetComboBox_Comcode("1", cob_BranchCd.value, fn_setDsObject_Comcode("1", "cob_ZipNo1"));
    cob_ZipNo1.Value = "";    
    //gfn_D1_SetComboBox_Teamcd("ds_Team", cob_BranchCd);
    // 2013.06.26. 이건민 - 권기철 과장님 요청사항으로 주석처리
    //gfn_D1_SetComboBox_Teamcd_all("ds_Team", cob_BranchCd);
    
    // 2013.06.26. 이건민 - 권기철 과장님 요청사항(지사 선택 시 팀정보에 공사관리팀, 수요개발팀 빼기)
    gfn_D1_SetComboBox_Teamcd("ds_Team", cob_BranchCd);
    
    cob_TeamCdSearch.Value = "";
    
    
    ds_Multi.ClearData();
    ds_Review.ClearData();
    ds_StopRst.ClearData();
    ds_Cancel.ClearData();
        
}

//-------------------------------------------------------------------------------
// 기      능   :  공통 조회
//-------------------------------------------------------------------------------
function fn_CommonSearch()
{
	ds_Multi.ClearData();
	ds_Multi_Excel.ClearData();

	ds_SearchTop.ClearData();
	ds_SearchTop.AddRow();
	
    //'팀코드가 200138','200148','200149','200151' 이면 지사코드를 ''으로 넣어준다 20110923 이상목 권기철과장요청
    if(cob_TeamCdSearch.Value == "200138" || cob_TeamCdSearch.Value == "200148" || cob_TeamCdSearch.Value == "200149" || cob_TeamCdSearch.Value == "200151")
    {
		ds_SearchTop.SetColumn(0,"BRANCH_CD"          , ""       );  // 지사
    }else{
		ds_SearchTop.SetColumn(0,"BRANCH_CD"          , cob_BranchCd.Value        );  // 지사
    } 
    ds_SearchTop.SetColumn(0,"ZIP_NO1"            , cob_ZipNo1.Value          );  // 시/구
    ds_SearchTop.SetColumn(0,"TEAM_CD"            , cob_TeamCdSearch.Value    );  // 팀
    ds_SearchTop.SetColumn(0,"REQ_YMD_START"      , cal_ReqYmdStart.Value     );  // 작업요청일자
    ds_SearchTop.SetColumn(0,"REQ_YMD_END"        , cal_ReqYmdEnd.Value       );  // 작업요청일자
	ds_SearchTop.SetColumn(0,"DANGER_JOB_STS_FLAG", cob_DangerJobStsFlag.Value);  // 진행상태
	ds_SearchTop.SetColumn(0,"WORK_FIRM_CD"       , edt_WorkFirmCdSearch.Text );  // 시공사
	ds_SearchTop.SetColumn(0,"DANGER_NUM"       , edt_DangerNumSearch.Text );  // 중폐지관리번호
	
	
	var strSvcID = "findList";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi=ds_Multi ds_Multi_Excel=ds_Multi_Excel";
	var strArgument  = "searchList=1";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	edt_Count.Text = ds_Multi.GetRowCount();			   
}

/*===============================================================================
 * 기      능   :  공통 Excel
===============================================================================*/
function fn_CommonExcelExport()
{
	var SearchCondition= "";
    SearchCondition = SearchCondition + "지사코드 :" + RPad(cob_BranchCd.Text," ",20);
    SearchCondition = SearchCondition + "시/구 :" + RPad(cob_ZipNo1.Text," ",20);
    SearchCondition = SearchCondition + "시공사업체명 :" + RPad(edt_WorkFirmNmSearch.Text," ",20);
    SearchCondition = SearchCondition + "공사진행상태 :" + RPad(cob_DangerJobStsFlag.Text," ",20);
    SearchCondition = SearchCondition + "작업요청일자 :" + RPad(cal_ReqYmdStart.Value +" ~ "+ cal_ReqYmdEnd.Value," ",20);
    
    gfn_ExportExcel("중폐지 작업 조회", 5, SearchCondition, "grd_ExcelList"); 	
}

//--------------------------------------------------------------------------------------------------
//	서비스 CallBack
//--------------------------------------------------------------------------------------------------
function fn_D1_CallBack(SrvID,ErrorCode,ErrorMsg)
{

	if(ErrorCode < 0) {
	
		alert(ErrorMsg);
		//에러시 초기화
		fv_FindRow_ShowRow = -1;
		return;
	}
	
    switch(SrvID){

		//상세 조회
        case "findDetail":
			
			gfn_D1_SetComboBox_Teamcd01("ds_Team_01",cob_BranchCd01); 
			 
			cob_MaterFlag_OnChanged(cob_MaterFlag, cob_MaterFlag.Value);
	
			fn_D1_OnRowPosChanged();
			
			// 첨부화일
			fn_File_List();
			fn_File_List01();
			
			if(gfn_GetGlobalValue("G_COM_ID") == "92"){
				if(ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '02' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '10' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '90')
				{
					edt_cancel_rmk.Enable = false;
					Btn_cancel.Enable = false;
				}
				else
				{
					edt_cancel_rmk.Enable = true;
					Btn_cancel.Enable = true;			
				}
			}else{
				if(ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '10' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '90')
				{
					edt_cancel_rmk.Enable = false;
					Btn_cancel.Enable = false;
				}
				else
				{
					edt_cancel_rmk.Enable = true;
					Btn_cancel.Enable = true;			
				}
			}
			
			/*
			if(ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '02' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '10' || ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_STS_FLAG") == '90')
			{
				edt_cancel_rmk.Enable = false;
				Btn_cancel.Enable = false;
			}
			else
			{
				edt_cancel_rmk.Enable = true;
				Btn_cancel.Enable = true;			
			}
			*/
			
			// 체납여부 조회
			fn_UnPayDetail();
        
			// 로우선택하기
			if(fv_FindRow_ShowRow > 0)
			{
				var nFocusRow = ds_Multi.FindRow("DANGER_NUM",fv_FindRow_ShowKey);
				if (nFocusRow != -1)
				{
					ds_Multi.row = nFocusRow;
				}	
				fv_FindRow_ShowRow = -1;
			}
			
			
			//요청전, 요청, 검토반려시 당사 담당자 미납존재 내역 초기화			
			if(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '01' ||	ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '02')									
			{
				 edt_Bldno.Text = '';
				 edt_Unpay_Ok.Text = '';
				 edt_Unpay.Text = '';
				 edt_Cont.Text = '';
			}
			else
			{
				 edt_Bldno.Text = ds_Multi_UnPay.GetColumn(0,"BLD_NUM");
				 edt_Unpay_Ok.Text = ds_Multi_UnPay.GetColumn(0,"UNPAY_YN");
				 edt_Unpay.Text = ds_Multi_UnPay.GetColumn(0,"UNPAY_AMT");
				 edt_Cont.Text = ds_Multi_UnPay.GetColumn(0,"CONT_YN");	
			}	 				 
				 
	
        	break;	

        default:

    }
}

//-------------------------------------------------------------------------------
// 기      능   :  공통 추가
//-------------------------------------------------------------------------------
function fn_CommonAddRow()
{/*
	if(!fv_COOP_YN && gfn_GetGlobalValue("G_USER_NO") != "199443297")
	{
		alert(" 시공사만 등록 가능합니다.");
		return;
	}
	*/
	
	if (gfn_isNull( cob_BranchCd.Value )) //지사 선택
	{
		alert(gfn_GetMessage("M000040", "%AAA%", "지사를"));
		cob_BranchCd.SetFocus();
		return;
	}

	alert("중폐지 신청 건물에 요금미납 및 계약해지가 되지않은 경우 신청이 불가합니다.\n건물번호 항목에서 미리 확인 후 신청 바랍니다");
		
	fn_D10_Common1();
	fn_D10_Common5();
	fn_D10_Common7();
	
	edt_DangerNum.Text = "";     //  	// 새로 등록할 위험작업번호 보여주기
	edtFileList.Text = "";
	
	ds_Multi_Re.ClearData();
	ds_Multi_Re.AddRow();
	
	edt_DangerJobStsFlag.Text = "00";
	edt_DangerJobStsFlagNm.Text = "위험작업요청전";
	ds_Review.ClearData();
	ds_DecideReq.ClearData();
	ds_StopRst.ClearData();
	
	Btn_Danger_Req.Enable = false;
	
	btn_gis.Enable = false;
	
	edt_WorkFirmNm.Enable = false;
	
	cob_BranchCd01.Value = cob_BranchCd.Value; // 지사셋팅
	//지사세팅 후 팀 세팅처리 2011.5.9
	cob_BranchCd01_OnChanged();
	edt_WorkFirmCd.Text  = gfn_GetGlobalValue("G_DEAL_CD");         // 시공사코드
	edt_WorkFirmNm.Text  = gfn_GetGlobalValue("G_COM_NAME");         // 시공사명 
	edt_WorkFirmTakerNm.Text = gfn_GetGlobalValue("G_NAME");      // 시공요청자

}


//-------------------------------------------------------------------------------
// 기      능   :  공통 저장 (2009.01.19 현재 검토(접수/반려) 부분까지 ==> 결재후 승인/반려 이루어질것
//-------------------------------------------------------------------------------
function fn_CommonSave()
{	
	danger_job_sts_flag = edt_DangerJobStsFlag.Text;

// 위험작업 요청전	00
// 위험작업 요청	01
// 반려	            02
// 변경요청	        03
// 결재반려	        04
// 결재승인	        06
// 작업결과등록     07


	if( fv_COOP_YN ) // 협력사이면 수정가능
	{
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
		{
			edt_DangerJobStsFlag.Text = "00";
		}
		else
		{
			alert("[시공사] 저장할 수 없습니다. 수정가능한 진행상태까지 기다려 주십시오.");
			return;
		}
		
	}
	else // SCG
	{
		if(danger_job_sts_flag == "00" && gfn_GetGlobalValue("G_USER_NO") == '199443297')
		{
		
		}
		else if(danger_job_sts_flag == "01")  //작업요청
		{
			alert("작업의뢰 내역 수정은 아래 작업내역 수정 버튼을 이용하세요.\n검토처리는 검토/결재 버튼 클릭시 검토 및 결재 처리가 됩니다..");
			return;
		}		
		else if(danger_job_sts_flag == "04")  //결재반려
		{
			alert("작업의뢰 내역 수정은 아래 작업내역 수정 버튼을 이용하세요.\n시공업체 검토 반려 처리시 반려에 체크하십시요.");
			return;
		}		
		else if(danger_job_sts_flag == "05" || danger_job_sts_flag == "06" || danger_job_sts_flag == "07")
		{
			alert("작업결과 내역 등록/수정 후 입회결과 등록/전자결재 버튼 클릭시 결과등록과 결재 처리가 가능 합니다..");
			return;
		}
		else
		{
			alert("[SCG] 수정 단계가 아닙니다..");		
			return;
		}
	}
	
	var chk01 = fn_D10_Validation01();
	if(chk01 == "1")
	{
		return;
	}

	ds_Multi_Re.SetColumn(0,"DANGER_JOB_STS_FLAG","00"); //작업내용 수정시 상태는 요청전으로 

	fn_D10_Save();
	
}


/********************************************************************************
* 기      능   :  시공사 등록시  
********************************************************************************/
function fn_D10_Save()
{	
	danger_num = ds_Multi_Re.GetColumn(0,"DANGER_NUM");
		
	ds_Multi_Re.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
	ds_Multi_Re.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	ds_Multi_Re.SetColumn(0,"CRT_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
	ds_Multi_Re.SetColumn(0,"CRT_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	
	ds_Multi_Re.SetColumn(0,"JOB_NM", ds_Multi_Re.GetColumn(0,"LOT_NUM_UNION"));
	
	ds_Multi_Re.SetColumn(0,"DANGER_JOB_FLAG","30");	//위험작업구분 (중폐지 "04")
		
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_Multi_Re.GetColumn(0,"DANGER_NUM"); //위험작업번호
			
	var strSvcID = "save";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";
	var strInDatasets  = "ds_Multi_Re=ds_Multi_Re:u";
	var strOutDatasets  = "";
	var strArgument  = "save=1";	
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
		fn_CommonSearch();			
	}				  
}

//-------------------------------------------------------------------------------
//	공통 버튼 클릭 - 삭제
//-------------------------------------------------------------------------------
function fn_CommonDeleteRow()
{
	if(ds_Multi.RowCount() == 0)
	{
		alert("삭제할 데이터가 존재하지 않습니다.");
		return;
	}
	else
	{
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
		{	
			if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != null && ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != '')
			{
				if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != '00' && ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != '02')
				{
					alert("가정관 진행 상태가["+ ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG_NM") + "] 로 삭제가 불가능합니다.");
					return;
				}
			}
				
			if(confirm("해당 중폐지 작업을 삭제하시겠습니까?"))
			{
				ds_Multi.DeleteRow(ds_Multi.row);
				
				var strSvcID        = "delete";
				var strPart         = "D10";
				var strURL          = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
				var strInDatasets   = "ds_Multi=ds_Multi:u";
				var strOutDatasets  = "";
				var strArgument     = "delete=1";	
				
				gfn_SyncCall(strSvcID,
						  strPart,
						  strURL,
						  strInDatasets,
						  strOutDatasets,
						  strArgument,
						 );
						 
				if(ErrorCode < 0)
				{    
					alert(ErrorMsg);
					return;
				}
				else
				{
					gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"),"black",true); 
					alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"));
					fn_CommonSearch();
				}	
			}		
		}
		else
		{
			alert("진행상태가 위험작업[요청전/반려] 상태만 삭제가 가능합니다..");
			return;
		}
	}
}

//--------------------------------------------------------------------------------------------------
// 로우 변경시
//--------------------------------------------------------------------------------------------------
function ds_Multi_OnRowPosChanged(obj,nOldRow,nRow)
{
	//trace("ds_Multi_OnRowPosChanged - " +nRow +" "+danger_num);
	
	if(nRow < 0) 
	{
		//로우 없을경우 초기화
		ds_Multi_Re.ClearData(); // 위험작업내역등록	
	}
	else
	{

		danger_num          = ds_Multi.GetColumn(nRow, "DANGER_NUM");
		danger_job_flag     = ds_Multi.GetColumn(nRow, "DANGER_JOB_FLAG");
		danger_job_sts_flag = ds_Multi.GetColumn(nRow, "DANGER_JOB_STS_FLAG");
		
		// detail Grid 조회
		fn_D1_SearchDetail(nRow); 		// 정비보수 내역 조회	
		
		//fn_D1_SearchDetailTeamUserList();	// 팀장 명 및 코드 가져오기 
	}
	
}


//--------------------------------------------------------------------------------------------------
// 상세조회 - 위험작업내역 상세조회 
//--------------------------------------------------------------------------------------------------
function fn_D1_SearchDetail(nRow)
{	

	if(nRow < 0) return;
	
	ds_Multi_Re.ClearData();
	ds_StopRst.ClearData();
	
	var strSvcID = "findDetail";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_Multi_Re=ds_Multi_Re ds_StopRst=ds_StopRst";
	var strArgument    = "searchDetail=1";
		strArgument	  += " DANGER_NUM=" + quote(ds_Multi.GetColumn(nRow, "DANGER_NUM"));
		strArgument	  += " DANGER_JOB_FLAG=" + quote(ds_Multi.GetColumn(nRow, "DANGER_JOB_FLAG"));
	var strCallbackFunc = "fn_D1_CallBack";	
		
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallbackFunc
			   );
	
	
}
function fn_D1_OnRowPosChanged()
{	

// 위험작업 요청전	00
// 위험작업 요청	01
// 반려	            02
// 변경요청	        03


// 결재반려	        04 05
// 결재승인	        06 07
// 작업결과등록     07 

// 작업결과 결재반려 08 06  
// 작업결과 결재승인 09 08 


	//############################################################################
	// 모든화면을 막는다.
	//############################################################################
	fn_D10_Common1();
	fn_D10_Common5();
	fn_D10_Common4();
	fn_D10_Common6();
	fn_D10_Common8();
	fn_D10_Common10();
	fn_D10_Common12();
	
	btn_DangerWork.Enable = true;	// 위험작업 허가기준
	Btn_Danger_Req.Enable = false;  // 중폐지 작업요청

	btn_gis.Enable = false;           // GIS위치보기

	// 데이터 바인딩
	fn_D10_Common2(); // 검토/반려
	fn_D10_Common3(); // 결재/반려
	btn_job_chg.Enable = false;
	//############################################################################
	// 권한에 따라서 화면을 풀어준다.
	//############################################################################
	
	//위험작업 등록상태(00) 반려(02)
	if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
	{
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{	
			fn_D10_Common7();   // 활성화
				
			Btn_Danger_Req.Enable = true;
		}
		// else // SCG
		// {
			// fn_D10_Common7();   // 활성화
				
			// Btn_Danger_Req.Enable = true;		
		// }
		
	}else if(danger_job_sts_flag == "01" || danger_job_sts_flag == "04")	//위험작업 요청, 결재 반려/취소
	{
	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{	

		}
		else // SCG
		{
			btn_job_chg.Enable = true;	
/*
			if(danger_job_sts_flag == "01" || danger_job_sts_flag == "04")
			{
			trace("a");
				btn_approval.Enable = true;	
			}
			else
			{
			trace("b");
				btn_approval.Enable = false;	
			}	
*/
			//2011.10.07 이상목 결재진행상태가 승인,결재중이 아닐땐 검토/전자결재(입회)버튼 활성화 해주
			if(ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '0' || ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '2')
			{
				btn_approval.Enable = false;	
			}
			else
			{
				btn_approval.Enable = true;	
			}				
			
			fn_D10_Common7();   // 활성화	
					
			cal_JobReqYmd1.Enable = false;	
			btn_ScgCharge.Enable = false;		
			
			chk_Change2.Enable = true;
			
			edt_ReviewOpini.Enable = true;
		}
		
	}else if(danger_job_sts_flag == "03")					//위험작업 승인상태
	{
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{	

		}
		else // SCG
		{
			if(ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '0' || ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '2')
			{
				btn_approval.Enable = false;	
			}
			else
			{
				btn_approval.Enable = true;	
			}					
		}
	}else if(danger_job_sts_flag == "05" || danger_job_sts_flag == "06" || danger_job_sts_flag == "07")					//위험작업 작업 결과 등록, 작업결과결재반려
	{
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{	

		}
		else // SCG
		{
			btn_JoinNm.Enable = true; // 입회자 버튼 
			
			if(ds_StopRst.GetColumn(ds_StopRst.row, "DECIDE_PROC_STS") == '0' || ds_StopRst.GetColumn(ds_StopRst.row, "DECIDE_PROC_STS") == '2')
			{
				btn_approval_result.Enable = false;	
			}
			else
			{
				btn_approval_result.Enable = true;	
			}	
						
			fn_D10_Common13(); // 작업결과 등록
			
			if( ds_StopRst.GetRowCount() == 0 )
			{
				ds_StopRst.ClearData();
				ds_StopRst.AddRow();
			}
		}
	}
}	

//-------------------------------------------------------------------------------
// 기      능   :  파일첨부 조회
//-------------------------------------------------------------------------------
function fn_UnPayDetail()
{
	ds_Multi_UnPay.ClearData();	
	
	if( gfn_IsNull( ds_Multi_Re.GetColumn(0, "BLD_NUM") ) )
	{
		return;
	}		
	
	var strSvcID = "findUnPayDetail";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_Multi_UnPay=ds_UnPay";
	var strArgument    = "findUnPay=1";
		strArgument	  += " BLD_NUM=" +quote(ds_Multi_Re.GetColumn(0, "BLD_NUM"));
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );		   		
}
//-------------------------------------------------------------------------------
// 기      능   :  파일첨부 조회
//-------------------------------------------------------------------------------
function fn_File_List()
{	
	ds_FileList.ClearData();
	
	var strWORK_FLAG = "10";
		
	var strSvcID = "findFile";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_FileList=ds_FileList";
	var strArgument    = "findFile=1";
		strArgument	  += " DANGER_NUM=" +quote(ds_Multi.GetColumn(ds_Multi.Row, "DANGER_NUM"));
		strArgument	  += " DANGER_JOB_FLAG=" +quote(danger_job_flag);
		strArgument	  += " WORK_FLAG=" +quote(strWORK_FLAG);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	edtFileList.text = "";
	for(var i=0; i<ds_FileList.RowCount(); i++)
	{
		edtFileList.text += ds_FileList.GetColumn(i,"ORG_FILE_NAME");
		if(ds_FileList.RowCount()-1 != i) edtFileList.text += "/";
	}
}

// 첨부 SCG
function fn_File_List01()
{	
	ds_FileList.ClearData();
	
	var strWORK_FLAG = "20";
		
	var strSvcID = "findFile";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_FileList=ds_FileList";
	var strArgument    = "findFile=1";
		strArgument	  += " DANGER_NUM=" +quote(ds_Multi.GetColumn(ds_Multi.Row, "DANGER_NUM"));
		strArgument	  += " DANGER_JOB_FLAG=" +quote(danger_job_flag);
		strArgument	  += " WORK_FLAG=" +quote(strWORK_FLAG);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	edtFileList01.text = "";
	for(var i=0; i<ds_FileList.RowCount(); i++)
	{
		edtFileList01.text += ds_FileList.GetColumn(i,"ORG_FILE_NAME");
		if(ds_FileList.RowCount()-1 != i) edtFileList01.text += "/";
	}
}


/********************************************************************************
* 기      능   :  위험작업 요청(버튼 클릭시 상태값 강제 01) 변경
********************************************************************************/
function Btn_Danger_Req_OnClick(obj)
{   
	danger_job_str_flag = ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG");

	if(danger_job_str_flag == "00" || danger_job_str_flag == "02")
	{	
		if(edt_Ok_Hmpp_Danger_Num.Text == null  || edt_Ok_Hmpp_Danger_Num.Text == '')
		{
			alert("가정과 위험작업 신청이 되지 않았습니다.\n가정관 연계버튼 클릭 후 가정관 위험작업 신청 후 요청하시기 바랍니다..");
			return;
		}
		
		//잠시대기
		var strBLD_NUM      = ds_Multi_Re.GetColumn(0, "BLD_NUM");	
		
		if( gfn_IsNull( strBLD_NUM ) || length(strBLD_NUM) != 9)
		{
			alert("건물허가번호는 필수입력사항입니다. 건물허가번호 저장후 진행바랍니다.");
			edt_BldNum.SetFocus();
			return;
		}		
		
		ds_UnPay.ClearData();
		
		var strSvcID = "findUnPay";
		var strPart = "D10";	
		var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
		var strInDatasets  = "";
		var strOutDatasets = "ds_UnPay=ds_UnPay";
		var strArgument    = "findUnPay=1";
			strArgument	  += " BLD_NUM=" +quote(strBLD_NUM);
		
		gfn_SyncCall( 
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );	
				   
		if(ErrorCode < 0)
		{    
			alert(ErrorMsg);
			return;
		}
		else
		{
//건물번호 조회시 조회된 데이타가 있는 경우는 체납여부 check하고 없는 경우는 			
//해당건물에 계량기 번호가 미존재(계약전)이므로 체납여부 check제외
//권기철 20100601
			if(ds_UnPay.GetRowCount() > 0)
			{
				
				var nFindRow = ds_UnPay.FindRow("UNPAY_YN","N");  // 미납여부
				
				if (nFindRow != 0)   // 미납이 있으면
				{
					alert("해당 건물은 미납된 상태입니다. 중폐지작업요청이 불가합니다.");
					return;
				}	
				
				nFindRow = '';
				
				nFindRow = ds_UnPay.FindRow("CONT_YN","Y");  // 계약여부
				
				if (nFindRow != 0)    // 계약존재시
				{
					alert("해당 건물은 계약된 상태입니다. 중폐지작업요청이 불가합니다.");
					return;
				}					
			}
		}
		
	
		if(Confirm("중,폐지 작업요청을 하시겠습니까? ") == true)
		{
			ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","01");
			ds_Review.SetColumn(0,"REVIEW_FLAG","");
			ds_Review.SetColumn(0,"REVIEW_YMD","");
			ds_Review.SetColumn(0,"REVIEW_OPINI","");
			ds_Review.SetColumn(0,"REVIEW_EMPID","");
			ds_Review.SetColumn(0,"REVIEW_YMD",'');
			fn_review();
		}
	}else{
		alert("이미 위험작업 요청을 하였습니다.");
		return;
	}
	
	fn_CommonSearch();
}

/********************************************************************************
* 기      능   :  접수,검토시 업데이트 (검토시 03, 반려시 02)
********************************************************************************/
function fn_review()
{   
	//danger_num = ds_Multi_Re.GetColumn(0,"DANGER_NUM");	
	
	ds_Review.UpdateControl = false;
	ds_Review.SetRowType(0,"update");

	ds_Review.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
	ds_Review.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	ds_Review.SetColumn(0,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM"));  
	ds_Review.SetColumn(0,"DANGER_JOB_FLAG","30");
		
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_Multi_Re.GetColumn(0,"DANGER_NUM"); //위험작업번호		
	
	var strSvcID = "review_update";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";
	var strInDatasets  = "ds_Review=ds_Review:u";
	var strOutDatasets = "";
	var strArgument  = "review_update=1";
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
		fn_CommonSearch();	
	}				  
}


/********************************************************************************
* 기      능   :  주소검색 등록
********************************************************************************/
function fn_ZipSearch(obj)
{
	var arrList = gfn_Dialog("A10", "A1101020010U", "", 1100, 600, true, -1, -1);
	if(arrList == "" || arrList == null || arrList ==0){
		return;
	} 
	
	//지번주소
	edt_Zip_Seq.Text = arrList[0];                // "주소일련번호"
	edt_Zip1.Text = arrList[2];            		  // "우편번호1"
	edt_Zip2.Text = arrList[3];            		  // "우편번호2"
	edt_Hill.Text = arrList[10];                  // "산번지"
	edt_Addr_M.Text = arrList[11];                // "본번"
	edt_Addr_S.Text = arrList[12];                // "지번"
	
	edt_SecondAddr.Text = arrList[13];     	      // "보조주소"
	edt_Bld_Ding.Text = arrList[14];              // "동"
	edt_Hosu.Text = arrList[15];           		  // "호수"
	edt_LotNumUnion.Text = arrList[17];           // "지번주소조합";
			
	//새주소
	edt_New_Addr_Bld_Seq.Text	= arrList[18];    // "주소일련번호";
	edt_New_Hosu	    .Text   = arrList[21];    // "호수";
	edt_Addr_Union	    .Text	= arrList[23];    // "새주소조합";
}

function btn_AddrSearch_OnClick(obj)
{
	var arrList = gfn_Dialog("A10", "A1101020010U", "", 1100, 600, true, -1, -1);
	if(arrList == "" || arrList == null || arrList ==0){
		return;
	} 
	
	var strSvcID = "";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service&branchcd=1"
			    + "&CODE_ITEM=" +arrList[2]; 
			   ;  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_BranchCd=ds_BranchCd";
	var strArgument  = "";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	// 2012.02.02. 이건민 - 용산이 강북에서 남부로 이동으로 인해 주석처리
	//if(ds_Multi_Re.GetColumn(ds_Multi_Re.row,"BRANCH_CD") != ds_BranchCd.GetColumn(0,"BRANCH_CD"))
	//{
		//alert("선택한 지사와 다른 지역입니다 작업위치를 확인하세요...");
		//return;
	//}

	//지번주소
	edt_Zip_Seq.Text = arrList[0];                // "주소일련번호"
	edt_Zip1.Text = arrList[2];            		  // "우편번호1"
	edt_Zip2.Text = arrList[3];            		  // "우편번호2"
	edt_Hill.Text = arrList[10];                  // "산번지"
	edt_Addr_M.Text = arrList[11];                // "본번"
	edt_Addr_S.Text = arrList[12];                // "지번"
	
	edt_SecondAddr.Text = arrList[13];     	      // "보조주소"
	edt_Bld_Ding.Text = arrList[14];              // "동"
	edt_Hosu.Text = arrList[15];           		  // "호수"
	edt_LotNumUnion.Text = arrList[17];           // "지번주소조합";
			
	//새주소
	edt_New_Addr_Bld_Seq.Text	= arrList[18];    // "주소일련번호";
	edt_New_Hosu	    .Text   = arrList[21];    // "호수";
	edt_Addr_Union	    .Text	= arrList[23];    // "새주소조합";
}

// 반려
function chk_Change2_OnClick(obj,strValue)
{
	if(chk_Change2.Value = 1){
	
		if(confirm("검토 반려를 하시겠습니까?")){
			
			//edt_ReviewEmpid.Text = gfn_GetGlobalValue("G_USER_NO");	
			//edt_ReviewEmpidNm.Text = gfn_GetGlobalValue("G_NAME");
			//ds_Review.SetColumn(0,"REVIEW_EMPID_NM","G_NAME");  //검토반려자명			

			ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","02");  //검토반려			
			ds_Review.SetColumn(0,"REVIEW_FLAG","N");			
			ds_Review.SetColumn(0,"REVIEW_EMPID",gfn_GetGlobalValue("G_USER_NO"));
			ds_Review.SetColumn(0,"REVIEW_OPINI",edt_ReviewOpini.Text);

			// 값이 없으면 현재일자
			if( gfn_IsNull( cal_ReviewYmd.Value) )
			{
				cal_ReviewYmd.Value = today();
				ds_Review.SetColumn(0,"REVIEW_YMD",today());
			}


			fn_review();  // 검토
			
			fn_CommonSearch();
		}
		else
		{
			chk_Change2.Value = 0;
		}
	}
}

/********************************************************************************
* 기      능   :  logic 공통부분 빼기
********************************************************************************/
function fn_D10_Common1()
{
	chk_Change2.Value = 0;
	chk_Change3.Value = 0;
	chk_Change4.Value = 0;
}
function fn_D10_Common5()
{
	chk_Change2.Enable = false;
	chk_Change3.Enable = false;
	chk_Change4.Enable = false;
}

// 검토/반려
function fn_D10_Common2()
{	
	ds_Review.ClearData();
	ds_Review.AddRow();

	ds_Review.SetColumn(0,"REVIEW_EMPID_NM",ds_Multi_Re.GetColumn(0,"REVIEW_EMPID_NM"));
	ds_Review.SetColumn(0,"REVIEW_EMPID",ds_Multi_Re.GetColumn(0,"REVIEW_EMPID"));
	ds_Review.SetColumn(0,"REVIEW_YMD",ds_Multi_Re.GetColumn(0,"REVIEW_YMD"));
	ds_Review.SetColumn(0,"REVIEW_OPINI",ds_Multi_Re.GetColumn(0,"REVIEW_OPINI"));	
	
	// 검토, 반려
	if( ds_Multi_Re.GetColumn(0,"REVIEW_FLAG") == 'N' ) 
	{
		chk_Change2.Value = 1;			
	}
	else
	{
		chk_Change2.Value = 0;			
	}
	
}

// 결재/반려 
function fn_D10_Common3()
{
	ds_DecideReq.ClearData();
	ds_DecideReq.AddRow();
		
	ds_DecideReq.SetColumn(0,"DECIDE_EMPID_NM",ds_Multi_Re.GetColumn(0,"DECIDE_EMPID_NM"));
	ds_DecideReq.SetColumn(0,"DECIDE_EMPID",ds_Multi_Re.GetColumn(0,"DECIDE_EMPID"));
	ds_DecideReq.SetColumn(0,"DECIDE_YMD",ds_Multi_Re.GetColumn(0,"DECIDE_YMD"));
	ds_DecideReq.SetColumn(0,"DECIDE_RTURN_WHY",ds_Multi_Re.GetColumn(0,"DECIDE_RTURN_WHY"));
	ds_DecideReq.SetColumn(0,"DECIDE_RTURN_WHY_NM",ds_Multi_Re.GetColumn(0,"DECIDE_RTURN_WHY_NM"));
	
/*  결재상태 (A10411)
0 - 승인
1 - 작성
2 - 결재중
5 - 반려 */
	
	// 결재반려 DECIDE_PROC_STS -- 결재진행상태
	if( ds_Multi_Re.GetColumn(0,"DECIDE_PROC_STS") == '0' ) // 승인
	{
		chk_Change3.Value = 1;
		chk_Change4.Value = 0;			
	}
	else if(ds_Multi_Re.GetColumn(0,"DECIDE_PROC_STS") == '5' ) // 반려
	{
		chk_Change3.Value = 0;
		chk_Change4.Value = 1;			
	}
	else
	{
		chk_Change3.Value = 0;
		chk_Change4.Value = 0;			
	}
	
	
	// 결과 -  결재반려 DECIDE_PROC_STS -- 결재진행상태
	if( ds_StopRst.GetColumn(0,"DECIDE_PROC_STS") == '0' ) // 승인
	{
		chk_Change5.Value = 1;
		chk_Change6.Value = 0;			
	}
	else if(ds_StopRst.GetColumn(0,"DECIDE_PROC_STS") == '5' ) // 반려
	{
		chk_Change5.Value = 0;
		chk_Change6.Value = 1;			
	}
	else
	{
		chk_Change5.Value = 0;
		chk_Change6.Value = 0;			
	}
	
	
		
}
function fn_D10_Common4()
{
	btn_DangerWork.Enable = false;
	Btn_Danger_Req.Enable = false;
	
	btn_approval.Enable = false;
	btn_approval_result.Enable = false;	
}

function fn_D10_Common6()
{
	//edt_WorkFirmNm.Enable = false;
	cob_WorkFirmTelDdd.Enable = false;
	work_firm_tel_exn.Enable = false;
	work_firm_tel_num.Enable = false;
	edt_WorkFirmTakerNm.Enable = false;
	cob_ReqTelDdd.Enable = false;
	edt_ReqTelExn.Enable = false;
	edt_ReqTelNum.Enable = false;
	btn_AddrSearch.Enable = false;
	edt_SecondAddr.Enable = false;
	cal_JobReqYmd1.Enable = false;
	edt_JobReqStrTime.Enable = false;
	edt_JobReqEndTime.Enable = false;
	cob_PavementKind.Enable = false;
	cob_PressFlag.Enable = false;
	cob_MaterFlag.Enable = false;
	cob_PipeDiamCd.Enable = false;
	cal_DigAdmitFrom.Enable = false;
	cal_DigAdmitTo.Enable = false;
	edt_DigAdmitNum.Enable = false;
	cob_JobItem.Enable = false;
	//cob_ClsJobMethodCd.Enable = false;	
	edt_RmkMain.Enable = false;
	edt_BldNum.Enable = false;
	Button2.Enable = false;
	
	btn_ScgCharge.Enable = false;
	btn_JoinNm.Enable = false;
	
}
function fn_D10_Common7()
{
	//edt_WorkFirmNm.Enable = true;
	cob_WorkFirmTelDdd.Enable = true;
	work_firm_tel_exn.Enable = true;
	work_firm_tel_num.Enable = true;
	edt_WorkFirmTakerNm.Enable = true;
	cob_ReqTelDdd.Enable = true;
	edt_ReqTelExn.Enable = true;
	edt_ReqTelNum.Enable = true;	
	btn_AddrSearch.Enable = true;
	edt_SecondAddr.Enable = true;
	cal_JobReqYmd1.Enable = true;
	edt_JobReqStrTime.Enable = true;
	edt_JobReqEndTime.Enable = true;
	cob_PavementKind.Enable = true;
	cob_PressFlag.Enable = true;
	cob_MaterFlag.Enable = true;
	cob_PipeDiamCd.Enable = true;
	cal_DigAdmitFrom.Enable = true;
	cal_DigAdmitTo.Enable = true;
	edt_DigAdmitNum.Enable = true;
	cob_JobItem.Enable = true;
	//cob_ClsJobMethodCd.Enable = true;
	edt_RmkMain.Enable = true;
	//edt_BldNum.Enable = true;
	Button2.Enable = true;
	
	btn_ScgCharge.Enable = true;
}

// 
function fn_D10_Common8()
{
	edt_ReviewEmpidNm.Enable = false;
	//btn_CardUserEmpNm.Enable = false;
	cal_ReviewYmd.Enable = false;
	edt_ReviewOpini.Enable = false;
}
function fn_D10_Common9()
{
	edt_ReviewEmpidNm.Enable = true;
	//btn_CardUserEmpNm.Enable = true;
	cal_ReviewYmd.Enable = true;
	edt_ReviewOpini.Enable = true;
}
function fn_D10_Common10()
{
	edt_DecideEmpidNm.Enable = false;
	cal_DecideYmd.Enable = false;
	edt_DecideRturnWhy.Enable = false;
}
function fn_D10_Common11()
{
	edt_DecideEmpidNm.Enable = true;
	cal_DecideYmd.Enable = true;
	edt_DecideRturnWhy.Enable = true;
}
function fn_D10_Common12()
{
	cal_JoinYmd.Enable = false;
	cob_JobYn.Enable = false;
	cob_ReuseYn.Enable = false;
	edt_Rmk.Enable = false;
}
function fn_D10_Common13()
{
	cal_JoinYmd.Enable = true;
	cob_JobYn.Enable = true;
	cob_ReuseYn.Enable = true;
	edt_Rmk.Enable = true;
}
/********************************************************************************
* 기      능   :  위험작업 허가기준 보기(POPUP)
********************************************************************************/
function btn_DangerWork_OnClick(obj)
{
	gfn_Dialog("D10","D1502010013U","",660,310,true,-1,-1);
}

//-------------------------------------------------------------------------------
// 설명     :   validation check
//-------------------------------------------------------------------------------
function fn_D10_Validation01()
{
	if( gfn_IsNull( edt_LotNumUnion.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%"," 작업위치(기존)는 "));
		edt_LotNumUnion.SetFocus();
		return 1;
	}
	
	if( gfn_IsNull( edt_Zip1.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","주소는 "));
		edt_Zip1.SetFocus();
		return 1;
	}
	if( gfn_IsNull( edt_Zip2.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","주소는 "));
		edt_Zip2.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( cob_BranchCd01.Value  ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","지사는 "));
		cob_BranchCd01.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( edt_Taker_EmpNm.Text ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","SCG담당자는 "));
		edt_Taker_EmpNm.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( cob_TeamCd.Value ) )
	{				
		alert(gfn_GetMessage("M000015","%AAA%","팀은 "));
		cob_TeamCd.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( cal_JobReqYmd1.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업요청일자는 "));
		cal_JobReqYmd1.SetFocus();
		return 1;
	}
	
	if( gfn_IsNull( edt_JobReqStrTime.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업요청 시작시간은 "));
		edt_JobReqStrTime.SetFocus();
		return 1;
	}	
	
	if( length(trim( ds_Multi_Re.GetColumn(0, "JOB_REQ_STR_TIME") )) != 4 )
	{
		alert("작업계획 시작시간은 4자리이어야 합니다.");
		edt_JobReqStrTime.SetFocus();
		return 1;		
	}
		
	if( gfn_IsNull( edt_JobReqEndTime.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업요청 종료시간은 "));
		edt_JobReqEndTime.SetFocus();
		return 1;
	}
	
	if( length(trim( ds_Multi_Re.GetColumn(0, "JOB_REQ_END_TIME") )) != 4 )
	{
		alert("작업계획 종료시간은 4자리이어야 합니다.");
		edt_JobReqEndTime.SetFocus();
		return 1;		
	}
	
	if( gfn_IsNull( edt_WorkFirmNm.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공사명은 "));
		edt_WorkFirmNm.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_WorkFirmTelDdd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공회사전화번호는 "));
		cob_WorkFirmTelDdd.SetFocus();
		return 1;
	}
	if( gfn_IsNull( work_firm_tel_exn.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공회사전화번호는 "));
		work_firm_tel_exn.SetFocus();
		return 1;
	}
	if( gfn_IsNull( work_firm_tel_num.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공회사전화번호는 "));
		work_firm_tel_num.SetFocus();
		return 1;
	}	 	 
	
	if( gfn_IsNull( cob_ReqTelDdd.Value ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","요청자전화번호는 "));
		cob_ReqTelDdd.SetFocus();
		return 1;
	}
	if( gfn_IsNull( edt_ReqTelExn.Text ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","요청자전화번호는 "));
		edt_ReqTelExn.SetFocus();
		return 1;
	}
	if( gfn_IsNull( edt_ReqTelNum.Text ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","요청자전화번호는 "));
		edt_ReqTelNum.SetFocus();
		return 1;
	}	 
		 	  	 
	if( gfn_IsNull( cob_PavementKind.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","포장종류는 "));
		cob_PavementKind.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_PressFlag.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","공급압력은 "));
		cob_PressFlag.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_MaterFlag.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","배관재질은 "));
		cob_MaterFlag.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_PipeDiamCd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","배관관경은 "));
		cob_PipeDiamCd.SetFocus();
		return 1;
	}
	//잠시대기
	if( gfn_IsNull( edt_BldNum.Text ) || length(edt_BldNum.Text) != 9)
	{
		alert("건물번호가 선택되지 않았거나 건물번호 선택 오류 입니다...");
		edt_BldNum.SetFocus();
		return 1;
	}	
	
	if(gfn_IsNull(edt_Unpay_Yn.Text) || (edt_Unpay_Yn.Text) != 'N' || length(edt_Unpay_Yn.Text) == 0)
	{
		alert("해당건물에 미납요금이 존재합니다. 요청등록이 불가능합니다..");
		edt_BldNum.SetFocus();
		return 1;
	}		
	
	if(gfn_IsNull(edt_Cont_Yn.Text) || (edt_Cont_Yn.Text) != 'Y' || length(edt_Cont_Yn.Text) == 0)
	{
		alert("해당건물에 계약건이 존재합니다. 요청등록이 불가능합니다..");
		edt_BldNum.SetFocus();
		return 1;
	}			
	
}	 
//-------------------------------------------------------------------------------
// 설명     :   validation check
//-------------------------------------------------------------------------------
function fn_D10_Validation02()
{
	if( gfn_IsNull( edt_ReviewEmpidNm.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","검토자는 "));
		edt_ReviewEmpidNm.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cal_ReviewYmd.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","검토일자는 "));
		cal_ReviewYmd.SetFocus();
		return 1;
	}	  
}	 
function btn_AddrSearch01_OnClick(obj)
{
	gfn_Dialog("B20","B2203050011U","",450,400,true,-1,-1);
}

//--------------------------------------------------------------------------------------------
//   검토 승인 후 전자 결제
//--------------------------------------------------------------------------------------------
function btn_approval_OnClick(obj)
{
	if(cob_state.Value == '0' || cob_state.Value == '1' || cob_state.Value == '2')
	{
		alert("현재 [" + cob_state.Text + "] 입니다...");
		return;
	}
	//잠시 대기
	if(edt_Bldno.text == null || edt_Bldno.text == '')
	{
		alert("건물번호를 확인하세요..");
		return;
	}
	if(danger_job_sts_flag == "01" || danger_job_sts_flag == "03")
	{
		if (gfn_GetGlobalValue("G_DEPT_CODE") == ds_Multi.GetColumn(ds_Multi.row,"TEAM_CD") || gfn_GetGlobalValue("G_USER_NO") == '199443297') 
		{	
		}	
		else
		{
			alert("검토 및 결재는 " + cob_TeamCd.Text + "팀원만 가능합니다.");
			return;
		}
		
		if(edt_BldNum.Text == edt_BldNo.Text)
		{
			if( ds_Multi_UnPay.GetRowCount() > 0 )
			{
				var strUNPAY_YN = ds_Multi_UnPay.GetColumn(0, "UNPAY_YN");
				if(strUNPAY_YN != "N")
				{
					alert("건물에 대한 미납정보가 존재합니다. 진행불가 합니다.");
					return;
				}
	
				var strCont_YN = ds_Multi_UnPay.GetColumn(0, "CONT_YN");
				if(strCont_YN != "Y")
				{
					alert("건물에 대한 계약건이 존재합니다. 진행불가 합니다.");
					return;
				}
			}

			if(danger_job_sts_flag == "01" )
			{
				if(confirm("검토 및 결재 요청 하시겠습니까?")){
				
					chk_Change2.Value = 0;
		
					//edt_ReviewEmpidNm.Text = gfn_GetGlobalValue("G_NAME");
					//edt_ReviewEmpid.Text = gfn_GetGlobalValue("G_USER_NO");
					
					ds_Review.SetColumn(0,"REVIEW_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	
					// 값이 없으면 현재일자
					if( gfn_IsNull( cal_ReviewYmd.Value) )
					{
						//cal_ReviewYmd.Value = today();
						ds_Review.SetColumn(0,"REVIEW_YMD",today());
					}
					
					ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","03");  //검토승인
					ds_Review.SetColumn(0,"REVIEW_FLAG","Y");
					
					ds_Review.SetColumn(0,"REVIEW_OPINI",edt_ReviewOpini.Text);
					
					fn_review();  // 검토
				}
				else
				{
					return;
				}
			}
			else
			{
				if(confirm("결재 요청 하시겠습니까?"))
				{
				}
				else
				{
					return;
				}
			}		
				
		}
		else
		{
			alert("신청한 건물번호와 검토한 건물번호가 틀립니다.. 확인 바랍니다..");
			return;
		}	
	}
	else
	{
		alert("검토 및 결재 단계가 아닙니다...");
		return;
	}	
	
	//전자결재 요청
	var dangernum = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_NUM");
	var dangerjobflag = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_JOB_FLAG");
	var dangerjobstsflag = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_JOB_STS_FLAG");
	gfv_callGWInfo("fmD34","d10","",2,dangernum+','+dangerjobflag);
	
	fn_CommonSearch();	
	
	alert("결재 상신 후 반드시 재 조회하셔야 결재진행 상태가 조회 됩니다...");
}

//--------------------------------------------------------------------------------------------
//   결과등록 후 전자 결제
//--------------------------------------------------------------------------------------------
function btn_approval_result_OnClick(obj)
{
	if(cob_state_result.Value == '0' || cob_state_result.Value == '1' || cob_state_result.Value == '2')
	{
		alert("현재 [" + cob_state_result.Text + "] 입니다...");
		return;
	}
	
	if( gfn_isNull( cob_ReuseYn.Value )){
		alert(gfn_GetMessage("M000015","%AAA%","재사용유무확인은 "));
		return 1;
	}
		
	var dangernum = ds_Multi.GetColumn(ds_Multi.row,"DANGER_NUM");
	var dangerjobflag = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_FLAG");
	var dangerjobstsflag = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG");
		
	if(danger_job_sts_flag == "05" || danger_job_sts_flag == "06" || danger_job_sts_flag == "07")
	{
		if (gfn_GetGlobalValue("G_DEPT_CODE") == ds_Multi.GetColumn(ds_Multi.row,"TEAM_CD") || gfn_GetGlobalValue("G_USER_NO") == '199443297') 
		{	
		}	
		else
		{
			alert("입회결과 등록 및 결재는 " + cob_TeamCd.Text + "팀원만 가능합니다.");
			return;
		}
				
		//danger_num = ds_Multi.GetColumn(ds_Multi.row,"DANGER_NUM");	
	
		ds_Multi_Re.UpdateControl = false;
		ds_Multi_Re.SetRowType(0,"update");
		
		ds_Multi_Re.SetColumn(0,"DANGER_JOB_STS_FLAG","06");
		ds_Multi_Re.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));   
		ds_Multi_Re.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));   
		ds_Multi_Re.SetColumn(0,"DANGER_NUM",ds_Multi.GetColumn(ds_Multi.Row, "DANGER_NUM"));
		ds_Multi_Re.SetColumn(0,"DANGER_JOB_FLAG","30");
			
		ds_StopRst.SetColumn(0,"DANGER_NUM",ds_Multi.GetColumn(ds_Multi.Row, "DANGER_NUM"));
		ds_StopRst.SetColumn(0,"DANGER_JOB_FLAG","30");
		ds_StopRst.SetColumn(0,"CRT_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_StopRst.SetColumn(0,"CRT_EMPID",gfn_GetGlobalValue("G_USER_NO"));
		ds_StopRst.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_StopRst.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));		
	
		fv_FindRow_ShowRow = 1;
		fv_FindRow_ShowKey = ds_Multi.GetColumn(ds_Multi.Row, "DANGER_NUM"); //위험작업번호		
		
		var strSvcID = "saveResult";
		var strPart = "D10";
		var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";
		var strInDatasets  = "ds_Multi_Re=ds_Multi_Re:u ds_StopRst=ds_StopRst:u";
		var strOutDatasets  = "";
		var strArgument  = "saveResult=1";	
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
					  );
		if(ErrorCode < 0)
		{    
			alert(ErrorMsg);
			return;
		}else{
			gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
			alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
			fn_CommonSearch();
		}				  
	}
	else
	{
		alert("작업 처리단계가 아닙니다.");
		return;
	}
			
	gfv_callGWInfo("fmD35","d10","",2,dangernum+','+dangerjobflag);	
	
	alert("결재 상신 후 반드시 재 조회하셔야 결재진행 상태가 조회 됩니다...");
}


//-------------------------------------------------------------------------------
//		FROM ~ TO 체크 (조회)
//-------------------------------------------------------------------------------
function cal_ReqYmdStart_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ReqYmdStart.Value !="" && cal_ReqYmdEnd.Value !="" && cal_ReqYmdStart.Value > cal_ReqYmdEnd.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ReqYmdStart.SetFocus();
		cal_ReqYmdStart.value = "";
		cal_ReqYmdEnd.value = "";
		return;
	}	
}

function cal_ReqYmdEnd_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ReqYmdStart.Value !="" && cal_ReqYmdEnd.Value !="" && cal_ReqYmdStart.Value > cal_ReqYmdEnd.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ReqYmdStart.SetFocus();
		cal_ReqYmdStart.value = "";
		cal_ReqYmdEnd.value = "";
		return;
	}	
}
//-------------------------------------------------------------------------------
//		FROM ~ TO 체크 (내역)
//-------------------------------------------------------------------------------
function cal_DigAdmitFrom_OnChanged(obj,strOldText,strNewText)
{
	if(cal_DigAdmitFrom.Value !="" && cal_DigAdmitTo.Value !="" && cal_DigAdmitFrom.Value > cal_DigAdmitTo.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_DigAdmitFrom.SetFocus();
		cal_DigAdmitFrom.value = "";
		cal_DigAdmitTo.value = "";
		return;
	}	
}

function cal_DigAdmitTo_OnChanged(obj,strOldText,strNewText)
{
	if(cal_DigAdmitFrom.Value !="" && cal_DigAdmitTo.Value !="" && cal_DigAdmitFrom.Value > cal_DigAdmitTo.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_DigAdmitFrom.SetFocus();
		cal_DigAdmitFrom.value = "";
		cal_DigAdmitTo.value = "";
		return;
	}	
}

// 지사변경시
function cob_BranchCd01_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 팀
	gfn_D1_SetComboBox_Teamcd01("ds_Team_01",cob_BranchCd01);
	//cob_TeamCd.Index = 0 ;		
}


// 첨부//파라메터 확인 ds_Multi.GetColumn(nRow, "DANGER_NUM")
function btn_FileFolder_OnClick(obj)
{
	if(gfn_IsNull(edt_DangerNum.Text)){
		alert("등록된 위험작업이 없습니다. 데이터를 저장후 파일업로드를 진행바랍니다.");
		return;
	}else{
		var strEnable = "";
	
		// 투자외부 - 위험작업요청전(00) 위험작업요청(01)  검토반려(02) 이전까지 수정된다.
		if( ! (danger_job_sts_flag == "00" || danger_job_sts_flag == "01" || danger_job_sts_flag == "02") )
		{
			strEnable = "Y";	
		}

		var arg = "fa_Url=handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service&DANGER_NUM="+danger_num+"&DANGER_JOB_FLAG=30&WORK_FLAG=10 fa_Part=D10 fa_Enable="+strEnable;
		var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
		edtFileList.text = "";
		for(var i=0; i<arrList.length; i++)
		{
			edtFileList.text += arrList[i];
			if(arrList.length-1 != i) edtFileList.text += "/";
		}	
	}
}

// 첨부 SCG
function btn_FileFolder01_OnClick(obj)
{
	if(gfn_IsNull(edt_DangerNum.Text)){
		alert("등록된 위험작업이 없습니다. 데이터를 저장후 파일업로드를 진행바랍니다.");
		return;
	}else{

		var strEnable = "";
		
		// 투자외부 - 결재승인(05), 작업결과등록(06), 작업결과결재반려(07) 이전까지 수정된다.
		if( ! (danger_job_sts_flag == "05" || danger_job_sts_flag == "06"  || danger_job_sts_flag == "07" ) )
		{
			strEnable = "Y";	
		}
		var arg = "fa_Url=handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service&DANGER_NUM="+danger_num+"&DANGER_JOB_FLAG=30&WORK_FLAG=20 fa_Part=D10 fa_Enable="+strEnable;
		var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
		edtFileList01.text = "";
		for(var i=0; i<arrList.length; i++)
		{
			edtFileList01.text += arrList[i];
			if(arrList.length-1 != i) edtFileList01.text += "/";
		}	
	}	
}

//-------------------------------------------------------------------------------
//	  GIS 위치보기 
//-------------------------------------------------------------------------------
function btn_gis_OnClick(obj)
{
	var args="";

        args  = "BUNGI='01'";
        
        args += " GU_NM="      + quote(ds_Multi_Re.GetColumn(0, "ZIP_NO1_NM")) ;
	    args += " DONG_NM_H="  + quote(ds_Multi_Re.GetColumn(0, "TOWN"      )) ;
	    args += " FNU=" 	   + quote(ds_Multi_Re.GetColumn(0, "ADDR_M"    )) ;
	    args += " SNU=" 	   + quote(ds_Multi_Re.GetColumn(0, "ADDR_S"    )) ;
	 	
	    gfn_Dialog("D10","D1402060011U",args,1208,840,"Scroll",-1,-1);	 	
}

//-------------------------------------------------------------------------------
//	  재질에 따른 관경정보 셋팅 
//-------------------------------------------------------------------------------
function cob_MaterFlag_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{

//trace ("cob_MaterFlag_OnChanged:"+ strCode);

	switch(strCode){
		//10 PLP : D10300
		case "10" : gfn_SetComboBox_Comcode("D10300",gfn_setDsObject_Comcode("cob_PipeDiamCd"));	
					cob_ClsJobMethodCd.Index = 0;
		break;
		//20 PE : D10301
		case "20" : gfn_SetComboBox_Comcode("D10301",gfn_setDsObject_Comcode("cob_PipeDiamCd"));	
					cob_ClsJobMethodCd.Index = 1;
		break;
		//30 ZS : D10302
		case "30" : gfn_SetComboBox_Comcode("D10302",gfn_setDsObject_Comcode("cob_PipeDiamCd"));	
					cob_ClsJobMethodCd.Index = 0;
		break;
		//40 AS : D10303
		case "40" : gfn_SetComboBox_Comcode("D10303",gfn_setDsObject_Comcode("cob_PipeDiamCd"));	
					cob_ClsJobMethodCd.Index = 0;
		break;
		//50 PT : D10304
		case "50" : gfn_SetComboBox_Comcode("D10304",gfn_setDsObject_Comcode("cob_PipeDiamCd"));	
					cob_ClsJobMethodCd.Index = 0;
		break;
	}
}



//----------------------------------------------------------------------------------------
// 건물 허가 번호 가져오기 
//----------------------------------------------------------------------------------------
function Button2_OnClick(obj)
{
	var result  = gfn_Dialog("C30","C3201002013U","",700,500,true,-1,-1);
	if(result == "" || result == null || result == 0){
		return;
	}		
	edt_BldNum.Text = result[0];
	edt_Unpay_Yn.Text = result[14];
	edt_Unpay_Amt.Text = result[15];
	edt_Cont_Yn.Text = result[16];	
}


//----------------------------------------------------------------------------------------
// 건물 허가 번호 가져오기 
//----------------------------------------------------------------------------------------
function Button3_OnClick(obj)
{
	var result  = gfn_Dialog("C30","C3201002013U","",700,500,true,-1,-1);
	if(result == "" || result == null || result == 0){
		return;
	}	
	edt_Bldno.Text = result[0];
	edt_Unpay_Ok.Text = result[14];
	edt_Unpay.Text = result[15];
	edt_Cont.Text = result[16];
}


//-------------------------------------------------------------------------------
//	공통 버튼 클릭 - 인쇄
//-------------------------------------------------------------------------------
function fn_CommonPrint()
{
	PrintScreen(true);
}

// SCG담당자
function btn_ScgCharge_OnClick(obj)
{
	if(gfn_IsNull(cob_BranchCd01.value))
	{
		alert("먼저 지사를 선택하여 주십시오.");
		return;
	}
	
	var args  = "BRANCH_CD=" + quote(cob_BranchCd01.value);
		args += " TEAM_CD="  + quote(cob_TeamCd.value);
		args += " SFALG=Y";			 
					 
	var arrList = gfn_Dialog("D10","D1101020015U",args,700,400,true,-1,-1);
						
	if( length( arrList ) > 0 )
	{	
		// 2013.06.26. 이건민 - 권기철 과장님 요청사항 (등록한 지사와 공사담당자 지사비교 후 틀리게 되면 리턴)
		if(cob_BranchCd01.value == arrList[6])
		{
			edt_Taker_EmpId.Text 	= arrList[0];  // SCG담당자사번
			edt_Taker_EmpNm.Text 	= arrList[1];  // SCG담당자명
			cob_TeamCd.Value    	= arrList[2];  // 팀
		}
		else
		{
			alert("SCG의 지사 담당자가 아닙니다.");
			return;
		}
		
		// 2013.06.26. 이건민 - 권기철 과장님 요청으로 주석처리
		/*
		edt_Taker_EmpId.Text = arrList[0];
		edt_Taker_EmpNm.Text = arrList[1];
		cob_TeamCd.Value    = arrList[2];  // 팀		
		*/
	}
}


// 위험작업 화면으로 이동
function btn_Danger_OnClick(obj)
{
	if( 1 !=1 ){	
		alert("등록된 중폐지 관리번호가 없습니다. 등록먼저 해주세요.");
		return;
	}else{

		var strArg = "";
		
		// 위험작업번호(가정관) 
		if( gfn_IsNull(edt_Ok_Hmpp_Danger_Num.Text) ) 
		{
		 	// 시공사이면
			if( fv_COOP_YN )
			{
				// 가정관에 저장할 외래키
				var strDANGER_STOP_NUM = ds_Multi_Re.GetColumn(0, "DANGER_NUM");
				var strDANGER_STOP_FLAG = ds_Multi_Re.GetColumn(0, "DANGER_JOB_FLAG");
				
				// 신규등록
				strArg += "STOP_FLAG=NEW";
				strArg += " DANGER_STOP_NUM="+quote(strDANGER_STOP_NUM);
				strArg += " DANGER_STOP_FLAG="+quote(strDANGER_STOP_FLAG);
				
				strArg += " BRANCH_CD="+quote(cob_BranchCd01.Value);  // 지사
				strArg += " TEAM_CD="+quote(cob_TeamCd.Value);        // 팀
				
				strArg += " EMPID="+quote(edt_Taker_EmpId.Text);  // SCG담당자사번
				strArg += " EMPNM="+quote(edt_Taker_EmpNm.Text);        // SCG담당자명
								
				strArg += " OLD_MATER_FLAG="+quote(cob_MaterFlag.Value); // 기존재질
				strArg += " OLD_DIAM_CD="+quote(cob_PipeDiamCd.Value);   // 기존관경
				strArg += " OLD_PRESS_FLAG="+quote(cob_PressFlag.Value); // 기존압력
				
				strArg += " JOB_REQ_YMD="+quote(cal_JobReqYmd1.Value);         // 작업요청일자
				strArg += " JOB_REQ_STR_TIME="+quote(edt_JobReqStrTime.Value); // 작업시작시간
				strArg += " JOB_REQ_END_TIME="+quote(edt_JobReqEndTime.Value); // 작업종료시간
				
				strArg += " WORK_FIRM_CD="+quote(edt_WorkFirmCd.Text);    // 시공사코드
				strArg += " WORK_FIRM_CD_NM="+quote(edt_WorkFirmNm.Text); // 시공사명
				
				strArg += " WORK_FIRM_TEL_DDD="+quote(cob_WorkFirmTelDdd.Value); // 시공사전화번호
				strArg += " WORK_FIRM_TEL_EXN="+quote(work_firm_tel_exn.Text);   // 시공사전화번호
				strArg += " WORK_FIRM_TEL_NUM="+quote(work_firm_tel_num.Text);   // 시공사전화번호
				
				strArg += " ZIP_NO1="      +quote( ds_Multi_Re.GetColumn(0, "ZIP_NO1"      ) ); // 우편번호1   
				strArg += " ZIP_NO2="      +quote( ds_Multi_Re.GetColumn(0, "ZIP_NO2"      ) ); // 우편번호2   
				strArg += " ZIP_SEQ="      +quote( ds_Multi_Re.GetColumn(0, "ZIP_SEQ"      ) ); // 우편일련번호
				strArg += " HILL="         +quote( ds_Multi_Re.GetColumn(0, "HILL"         ) ); // 산번지      
				strArg += " ADDR_M="       +quote( ds_Multi_Re.GetColumn(0, "ADDR_M"       ) ); // 본번        
				strArg += " ADDR_S="       +quote( ds_Multi_Re.GetColumn(0, "ADDR_S"       ) ); // 부번        
				strArg += " BLD_DONG="     +quote( ds_Multi_Re.GetColumn(0, "BLD_DONG"     ) ); // 건물동      
				strArg += " HOSU="         +quote( ds_Multi_Re.GetColumn(0, "HOSU"         ) ); // 호수        
				strArg += " SECOND_ADDR="  +quote( ds_Multi_Re.GetColumn(0, "SECOND_ADDR"  ) ); // 보조주소    
				strArg += " LOT_NUM_UNION="+quote( ds_Multi_Re.GetColumn(0, "LOT_NUM_UNION") ); // 지번주소조합				
				
				
				gfn_NewWindowAndExistClose("D10","D1501010011F",strArg);
			}
		}
		else
		{	
			// 조회할 KEY
			var strDANGER_STOP_NUM = ds_Multi_Re.GetColumn(0, "OK_HMPP_DANGER_NUM");
			var strDANGER_STOP_FLAG = "20";

			// 기존화면조회
			strArg += "STOP_FLAG=STOP";
			strArg += " DANGER_STOP_NUM="+quote(strDANGER_STOP_NUM);
			strArg += " DANGER_STOP_FLAG="+quote(strDANGER_STOP_FLAG);
			
			strArg += " BRANCH_CD="+quote(cob_BranchCd01.Value); // 지사
			strArg += " TEAM_CD="+quote(cob_TeamCd.Value);       // 팀
			
			gfn_NewWindowAndExistClose("D10","D1501010011F",strArg);				
		}
	
	}	
}


// 작업요청시간 변경시
function ds_Multi_Re_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'JOB_REQ_STR_TIME')
	{
		
		if(edt_JobReqStrTime.Value == '' || edt_JobReqStrTime.Value == null)
		{ 
			return;
		}
						
		if(substr(edt_JobReqStrTime.Value,0,2) > "24"){
			alert("25시 이상 입력할 수 없습니다. ");
			edt_JobReqStrTime.Value = '';
			edt_JobReqStrTime.SetFocus();
			return;
		}
		if(substr(edt_JobReqStrTime.Value,2,2) > "59"){
			alert("60분 이상 입력할 수 없습니다. ");
			edt_JobReqStrTime.Value = '';
			edt_JobReqStrTime.SetFocus();
			return;
		}		
	}	
	
	if(strColumnID == 'JOB_REQ_END_TIME')
	{
				
		if(edt_JobReqEndTime.Value == '' || edt_JobReqEndTime.Value == null)
		{
			return;
		}
		
		if(substr(edt_JobReqEndTime.Value,0,2) > "24"){
			alert("25시 이상 입력할 수 없습니다. ");
			edt_JobReqEndTime.Value = '';
			edt_JobReqEndTime.SetFocus();
			return;
		}
		if(substr(edt_JobReqEndTime.Value,2,2) > "59"){
			alert("60분 이상 입력할 수 없습니다. ");
			edt_JobReqEndTime.Value = '';
			edt_JobReqEndTime.SetFocus();
			return;
		}
	}
}



function Button0_OnClick(obj)
{

	// ##############################################
	// 정비보수 화면 연계
	// ##############################################
	
	var objDsName = gfn_D10_setDsObject_D1601010010F();
	
	eval(objDsName).SetColumn(0,"OPEN_FLAG"         ,"D1301020010F"); // 01. 구분 (지정된 화면)  
	eval(objDsName).SetColumn(0,"MAINTER_NUM"       ,"2"); // 02. 정비보수번호        
	eval(objDsName).SetColumn(0,"BRANCH_CD"         ,"3"); // 03. 지사코드            
	eval(objDsName).SetColumn(0,"ZIP_NO1"           ,"4"); // 04. 시/구코드           
	eval(objDsName).SetColumn(0,"TEAM_CD"           ,"5"); // 05. 팀코드              
	eval(objDsName).SetColumn(0,"WORK_FIRM_CD"      ,"6"); // 06. 시공사코드          
	eval(objDsName).SetColumn(0,"FACI_NUM"          ,"7"); // 07. 시설물코드          
	eval(objDsName).SetColumn(0,"FACI_NM"           ,"8"); // 08. 시설물명            
	eval(objDsName).SetColumn(0,"ZIP_SEQ"           ,"9"); // 09. 우편일련번호        
	eval(objDsName).SetColumn(0,"ZIP_NO1"           ,"10"); // 10. 우편번호1           
	eval(objDsName).SetColumn(0,"ZIP_NO2"           ,"11"); // 11. 우편번호2           
	eval(objDsName).SetColumn(0,"HILL"              ,"12"); // 12. 산번지              
	eval(objDsName).SetColumn(0,"ADDR_M"            ,"13"); // 13. 본번                
	eval(objDsName).SetColumn(0,"ADDR_S"            ,"14"); // 14. 부번                
	eval(objDsName).SetColumn(0,"SECOND_ADDR"       ,"15"); // 15. 보조주소            
	eval(objDsName).SetColumn(0,"BLD_DONG"          ,"16"); // 16. 건물동              
	eval(objDsName).SetColumn(0,"HOSU"              ,"17"); // 17. 호수                
	eval(objDsName).SetColumn(0,"LOT_NUM_UNION"     ,"18"); // 18. 지번주소조합        
	eval(objDsName).SetColumn(0,"PAVEMENT_KIND"     ,"19"); // 19. 포장종류코드        
	eval(objDsName).SetColumn(0,"WORK_REQ_EMPID"    ,"20"); // 20. 의뢰자ID            
	eval(objDsName).SetColumn(0,"WORK_REQ_EMPID_NM" ,"21"); // 21. 의뢰자명            
	eval(objDsName).SetColumn(0,"KEY1"              ,"22"); // 22. PK1                 
	eval(objDsName).SetColumn(0,"KEY2"              ,"23"); // 23. PK2                 
	eval(objDsName).SetColumn(0,"KEY3"              ,"24"); // 24. PK3                 
	eval(objDsName).SetColumn(0,"KEY4"              ,"25"); // 25. PK4                 
	eval(objDsName).SetColumn(0,"KEY5"              ,"25"); // 26. PK5	

	// 화면 OPEN
	gfn_Form_D1601010010F( objDsName );
}

function grd_DangerJob_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_SetGridSort(obj, nCell);
}


function Btn_cancel_OnClick(obj)
{
	if( fv_COOP_YN )
 	{
		alert("시공사는 취소처리가 불가합니다.");
		return;
	}
	if(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '10')
	{
		alert("작업 완료건은 취소불가합니다.");
		return;
	}
	else if(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '90')
	{
		alert("이미 취소 처리 되었습니다.");
		return;
	// 2012.04.30 권기철 과장님 추가요청_이건민
	// 중폐지 진행상태 작업결과등록 상태이면 입회결과등록 결재진행상태 로직 체크
	}else if(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '06'){
		if(ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '0' || ds_Multi_Re.GetColumn(ds_Multi_Re.row, "DECIDE_PROC_STS") == '2')
		{
			alert("입회결과등록의 결과진행상태가 완료 또는 진행중이므로 취소 불가능합니다.");
			return;
		}
	}
		
		
	if (ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG") == '02')
	{
		if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == null || ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '')
		{
				alert("해당 중폐지 위험작업은 삭제처리가 가능합니다.");
				return;		
		}
		else 
		{
			if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '00' || ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '02')
			{
				alert("해당 중폐지 위험작업 및 가정관 위험작업은 삭제처리가 가능합니다.");
				return;
			}
			else if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '10')
			{
				alert("해당 가정관 위험작업이 작업완료되어 취소 처리가 불 가능합니다.");
				return;
			}
			// 2012.04.24. 권기철 과장님 추가요청_이건민
			else if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '90')
			{
				alert("해당 가정관 위험작업이 이미 취소 처리가 되었습니다.");
				return;
			}
		}						
	}	
	else if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != null && ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != '')
	{
		if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '10')
		{
			alert("해당 중폐지 위험작업은 가정관 위험작업이 완료되어 취소처리가 불 가능합니다.");
			return;
		}
		else if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") == '90')
		{
			alert("해당 중폐지 위험작업은 가정관 위험작업이 이미 취소 처리가 되어  취소처리가 불 가능합니다.");
			return;
		}
	}
		
	if (gfn_GetGlobalValue("G_DEPT_CODE") == ds_Multi.GetColumn(ds_Multi.row,"TEAM_CD") || gfn_GetGlobalValue("G_USER_NO") == '199443297' || gfn_GetGlobalValue("G_USER_NO") == '700004008') 
	{
		if (edt_cancel_rmk.text == '')
		{
			alert("취소사유를 입력 하세요");
			return;
		} 
		
		if(confirm("가정관이 있는 경우 해당 가정관작업도 함께 취소처리 됩니다.\n취소처리 하시겠습니까?"))
		{
			fn_D1_Cancel();
		}	
		else
		{
			return;
		}
	}
	else
	{
		alert("취소는 해당 팀원만 가능합니다.");
		return;
	}		
}

//----------------------------------------------------------------------------------------------
// 함수명: fn_D1_Cancel()
// 설명:   중폐지 위험작업 취소
// arguments
// return 내용: 없음
//----------------------------------------------------------------------------------------------
function fn_D1_Cancel()
{    
	ds_Cancel.ClearData();
	ds_Cancel.UpdateControl = false ;
	var row = ds_Cancel.AddRow();
	ds_Cancel.SetRowType(row, "update");
    ds_Cancel.SetColumn(row,"DANGER_NUM"  , ds_Multi.GetColumn(ds_Multi.row , "DANGER_NUM"));  // 중폐지 위험작업번호
    ds_Cancel.SetColumn(row,"DANGER_JOB_FLAG"  , '30');  // 중폐지 위험작업구분
    ds_Cancel.SetColumn(row,"OK_HMPP_DANGER_NUM"  , ds_Multi.GetColumn(ds_Multi.row , "OK_HMPP_DANGER_NUM"));  // 가정관 위험작업번호
    ds_Cancel.SetColumn(row,"OK_HMPP_JOB_FLAG"  , '20');  // 가정관 위험작업구분
	ds_Cancel.SetColumn(row,"UPD_EMPID" , gfn_GetGlobalValue("G_USER_NO"));  // UPD_EMPID
	ds_Cancel.SetColumn(row,"UPD_IP"    , gfn_GetLocalIpAddress());  // UPD_IP
	ds_Cancel.SetColumn(row,"CANCEL_RMK"   , edt_cancel_rmk.Text);  // 취소사유
	ds_Cancel.SetColumn(row,"CANCEL_EMPID" , gfn_GetGlobalValue("G_USER_NO"));  // 취소자사번

	var strSvcID = "cancel";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiCutDiusMgr-service";  
	var strInDatasets  = "ds_Cancel=ds_Cancel:u";
	var strOutDatasets  = "";
	var strArgument  = "cancel=1";	
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 취소"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 취소")); 
		ds_Multi.SetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG" , '90');
		if(ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != null && ds_Multi.GetColumn(ds_Multi.row, "OK_HMPP_DANGER_JOB_STS_FLAG") != '')
		{
			ds_Multi.SetColumn(ds_Multi.row,"OK_HMPP_DANGER_JOB_STS_FLAG" , '90');
			ds_Multi.SetColumn(ds_Multi.row,"OK_HMPP_DANGER_JOB_STS_FLAG_NM" , '공사취소');
		}	
	}				  
}

function ds_Multi_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	if(nReason == 5)
	{
		ds_Multi_OnRowPosChanged();
	}
}

function btn_job_chg_OnClick(obj)
{	
	if (gfn_GetGlobalValue("G_DEPT_CODE") == ds_Multi.GetColumn(ds_Multi.row,"TEAM_CD") || gfn_GetGlobalValue("G_USER_NO") == '199443297') 
	{	
	}	
	else
	{
		alert("작업결과 수정은 " + cob_TeamCd.Text + "팀원만 가능합니다.");
		return;
	}
	
	var chk01 = fn_D10_Validation01();
	if(chk01 == "1")
	{
		return;
	}	
	
	ds_Multi_Re.SetColumn(0,"DANGER_JOB_STS_FLAG","01"); //작업내용 수정시 상태는 요청전으로 

	fn_D10_Save();	
}

function btn_CardUserEmpNm_OnClick(obj)
{
	var args  = "BRANCH_CD=" + quote(cob_BranchCd01.value);
		args += " TEAM_CD="  + quote(cob_TeamCd.value);
		args += " SFALG=Y";			 
					 
	var arrList = gfn_Dialog("D10","D1101020015U",args,700,400,true,-1,-1);
						
	if( length( arrList ) > 0 )
	{
		edt_JoinEmpid.Text = arrList[0];
		edt_JoinNm.Text = arrList[1];
	}
}
]]></Script>
</Window>