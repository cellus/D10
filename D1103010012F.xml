<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="577" Id="D1103010012F" Left="8" OnLoadCompleted="D1103020011F_OnLoadCompleted" PidAttrib="7" Title="안전관리&#32;투자비&#32;실적조회_D1103010012F" Top="8" Ver="1.0" Width="1005" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_InvRst" OnColumnChanged="ds_InvPln_OnColumnChanged">
				<Contents>
					<colinfo id="SAFE_MANAGE_OBJ_YN" size="256" type="STRING"/>
					<colinfo id="DETA_DESC_TITACNT_ITEM_CD" size="256" type="STRING"/>
					<colinfo id="RMK" size="256" type="STRING"/>
					<colinfo id="RELAT_DEPT_CD" size="256" type="STRING"/>
					<colinfo id="BASIC_1" size="256" type="STRING"/>
					<colinfo id="ADJUST_1" size="256" type="STRING"/>
					<colinfo id="COM_1" size="256" type="STRING"/>
					<colinfo id="BASIC_2" size="256" type="STRING"/>
					<colinfo id="ADJUST_2" size="256" type="STRING"/>
					<colinfo id="COM_2" size="256" type="STRING"/>
					<colinfo id="BASIC_3" size="256" type="STRING"/>
					<colinfo id="ADJUST_3" size="256" type="STRING"/>
					<colinfo id="COM_3" size="256" type="STRING"/>
					<colinfo id="BASIC_QUATER_TOT" size="256" type="STRING"/>
					<colinfo id="ADJUST_QUATER_TOT" size="256" type="STRING"/>
					<colinfo id="COM_QUATER" size="256" type="STRING"/>
					<colinfo id="BASIC_TOT" size="256" type="STRING"/>
					<colinfo id="ADJUST_TOT" size="256" type="STRING"/>
					<colinfo id="COM_TOT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape1" Left="5" LineColor="user7" Right="1000" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="9" Top="30" Type="RoundRect" Width="995"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape2" Left="10" LineWidth="0" Right="995" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="10" Top="35" Type="Rectangle" Width="985"></Shape>
		<Image Align="Left" Height="6" Id="Image7" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search_Indis" TabOrder="6" Text="항목" Top="46" Width="84"></Image>
		<Image Align="Left" Height="6" Id="Image3" ImageID="blt" Left="309" LeftMargin="12" Style="blt_search" TabOrder="7" Text="대상" Top="46" Width="95"></Image>
		<Combo Border="Flat" Height="18" Id="cob_SafeManageObjYn" Left="349" Style="combo" TabOrder="3" Top="39" Width="140"></Combo>
		<Image Align="Left" Height="6" Id="Image10" ImageID="blt" Left="499" LeftMargin="12" Style="blt_search" TabOrder="8" Text="세부내용" Top="46" Width="84"></Image>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="11" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="995">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" Height="18" Id="cob_SafeManageItem" Left="56" Style="combo_indis" TabOrder="1" Top="39" Width="140"></Combo>
		<Combo Border="Flat" Height="18" Id="cob_DetaDescTitacntItemCd" Left="563" Style="combo" TabOrder="4" Top="39" Width="140"></Combo>
		<Shape BKColor="#6cbae1" Bottom="93" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1000" TabOrder="13" Top="90" Type="Rectangle" Width="995"></Shape>
		<Grid AutoEnter="TRUE" BindDataset="ds_InvRst" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="579" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="483" Id="grd_InvRst" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" Right="1003" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="12" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="995">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="100"/>
						<col fix="left" width="100"/>
						<col fix="left" width="100"/>
						<col fix="left" width="100"/>
						<col width="90"/>
						<col width="90"/>
						<col width="94"/>
						<col width="90"/>
						<col width="90"/>
						<col width="93"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
						<col width="90"/>
					</columns>
					<head>
						<cell bkcolor="user11" col="0" display="normal" rowspan="2" text="대상"/>
						<cell bkcolor="user11" col="1" display="text" rowspan="2" text="세부내용"/>
						<cell col="2" display="text" rowspan="2" text="관련부서"/>
						<cell col="3" display="text" rowspan="2" text="적요"/>
						<cell col="4" colspan="3" display="text" text="1월"/>
						<cell col="7" colspan="3" display="text" text="2월"/>
						<cell col="16" colspan="3" display="text" text="총계"/>
						<cell col="4" display="text" row="1" text="계획"/>
						<cell col="5" display="text" row="1" text="실적"/>
						<cell col="6" display="text" row="1" text="대비"/>
						<cell col="7" display="text" row="1" text="계획"/>
						<cell col="8" display="text" row="1" text="실적"/>
						<cell col="9" display="text" row="1" text="대비"/>
						<cell col="10" colspan="3" display="text" text="3월"/>
						<cell col="10" display="text" row="1" text="계획"/>
						<cell col="11" display="text" row="1" text="실적"/>
						<cell col="12" display="text" row="1" text="대비"/>
						<cell col="13" colspan="3" display="text" text="1분기"/>
						<cell col="13" display="text" row="1" text="계획"/>
						<cell col="14" display="text" row="1" text="실적"/>
						<cell col="15" display="text" row="1" text="대비"/>
						<cell col="16" display="text" row="1" text="계획"/>
						<cell col="17" display="text" row="1" text="실적"/>
						<cell col="18" display="text" row="1" text="대비"/>
					</head>
					<body>
						<cell col="0" colid="SAFE_MANAGE_OBJ_YN" display="normal" expandsize="18" wordwrap="word"/>
						<cell col="1" colid="DETA_DESC_TITACNT_ITEM_CD" display="text" expandsize="18" wordwrap="word"/>
						<cell col="2" colid="RELAT_DEPT_CD" display="text" expandsize="18" wordwrap="word"/>
						<cell col="3" colid="RMK" display="text" expandsize="18" wordwrap="word"/>
						<cell col="4" colid="BASIC_1" display="text" expandsize="18" wordwrap="word"/>
						<cell col="5" colid="ADJUST_1" display="text" expandsize="18" wordwrap="word"/>
						<cell col="6" colid="COM_1" display="text" expandsize="18" wordwrap="word"/>
						<cell col="7" colid="BASIC_2" display="text" expandsize="18" wordwrap="word"/>
						<cell col="8" colid="ADJUST_2" display="text" expandsize="18" wordwrap="word"/>
						<cell col="9" colid="COM_2" display="text" expandsize="18" wordwrap="word"/>
						<cell col="10" colid="BASIC_3" display="text" expandsize="18" wordwrap="word"/>
						<cell col="11" colid="ADJUST_3" display="text" expandsize="18" wordwrap="word"/>
						<cell col="12" colid="COM_3" display="text" expandsize="18" wordwrap="word"/>
						<cell col="13" colid="BASIC_QUATER_TOT" display="text" expandsize="18" wordwrap="word"/>
						<cell col="14" colid="ADJUST_QUATER_TOT" display="text" expandsize="18" wordwrap="word"/>
						<cell col="15" colid="COM_QUATER" display="text" expandsize="18" wordwrap="word"/>
						<cell col="16" colid="BASIC_TOT" display="text" expandsize="18" wordwrap="word"/>
						<cell col="17" colid="ADJUST_TOT" display="text" expandsize="18" wordwrap="word"/>
						<cell col="18" colid="COM_TOT" display="text" expandsize="18" wordwrap="word"/>
					</body>
					<summary>
						<cell align="center" bkcolor="user13" col="0" colspan="4" display="text" text="총계"/>
						<cell align="center" bkcolor="user13" col="4" display="text" expr='SumNF(&quot;BASIC_1&quot;)'/>
						<cell align="center" bkcolor="user13" col="5" display="text" expr='SumNF(&quot;ADJUST_1&quot;)'/>
						<cell align="center" bkcolor="user13" col="6" display="text" expr='SumNF(&quot;COM_1&quot;)&#32;+&#32;&apos;&#32;%&apos;'/>
						<cell align="center" bkcolor="user13" col="7" display="text" expr='SumNF(&quot;BASIC_2&quot;)'/>
						<cell align="center" bkcolor="user13" col="8" display="text" expr='SumNF(&quot;ADJUST_2&quot;)'/>
						<cell align="center" bkcolor="user13" col="9" display="text" expr='SumNF(&quot;COM_2&quot;)&#32;+&#32;&apos;&#32;%&apos;'/>
						<cell align="center" bkcolor="user13" col="10" display="text" expr='SumNF(&quot;BASIC_3&quot;)'/>
						<cell align="center" bkcolor="user13" col="11" display="text" expr='SumNF(&quot;ADJUST_3&quot;)'/>
						<cell align="center" bkcolor="user13" col="12" display="text" expr='SumNF(&quot;COM_3&quot;)&#32;+&#32;&apos;&#32;%&apos;'/>
						<cell align="center" bkcolor="user13" col="13" display="text" expr='SumNF(&quot;BASIC_QUATER_TOT&quot;)'/>
						<cell align="center" bkcolor="user13" col="14" display="text" expr='SumNF(&quot;ADJUST_QUATER_TOT&quot;)'/>
						<cell align="center" bkcolor="user13" col="15" display="text" expr='SumNF(&quot;COM_QUATER&quot;)&#32;+&#32;&apos;&#32;%&apos;'/>
						<cell align="center" bkcolor="user13" col="16" display="text" expr='SumNF(&quot;BASIC_TOT&quot;)'/>
						<cell align="center" bkcolor="user13" col="17" display="text" expr='SumNF(&quot;ADJUST_TOT&quot;)'/>
						<cell align="center" bkcolor="user13" col="18" display="text" expr='SumNF(&quot;COM_TOT&quot;)&#32;+&#32;&apos;&#32;%&apos;'/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="10" Id="Image0" ImageID="blt_8" Left="5" LeftMargin="12" Style="text_title" TabOrder="14" Text="안전관리를&#32;위한&#32;R&amp;D&#32;투자비" Top="75" Width="210"></Image>
		<Image Align="Left" Height="6" Id="Image1" ImageID="blt" Left="712" LeftMargin="12" Style="blt_search" TabOrder="15" Text="분기" Top="46" Width="84"></Image>
		<Combo Border="Flat" Height="18" Id="cob_Quater" Left="750" Style="combo" TabOrder="5" Top="39" Width="80"></Combo>
		<Image Align="Left" Height="6" Id="Image2" ImageID="blt" Left="206" LeftMargin="12" Style="blt_search_Indis" TabOrder="16" Text="년도" Top="47" Width="84"></Image>
		<Spin Border="Flat" Height="18" Id="sp_Year" Left="246" Style="spin_indis" TabOrder="2" Text="2008" Top="40" Width="54"></Spin>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1103010012F.xml
* Form 설명  : 안전투자비 계획등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 김태화 
* 작성일     : 2009-01-13
* 변경내용   : 
****************************************************************************************************/

#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";

function D1103020011F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	
	//-----------------------------------------
	//  콤보박스의 내용을 셋팅한다.
	//-----------------------------------------
	gfn_SetComboBox_Comcode("D10005",gfn_setDsObject_Comcode("cob_SafeManageItem"));  //항목
	gfn_SetComboBox_Comcode("D10034",gfn_setDsObject_Comcode("cob_SafeManageObjYn")); //대상
	gfn_SetComboBox_Comcode("D10095",gfn_setDsObject_Comcode("cob_DetaDescTitacntItemCd")); //세부내용
	gfn_SetComboBox_Comcode("E50059",gfn_setDsObject_Comcode("cob_Quater")); //분기
	
	cob_SafeManageItem.Index = 0;
	cob_Quater.Index = 0;
}

//------------------------------------------------------------------------------- 
// 함수명: fn_CommonSearch()
//   설명: 안전투자비 계획등록 조회
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_CommonSearch()
{
	f1_D1_SetComboInit();
	fn_D1_InvRst();
}

function fn_D1_InvRst()
{
	var strSvcID = "fn_D1_InvRst";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_SafetyMangeCostResltSearMgr-service&INSPECT_YEAR="+sp_Year.Value+"&SAFE_MANAGE_ITEM="+cob_SafeManageItem.Value+"&SAFE_MANAGE_OBJ_YN="+cob_SafeManageObjYn.Value+"&DETA_DESC_TITACNT_ITEM_CD="+cob_DetaDescTitacntItemCd.Value;
	var strInDatasets  = "";
	var strOutDatasets  = "ds_InvRst=ds_InvRst";
	var strArgument  = "";
	
	if(cob_Quater.Value == "1")
	{
		strArgument = "findInvRst1";
	}else if(cob_Quater.Value == "2")
	{
		strArgument = "findInvRst2";
	}else if(cob_Quater.Value == "3")
	{
		strArgument = "findInvRst3";
	}else if(cob_Quater.Value == "4")
	{
		strArgument = "findInvRst4";
	}
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}
	
}

//------------------------------------------------------------------------------- 
// 함수명: f1_D1_SetComboInit()
//   설명: 안전투자비 계획등록 그리드 관련 콤보박스 초기화
// arguments   
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function f1_D1_SetComboInit()
{
	gfn_SetGrdComboBox_Comcode("grd_InvRst",0,"D10034"); //대상
	gfn_SetGrdComboBox_Comcode("grd_InvRst",1,"D10095"); //세부내용
	gfn_SetGrdComboBox_Comcode("grd_InvRst",2,"A10414"); //관련부서
	grd_InvRst.SetCellProp("body",0,"Edit","none");
	grd_InvRst.SetCellProp("body",1,"Edit","none");
	
	var strFirst = "";
	var strSecond = "";
	var strThird = "";
	var strQuaterTot = "";

	if(cob_Quater.Value == "1")
	{
		strFirst = "1월";
		strSecond = "2월";
		strThird = "3월";
		strQuaterTot = "1분기";
	}else if(cob_Quater.Value == "2")
	{
		strFirst = "4월";
		strSecond = "5월";
		strThird = "6월";
		strQuaterTot = "2분기";
	}else if(cob_Quater.Value == "3")
	{
		strFirst = "7월";
		strSecond = "8월";
		strThird = "9월";
		strQuaterTot = "3분기";
	}else if(cob_Quater.Value == "4")
	{
		strFirst = "10월";
		strSecond = "11월";
		strThird = "12월";
		strQuaterTot = "4분기";
	}
	grd_InvRst.SetCellProp("head",4,"Text",strFirst); //첫번째
	grd_InvRst.SetCellProp("head",5,"Text",strSecond); //두번째
	grd_InvRst.SetCellProp("head",13,"Text",strThird); //세번째
	grd_InvRst.SetCellProp("head",17,"Text",strQuaterTot);  //분기	
}]]></Script>
</Window>