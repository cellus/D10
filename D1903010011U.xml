<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="640" Id="D1903010011U" Left="8" OnLoadCompleted="D1903010011U_OnLoadCompleted" PidAttrib="7" Title="%IR_D1903010011U" Top="8" Ver="1.0" Width="545" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Editable="True" Id="ds_IR_MGR">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_RSLT_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="IR_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="IR_LEFT" size="256" summ="default" type="INT"/>
					<colinfo id="IR_RIGHT" size="256" summ="default" type="INT"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ExcelData">
				<Contents>
					<colinfo id="EXCOL0" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL1" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL2" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL3" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL4" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL5" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCOL6" size="255" summ="default" type="STRING"/>
					<record>
						<EXCOL0></EXCOL0>
						<EXCOL1></EXCOL1>
						<EXCOL2></EXCOL2>
						<EXCOL3></EXCOL3>
						<EXCOL4></EXCOL4>
						<EXCOL5></EXCOL5>
						<EXCOL6></EXCOL6>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ECDA_RST">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_RSLT_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_GR_CONN" size="256" summ="default" type="STRING"/>
					<colinfo id="ANODE_POINT" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_ISOLATION" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLTAGE" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLTAIC" size="256" summ="default" type="STRING"/>
					<colinfo id="VOLTAIC_MACHINE" size="256" summ="default" type="STRING"/>
					<colinfo id="DAMAGE_ADDR_POTENTIAL" size="256" summ="default" type="INT"/>
					<colinfo id="PIPE_END_ON" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_END_OFF" size="256" summ="default" type="STRING"/>
					<colinfo id="POTENTIAL" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Search">
				<Contents>
					<colinfo id="BASE_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPLOR_RSLT_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="IR_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ExcelSAMPLE">
				<Contents>
					<colinfo id="IR_LEFT" size="255" summ="default" type="STRING"/>
					<colinfo id="IR_RIGHT" size="255" summ="default" type="STRING"/>
					<record>
						<IR_LEFT>10.5</IR_LEFT>
						<IR_RIGHT>20.5</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>30</IR_LEFT>
						<IR_RIGHT>40</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>36.9</IR_LEFT>
						<IR_RIGHT>100</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>200</IR_LEFT>
						<IR_RIGHT>500</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>30.5</IR_LEFT>
						<IR_RIGHT>50.5</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>10</IR_LEFT>
						<IR_RIGHT>100.2</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>20</IR_LEFT>
						<IR_RIGHT>200.5</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>30</IR_LEFT>
						<IR_RIGHT>200.5</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>40</IR_LEFT>
						<IR_RIGHT>300</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>50</IR_LEFT>
						<IR_RIGHT>400</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>60</IR_LEFT>
						<IR_RIGHT>500</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>40</IR_LEFT>
						<IR_RIGHT>20</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>80</IR_LEFT>
						<IR_RIGHT>30</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>150</IR_LEFT>
						<IR_RIGHT>50</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>100</IR_LEFT>
						<IR_RIGHT>80</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>200</IR_LEFT>
						<IR_RIGHT>110</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>300</IR_LEFT>
						<IR_RIGHT>210</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>400</IR_LEFT>
						<IR_RIGHT>330</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>500</IR_LEFT>
						<IR_RIGHT>430</IR_RIGHT>
					</record>
					<record>
						<IR_LEFT>600</IR_LEFT>
						<IR_RIGHT>20</IR_RIGHT>
					</record>
				</Contents>
			</Dataset>
		</Datasets>
		<Div DisableBKColor="white" Height="29" Id="Div0" Left="2" OnLoadCompleted="ComButton_OnLoadCompleted" OnTimer="ComButton_OnTimer" TabOrder="3" Text="Div0" Top="39" Url="globals::ComButton.xml" Visible="FALSE" Width="536">
			<Contents></Contents>
		</Div>
		<Image Align="Left" Height="39" Id="Image0" ImageID="popup_top" LeftMargin="33" Style="popup_title" TabOrder="2" Text="%IR" Transparent="TRUE" Width="545"></Image>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_IR_MGR" BkColor2="user19" BoldHead="FALSE" Border="Flat" Bottom="630" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Font="돋움,9" HeadBorder="Flat" HeadHeight="20" Height="478" Id="grd_IR" InputPanel="true" Left="7" LineColor="default" LineType="ExVERT" MinWidth="100" OnHeadClick="grd_List_OnHeadClick" Right="537" SelColor="MENU" Style="grid_pop" TabOrder="1" TabStop="true" Top="152" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="530">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="160"/>
						<col width="160"/>
					</columns>
					<head>
						<cell col="0" display="text" text="구분"/>
						<cell bkcolor="user11" col="1" display="text" text="LEFT"/>
						<cell bkcolor="user11" col="2" display="text" text="RIGHT"/>
					</head>
					<body>
						<cell col="0" colid="DEAL_NM" display="number" expandsize="18" expr="currow+1" wordwrap="word"/>
						<cell col="1" colid="IR_LEFT" display="number" edit="regexpr" expandsize="18" limit="4" LimitDec="1" Mask="#,##0.0" RegExprFilter="[0-9.]" wordwrap="word"/>
						<cell col="2" colid="IR_RIGHT" display="number" edit="regexpr" expandsize="18" limit="4" LimitDec="1" Mask="#,##0.0" RegExprFilter="[0-9.]" wordwrap="word"/>
					</body>
					<summary>
						<cell bkcolor="user14" col="0" display="text" text="계"/>
						<cell bkcolor="user14" col="1" display="number" expr="sum(&apos;IR_LEFT&apos;)"/>
						<cell bkcolor="user14" col="2" display="number" expr="sum(&apos;IR_RIGHT&apos;)"/>
						<cell bkcolor="user15" col="0" display="text" row="1" text="%IR"/>
						<cell bkcolor="user15" col="1" display="number" expr="Round(&#32;sum(&apos;IR_LEFT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)" row="1"/>
						<cell bkcolor="user15" col="2" display="number" expr="Round(&#32;sum(&apos;IR_RIGHT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)" row="1"/>
						<cell col="0" display="text" row="2" text="%IR"/>
						<cell col="1" colspan="2" display="number" expr="iif(&#32;Round(&#32;sum(&apos;IR_LEFT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)&#32;&gt;&#32;Round(&#32;sum(&apos;IR_RIGHT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)&#32;,&#32;Round(&#32;sum(&apos;IR_LEFT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)&#32;,&#32;Round(&#32;sum(&apos;IR_RIGHT&apos;)&#32;/&#32;ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)&#32;*&#32;100&#32;,&#32;1&#32;)&#32;)" row="2"/>
						<cell col="0" display="text" row="3" text="손상부전위차"/>
						<cell col="1" colspan="2" combocol="DAMAGE_ADDR_POTENTIAL" combodataset="ds_ECDA_RST" combotext="DAMAGE_ADDR_POTENTIAL" display="number" expr="ds_ECDA_RST.GetColumn(&#32;0&#32;,&#32;&apos;DAMAGE_ADDR_POTENTIAL&apos;&#32;)" row="3"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user16" Bottom="153" Height="3" Id="Shape0" Left="7" LineWidth="0" Right="537" TabOrder="4" Top="150" Type="Rectangle" Width="530"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_ExcelUproad" ImageID="btn_6_excelup" Left="431" LeftMargin="21" OnClick="btn_ExcelUproad_OnClick" Style="button" TabOrder="5" Text="EXCEL&#32;업로드" Top="124" Width="106"></Button>
		<Edit Height="21" Id="edit_DAP" Left="143" TabOrder="6" Top="122" Visible="FALSE" Width="116"></Edit>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_ExcelSAMPLE" BkColor2="user19" BoldHead="FALSE" Border="Flat" Bottom="470" ColSelect="TRUE" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" Font="돋움,9" HeadBorder="Flat" HeadHeight="20" Height="264" Id="Grid_XLS_SAMPLE" InputPanel="true" Left="232" LineColor="default" LineType="ExVERT" MinWidth="100" OnHeadClick="grd_List_OnHeadClick" Right="523" SelColor="MENU" Style="grid_pop" TabOrder="7" TabStop="true" Top="206" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="291">
			<contents>
				<format id="Default">
					<columns>
						<col width="130"/>
						<col width="130"/>
					</columns>
					<head>
						<cell col="0" display="text" text="IR_LEFT"/>
						<cell col="1" display="text" text="IR_RIGHT"/>
					</head>
					<body>
						<cell col="0" colid="IR_LEFT" display="number" expandsize="18" Mask="#,###.0" wordwrap="word"/>
						<cell col="1" colid="IR_RIGHT" display="number" edit="number" expandsize="18" Mask="#,###.0" wordwrap="word"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_ExcelSample" ImageID="btn_6_excel" Left="323" LeftMargin="21" OnClick="btn_ExcelSample_OnClick" Style="button" TabOrder="8" Text="EXCEL&#32;샘플" Top="125" Width="106"></Button>
		<Shape BKColor="user6" Bottom="116" Height="39" Id="Shape3" Left="7" LineColor="user7" Right="537" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="10" Top="77" Type="RoundRect" Width="530"></Shape>
		<Shape BKColor="user8" Bottom="112" Height="29" Id="Shape4" Left="13" LineWidth="0" Right="533" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="9" Top="83" Type="Rectangle" Width="520"></Shape>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="24" LeftMargin="12" Style="table_1" TabOrder="11" Text="%IR" Top="88" Transparent="TRUE" Width="92"></Image>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1903010011U.xml
* Form 설명  : 배관진단실적등록
* 시스템 명  : 안전공급 (D1)
* 작성자     : kimkk 
* 작성일     : 2013-04-09
* 변경내용   : 
****************************************************************************************************/
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMONB10001.js"; 
#include "JS::COMMONB30001.js"; 
#include "JS::COMMOND10001.js";

/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var fa_base_year       ;
var fa_mpipe_id        ;
var fa_explor_rslt_seq ;

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/

//--------------------------------------------------------------------------------------------------
//	OnLoadCompleted
//--------------------------------------------------------------------------------------------------
function D1903010011U_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj); 
	
	fn_init( );
	
	gfn_SetForceButton("00110101");	//처음부터 ( 추가,삭제,저장,조회,선택,엑셀,인쇄,닫기 )  
	
	grd_IR.NoDataText = gfn_GetMessage("M000022","%AAA%","조회결과가");		

}

//--------------------------------------------------------------------------------------------------
//	fn_init()   :  손상부전위차값을 가져온다.
//--------------------------------------------------------------------------------------------------
function fn_init( )
{ 
	ds_Search.AddRow();
	ds_Search.SetColumn( ds_Search.row , 'BASE_YEAR'       , fa_base_year );
	ds_Search.SetColumn( ds_Search.row , 'MPIPE_ID'        , fa_mpipe_id  );
	ds_Search.SetColumn( ds_Search.row , 'EXPLOR_RSLT_SEQ' , fa_explor_rslt_seq ); 

	var strSvcID = "init";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1903010011U-service";  
	var strInDatasets  = "ds_Search=ds_Search";
	var strOutDatasets = "ds_ECDA_RST=ds_ECDA_RST";
	var strArgument    = "init=1"; 
    var CallBack       = "fn_D1_CallBack";
    	
	gfn_AsyncCall(  
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
		           , CallBack); 
}

//---------------------------------------------------------
//	공통 버튼 클릭 - 조회
//---------------------------------------------------------
function fn_CommonSearch()
{ 
	ds_IR_MGR.ClearData();
	
	var strSvcID = "find";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1903010011U-service";  
	var strInDatasets  = "ds_Search=ds_Search";
	var strOutDatasets = "ds_IR_MGR=ds_IR_MGR";
	var strArgument    = "find=1"; 
    var CallBack       = "fn_D1_CallBack"; 
    	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
		           , CallBack);
}

//---------------------------------------------------------
//	공통 버튼 - 저장
//--------------------------------------------------------- 
function fn_CommonSave()  
{   
	//if(!gfn_B3_CheckGridColumn(grd_IR)) return false;
	
	for( i = 0 ; i < ds_IR_MGR.GetRowCount() ; i++){
		ds_IR_MGR.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));
		ds_IR_MGR.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));
		ds_IR_MGR.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));
		ds_IR_MGR.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));
    }
    
	var strSvcID = "save";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1903010011U-service";  
	var strInDatasets  = "ds_IR_MGR=ds_IR_MGR:U";
	var strOutDatasets = "";
	var strArgument    = "save=1"; 
    var CallBack       = "fn_D1_CallBack"; 
    	
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
		           , CallBack);
}
 
//---------------------------------------------------------
//	공통 버튼 - 행추가
//--------------------------------------------------------- 
function fn_CommonAddRow()  
{  
	alert("행을 임의로 추가하실수 없습니다.");
	/* 
    //20개 행으로 무조건 나열되기 때문에 별도의 로우추가는 필요없다.
	ds_IR_MGR.AddRow();
	ds_IR_MGR.SetColumn( ds_IR_MGR.row , 'BASE_YEAR' , fa_base_year  );
	ds_IR_MGR.SetColumn( ds_IR_MGR.row , 'MPIPE_ID'  , fa_mpipe_id  );
	ds_IR_MGR.SetColumn( ds_IR_MGR.row , 'EXPLOR_RSLT_SEQ' , fa_explor_rslt_seq ); 
	*/
}

//---------------------------------------------------------
//	공통 버튼 - 행삭제
//--------------------------------------------------------- 
function fn_CommonDeleteRow()  
{   
	ds_IR_MGR.SetColumn( ds_IR_MGR.row , 'IR_LEFT'  , 0 );
	ds_IR_MGR.SetColumn( ds_IR_MGR.row , 'IR_RIGHT' , 0 ); 
} 

//--------------------------------------------------------------------------------------------------
//	서비스 CallBack
//--------------------------------------------------------------------------------------------------
function fn_D1_CallBack(SrvID,ErrorCode,ErrorMsg)
{

	if(ErrorCode < 0) 
	{
		alert(ErrorMsg);
		return;
	}
	
    switch(SrvID)
    {
        
        case "init":
			//trace(ds_ECDA_RST.SaveXML());  
			edit_DAP.Text = ds_ECDA_RST.GetColumn( 0 , "DAMAGE_ADDR_POTENTIAL" );
			fn_CommonSearch();
        	break;	
        	
		case "save":
			alert( '저장되었습니다.' );
			fn_CommonSearch();
        	break;	
        default:

    }
}
//------------------------------------------------------------------------------- 
// 기      능   :  공통 Excel
//------------------------------------------------------------------------------- 
function fn_CommonExcelExport()
{
	var SearchCondition= "";
    //SearchCondition = SearchCondition + "업체명 :" + RPad(edt_DealNm.Text," ",20); 
    gfn_ExportExcel("배관진단실적등록", 5, SearchCondition, "grd_IR"); 	
}

//-------------------------------------------------------------------------------
//	sorting - Master Grid
//-------------------------------------------------------------------------------
function grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	if( obj.getRowCount() > 0 )
	{
		if(nCell == 0 || nCell == 1 || nCell == 2 || nCell == 3) {
			gfn_SetGridSort(obj, nCell);
		}	
	} 
}

function btn_ExcelUproad_OnClick(obj)
{
	//ds_Excel.ClearData(); 
	var strColNms = "IR_LEFT,IR_RIGHT";
	gfn_D1_UploadExcelData( ds_IR_MGR, grd_IR , strColNms);
	for( var i = 0; i < ds_IR_MGR.rowcount ; i ++ ){ 
		ds_IR_MGR.SetColumn( i , 'BASE_YEAR'       , fa_base_year );
		ds_IR_MGR.SetColumn( i , 'MPIPE_ID'        , fa_mpipe_id  );
		ds_IR_MGR.SetColumn( i , 'EXPLOR_RSLT_SEQ' , fa_explor_rslt_seq );  
		ds_IR_MGR.SetColumn( i , 'IR_SEQ'   , i + 1 ); 
	}
	//trace( ds_ExcelData.saveXml() );  
}

function btn_ExcelSample_OnClick(obj)
{ 
	gfn_ExportExcelSample( "Grid_XLS_SAMPLE" ); 	
}
]]></Script>
</Window>