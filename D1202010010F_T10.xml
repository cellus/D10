<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="696" Id="cob_Ar" Left="8" OnLoadCompleted="D1202010010F_T10_OnLoadCompleted" OnUnloadCompleted="D1202010010F_T10_OnUnloadCompleted" PidAttrib="7" Title="누출탐지차량&#32;순찰점검등록_D1202010010F_T10" Top="8" Ver="1.0" Width="1260" WorkArea="true">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Fid" OnRowPosChanged="ds_Multi_OnRowPosChanged"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Fid_h_Save" OnRowPosChanged="ds_Fid_h_Save_OnRowPosChanged">
				<Contents>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="FID_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CAR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_NIGHT_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="KOPIPE_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="MPIPE_LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="OPERAT_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVING_DISTANCE" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="NO_PATROL_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID1" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID2" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_EMPID3" size="256" summ="default" type="STRING"/>
					<colinfo id="TAKER_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Fid_b_Save">
				<Contents>
					<colinfo id="CHK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_QUARTER" size="256" summ="default" type="STRING"/>
					<colinfo id="FID_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BLOCK_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PATROL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="LEAK_DETECT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="LK_BRANCH" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_DENSITY" size="256" summ="default" type="STRING"/>
					<colinfo id="UNDERTAKE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="HANDOVER_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="HANDOVER_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="UNDERTAKE_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Dub"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_dong">
				<Contents>
					<colinfo id="DONG_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Image Align="Left" Height="13" Id="Image5" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="6" Text="누출내역" Top="522" Width="117"></Image>
		<Image Align="Left" Height="12" Id="Image4" ImageID="blt_8" Left="5" LeftMargin="12" OnClick="Image13_OnClick" Style="text_title" TabOrder="5" Text="누출탐지차량&#32;운행내역" Top="280" Width="167"></Image>
		<Shape BKColor="#6cbae1" Bottom="29" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1251" TabOrder="2" Top="26" Type="Rectangle" Width="1246"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Fid" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="264" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="235" Id="grd_Multi" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" Right="1251" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="1" TabStop="true" Top="29" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col fix="left" width="50"/>
						<col width="61"/>
						<col width="57"/>
						<col width="200"/>
						<col width="223"/>
						<col width="118"/>
						<col width="105"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="계획년도"/>
						<cell col="3" display="text" text="계획분기"/>
						<cell col="4" display="text" text="점검구간"/>
						<cell col="5" display="text" text="순찰지역"/>
						<cell col="6" display="text" text="본관FID&#32;(m)"/>
						<cell col="7" display="text" text="공급관FDI&#32;(m)"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="CHK_YEAR" display="text"/>
						<cell align="center" col="3" colid="CHK_QUARTER" display="text"/>
						<cell col="4" colid="BLOCK_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell col="5" colid="DONG_NM" display="text"/>
						<cell align="right" col="6" colid="KOPIPE_FID_LENG" display="number"/>
						<cell col="7" colid="MPIPE_FID_LENG" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Fid_b_Save" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="688" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="144" Id="grd_MultiSave_b" InputPanel="FALSE" Left="4" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="grd_MultiSave_OnCellDblClick" OnCellPosChanged="grd_MultiSave_OnCellPosChanged" Right="1250" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="3" TabStop="true" Top="544" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col width="50"/>
						<col width="100"/>
						<col width="214"/>
						<col width="106"/>
						<col width="118"/>
						<col width="109"/>
						<col width="528"/>
					</columns>
					<head>
						<cell col="0" display="text" text="내용년수"/>
						<cell col="1" display="text" text="NO"/>
						<cell col="2" display="text" text="순찰일자"/>
						<cell col="3" display="text" text="누설지점"/>
						<cell align="center" col="4" display="text" text="검지농도(%)"/>
						<cell col="5" display="text" text="인수자"/>
						<cell col="6" display="text" text="인계일자"/>
						<cell col="7" display="text" text="인계내역"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell col="2" colid="PATROL_YMD" display="date"/>
						<cell col="3" colid="LK_BRANCH" display="text" edit="normal" expandsize="18" wordwrap="word"/>
						<cell align="right" col="4" colid="CHK_DENSITY" display="number" edit="number" LimitDec="2"/>
						<cell align="center" col="5" colid="UNDERTAKE_EMPID_NM" display="text" expandimage="SEarch" expandshow="true"/>
						<cell col="6" colid="HANDOVER_YMD" display="date" edit="date"/>
						<cell align="left" col="7" colid="HANDOVER_DESC" display="normal" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user15" Bottom="545" Height="3" Id="Shape1" Left="4" LineWidth="0" Right="1251" TabOrder="4" Top="542" Type="Rectangle" Width="1247"></Shape>
		<Button ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Sanction" ImageID="btn_5_Amendment" Left="1199" LeftMargin="21" OnClick="btn_Sanction_OnClick" Style="button" TabOrder="7" Text="결재" Top="5" Width="50"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button228" ImageID="btn_6_Pastrecord" Left="1146" LeftMargin="21" OnClick="fn_LeakHistory_B_OnClick" Style="button" TabOrder="8" Text="누설이력&#32;조회" Top="518" Width="103"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button1" ImageID="btn_add" Left="987" LeftMargin="20" OnClick="fn_D1_Addrowm_B_OnClick" Style="button" TabOrder="9" Text="추가" Top="518" Width="50"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="Button8" ImageID="btn_delete" Left="1040" LeftMargin="20" OnClick="fn_D1_Delete_B_OnClick" Style="button" TabOrder="10" Text="삭제" Top="518" Width="50"></Button>
		<Button ButtonStyle="TRUE" Height="19" Id="Button2" ImageID="btn_popsave" Left="1093" LeftMargin="21" OnClick="fn_D1_Save_B_OnClick" Style="button" TabOrder="11" Text="저장" Top="518" Width="50"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button0" ImageID="btn_6_Pastrecord" Left="1148" LeftMargin="21" OnClick="fn_LeakHistory_H_OnClick" Style="button" TabOrder="12" Text="차량운행&#32;조회" Top="281" Width="103"></Button>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_Fid_h_Save" BkColor2="default" BoldHead="FALSE" Border="Flat" Bottom="509" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="208" Id="grd_MultiSave_h" InputPanel="FALSE" Left="4" LineColor="default" LineType="ExVERT" MinWidth="100" MultiSelect="TRUE" OnCellDBLClick="grd_MultiSave_OnCellDblClick" OnCellPosChanged="grd_MultiSave_OnCellPosChanged" Right="1250" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="13" TabStop="true" Top="301" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1246">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="0"/>
						<col width="39"/>
						<col width="57"/>
						<col width="27"/>
						<col width="68"/>
						<col width="106"/>
						<col width="53"/>
						<col width="56"/>
						<col width="56"/>
						<col width="89"/>
						<col width="56"/>
						<col width="56"/>
						<col width="56"/>
						<col width="56"/>
						<col width="99"/>
						<col width="197"/>
						<col width="164"/>
					</columns>
					<head>
						<cell col="0" display="text"/>
						<cell col="1" display="text" rowspan="2" text="NO"/>
						<cell col="2" display="text" rowspan="2" text="순찰년도"/>
						<cell col="3" display="text" rowspan="2" text="분기"/>
						<cell col="4" display="text" rowspan="2" text="순찰일자"/>
						<cell col="5" display="text" rowspan="2" text="점검구간"/>
						<cell col="6" display="text" rowspan="2" text="결재상태"/>
						<cell col="7" display="text" rowspan="2" text="주야구분"/>
						<cell col="8" display="text" rowspan="2" text="순찰구분"/>
						<cell col="9" display="text" rowspan="2" text="차량번호"/>
						<cell col="10" display="text" text="운행시간"/>
						<cell col="10" display="text" row="1" text="(분)"/>
						<cell col="11" display="text" text="운행거리"/>
						<cell col="11" display="text" row="1" text="(Km)"/>
						<cell col="12" colspan="2" display="text" text="순찰연장(m)"/>
						<cell col="12" display="text" row="1" text="본관"/>
						<cell col="13" display="text" row="1" text="공급관"/>
						<cell col="14" display="text" rowspan="2" text="미순찰사유"/>
						<cell col="15" display="text" rowspan="2" text="비고"/>
						<cell col="16" display="text" rowspan="2" text="특기사항"/>
						<cell col="0" display="text" row="1" text="내용년수"/>
					</head>
					<body>
						<cell col="0" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="1" display="text" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="2" colid="CHK_YEAR" display="text"/>
						<cell align="center" col="3" colid="CHK_QUARTER" display="text"/>
						<cell align="center" col="4" colid="PATROL_YMD" display="date"/>
						<cell align="center" col="5" colid="BLOCK_NM" display="text" LimitDec="2"/>
						<cell align="center" col="6" colid="DECIDE_PROC_STS" display="combo"/>
						<cell align="center" col="7" colid="DAY_NIGHT_FLAG" display="combo"/>
						<cell col="8" colid="PATROL_FLAG" display="combo"/>
						<cell align="center" col="9" colid="CAR_NUM" display="text"/>
						<cell align="right" col="10" colid="OPERAT_TIME" display="text" edit="number"/>
						<cell align="right" col="11" colid="MOVING_DISTANCE" display="text" edit="number"/>
						<cell align="right" col="12" colid="KOPIPE_LENG" display="text" edit="number"/>
						<cell align="right" col="13" colid="MPIPE_LENG" display="text" edit="number"/>
						<cell col="14" colid="NO_PATROL_WHY" display="combo"/>
						<cell col="15" colid="RMK1" display="text" edit="normal"/>
						<cell col="16" colid="RMK2" display="text" edit="normal"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Shape BKColor="user15" Bottom="302" Height="3" Id="Shape2" Left="4" LineWidth="0" Right="1251" TabOrder="14" Top="299" Type="Rectangle" Width="1247"></Shape>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID      : D1201010010F_T10.xml
* Form 설명   : 누설탐지차량 순찰점검등록 조회,등록,수정,삭제
* 시스템 명   : 안전공급(D1)
* 작성자      : 임성수
* 작성일      : 2009-01-16
* 변경내용    : 변경내용없음
****************************************************************************************************/

//-----------------------------------------
// 전처리 함수 선언
//-----------------------------------------
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONA10008.js";
#include "JS::COMMONE20001.js";

var Quarter = '';

function D1202010010F_T10_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	gfn_D1_SetGrid_Sort(grd_Multi);
	gfn_D1_SetGrid_Sort(grd_MultiSave_h);
	gfn_D1_SetGrid_Sort(grd_MultiSave_b);
	fn_D1_Combo_Set();
	
	fn_chkQuarter();
}

function fn_D1_Combo_Set()
{
	gfn_SetGrdComboBox_Comcode("grd_MultiSave_h",6,"A10411");	
	grd_MultiSave_h.SetCellProp("body",6,"Edit","none");
	gfn_SetGrdComboBox_Comcode("grd_MultiSave_h",7,"B20031");		//주야구분
	gfn_SetGrdComboBox_Comcode("grd_MultiSave_h",8,"D10135");		//순찰구분
	gfn_SetGrdComboBox_Comcode("grd_MultiSave_h",14,"D10194");		//미순찰사유		
}
		
function fn_chkQuarter()
{
	if(SubStr(cal_PPatrolYmd.Value,4,2)=="01"||SubStr(cal_PPatrolYmd.Value,4,2)=="02"||SubStr(cal_PPatrolYmd.Value,4,2)=="03")
	{
		Quarter = '1';
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="04"||SubStr(cal_PPatrolYmd.Value,4,2)=="05"||SubStr(cal_PPatrolYmd.Value,4,2)=="06")
	{
		Quarter = '2';
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="07"||SubStr(cal_PPatrolYmd.Value,4,2)=="08"||SubStr(cal_PPatrolYmd.Value,4,2)=="09")
	{
		Quarter = '3';
	}
	else if(SubStr(cal_PPatrolYmd.Value,4,2)=="10"||SubStr(cal_PPatrolYmd.Value,4,2)=="11"||SubStr(cal_PPatrolYmd.Value,4,2)=="12")
	{
		Quarter = '4';
	}    
}   

function fn_Quarter(chk_ymd)
{
	if(SubStr(chk_ymd,4,2)=="01"||SubStr(chk_ymd,4,2)=="02"||SubStr(chk_ymd,4,2)=="03")
	{
		return '1';
	}
	else if(SubStr(chk_ymd,4,2)=="04"||SubStr(chk_ymd,4,2)=="05"||SubStr(chk_ymd,4,2)=="06")
	{
		return '2';
	}
	else if(SubStr(chk_ymd,4,2)=="07"||SubStr(chk_ymd,4,2)=="08"||SubStr(chk_ymd,4,2)=="09")
	{
		return '3';
	}
	else if(SubStr(chk_ymd,4,2)=="10"||SubStr(chk_ymd,4,2)=="11"||SubStr(chk_ymd,4,2)=="12")
	{
		return '4';
	}
}
//------------------------------------------------------------------------------- 
// 함수명: fn_D1_ExcelExport()
//  설명: 특별관리시설 엑셀로 저장
// arguments   
//  return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_ExcelExport()
{ 
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 :"     + RPad(cob_PBranchCd.Text," ",20);
    SearchCondition = SearchCondition + "팀 :"       + RPad(cob_PTeamCd.Text," ",20);
    SearchCondition = SearchCondition + "조 :"       + RPad(cob_PShiftWorkCd.Text," ",20);
    SearchCondition = SearchCondition + "구간코드 :" + RPad(cob_block.Text," ",20);
    SearchCondition = SearchCondition + "순찰일자 :" + RPad(cal_PPatrolYmd.Text," ",20);
	gfn_ExportExcel("누출탐지차량 순찰점검등록", 5, SearchCondition, "grd_Multi");
}


//-------------------------------------------------------------------------------
// 함수명   : fn_D1_Find()
// 설명     : 순찰점검 주 계획을 조회한다.
// return 내용 : 없음
//-------------------------------------------------------------------------------
function fn_D1_Find()
{
	ds_Fid.ClearData();

	ds_Fid_h_Save.ClearData();
	ds_Fid_b_Save.ClearData();
	
	
	fn_chkQuarter();

	ds_Search.ClearData();
	var row = ds_Search.AddRow();

	ds_Search.SetColumn(row,"BRANCH_CD",cob_PBranchCd.Value);
	ds_Search.SetColumn(row,"BLOCK_CD",cob_block.Value);
	ds_Search.SetColumn(row,"CHK_YEAR",SubStr(cal_PPatrolYmd.Value,0,4));
	ds_Search.SetColumn(row,"CHK_QUARTER",Quarter);	
	
	if(cob_PShiftWorkCd.value=="10"||cob_PShiftWorkCd.value=="20")
	{
	    ds_Search.SetColumn(row,"TEAM_CD",cob_PTeamCd.Value);		//팀코드
	}
	else
	{
	    ds_Search.SetColumn(row,"TEAM_CD",'');
	}
	
	var strSvcID = "find_fid";
	var strPart  = "D10";
	var strURL   = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets  = "ds_Search=ds_Search";
	var strOutDatasets  = "ds_Fid=ds_Multi";
	var strArgument  = "find_fid=1";
				
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );					  	
		
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_SAVE
//   설명  : 누출탐지차량 운행내역(헤더)을 등록한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Save()
{
    if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		return;
    }
	if(ds_Fid_h_Save.RowCount() == 0)
	{
		return;
	}
		
	for(var i =0; i<ds_Fid_h_Save.GetRowCount();i++)
	{ 
		if(ds_Fid_h_Save.GetColumn(i,"PATROL_YMD") > today())
		{
			alert("점검일자가 현재일보다 큽니다.");
			return;
		}
		
		if(ds_Fid_h_Save.GetColumn(0,"DAY_NIGHT_FLAG") == ""||ds_Fid_h_Save.GetColumn(0,"DAY_NIGHT_FLAG") == null)
		{
			alert(gfn_GetMessage("M000011","%AAA%","주야 구분을"));	
			return;
		}
	
		if(ds_Fid_h_Save.GetColumn(0,"PATROL_FLAG") == ""||ds_Fid_h_Save.GetColumn(0,"PATROL_FLAG") == null)
		{
			alert(gfn_GetMessage("M000011","%AAA%","순찰구분을"));	
			return;
		}

		if(ds_Fid_h_Save.GetColumn(0,"CAR_NUM") == ""||ds_Fid_h_Save.GetColumn(0,"CAR_NUM") == null)
		{ 
			alert(gfn_GetMessage("M000011","%AAA%","차량번호를"));	
			return;
		}
		
		if (ds_Fid_h_Save.GetRowType(i) == 'insert' || ds_Fid_h_Save.GetRowType(i) == 'update')
		{
			//결재여부 확인 루틴//점검일에 결재 유무 확인
			if(ds_Fid_h_Save.GetColumn(i,"DECIDE_PROC_STS") == '0' || ds_Fid_h_Save.GetColumn(i, "DECIDE_PROC_STS") == '1' || ds_Fid_h_Save.GetColumn(i, "DECIDE_PROC_STS") == '2')
			{
				alert("점검일자(" + ds_Fid_h_Save.GetColumn(i, "PATROL_YMD") +  ")는 결재(완료/진행중)으로 내역을 수정할 수 없습니다...");
				return;
			}
		}
		
		if (ds_Fid_h_Save.GetRowType(i) == 'insert')
		{
			ds_Fid_h_Save.SetColumn(i, "CRT_EMPID"     ,gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_Fid_h_Save.SetColumn(i, "CRT_IP"        ,gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
			ds_Fid_h_Save.SetColumn(i, "UPD_EMPID"     ,gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_Fid_h_Save.SetColumn(i, "UPD_IP"        ,gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP			
		}
		else if(ds_Fid_h_Save.GetRowType(i) == 'update')
		{
			ds_Fid_h_Save.SetColumn(i, "UPD_EMPID"     ,gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_Fid_h_Save.SetColumn(i, "UPD_IP"        ,gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP			
		}	
	}
	
	var strSvcID         = "fid_h_check";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1202010010F-service";					
	var strInDatasets    = "ds_Fid_h_Save=ds_Fid_h_Save:u";
	var strOutDatasets   = "";		
	var strArgument      = "fid_h_check=1";

	gfn_syncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				);
			   
	if(ErrorCode<0)
	{
		return;
	}

	alert("운행내역이 저장/수정 되었습니다.");
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Addrowm()
//   설명  :  행추가 
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Addrowm()
{ 
    if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		return;
    }else if(ds_Fid.GetRowCount() == 0) {
		return;
    }
    
	ds_Fid_h_Save.InsertRow(0);
	
	ds_Fid_h_Save.SetColumn(0, "CHK_YEAR"      ,ds_Fid.GetColumn(ds_Fid.row, "CHK_YEAR"));
	ds_Fid_h_Save.SetColumn(0, "CHK_QUARTER"      ,ds_Fid.GetColumn(ds_Fid.row, "CHK_QUARTER"));
	ds_Fid_h_Save.SetColumn(0, "BLOCK_NM"      ,ds_Fid.GetColumn(ds_Fid.row, "BLOCK_NM") + '-' + ds_Fid.GetColumn(ds_Fid.row, "SEQ"));	
	ds_Fid_h_Save.SetColumn(0, "FID_FLAG"      ,ds_Fid.GetColumn(ds_Fid.row, "FID_FLAG"));			
	ds_Fid_h_Save.SetColumn(0, "BLOCK_CD"      ,ds_Fid.GetColumn(ds_Fid.row, "BLOCK_CD"));
	ds_Fid_h_Save.SetColumn(0, "SEQ"      ,ds_Fid.GetColumn(ds_Fid.row, "SEQ"));
	ds_Fid_h_Save.SetColumn(0,"PATROL_YMD",Today());
	grd_MultiSave_h.SetCellProp("body",4,"Edit"   ,"expr:decode(rowtype,'insert','date','none')"); 
	ds_Fid_h_Save.SetColumn(0, "BRANCH_CD"     ,ds_Fid.GetColumn(ds_Fid.row, "BRANCH_CD"));
	ds_Fid_h_Save.SetColumn(0, "TEAM_CD"     ,ds_Fid.GetColumn(ds_Fid.row, "TEAM_CD"));
	ds_Fid_h_Save.SetColumn(0, "CAR_NUM"     ,edt_car_num.text);
	ds_Fid_h_Save.SetColumn(0, "TAKER_EMPID1",edt_empid1.text );	
	ds_Fid_h_Save.SetColumn(0, "TAKER_EMPID2",edt_empid2.text );
	ds_Fid_h_Save.SetColumn(0, "TAKER_EMPID3",edt_empid3.text );
	ds_Fid_h_Save.SetColumn(0,"TAKER_NAME", edt_empnm1.text+ " " +edt_empnm2.text+ " "+edt_empnm3.text);		
}

//-------------------------------------------------------------------------------------
// 함수명 :  fn_D1_Delete()
// 내용   :  순찰 실적을 삭제한다.
// args   : 
// return : 없음
//-------------------------------------------------------------------------------------
function fn_D1_Delete()
{
	if(ds_Fid_h_Save.GetRowCount()==0)
	{
		return;
	}

	if(ds_Fid_h_Save.GetRowType(ds_Fid_h_Save.row) == "insert")
	{
		ds_Fid_h_Save.DeleteRow(ds_Fid_h_Save.row);
		return;
	}

	if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		alert("담당자만 삭제가 가능합니다..");
		return;
    }

	if (ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '0' || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '1'  || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '2') 
	{	
		alert("결재(진행/완료)중으로 삭제가 불가합니다...");
		return;
    }else if(confirm("삭제하시겠습니까?"))
    {
		ds_Fid_h_Save.DeleteRow(ds_Fid_h_Save.Row);

		var strSvcID         = "fid_h_check";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1202010010F-service";
		var strInDatasets    = "ds_Fid_h_Save=ds_Fid_h_Save:u";
		var strOutDatasets   = "";
		var strArgument      = "fid_h_check=1";
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
				   
		if(ErrorCode < 0)
		{
			return;
		}
		
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"));
			
	}
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Save_B_OnClick
//   설명  : 누출내역(바디)을  등록한다.(수정 안됨)
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Save_B_OnClick(obj)
{
    if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		return;
    }
	if(ds_Fid_b_Save.RowCount() == 0)
	{
		return;
	}	
	for(var i =0; i<ds_Fid_b_Save.GetRowCount();i++)
	{
		if(ds_Fid_b_Save.GetColumn(i,"CHK_DENSITY")==""||ds_Fid_b_Save.GetColumn(i,"CHK_DENSITY")==null)
		{
			alert(gfn_GetMessage("M000011","%AAA%","검지농도(%)를"));
			return;
		}
	
		if(ds_Fid_b_Save.GetRowType(i)=="insert")
		{
			ds_Fid_b_Save.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_Fid_b_Save.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
			ds_Fid_b_Save.SetColumn(i, "CRT_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//등록자사번
			ds_Fid_b_Save.SetColumn(i, "CRT_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//등록자 IP
		}	
		else
		{	
			ds_Fid_b_Save.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));	//수정자사번
			ds_Fid_b_Save.SetColumn(i, "UPD_IP", gfn_GetGlobalValue("G_IPADDRESS"));	//수정자 IP
		}
	}
	
	var strSvcID         = "fid_b_check";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets    = "ds_Fid_b_Save=ds_Fid_b_Save:u";
	var strOutDatasets   = "";
	var strArgument      = "fid_b_check";
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   
	if(ErrorCode < 0)
	{
		return;
	}
	else
	{
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"));
	}
}


// ---------------------------------------------------------
// 그리드 타입에 따른 활성화 여부
// ---------------------------------------------------------
function grd_MultiSave_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if(ds_Fid_b_Save.GetColumn(0,"HANDOVER_YMD")>today())
	{
		alert("현재일보다 큽니다.");
		ds_Fid_b_Save.SetColumn(0,"HANDOVER_YMD",ds_Fid_b_Save.GetColumn(0,"PATROL_YMD"));
		return;
	}
	if(ds_Fid_b_Save.GetColumn(0,"HANDOVER_YMD") < ds_Fid_b_Save.GetColumn(0,"PATROL_YMD"))
	{
		alert("순찰일자보다 작습니다.");
		ds_Fid_b_Save.SetColumn(0,"HANDOVER_YMD",ds_Fid_b_Save.GetColumn(0,"PATROL_YMD"));
	}
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Addrowm()
//   설명  :  행추가 
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Addrowm_B_OnClick(obj)
{
    if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		return;
    }
	if(ds_Fid_h_Save.GetRowCount()==0)
    {
		return;
    }	    
    if(ds_Fid_h_Save.GetRowType(ds_Fid_h_Save.row)=="insert")
    {
		return;
    }	
    
    if (ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '0' || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '1'  || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '2')
   	{	
		alert("결재(진행/완료)중으로 누출내역을 추가가 불가합니다...");
		return;
	}
		
	ds_Fid_b_Save.InsertRow(0);											//insert시 맨위에 행추가

	ds_Fid_b_Save.SetColumn(0, "CHK_YEAR"      ,ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "CHK_YEAR"));
	ds_Fid_b_Save.SetColumn(0, "CHK_QUARTER"   ,ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "CHK_QUARTER"));
	ds_Fid_b_Save.SetColumn(0, "FID_FLAG"      ,ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "FID_FLAG"));			
	ds_Fid_b_Save.SetColumn(0, "BLOCK_CD"      ,ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "BLOCK_CD"));
	ds_Fid_b_Save.SetColumn(0, "SEQ"      ,ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "SEQ"));
	ds_Fid_b_Save.SetColumn(0,"PATROL_YMD",ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "PATROL_YMD"));	
	ds_Fid_b_Save.SetColumn(0,"HANDOVER_YMD",ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "PATROL_YMD"));	
	ds_Fid_b_Save.SetColumn(0,"BRANCH_CD",ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "BRANCH_CD"));		
	ds_Fid_b_Save.SetColumn(0,"TEAM_CD",ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "TEAM_CD"));			
}

function fn_D1_Delete_B_OnClick(obj)
{
	if(ds_Fid_b_Save.GetRowCount()==0)
	{
		return;
	}

	if(ds_Fid_b_Save.GetRowType(ds_Fid_b_Save.row) == "insert")
	{
		ds_Fid_b_Save.DeleteRow(ds_Fid_b_Save.row);
		return;
	}

    if((gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '199443297') && (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") AND (gfn_GetGlobalValue("G_USER_NO") <> '700004008'))
    {
		alert("담당자만 삭제가 가능합니다..");
		return;
    }

	if (ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '0' || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '1' || ds_Fid_h_Save.GetColumn(ds_Fid_h_Save.row, "DECIDE_PROC_STS") == '2') 
	{	
		alert("결재(진행/완료)중으로 삭제가 불가합니다...");
		return;
    }else if(confirm("삭제하시겠습니까?"))
    {
		ds_Fid_b_Save.DeleteRow(ds_Fid_b_Save.Row);

		var strSvcID         = "fid_b_check";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1202010010F-service";
		var strInDatasets    = "ds_Fid_b_Save=ds_Fid_b_Save:u";
		var strOutDatasets   = "";
		var strArgument      = "fid_b_check=1";
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );
				   
		if(ErrorCode < 0)
		{
			return;
		}
	
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"));
	}	
}

//-----------------------------------------
// 누출이력조회 팝업(헤더)
//-----------------------------------------
function fn_LeakHistory_H_OnClick(obj)
{
	if(edt_CarNum.Text == "" || edt_CarNum.Text == null)
	{
		alert('순찰차량 정보가 없습니다.');
		return;
	}
	var args = "CHK_YEAR=" 			+quote(ds_Multi.GetColumn(0,"CHK_YEAR"))		//점검년도
			  +" CHK_QUARTER=" 		+quote(ds_Multi.GetColumn(0,"CHK_QUARTER"))		//점검분기
			  +" FID_FLAG=" 		+quote(ds_Multi.GetColumn(0,"FID_FLAG"))		//FID구분
			  +" BLOCK_CD=" 		+quote(ds_Multi.GetColumn(0,"BLOCK_CD"))		//구간코드
			  +" SEQ=" 				+quote(ds_Multi.GetColumn(0,"SEQ"))				//일련번호
			  ;
	gfn_Dialog("D10","D1202010039U",args,1000,400,true,-1,-1);
}

//-----------------------------------------
// 누출이력조회 팝업(바디)
//-----------------------------------------
function fn_LeakHistory_B_OnClick(obj)
{
	var args = "BRANCH_CD=" +quote(cob_PBranchCd.Value);			//점검년도
			  ;
	gfn_Dialog("D10","D1202010036U",args,660,400,true,-1,-1);
}

//-------------------------------------------------------------------------------
// 함수명   : btn_Sanction_OnClick(obj)
// 설명     : 전자결재
// return 내용 : 없음
//-------------------------------------------------------------------------------
function btn_Sanction_OnClick(obj)
{
	alert("누출탐지 차량 순찰 결재는 순찰일별 차량별 결재로 진행됩니다..");
	
	var Chk_Year = substr(cal_PPatrolYmd.Value,0,4);
	fn_chkQuarter();
	var Chk_Quarter = Quarter;
	var Fid_Flag = (ds_Fid.GetColumn(ds_Fid.row,"Fid_Flag"));
	var Patrol_Ymd = cal_PPatrolYmd.Value;
	var Branch_Cd = cob_PBranchCd.Value;
	var Team_Cd = ds_emp.GetColumn(0,"TEAM_CD");
	var Empid = ds_emp.GetColumn(0,"EMPID");
 //TRACE(Chk_Year + "-" + Fid_Flag +  "-" +  Chk_Quarter + "-" + Patrol_Ymd + "-" + Branch_Cd + "-" + Team_Cd + "-" + Empid);	
	//var Car_Num = ds_emp.GetColumn(0,"CAR_NUM");

	//그룹웨어에서 차량번호(한글)파라메터 전달 불가로 로그인자 사번넘겨 차량번호 참조 오즈로 넘겨줌 
	gfv_callGWInfo("fmD08","D10","D1202010010P_10",7,Chk_Year+","+Chk_Quarter+","+Fid_Flag+","+Patrol_Ymd+","+Branch_Cd+","+Team_Cd+","+Empid);
   // 1번 : 화면명칭   2번 : 업무그룹 (b10,b20... OZ 인경우 필수), 3번: 프로그램ID (oz인경우 필수) 4: 아규먼트 갯수 (1....5)
   // 5번 : 아규먼트 목록 (형식 , 표시로 각 아규먼트 구분자 사용)
}

function D1202010010F_T10_OnUnloadCompleted(obj)
{
	if(ds_Fid_b_Save.GetUpdate())
	{
		if(!confirm(gfn_GetMessage("M000016","%AAA%","변동된 사항이 있습니다. 종료")))
		 {
			 return false;
		 }	
	}
}

function grd_MultiSave_OnCellPosChanged(obj,nRow,nCell,nOldRow,nOldCell,nPivotIndex,nOldPivotIndex)
{
	if(ds_Fid_b_Save.GetColumn(0,"PATROL_YMD")>today())
	{
		alert("현재일보다 큽니다.");
		ds_Fid_b_Save.SetColumn(0,"PATROL_YMD",'');
	}
}

function ds_Multi_OnRowPosChanged(obj,nOldRow,nRow)
{
	ds_Fid_h_Save.ClearData();
	ds_Fid_b_Save.ClearData();
	
    var strSvcID        = "find_fid_h";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Fid_h_Save=ds_Fid_h_Save";
	var strArgument     = "find_fid_h=1";
		// strArgument		+= " CHK_YEAR="    + ds_Fid.GetColumn(nRow,"CHK_YEAR");
		// strArgument		+= " CHK_QUARTER=" + ds_Fid.GetColumn(nRow,"CHK_QUARTER");
		strArgument		+= " FID_FLAG="    + ds_Fid.GetColumn(nRow,"FID_FLAG");
		strArgument		+= " BLOCK_CD="    + ds_Fid.GetColumn(nRow,"BLOCK_CD");
		strArgument		+= " SEQ="         + ds_Fid.GetColumn(nRow,"SEQ");
								 	 
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );				    
	    
}

function grd_MultiSave_OnCellDblClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	if("UNDERTAKE_EMPID_NM" == grd_MultiSave_b.GetCellProp("body",nCell,"ColId"))	//점검대장 등록여부
		var retValue = gfn_E2_SearchOutEmplDialog();
		ds_Fid_b_Save.SetColumn(nRow,"UNDERTAKE_EMPID",retValue[0]);
		ds_Fid_b_Save.SetColumn(nRow,"UNDERTAKE_EMPID_NM",retValue[1]);
	}
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonPrint()
// 설명  : 순찰실적 장표를 출력한다. 
// arguments 없음
// return  없음
//-------------------------------------------------------------------------------
function fn_D1_Print()
{
    //함수 호출용 파라미터를 설정한다
	var strTitle ="누출탐지차량 일별 순찰내역"; 
	var strPart ="D10" ;
	var strReport="D1202010010P_10";  
	var strParameter="CHK_YEAR="+substr(cal_PPatrolYmd.Value,0,4)
				   +",CHK_QUARTER="+strQuarter
				   +",FID_FLAG="+(ds_Fid.GetColumn(ds_Fid.row,"Fid_Flag"));
		           +",PATROL_YMD="+cal_PPatrolYmd.Value
				   +",BRANCH_CD="+cob_PBranchCd.Value
		           +",TEAM_CD="+ds_emp.GetColumn(0,"TEAM_CD")
		           +",CAR_NUM="+ds_emp.GetColumn(0,"CAR_NUM")
					;
					
    //	공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);	
}
function ds_Fid_h_Save_OnRowPosChanged(obj,nOldRow,nRow)
{
	ds_Fid_b_Save.ClearData();
	
    var strSvcID        = "find_fid_b";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1202010010F-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Fid_b_Save=ds_Fid_b_Save";
	var strArgument     = "find_fid_b=1";
		strArgument		+= " CHK_YEAR="    + ds_Fid_h_Save.GetColumn(nRow,"CHK_YEAR");
		strArgument		+= " CHK_QUARTER=" + ds_Fid_h_Save.GetColumn(nRow,"CHK_QUARTER");
		strArgument		+= " FID_FLAG="    + ds_Fid_h_Save.GetColumn(nRow,"FID_FLAG");
		strArgument		+= " BLOCK_CD="    + ds_Fid_h_Save.GetColumn(nRow,"BLOCK_CD");
		strArgument		+= " SEQ="         + ds_Fid_h_Save.GetColumn(nRow,"SEQ");
		strArgument		+= " PATROL_YMD="  + ds_Fid_h_Save.GetColumn(nRow,"PATROL_YMD");
								 	 
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );				    	
}
]]></Script>
</Window>