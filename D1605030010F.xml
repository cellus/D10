<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="853" Id="D1605030010F" Left="8" OnLoadCompleted="D1605030010F_OnLoadCompleted" PidAttrib="7" Title="정비보수작업&#32;전표등록_D1605030010F" Top="8" Ver="1.0" Width="1270" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi">
				<Contents>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_REQ_YMD_1" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_REQ_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_REQ_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_LOC1" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_APPRO_OBJ_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MOVE_REPAIR_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAP_UPD_OBJ_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="MIS_UPD_OBJ_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="PIPE_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK1" size="256" summ="default" type="STRING"/>
					<colinfo id="EXPECT_JOB_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REAL_JOB_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_APPRO_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_APPRO_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_OBJ_YN_A" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_SCALE_A" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_ADMIT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADJ_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK2" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_L_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_M_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_S_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACT_DESC" size="256" summ="default" type="STRING"/>
					<colinfo id="GIS_RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="GIS_PAS_DU_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="GIS_CONF_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_AMT_UNIT_PRC" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_AMT_REAL_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_TREAT_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_TREAT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_REQ" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_MAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_MAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_MAT" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_RST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_RST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_RST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_PAY" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_PAY" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_PAY" size="256" summ="default" type="STRING"/>
					<colinfo id="TABLET_COMM_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_TYPE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RETURN_WHY_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_YMD_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_EMPID_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_RETURN_WHY_WORK_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_YMD_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_EMPID_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_RETURN_WHY_IND_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_YMD_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_EMPID_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_RETURN_WHY_DIR_COST" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM_SUB" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_REQ_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_L_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_M_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_S_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACROSS_A" size="256" summ="default" type="STRING"/>
					<colinfo id="HEIGHT_A" size="256" summ="default" type="STRING"/>
					<colinfo id="ACROSS_B" size="256" summ="default" type="STRING"/>
					<colinfo id="HEIGHT_B" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_OBJ_YN_B" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_SCALE_B" size="256" summ="default" type="STRING"/>
					<colinfo id="DAY_NIGHT_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="COST" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_SUM" size="256" summ="default" type="STRING"/>
					<colinfo id="TOTAL_SUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCOUNT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetailDelete"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillHeader">
				<Contents>
					<colinfo id="COM_ID" size="255" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" type="STRING"/>
					<colinfo id="UPD_IP" size="255" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" type="STRING"/>
					<colinfo id="CRT_IP" size="255" type="STRING"/>
					<colinfo id="APPRO_YN" size="255" type="STRING"/>
					<colinfo id="ACNT_YMD" size="255" type="STRING"/>
					<colinfo id="ACNT_BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="TOT_LN_NUM" size="255" type="DECIMAL"/>
					<colinfo id="FINL_LN_NUM" size="255" type="STRING"/>
					<colinfo id="DR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="CR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_WRITE_DEPT_CD" size="255" type="STRING"/>
					<colinfo id="BILL_KIND" size="255" type="STRING"/>
					<colinfo id="SYS_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_CRT_INFO" size="255" type="STRING"/>
					<colinfo id="ACNT_FLAG" size="255" type="STRING"/>
					<colinfo id="DEL_YN" size="255" type="STRING"/>
					<colinfo id="ADJ_CNT" size="255" type="DECIMAL"/>
					<colinfo id="OUTPUT_CNT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_OUTPUT_DTM" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Modify">
				<Contents>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Com">
				<Contents>
					<colinfo id="LOAN_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNC_PROD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PAP_ELE_FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_ACNT_CD">
				<Contents>
					<colinfo id="ACNT_TITACNT_CD_CR" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDelete">
				<Contents>
					<colinfo id="COM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="SYS_FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail2">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="PUBL_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SearchTop">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_START" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_END" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_WORK_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_IND_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ASSENT_DIR_FLAG" size="256" summ="default" type="STRING"/>
					<record>
						<ASSENT_DIR_FLAG></ASSENT_DIR_FLAG>
						<ASSENT_IND_FLAG></ASSENT_IND_FLAG>
						<ASSENT_TYPE></ASSENT_TYPE>
						<ASSENT_WORK_FLAG></ASSENT_WORK_FLAG>
						<BRANCH_CD></BRANCH_CD>
						<FACI_FLAG></FACI_FLAG>
						<MAINTER_NUM></MAINTER_NUM>
						<MAINTER_REQ_FLAG></MAINTER_REQ_FLAG>
						<MAINTER_STS_FLAG></MAINTER_STS_FLAG>
						<REQ_YMD_END></REQ_YMD_END>
						<REQ_YMD_START></REQ_YMD_START>
						<TEAM_CD></TEAM_CD>
						<WORK_FIRM_CD></WORK_FIRM_CD>
						<ZIP_NO1></ZIP_NO1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Bill">
				<Contents>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_AMT_SUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="HOLI_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCOUNT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Bill_Req">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_START" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_END" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Bill_Cancel"></Dataset>
		</Datasets>
		<Shape BKColor="#6cbae1" Bottom="695" Height="3" Id="Shape3" Left="5" LineWidth="0" Right="1248" TabOrder="23" Top="692" Type="Rectangle" Width="1243"></Shape>
		<Shape BKColor="#6cbae1" Bottom="100" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1257" TabOrder="3" Top="97" Type="Rectangle" Width="1252"></Shape>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Button" ImageID="btn_4" Left="1077" LeftMargin="21" OnClick="btn_Button_OnClick" Style="button" TabOrder="13" Text="전자결재" Top="74" Visible="FALSE" Width="76"></Button>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape1" Left="1" LineColor="user7" Right="1258" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="5" Top="30" Type="RoundRect" Width="1257"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape2" Left="8" LineWidth="0" Right="1254" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="6" Top="35" Type="Rectangle" Width="1246"></Shape>
		<Image Align="Left" Height="18" Id="Image10" ImageID="blt" Left="13" LeftMargin="12" Style="blt_search_Indis" TabOrder="2" Text="지사" Top="40" Width="61"></Image>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="7" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1252">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" Height="18" Id="cob_BranchCd" Left="56" Style="combo_indis" TabOrder="1" Top="40" Width="90"></Combo>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi" BkColor2="#f8f8f8" BkSelColor="skyblue" BoldHead="FALSE" Border="Flat" Bottom="666" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="36" Height="567" Id="grd_Mainter" InputPanel="FALSE" Left="5" LineColor="silver" LineType="ExVERT" MultiSelect="TRUE" OnCellClick="grd_Mainter_OnCellClick" OnHeadClick="grd_List_OnHeadClick" Right="1257" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="4" TabStop="true" Top="99" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1252">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col width="80"/>
						<col width="110"/>
						<col width="120"/>
						<col width="75"/>
						<col width="200"/>
						<col width="75"/>
						<col width="100"/>
						<col width="75"/>
						<col width="100"/>
						<col width="75"/>
						<col width="100"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" edit="normal" text="NO"/>
						<cell col="1" display="text" text="정비보수번호"/>
						<cell col="2" display="text" text="팀명"/>
						<cell col="3" display="text" text="시공회사"/>
						<cell col="4" display="text" text="의뢰일자"/>
						<cell col="5" display="text" text="의뢰내역"/>
						<cell col="6" display="text" text="공사비&#10;승인일자"/>
						<cell col="7" display="text" text="공사비(원)"/>
						<cell col="8" display="text" text="간접복구비&#10;승인일자"/>
						<cell col="9" display="text" text="간접복구비(원)"/>
						<cell col="10" display="text" text="직접공사비&#10;승인일자"/>
						<cell col="11" display="text" text="직접복구비(원)"/>
					</head>
					<body>
						<cell align="center" col="0" display="normal" expr="currow+1"/>
						<cell align="center" col="1" colid="MAINTER_NUM" display="text" expandsize="18" wordwrap="word"/>
						<cell col="2" colid="TEAM_CD_NM" display="text"/>
						<cell col="3" colid="WORK_FIRM_CD_NM" display="text"/>
						<cell col="4" colid="WORK_REQ_YMD_1" display="date"/>
						<cell col="5" colid="WORK_REQ_DESC" display="text"/>
						<cell align="center" col="6" colid="ASSENT_YMD_WORK_COST" display="date"/>
						<cell col="7" colid="WORK_AMT" display="number"/>
						<cell align="center" col="8" colid="ASSENT_YMD_IND_COST" display="date"/>
						<cell col="9" colid="IND_RC_AMT" display="number"/>
						<cell align="center" col="10" colid="ASSENT_YMD_DIR_COST" display="date"/>
						<cell col="11" colid="DIR_RC_AMT" display="number"/>
					</body>
					<summary>
						<cell col="0" display="text"/>
						<cell col="1" display="text"/>
						<cell col="2" display="text"/>
						<cell col="3" display="text"/>
						<cell col="4" display="text"/>
						<cell col="5" display="text"/>
						<cell col="6" display="text"/>
						<cell col="7" display="number" expr="sum(&apos;WORK_AMT&apos;)"/>
						<cell col="8" display="text"/>
						<cell col="9" display="number" expr="sum(&apos;IND_RC_AMT&apos;)"/>
						<cell col="10" display="text"/>
						<cell col="11" display="number" expr="sum(&apos;DIR_RC_AMT&apos;)"/>
					</summary>
				</format>
			</contents>
		</Grid>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BillYmd" Left="909" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="10" Top="74" WeeksFont="Default,-1" Width="88"></Calendar>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_bill" ImageID="btn_4_billreg" Left="999" LeftMargin="21" OnClick="btn_bill_OnClick" Style="button" TabOrder="8" Text="전표등록" Top="74" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_billDel" ImageID="btn_4_Close&#32;cancellation" Left="1077" LeftMargin="21" OnClick="btn_billDel_OnClick" Style="button" TabOrder="9" Text="전표취소" Top="74" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button104" ImageID="btn_6_add" Left="1155" LeftMargin="21" OnClick="Button212_OnClick" Style="button" TabOrder="11" Text="지불계좌&#32;추가" Top="74" Width="103"></Button>
		<Image Align="Left" Height="16" Id="Image4" ImageID="blt" Left="823" LeftMargin="12" Style="blt_search" TabOrder="12" Text="전표발행일자" Top="76" Width="84"></Image>
		<Static Height="13" Id="Static73" Left="315" Style="static" TabOrder="16" Text="~" Top="40" Width="10"></Static>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdEnd" Left="325" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="15" Top="40" WeeksFont="Default,-1" Width="90"></Calendar>
		<Image Align="Left" Height="18" Id="Image7" ImageID="blt" Left="665" LeftMargin="12" Style="blt_search" TabOrder="17" Text="이체일자" Top="76" Width="64"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_Transfer_Ymd" Left="733" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="18" Top="75" WeeksFont="Default,-1" Width="88"></Calendar>
		<Image Align="Left" Height="18" Id="Image2" ImageID="blt" Left="157" LeftMargin="12" Style="blt_search_Indis" TabOrder="19" Text="승인일자" Top="40" Width="61"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdStart" Left="224" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="14" Top="40" WeeksFont="Default,-1" Width="90"></Calendar>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi_Bill" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="844" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="150" Id="grd_list" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" OnHeadClick="grd_list_OnHeadClick" Right="1248" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="20" TabStop="true" Top="694" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1243">
			<contents>
				<format id="Default">
					<columns>
						<col width="30"/>
						<col width="120"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
					</columns>
					<head>
						<cell col="0" display="text" text="NO"/>
						<cell col="1" display="text" text="시공회사"/>
						<cell bkcolor="user11" col="2" display="text" text="총액(원)"/>
						<cell col="3" display="text" text="공사비(원)"/>
						<cell col="4" display="text" text="간접복구비(원)"/>
						<cell col="5" display="text" text="직접복구비(원)"/>
						<cell col="6" display="text" text="휴일대기비용(원)"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="currow&#32;+&#32;1"/>
						<cell align="left" col="1" colid="WORK_FIRM_CD_NM" display="text"/>
						<cell col="2" colid="WORK_AMT_SUM" display="number"/>
						<cell col="3" colid="WORK_AMT" display="number"/>
						<cell col="4" colid="IND_RC_AMT" display="number"/>
						<cell col="5" colid="DIR_RC_AMT" display="number"/>
						<cell col="6" colid="HOLI_AMT" display="number"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="12" Id="Image5" ImageID="blt_8" Left="9" LeftMargin="12" Style="text_title" TabOrder="21" Text="정비보수작업&#32;내역" Top="81" Width="130"></Image>
		<Image Align="Left" Height="12" Id="Image1" ImageID="blt_8" Left="12" LeftMargin="12" Style="text_title" TabOrder="22" Text="정비보수작업&#32;시공회사별&#32;집계" Top="678" Width="198"></Image>
		<Image Align="Left" Height="18" Id="Image12" ImageID="blt" Left="438" LeftMargin="12" Style="blt_search" TabOrder="24" Text="시공사" Top="40" Width="61"></Image>
		<Edit Border="Flat" Height="18" Id="edt_WorkFirmCdSearch" ImeMode="none" Left="491" OnChar="edt_WorkFirmCdSearch_OnChar" Style="edit" TabOrder="25" Top="40" Width="85"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_WorkFirmNmSearch" ImeMode="none" Left="577" Style="edit" TabOrder="26" Top="40" Width="150"></Edit>
		<Button Cursor="HAND" Height="18" Id="btn_WorkFirmCdSearch" ImageID="search" Left="728" OnClick="btn_WorkFirmCdSearch_OnClick" TabOrder="27" Text="Button8" Top="40" Width="18"></Button>
		<Grid BindDataset="ds_Bill_Req" BkColor2="default" BoldHead="true" Bottom="552" Enable="true" EndLineColor="default" Height="120" Id="Grid0" InputPanel="FALSE" Left="32" LineColor="default" Right="704" TabOrder="28" TabStop="true" Top="432" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="672">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="BRANCH_CD"/>
					<cell col="1" display="text" text="WORK_FIRM_CD"/>
					<cell col="2" display="text" text="REQ_YMD_START"/>
					<cell col="3" display="text" text="REQ_YMD_END"/>
					<cell col="4" display="text" text="BILL_YMD"/>
					<cell col="5" display="text" text="BILL_SEQ"/>
					<cell col="6" display="text" text="UPD_EMPID"/>
					<cell col="7" display="text" text="UPD_IP"/>
				</head>
				<body>
					<cell col="0" colid="BRANCH_CD" display="text"/>
					<cell col="1" colid="WORK_FIRM_CD" display="text"/>
					<cell col="2" colid="REQ_YMD_START" display="text"/>
					<cell col="3" colid="REQ_YMD_END" display="text"/>
					<cell col="4" colid="BILL_YMD" display="text"/>
					<cell col="5" colid="BILL_SEQ" display="text"/>
					<cell col="6" colid="UPD_EMPID" display="text"/>
					<cell col="7" colid="UPD_IP" display="text"/>
				</body>
			</contents>
		</Grid>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1605040010F.xml
* Form 설명  : 정비보수 정산승인목록
* 시스템 명  : 안전공급 (D1)
* 작성자     : 정대권 
* 작성일     : 2009-01-20
* 변경내용   : 
****************************************************************************************************/
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONE50001.js";
#include "js::COMMONA10008.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var ClickRow = "";
/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
//--------------------------------------------------------------------------------------------------
//	OnLoadCompleted
//--------------------------------------------------------------------------------------------------

function D1605030010F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
    fn_Init();
    gfn_D1_SetGrid_Sort(grd_Mainter);
    btn_Button.Enable = false;
    
	grd_Mainter.NoDataText = gfn_GetMessage("M000022","%AAA%","조회결과가");
	    
}
/*===============================================================================
 * 기      능   :  공통 코드 셋팅
===============================================================================*/
function fn_Init()
{
	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_Branchcd"));		//지사코드
	
	if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") {
		cob_Branchcd.Enable = true;
		cob_Branchcd.Index=0;
		
	}else{
		cob_Branchcd.Value = gfn_GetGlobalValue("G_BRANCH_CD");
		cob_Branchcd.Enable = false;
	} 	
	
	cal_ReqYmdStart.Value = addMonth(substr(today(),0,6)+"21", -1) ;		 // 전월 21일
	cal_ReqYmdEnd.Value = substr(today(),0,6)+"20"; // 해당날의 마지막날 구하기
	
}
// 검색 시공사코드 삭제시 시공사명도 같이 삭제 
function edt_WorkFirmCdSearch_OnChar(obj,strPreText,nChar,strPostText,LLParam,HLParam)
{
	if( nChar == '8' || nChar == '46')
	{
		edt_WorkFirmCdSearch.Text = "";
		edt_WorkFirmNmSearch.Text = "";
	}
	
}

// 정비보수업체 팝업
function btn_WorkFirmCdSearch_OnClick(obj)
{
	var args =  "BRANCH_CD=" + quote(cob_Branchcd.Value);
	
	var strResult = gfn_Dialog("D10","D1601010018U",args,-1,-1,true,-1,-1);
	
	if( length(strResult) > 0 )
	{
		
		edt_WorkFirmCdSearch.Text = strResult[0];  // 업체코드
		edt_WorkFirmNmSearch.Text = strResult[1]; // 업체명
	}

}
/*===============================================================================
 * 기      능   :  공통 조회
===============================================================================*/
function fn_CommonSearch()
{
	fn_D1_List();

	btn_Button.Enable = false;
}

/*===============================================================================
 * 기      능   :  조회
===============================================================================*/
function fn_D1_List()
{	

	if(gfn_IsNull(cob_Branchcd.Value))
	{
		alert("조회시 지사코드는 필수입력사항입니다.");
		cob_Branchcd.SetFocus();
		return;
	}
	
	if(gfn_IsNull(cal_ReqYmdStart.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdStart.SetFocus();
		return;
	}
	
	if(gfn_IsNull(cal_ReqYmdEnd.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdEnd.SetFocus();
		return;
	}
	
	ds_Multi.ClearData();
	ds_Multi_Bill.ClearData();
	ds_ACNT_CD.ClearData();
	
    ds_SearchTop.SetColumn(0,"BRANCH_CD"          , cob_BranchCd.Value        );  // 지사
	ds_SearchTop.SetColumn(0,"WORK_FIRM_CD"       , edt_WorkFirmCdSearch.Text );  // 시공사
    ds_SearchTop.SetColumn(0,"REQ_YMD_START"      , cal_ReqYmdStart.Value     );  // 작업요청일자
    ds_SearchTop.SetColumn(0,"REQ_YMD_END"        , cal_ReqYmdEnd.Value       );  // 작업요청일자

	
	var strSvcID = "findList";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1_MaintRepaiApproMgr-service";  															
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi=ds_Multi ds_Multi_Bill=ds_Multi_Bill ds_ACNT_CD=ds_ACNT_CD";
	var strArgument    = "searchList=1";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			    );
					    
}

/*===============================================================================
 * 기      능   :  공통 Excel
===============================================================================*/
function fn_CommonExcelExport()
{

	if(gfn_IsNull(cal_ReqYmdStart.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdStart.SetFocus();
		return;
	}
	
	if(gfn_IsNull(cal_ReqYmdEnd.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdEnd.SetFocus();
		return;
	}
	
	
	var SearchCondition= "";
    SearchCondition = SearchCondition + "지사코드 :" + RPad(cob_BranchCd.Text," ",20);
    SearchCondition = SearchCondition + "승인일자 :" + RPad(cal_ReqYmdStart.Text+'~'+cal_ReqYmdEnd.Text," ",20);
    gfn_ExportExcel("정비보수작업 전표등록", 5, SearchCondition, "grd_Mainter"); 	
    
}

//--------------------------------------------------------------------------------------------
//   검토 승인 후 전자 결제
//--------------------------------------------------------------------------------------------
function btn_Button_OnClick()
{
	var dangernum = ds_Multi.GetColumn(ds_Multi.row,"MAINTER_NUM");
	gfv_callGWInfo("fmD17","d10","",1,dangernum);
}

function grd_Mainter_OnCellClick(obj,nRow,nCell,nX,nY,nPivotIndex)
{
	btn_Button.Enable = true;
}

/*===============================================================================
 * 전표처리
===============================================================================*/ 
//-------------------------------------------------------------------------------
// 함수명: btn_Bill_OnClick()
//   설명: 전표 처리
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_bill_OnClick(obj)
{
	// if (gfn_GetGlobalValue("G_USER_NO") <> '19944397')
	// {
		// alert("프로그램 보완중입니다...");
		// return;
	// }
	
	// 2009-12-21 마감체크 추가 
	var strComId = gfn_GetGlobalValue("G_COM_ID");
	var strBizplc = gfn_GetGlobalValue("G_BIZPLACE");
	var strClsYmd = cal_BillYmd.Value;
	var massageYn = "Y";
	
	var Result  = gfn_E5_checkClsYn( strComId , strBizplc , strClsYmd , massageYn);
	
	if(Result == "1")
	{
		return;
	}
	
	if(!fn_D1_PreBill())
	{
		return false;
	}
	
	var strSvcID = "btn_bill_OnClick";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_AutoBillCreateMgr-service";
	var strInDatasets   = "ds_Multi=ds_BillDetail:u ds_Single=ds_BillHeader:u";
	var strOutDatasets  = "ds_BillDetail2=ds_Multi ds_BillHeader=ds_Single";
	var strArgument     = "insert=1";
	var strCallbackFunc = "fn_D1_CallBack";
	
	gfn_AsyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument,
	              strCallbackFunc
	              );
	   
}
//---------------------------------------------------------
//	
//---------------------------------------------------------
function fn_D1_PreBill()
{     		
	var cnt  = 0;
	var ccnt = 0;


	if(gfn_IsNull(cob_Branchcd.Value))
	{
		alert("조회시 지사코드는 필수입력사항입니다.");
		cob_Branchcd.SetFocus();
		return false;
	}
	
	if(gfn_IsNull(cal_ReqYmdStart.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdStart.SetFocus();
		return false;
	}
	
	if(gfn_IsNull(cal_ReqYmdEnd.Value))
	{
		alert("조회시 승인일자는 필수입력사항입니다.");
		cal_ReqYmdEnd.SetFocus();
		return false;
	}

	for(var i=0; i<ds_Multi_Bill.GetRowCount(); i++)
	{

		if(gfn_IsNull(ds_Multi_Bill.GetColumn(i, "BNK_NM")))
		{
			alert("지급 은행 정보가 존재하지 않습니다. 지불계좌 버튼을 이용하세요. ");
			return false;
		}
		
		if(gfn_IsNull(ds_Multi_Bill.GetColumn(i, "ACCOUNT_NUM")))
		{
			alert("지급계좌번호가 존재하지 않습니다. 지불계좌 버튼을 이용하세요. ");
			return false;
		}

	}
	
	if(ds_Multi_Bill.GetRowCount() == 0)
	{
		alert("전표 처리될 데이터가 없습니다. ");
		return false;
	}
	
	if(ds_ACNT_CD.GetRowCount() == 0)
	{
		alert("전표기초코드 데이터가 없습니다.[차변,대변코드 ds_ACNT_CD]");
		return false;
	}

	if(gfn_IsNull(trim(cal_BillYmd.Value)))
	{
		alert("전표발행일자를 선택하여 주십시오.");
		cal_BillYmd.SetFocus();
		return false;
	}

	if(gfn_IsNull(trim(cal_Transfer_Ymd.Value)))
	{
		alert("이체일자를 선택하여 주십시오.");
		cal_Transfer_Ymd.SetFocus();
		return false;
	}	    
	    
	// for(var i=0;i<ds_Multi.rowcount;i++){
	
		// if(ds_Multi.GetColumn(i,"CHK") == "1")
		// {						
			// cnt++;						
			// if(!gfn_IsNull(ds_Multi.GetColumn(i,"BILL_YMD")))
			// {
				// ccnt++;
			// }
		// }		
	// }    
    
	// if(cnt > 0 && ccnt == 0){
	fn_D1_MakeBillData();
	// }else{
		// if(cnt < 0 || cnt == 0 ){
			// alert(gfn_GetMessage("M000041")); //체크된 항목이 없습니다.
			// return false;
		// }
		// if(ccnt > 0){
			// alert("이미 전표생성된 자료가 포함되어있습니다");
			// return false;
		// }
	// }
	
	return true;
}
//---------------------------------------------------------
//	
//---------------------------------------------------------
function fn_D1_MakeBillData()
{

	var comId	 = gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd = gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  = cal_BillYmd.Value;
	var billSeq  = fn_D1_Tr_getBillSeq(comId,bizplcCd,billYmd);
		
	fn_D1_MakeBillDetail(comId,bizplcCd,billYmd,billSeq);
	fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq);
	
	
	// 자동전표등록후  MIS업데이트 칠 파라미터
	
	var strUPD_EMPID = gfn_GetGlobalValue("G_USER_NO");
	var strUPD_IP = gfn_GetLocalIpAddress();
			
	ds_Bill_Req.ClearData();
	var nRow = ds_Bill_Req.AddRow();
	ds_Bill_Req.SetColumn(nRow, "BRANCH_CD", 	ds_SearchTop.GetColumn(0 ,"BRANCH_CD"));
	ds_Bill_Req.SetColumn(nRow, "WORK_FIRM_CD", ds_SearchTop.GetColumn(0 ,"WORK_FIRM_CD"));
	ds_Bill_Req.SetColumn(nRow, "REQ_YMD_START",ds_SearchTop.GetColumn(0 ,"REQ_YMD_START"));
	ds_Bill_Req.SetColumn(nRow, "REQ_YMD_END", 	ds_SearchTop.GetColumn(0 ,"REQ_YMD_END"));
	ds_Bill_Req.SetColumn(nRow, "BILL_YMD", 	billYmd);
	ds_Bill_Req.SetColumn(nRow, "BILL_SEQ", 	billSeq);
	ds_Bill_Req.SetColumn(nRow, "UPD_EMPID",    strUPD_EMPID);
	ds_Bill_Req.SetColumn(nRow, "UPD_IP",       strUPD_IP);
}

//---------------------------------------------------------
//	
//---------------------------------------------------------
function fn_D1_Tr_getBillSeq(ComId,bizplcCd,billYmd)
{
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_getBillSeq(ComId,bizplcCd,billYmd)
	// 설명     : 전표번호를 리턴.
	// return 내용 : 4자리 문자형태의 전표번호 
	//-------------------------------------------------------------------------------
	
	ds_Com.Clear();
			
	var strSvcID = "fn_D1_Tr_find";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_NonBillCreateMgr-service";
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Com=ds_Multi";
	var strArgument     = "seqSelect=1";
		strArgument	   += " COM_ID="	+ quote(ComId);			//회사구분
	    strArgument    += " BIZPLC_CD=" + quote(bizplcCd);		//사업장코드
	    strArgument    += " NUMB_YMD="  + quote(billYmd);		//전표일자
	    strArgument    += " NUMB_FLAG=" + "10";		

	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	              
	if (  ErrorCode<0 )
	{
		alert(ErrorCode);
		return false;
		
	}
	else
	{
		if(ds_Com.RowCount()==0)
		{
			return "0001";	
		}
		else
		{
			return ds_Com.GetColumn(0,"BILL_SEQ");
		}
	}
}
//---------------------------------------------------------
//	
//---------------------------------------------------------
function fn_D1_MakeBillDetail(strComId,strBizplcCd,strBillYmd,strBillSeq)
{	
	var count    = 0;			//선택된 row만 체크하여 전표BILL_LINE생성해주기위한 변수
	var sumvalue = 0;			//선택된 row만 체크하여 발행금액합계를 구하기위한 변수
												
	ds_BillDetail.ClearData();		//실행되기전 데이터셋내의 모든 데이터를 삭제함.
	
	var str_ACNT_TITACNT_CD_CR     = ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_CR");  // 차변-- V4135911 (판매비및일반관리비-시설유지보수비)
	var str_ACNT_TITACNT_CD_CR_VAT = ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_CR1"); // 차변-- A72919   (선급제세-부가세)
	var str_ACNT_TITACNT_CD_DR     = ds_ACNT_CD.GetColumn(0,"ACNT_TITACNT_CD_DR");  // 대변-- J33117   (미지급금-일반)
	

	var str_DEAL_FLAG       = "";
	var str_DEAL_CD         = ""; 
	var str_BNK_BRANCH_CD   = ""; 
	var str_PLAN_YMD        = ""; 
	var str_PAY_ACCOUNT_NUM = ""; 
	var str_G_DEPT_CODE     = ""; 
	var str_APPLY           = ""; 
	var str_TOTAL_SUM       = "";
	var str_VAT		= "";
	
	var str_BRACH_NM = cob_BranchCd.Text;  // 지사명
	//var str_MONTH    = substr(cal_ReqYmdStart.Value,4,2) ; // 해당월
	//승인일자의 시작월 적용에 생성에서 전표발행년월로 변경 2010.4.11 정우현 과장
	var str_MONTH    = substr(cal_BillYmd.Value,4,2) ; // 해당월	
	var str_TRANSFER = cal_Transfer_Ymd.Value; // 이체일자

	for(var i=0; i<ds_Multi_Bill.rowcount; i++)					
	{	
		
		str_DEAL_FLAG       = ds_Multi_Bill.GetColumn(i, "DEAL_FLAG"        );  // 100 거래처구분(필)
		str_DEAL_CD         = ds_Multi_Bill.GetColumn(i, "WORK_FIRM_CD"     );  // 101 거래처(필)
		str_BNK_BRANCH_CD   = ds_Multi_Bill.GetColumn(i, "BNK_NM"           );  // 102 은행		
		//str_PLAN_YMD        = ds_Multi.GetColumn(ds_Multi.row, cal_BillYmd.Value  );  // 107 예정일자(필) 
		str_PAY_ACCOUNT_NUM = ds_Multi_Bill.GetColumn(i, "ACCOUNT_NUM"      );  // 108 지불계좌번호   
		str_G_DEPT_CODE     = gfn_GetGlobalValue("G_DEPT_CODE");
		str_TOTAL_SUM       = ds_Multi_Bill.GetColumn(i, "WORK_AMT_SUM"     );  // 정비보수 정산금액
		str_VAT		        = truncate(parseFloat(str_TOTAL_SUM) * 0.1);		      // 소숫점 절사
		str_APPLY           = str_BRACH_NM + ", "
							+ trim(ds_Multi_Bill.GetColumn(i, "WORK_FIRM_CD_NM")) + ", " 
							+ str_MONTH + "월 " 
							+ "시설물 유지보수비" 
							;
		//---------------------------------------------------------------------------------------------------------------------------
		gfn_E5_DatasetAddRow(ds_BillDetail);
							
		//공통(차변) - V4135911				
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"    , strComId);               //회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD" , strBizplcCd);            //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"  , strBillYmd);             //전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"  , strBillSeq);             //전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE" , LPAD((count+1),'0',4));	 //전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD", str_ACNT_TITACNT_CD_CR); //계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG" , "1");			 //차변으로 세팅
		ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY"     , str_APPLY);              //적요	
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,str_G_DEPT_CODE);          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,str_G_DEPT_CODE);
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_TOTAL_SUM  );	//미승인전표금액(점용료)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,""	     );
		sumvalue += toNumber(str_TOTAL_SUM);
		//공통(차변)
			
		//계정별관리항목에서 가져오는 선택값(차변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"          , strBillYmd); // 111 거래일자  (발행일자)
		//ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '01'      ); // 증빙구분(필수)
		//ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '11'      ); // 매입매출부가세코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , ''        ); // 증빙구분(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , ''        ); // 매입매출부가세코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"   , ''        ); // 116 원금액/공급가액
		ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"           , "400"     ); // 121 단위		
		//계정별관리항목에서 가져오는 선택값(차변) END												
		//---------------------------------------------------------------------------------------------------------------------------
		
		//---------------------------------------------------------------------------------------------------------------------------
		count ++;	
		
		// 부가세 A72919
		gfn_E5_DatasetAddRow(ds_BillDetail);
	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"    ,strComId);              		//회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD" ,strBizplcCd);           		//사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"  ,strBillYmd);            		//전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"  ,strBillSeq);            		//전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE" ,LPAD((count+1),'0',4));		//전표lINE
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD",str_ACNT_TITACNT_CD_CR_VAT);	//계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG" ,"1");						//차변으로 세팅	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY"     , str_APPLY);					//적요	
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,str_G_DEPT_CODE);          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,str_G_DEPT_CODE);
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",str_VAT);//미승인전표금액(점용료)
		sumvalue += toNumber(str_VAT);
		ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"1098131605");		
		//공통(차변)
		
		//계정별관리항목에서 가져오는 선택값(차변: 사유지점용료 부가세) START
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"         , str_DEAL_FLAG ); // 100 거래처구분(필)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"           , str_DEAL_CD   ); // 101 거래처(필)		 	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '01'          ); // 증빙구분(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '11'          ); // 매입매출부가세코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"          , strBillYmd    ); // 거래일자(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"   , str_TOTAL_SUM ); // 원금액/공급가액(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"QTY_PERS"          , "1"           ); // 수량/인원(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"	          , "400"  	      ); // 단위(필수)
		// 2010-03-31 황재혁 추가
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PAP_ELE_FLAG"	  , "2"  	      ); // 종이세금계산서(1), 전자세금계산서(2)
		
		
		//계정별관리항목에서 가져오는 선택값(대변: 사유지점용료 부가세) END
		count ++;

	
		//---------------------------------------------------------------------------------------------------------------------------	
		
		//---------------------------------------------------------------------------------------------------------------------------		
		gfn_E5_DatasetAddRow(ds_BillDetail);
				
		//공통(대변) - J33117	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           	//회사구분               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	        //사업장코드             
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            	//전표일자               
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            	//전표SEQ                
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,LPAD((count+1),'0',4));	//전표LINE
		ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,str_ACNT_TITACNT_CD_DR);	//계정코드
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"2");			//대변으로 세팅		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY",           str_APPLY);                //적요
		
		ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,str_G_DEPT_CODE);          
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,str_G_DEPT_CODE);    			
		ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",sumvalue);		//미승인전표금액(점용료)
		//공통(대변)
		
		//계정별관리항목에서 가져오는 선택값(대변) STSRT
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"         , str_DEAL_FLAG);      // 100 거래처구분(필)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"           , str_DEAL_CD);        // 101 거래처(필)
		//ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '01'); 			     // 증빙구분(필수)
		//ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '11'); 				 // 매입매출부가세코드	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , ''); 			     // 증빙구분(필수)
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , ''); 				 // 매입매출부가세코드	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"BNK_BRANCH_CD"     , str_BNK_BRANCH_CD);  // 102 은행
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PAY_WAY"	      	  , "20");               // 106 지불수단(필) - 자동이체 - 계좌이체
	
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PLAN_YMD"          , str_TRANSFER);       // 107 예정일자(필) *
		ds_BillDetail.SetColumn(ds_BillDetail.row,"PAY_ACCOUNT_NUM"   , str_PAY_ACCOUNT_NUM);// 108 지불계좌번호
		//계정별관리항목에서 가져오는 선택값(대변) END		
		//---------------------------------------------------------------------------------------------------------------------------
		count ++;
		
		sumvalue = 0;
	}
}

function fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq)
{
    //헤더추가
    ds_BillHeader.ClearData();

	gfn_E5_DatasetAddRow(ds_BillHeader);
	
	var DR_sum = 0;
	var CR_sum = 0;
	
	ds_BillHeader.SetColumn(ds_BillHeader.row,"COM_ID"             , comId   );  //회사구분
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BIZPLC_CD"          , bizplcCd);  //사업장
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_YMD"           , billYmd );  //전표일자 
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_SEQ"           , billSeq );  //전표번호                        
	ds_BillHeader.SetColumn(ds_BillHeader.row,"APPRO_YN"           , "N"     );  //승인여부
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_WRITE_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE")); //입력부서코드
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_KIND"          ,"2");        //전표종류 2:출금
	 //여기까지공통
	
	 //변경되는부분
	ds_BillHeader.SetColumn(ds_BillHeader.row,"SYS_FLAG"      ,"D1");           //시스템구분 D1:안전공급 
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_FLAG"     ,"404");          //전표구분   000:수전표
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_CRT_INFO" ,"D1605030010F"); //전표생성정보 D1605030010F : 전표등록프로그램
	ds_BillHeader.SetColumn(ds_BillHeader.row,"ACNT_FLAG"     ,'30');            //회계구분 3:공통         
	ds_BillHeader.SetColumn(ds_BillHeader.row,"DEL_YN"        ,"N");            //삭제구분 
	//여기까지변경되는부분
	
	for (var i=0 ; i<ds_BillDetail.rowcount ; i++)
	{
		drcrFlag = ds_BillDetail.GetColumn(i,"DRCR_FLAG");			 //차변		
		noApprAmt= toNumber(ds_BillDetail.GetColumn(i,"NO_APPRO_BILL_AMT"));	 //미승인전표금액(점용료금액) 
	    
	    if(drcrFlag=="1")
	    {
			DR_sum+=noApprAmt;						 //차변금액합계
	    }
	    else
	    {
			CR_sum+=noApprAmt;						 //대변금액합계
	    }
	
		ds_BillHeader.SetColumn(0,"TOT_LN_NUM"  ,ds_BillDetail.rowcount);	  //총행수
		ds_BillHeader.SetColumn(0,"FINL_LN_NUM" ,ds_BillDetail.Max("BILL_LINE")); //최종행수	
		ds_BillHeader.SetColumn(0,"DR_SUM_AMT"  ,DR_sum);			  //차변합계금액
		ds_BillHeader.SetColumn(0,"CR_SUM_AMT"  ,CR_sum);			  //대변합계금액                       
	}
}


//-------------------------------------------------------------------------------
// 함수명   : btn_billDel_OnClick()
// 설명     : 전표취소//조회 트렌젝션을 처리 fn_D1_CallBack으로 결과를 넘김.
// return 내용 : 없음
//-------------------------------------------------------------------------------
function btn_billDel_OnClick(obj)
{
 
 	var Cost = gfn_Dialog("D10","D1605030011U","",400,440,true,-1,-1); 
 	
}

//---------------------------------------------------------
//	전표등록후 UPDATE
//---------------------------------------------------------
function fn_D1_billUpdate()
{
		
	if( ds_Bill_Req.GetRowCount() <= 0) return;

	var strSvcID = "bill_req";
	var strPart  = "D10";	
	var strURL   = "handle.do?ServiceName=D1_MaintRepaiApproMgr-service";
	var strInDatasets  = "ds_Bill_Req=ds_Bill_Req:u";
	var strOutDatasets = "";
	var strArgument  = "bill_req=1";
	var strCallBackFunc = "fn_D1_CallBack";	
					
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallBackFunc
			   );
}

//--------------------------------------------------------------------------------------------------
//	서비스 CallBack
//--------------------------------------------------------------------------------------------------
function fn_D1_CallBack(svcId, ErrorCode, ErrorMsg)
{    

	if ( ErrorCode < 0 )
	{
		alert(ErrorMsg);
		return false;
	}
	switch(svcId){	

		case "fn_D1_Tr_find":	    
			//조회 성공메세지 출력
			if (ds_Multi.RowCount() > 0) {
				gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true);		//"조회를 완료하였습니다."
			} else {
				gfn_SetStatusMsg(gfn_GetMessage("M000008","%AAA%","조회결과 데이터가"),"black",true);	//"조회결과데이터가없습니다."
			}
			break;	
			
		case "btn_bill_OnClick": //전표생성후
			fn_D1_billUpdate();
			break;	
			
		case "bill_req": // MIS업데이트
		
			var fv_BILL_YMD = ds_Bill_Req.GetColumn(0,"BILL_YMD");	
			var fv_BILL_SEQ = ds_Bill_Req.GetColumn(0,"BILL_SEQ");
			alert(" (발행일자:"+fv_BILL_YMD +", 전표번호:" +fv_BILL_SEQ+") 자동전표가 발행되었습니다. ");
			cal_Transfer_Ymd.Value = "";
			cal_BillYmd.Value = "";
			ds_Bill_Req.ClearData();
			fn_CommonSearch();
			break;	
						
	}
	

}

//-----------------------
//  체크박스 체크
//-----------------------
function grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_GridSelChk(obj, "CHK");
}
//-------------------------------------------------------------------------------
// 함수명   : Button212_OnClick()
// 설명     : 지불계좌 등록
// return 내용 : 없음
//-------------------------------------------------------------------------------
function Button212_OnClick(obj)
{
	 var strPrefix = "E40";
	 var strFormid = "E4201010010F";
	 var strArg    = "" ;
	     
	gfn_NewWindow(strPrefix, strFormid, strArg, "지불계좌 등록", strFormid, "", 0, "");
}
]]></Script>
</Window>