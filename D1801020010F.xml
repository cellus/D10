<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="728" Id="D1801020010F" Left="8" OnLoadCompleted="D1801020010F_OnLoadCompleted" PidAttrib="7" Title="사유지점용료일괄지급등록" Top="8" Ver="1.0" Width="1280" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_month">
				<Contents>
					<colinfo id="CD_ID" size="256" type="STRING"/>
					<colinfo id="CD_NAME" size="256" type="STRING"/>
					<record>
						<CD_ID>01</CD_ID>
						<CD_NAME>01</CD_NAME>
					</record>
					<record>
						<CD_ID>02</CD_ID>
						<CD_NAME>02</CD_NAME>
					</record>
					<record>
						<CD_ID>03</CD_ID>
						<CD_NAME>03</CD_NAME>
					</record>
					<record>
						<CD_ID>04</CD_ID>
						<CD_NAME>04</CD_NAME>
					</record>
					<record>
						<CD_ID>05</CD_ID>
						<CD_NAME>05</CD_NAME>
					</record>
					<record>
						<CD_ID>06</CD_ID>
						<CD_NAME>06</CD_NAME>
					</record>
					<record>
						<CD_ID>07</CD_ID>
						<CD_NAME>07</CD_NAME>
					</record>
					<record>
						<CD_ID>08</CD_ID>
						<CD_NAME>08</CD_NAME>
					</record>
					<record>
						<CD_ID>09</CD_ID>
						<CD_NAME>09</CD_NAME>
					</record>
					<record>
						<CD_ID>10</CD_ID>
						<CD_NAME>10</CD_NAME>
					</record>
					<record>
						<CD_ID>11</CD_ID>
						<CD_NAME>11</CD_NAME>
					</record>
					<record>
						<CD_ID>12</CD_ID>
						<CD_NAME>12</CD_NAME>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FPayNm" OnColumnChanged="ds_FPayNm_OnColumnChanged">
				<Contents>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="GOV_ROOM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_PAY_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="AGREE_SQUARE" size="256" summ="default" type="STRING"/>
					<colinfo id="PERSO_PUBLIC_PRC" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_RT" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_DAY_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="CALCU_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_TOT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="INST_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_PAY_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPOSITOR_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ACCOUNT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_CLASS_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_CLASS" size="256" summ="default" type="STRING"/>
					<colinfo id="VAT_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_DR" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_PAY_YMD1" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPOSITOR_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="BNK_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="ACNT_TITACNT_CD_CR1" size="256" summ="default" type="STRING"/>
					<colinfo id="AGREE_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Y_Count">
				<Contents>
					<colinfo id="YEAR_COUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_M_Count">
				<Contents>
					<colinfo id="MONTH_COUNT" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Count">
				<Contents>
					<colinfo id="NCOUNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Com">
				<Contents>
					<colinfo id="LOAN_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FNC_PROD_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillHeader">
				<Contents>
					<colinfo id="COM_ID" size="255" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" type="STRING"/>
					<colinfo id="UPD_IP" size="255" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" type="STRING"/>
					<colinfo id="CRT_IP" size="255" type="STRING"/>
					<colinfo id="APPRO_YN" size="255" type="STRING"/>
					<colinfo id="ACNT_YMD" size="255" type="STRING"/>
					<colinfo id="ACNT_BILL_SEQ" size="255" type="STRING"/>
					<colinfo id="TOT_LN_NUM" size="255" type="DECIMAL"/>
					<colinfo id="FINL_LN_NUM" size="255" type="STRING"/>
					<colinfo id="DR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="CR_SUM_AMT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_WRITE_DEPT_CD" size="255" type="STRING"/>
					<colinfo id="BILL_KIND" size="255" type="STRING"/>
					<colinfo id="SYS_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_FLAG" size="255" type="STRING"/>
					<colinfo id="BILL_CRT_INFO" size="255" type="STRING"/>
					<colinfo id="ACNT_FLAG" size="255" type="STRING"/>
					<colinfo id="DEL_YN" size="255" type="STRING"/>
					<colinfo id="ADJ_CNT" size="255" type="DECIMAL"/>
					<colinfo id="OUTPUT_CNT" size="255" type="DECIMAL"/>
					<colinfo id="BILL_OUTPUT_DTM" size="255" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetailDelete"></Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDelete">
				<Contents>
					<colinfo id="COM_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Modify">
				<Contents>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_VAT_BIZPLC" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_YM" size="256" summ="default" type="STRING"/>
					<colinfo id="TXBILL_PUBL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_PAY_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BillDetail2">
				<Contents>
					<colinfo id="COM_ID" size="255" summ="default" type="STRING"/>
					<colinfo id="BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPNM" size="255" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="255" summ="default" type="STRING"/>
					<colinfo id="DRCR_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="TITACNT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_APPRO_BILL_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="APPLY" size="255" summ="default" type="STRING"/>
					<colinfo id="FIRM_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPART_DPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PASS_DEPT_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="EST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BNK_BRANCH_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEPST_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="OTHER_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="CHECK_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="QTY_PERS" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="UNIT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="INT_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CAPI_SUPPLY_VAL" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="CURCY_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="EXCHG_RT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="FORGCURCY_AMT" size="255" summ="default" type="DECIMAL"/>
					<colinfo id="PERIOD_FROM_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PERIOD_TO" size="255" summ="default" type="STRING"/>
					<colinfo id="NO_CLOSE_ACNT_UNITY_YN" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="ALT_OBJ_BILL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_WAY" size="255" summ="default" type="STRING"/>
					<colinfo id="PAY_ACCOUNT_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="EVIDENCE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="CARD_NUM" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_KIND" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_NO" size="255" summ="default" type="STRING"/>
					<colinfo id="PUBL_PROPO_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_STS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_PUBL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="NOTE_EXPIRE_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="MANAGE_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SITE_CD_NM" size="255" summ="default" type="STRING"/>
					<colinfo id="CONST_ASSET_COST_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CHG_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="ASSET_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="PROJECT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_SALES_VAT_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="BUY_NOEXEC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SALES_VAT_CLASS_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="VAT_BIZPLC" size="255" summ="default" type="STRING"/>
					<colinfo id="SUSPENSE_TXBILL_FLAG" size="255" summ="default" type="STRING"/>
					<colinfo id="PLAN_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="RCV_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_BIZPLC_CD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_YMD" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_SEQ" size="255" summ="default" type="STRING"/>
					<colinfo id="SND_ACNT_BILL_LINE" size="255" summ="default" type="STRING"/>
					<colinfo id="DEAL_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="FND_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="LOAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="REC_PLAN_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="BILL_APPRO_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="PAY_YEAR" size="256" summ="default" type="STRING"/>
					<colinfo id="FACI_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="BACK_YEAR" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Shape BKColor="user6" Bottom="69" Height="39" Id="Shape1" Left="5" LineColor="user7" Right="1271" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="6" Top="30" Type="RoundRect" Width="1266"></Shape>
		<Shape BKColor="user8" Bottom="64" Height="29" Id="Shape2" Left="10" LineWidth="0" Right="1267" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="7" Top="35" Type="Rectangle" Width="1257"></Shape>
		<Image Align="Left" Color="blue" Height="18" Id="Image7" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search" TabOrder="1" Text="지사" Top="40" Width="84"></Image>
		<Image Align="Left" Color="blue" Height="18" Id="Image3" ImageID="blt" Left="205" LeftMargin="12" Style="blt_search" TabOrder="2" Text="시/구" Top="40" Width="95"></Image>
		<Shape BKColor="#6cbae1" Bottom="98" Height="3" Id="Shape0" Left="8" LineWidth="0" Right="1271" TabOrder="3" Top="95" Type="Rectangle" Width="1263"></Shape>
		<Image Align="Left" Height="10" Id="Image5" ImageID="blt_8" Left="5" LeftMargin="12" Style="text_title" TabOrder="4" Text="당월지급대상(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;)&#32;/&#32;당년지급대상(&#32;&#32;&#32;&#32;&#32;&#32;&#32;&#32;)" Top="75" Width="305"></Image>
		<Combo Border="Flat" Height="18" Id="cob_CountyFlag" Left="251" Style="combo_indis" TabOrder="5" Top="40" Width="140"></Combo>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="8" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1269">
			<Contents></Contents>
		</Div>
		<Combo Border="Flat" Height="18" Id="cob_ObjectFlag" Left="56" OnChanged="cob_BranchCd_OnChanged" Style="combo_indis" TabOrder="9" Top="40" Width="140"></Combo>
		<Static Align="Center" BindDataset="ds_M_Count" Column="MONTH_COUNT" Height="13" Id="Static0" Left="105" Style="text_title" TabOrder="10" Text="0건" Top="74" Width="32"></Static>
		<Static Align="Center" BindDataset="ds_Y_Count" Column="YEAR_COUNT" Height="13" Id="Static1" Left="253" Style="text_title" TabOrder="11" Text="0건" Top="74" Width="32"></Static>
		<Image Align="Left" Color="dimgray" Height="18" Id="Image10" ImageID="blt" Left="401" LeftMargin="12" Style="blt_search" TabOrder="12" Text="지급년월" Top="41" Width="84"></Image>
		<Calendar Border="Flat" Dateformat="yyyy-MM" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="Calendar0" Left="466" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="13" Top="41" WeeksFont="Default,-1" Width="72"></Calendar>
		<Grid AutoEnter="TRUE" BindDataset="ds_FPayNm" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="728" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="632" Id="Grid0" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" OnHeadClick="grd_List_OnHeadClick" Right="1271" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="14" TabStop="true" Top="96" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1263">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="50"/>
						<col fix="left" width="50"/>
						<col fix="left" width="80"/>
						<col fix="left" width="78"/>
						<col fix="left" width="57"/>
						<col fix="left" width="92"/>
						<col fix="left" width="80"/>
						<col fix="left" width="80"/>
						<col width="186"/>
						<col width="102"/>
						<col width="102"/>
						<col width="79"/>
						<col width="228"/>
						<col width="122"/>
						<col width="138"/>
						<col width="100"/>
						<col width="100"/>
						<col width="130"/>
						<col width="200"/>
						<col width="93"/>
						<col width="80"/>
					</columns>
					<head>
						<cell col="0" display="checkbox" edit="checkbox"/>
						<cell col="1" display="normal" text="NO"/>
						<cell bkcolor="user11" col="2" display="text" text="정압실명"/>
						<cell col="3" display="text" text="지사"/>
						<cell col="4" display="text" text="시/구"/>
						<cell bkcolor="user11" col="5" display="text" text="설치년월"/>
						<cell col="6" display="text" text="부지분류"/>
						<cell col="7" display="text" text="납부시기"/>
						<cell bkcolor="user11" col="8" display="text" text="공시지가(원)"/>
						<cell col="9" display="text" text="점용면적(㎡)"/>
						<cell bkcolor="user11" col="10" display="text" text="점용요율(%)"/>
						<cell bkcolor="user11" col="11" display="text" text="점용일수"/>
						<cell col="12" display="text" text="산정금액(원)"/>
						<cell col="13" display="text" text="부가세(가산비율)"/>
						<cell col="14" display="text" text="점용료(원)"/>
						<cell bkcolor="user11" col="15" display="text" text="예금주"/>
						<cell col="16" display="text" text="은행명"/>
						<cell col="17" display="text" text="계좌번호"/>
						<cell col="18" display="text" Mask="비고" text="비고"/>
						<cell col="19" display="text" text="전표발행일자"/>
						<cell col="20" display="text" text="전표번호"/>
					</head>
					<body>
						<cell col="0" colid="CHK" display="checkbox" edit="checkbox"/>
						<cell align="center" col="1" colid="RNUM" display="normal" expandsize="18" expr="rowindex+1" text="0" wordwrap="word"/>
						<cell align="center" col="2" colid="GOV_ROOM_NM" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="BRANCH_NM" display="text"/>
						<cell align="center" col="4" colid="ZIP_NO1_NM" display="text"/>
						<cell align="center" col="5" colid="INST_YMD" display="date" expandsize="18" wordwrap="word"/>
						<cell align="center" col="6" colid="LEASE_CLASS_NM" display="text"/>
						<cell align="center" col="7" colid="LEASE_AMT_PAY_YMD1" display="text"/>
						<cell align="right" col="8" colid="PERSO_PUBLIC_PRC" display="number" edit="number" limit="8"/>
						<cell col="9" colid="AGREE_SQUARE" display="numberexp" expandsize="18" wordwrap="word"/>
						<cell align="center" col="10" colid="LEASE_RT" display="number" edit="number" expandsize="18" limit="3" wordwrap="word"/>
						<cell align="center" col="11" colid="LEASE_DAY_CNT" display="number" edit="number" expandsize="18" limit="3" wordwrap="word"/>
						<cell align="right" col="12" colid="CALCU_AMT" display="number" limit="10" text="0"/>
						<cell align="right" col="13" colid="VAT" display="number"/>
						<cell align="right" col="14" colid="PAY_TOT_AMT" display="number" limit="10" text="0"/>
						<cell align="center" col="15" colid="DEPOSITOR_NM1" display="text" expandsize="18" wordwrap="word"/>
						<cell align="center" col="16" colid="BNK_NM1" display="text"/>
						<cell align="center" col="17" colid="ACCOUNT_NUM" display="text"/>
						<cell col="18" colid="RMK" display="text" edit="normal"/>
						<cell align="center" col="19" colid="BILL_YMD" display="date"/>
						<cell align="center" col="20" colid="BILL_SEQ" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Button0" ImageID="btn_4_billreg" Left="1118" LeftMargin="21" OnClick="btn_bill_OnClick" Style="button" TabOrder="15" Text="전표등록" Top="73" Width="76"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_billDel" ImageID="btn_4_Close&#32;cancellation" Left="1195" LeftMargin="21" OnClick="btn_billDel_OnClick" Style="button" TabOrder="16" Text="전표취소" Top="73" Width="76"></Button>
		<Image Align="Left" Height="16" Id="Image4" ImageID="blt" Left="938" LeftMargin="12" Style="blt_search" TabOrder="18" Text="전표발행일자" Top="75" Width="84"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_BillYmd" Left="1028" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="17" Top="73" WeeksFont="Default,-1" Width="88"></Calendar>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1802030010F.xml
* Form 설명  : 사유지점용료 일괄지급등록 상세 조회
* 시스템 명  : 안전공급 (D1)
* 작성자     : 정주혜 
* 작성일     : 2008-12-11
* 변경내용   : 
****************************************************************************************************/

#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONE50001.js";

function D1801020010F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
	fn_CommonSearch();  //  초기조회
} 

//---------------------------------------------------------
//	초기 설정
//---------------------------------------------------------
function fn_Init()
{
	  gfn_D1_All_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_ObjectFlag"));
		
	  if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") {
		cob_ObjectFlag.Enable = true;
		cob_ObjectFlag.Value = "";
	 } else {
		 cob_ObjectFlag.Value = gfn_GetGlobalValue("G_BRANCH_CD");
		 cob_ObjectFlag.Enable = false;
	 }
	 
	 Calendar0.Value = today();
	 
	cob_BranchCd_OnChanged();	
	fn_D1_Find();
}

/********************************************************************************
* 기      능   :  지사별 구를 조회하여 콤보박스에 셋팅
********************************************************************************/
function cob_BranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) {

    fn_SetComboBox_Comcode("1", cob_ObjectFlag.Value, fn_setDsObject_Comcode("1", "cob_CountyFlag"));
    cob_CountyFlag.Value = "";
}

/*===============================================================================
 * 공통 div_ComHead 에서 버튼 이벤트
		추가	fn_CommonAddRow
		삭제	fn_CommonDeleteRow
		저장	fn_CommonSave
		조회	fn_CommonSearch
		엑셀	fn_CommonExcelExport
		인쇄	fn_CommonPrint
		닫기	공통에서 처리
===============================================================================*/ 

/*===============================================================================
 * 함수명: fn_CommonAddRow()
   설명: 탭별  내용를 신규 추가 하는 모드로 변경 하는 함수
   return 내용: 없음
===============================================================================*/ 
function fn_CommonAddRow()
{
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonExcelExport()
// 설명: 엑셀 button 실행, 조회된데이터를 엑셀형식으로변환한다
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonExcelExport()
{
	var SearchCondition= "";
    
    SearchCondition = SearchCondition + "지사 : "   + RPad(cob_ObjectFlag.Text          ," ",20);
    SearchCondition = SearchCondition + "시/구 :  " + RPad(cob_CountyFlag.Text          ," ",20);
    SearchCondition = SearchCondition + "지급월 : " + RPad(subStr(Calendar0.Value, 0, 6)," ",20);
        
    gfn_ExportExcel("사유지 점용료 지급일괄등록", 5, SearchCondition, "Grid0");             
}

//-------------------------------------------------------------------------------
// 함수명: fn_CommonExcelExport()
// 설명: 출력 button 실행, 조회된데이터를 출력한다
// arguments	없음
// return  없음
//-------------------------------------------------------------------------------
function fn_CommonPrint()
{
	PrintScreen();
}

//---------------------------------------------------------
//	공통 버튼 클릭 - 조회
//---------------------------------------------------------
function fn_CommonSearch()
{
	fn_D1_Find();
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  사유지 점용료 협의사항를 조회한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Find()
{	
    var strSvcID        = "fn_D1_Find";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_RentalBatchPaySpecSearMgr-service"
					    + "&LEASE_AMT_PAY_MONTH=" + subStr(Calendar0.Value, 0, 6)
					    + "&BRANCH_CD="           + cob_ObjectFlag.Value
					    + "&ZIP_NO1="             + cob_CountyFlag.Value 
					    ;
	var strInDatasets   = "";
	var strOutDatasets  = "ds_FPayNm=ds_FPayNm ds_M_Count=ds_M_Count ds_Y_Count=ds_Y_Count";
	var strArgument     = "view";
	 
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );	   
	
	if(ds_FPayNm.GetRowCount()	== 0){
		Grid0.NoDataText = gfn_GetMessage("M000009","%AAA%","조회를");
	}	   		
			   		
		for(var i=0; i<ds_FPayNm.GetRowCount(); i++){
			
			// 학교일경우 가산비율 사유지는 부가세
			if(ds_FPayNm.GetColumn(i, "LEASE_CLASS") == '30'){
				//Grid0.SetCellProp("head",5,"text","가산비율");
				if(ds_FPayNm.GetColCount(i, "LEASE_DAY_CNT") == '' || ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT") == null){
					ds_FPayNm.SetColumn(i, "LEASE_RT"      , 0.02 );
				}
				
				if(ds_FPayNm.GetColCount(i, "LEASE_DAY_CNT") == '' || ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT") == null){
					ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT" , '365');
				}
					ds_FPayNm.SetColumn(i, "VAT"           , 120/100  );
			}	
			
			if(ds_FPayNm.GetColumn(i, "LEASE_CLASS") == '20'){
				//Grid0.SetCellProp("head",5,"text","부가세");			
				
				if(ds_FPayNm.GetColCount(i, "LEASE_DAY_CNT") == '' || ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT") == null){
					ds_FPayNm.SetColumn(i, "LEASE_RT"      , 0.02 );
				}
				
				if(ds_FPayNm.GetColCount(i, "LEASE_DAY_CNT") == '' || ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT") == null){
					ds_FPayNm.SetColumn(i, "LEASE_DAY_CNT" , '365');
				}
				
				if(ds_FPayNm.GetColCount(i, "VAT") == '' || ds_FPayNm.SetColumn(i, "VAT") == null){
					ds_FPayNm.SetColumn(i, "VAT", null );
				}
			}
		}
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_Find()
//   설명  :  사유지 점용료 당년 지급대상을 를 조회한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Count(PAY_YEAR, FACI_NUM, BACK_YEAR)
{	
    var strSvcID        = "fn_D1_Find";
	var strPart         = "D10";	
	var strURL          = "handle.do?ServiceName=D1_RentalBatchPaySpecSearMgr-service"
					    + "&PAY_YEAR="  + PAY_YEAR
					    + "&FACI_NUM="  + FACI_NUM
					    + "&BACK_YEAR=" + BACK_YEAR
					    ;
	
	var strInDatasets   = "";
	var strOutDatasets  = "ds_Count=ds_Count";
	var strArgument     = "count";
	 
	gfn_syncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	return ds_Count.GetColumn(0, "NCOUNT");
}

//---------------------------------------------------------
//	공통 버튼 클릭 - 저장
//---------------------------------------------------------
function fn_CommonSave()
{
	fn_D1_Save();
}

//------------------------------------------------------------------------------- 
//   함수명: fn_D1_SAVE
//   설명  : 사유지 점용료 협의사항를 등록/업데이트한다.
//   arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_Save()
{	
	//-------------------------------------------------------------------------------
	//  Transition   : Service id
	//  ServicePart   : Service part
	//  Url   : Server url
	//  InputDsList   : Input Dataset List
	//  OutputDsList   : Output Dataset List
	//  Argument   :  Argument
	//-------------------------------------------------------------------------------

	var rowCount = ds_FPayNm.rowcount();		
	
	for(var i=0; i<rowCount; i++){
		if(ds_FPayNm.GetRowType(i) == 'normal'){
			alert("변경내역이 존재하지 않습니다. ");
			return;
		}
		
		if(ds_FPayNm.GetColumn(i, "PERSO_PUBLIC_PRC")=='' || ds_FPayNm.GetColumn(i, "PERSO_PUBLIC_PRC") == null){
				alert("공시지가금액을 입력하세요. ");
				return;
			}
			
			if(ds_FPayNm.GetColumn(i, "LEASE_RT")=='' || ds_FPayNm.GetColumn(i, "LEASE_RT") == null){
				alert("점용요율을 입력하세요. ");
				return;
			}
			
			if(ds_FPayNm.GetColumn(i, "LEASE_DAY_CNTC")=='' || ds_FPayNm.GetColumn(i, "LEASE_DAY_CNT") == null){
				alert("점용일수를 입력하세요. ");
				return;
			}	
	}
	
	for(var i=0; i<rowCount; i++){
				
		ds_FPayNm.SetColumn(i, "UPD_EMPID"       , gfn_GetGlobalValue("G_USER_NO"));    //수정IP
		ds_FPayNm.SetColumn(i, "UPD_IP"          , gfn_GetGlobalValue("G_IPADDRESS"));  //수정자 
		ds_FPayNm.SetColumn(i, "CRT_EMPID"       , gfn_GetGlobalValue("G_USER_NO"));    //수정IP
		ds_FPayNm.SetColumn(i, "CRT_IP"          , gfn_GetGlobalValue("G_IPADDRESS"));  //수정자 
		ds_FPayNm.SetColumn(i, "LEASE_AMT_PAY_YN", "N");
		ds_FPayNm.SetColumn(i, "BACK_YEAR"       , ds_FPayNm.GetColumn(i, "PAY_YEAR"));
						
		var result = fn_D1_Count(ds_FPayNm.GetColumn(i, "PAY_YEAR"), ds_FPayNm.GetColumn(i, "FACI_NUM"), ds_FPayNm.GetColumn(i, "BACK_YEAR"));
				
		ds_FPayNm.UpdateControl = false;
		
		if(result > 0){
			ds_FPayNm.SetRowType(i, "update");
		}else{
			ds_FPayNm.SetRowType(i, "insert");
		}
		
	}
	
	var strSvcID         = "";
	var strPart          = "D10";	
	var strURL           = "handle.do?ServiceName=D1_RentalBatchPaySpecSearMgr-service" ;
	var strInDatasets    = "ds_FPayNm=ds_FPayNm:u";
	var strOutDatasets   = "";		
	var strArgument      = "save";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart  	 
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	if(ErrorCode<0)
	{
		return false;
	}
	
	alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true);
	fn_D1_Find();
}

function Grid0_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_D1_SetGrid_Sort(Grid0);
}

function ds_FPayNm_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{	
	// 학교일경우 가산비율 (부가세없음)
	if(ds_FPayNm.GetColumn(nRow, "LEASE_CLASS") == '30'){
		if(strColumnID == 'PERSO_PUBLIC_PRC' || strColumnID == 'AGREE_SQUARE' || strColumnID == 'LEASE_RT' || strColumnID == 'LEASE_DAY_CNT'){	
			var PERSO_PUBLIC_PRC = ds_FPayNm.GetColumn(nRow, "PERSO_PUBLIC_PRC"); // 개별공지시가
			var AGREE_SQUARE     = ds_FPayNm.GetColumn(nRow, "AGREE_SQUARE"    ); // 점용면적
			var LEASE_RT         = ds_FPayNm.GetColumn(nRow, "LEASE_RT"        ); // 요율
			var LEASE_DAY_CNT    = ds_FPayNm.GetColumn(nRow, "LEASE_DAY_CNT"   ); // 사용일수
			var VAT	       		 = ds_FPayNm.GetColumn(nRow, "VAT"             ); // 부가세
			var CALCU_AMT        = ''; // 산정금액
			var PAY_TOT_AMT      = ''; // 점용료(백단위절삭)
			
			if(LEASE_RT == '' || LEASE_RT == null){
				LEASE_RT = '1';
			}
			
			CALCU_AMT =  parseInt  (PERSO_PUBLIC_PRC  ) 
					  *  parseFloat(AGREE_SQUARE      ) 
					  *  parseFloat(LEASE_RT          )
					  * (parseFloat(parseInt(LEASE_DAY_CNT)/365))
					  *  parseFloat("1.2")
					  ;
			
			CALCU_AMT = round(CALCU_AMT);
			
			PAY_TOT_AMT = parseInt(CALCU_AMT);		 
			//PAY_TOT_AMT = round(round(PAY_TOT_AMT) * 0.1) * 10;
				
			ds_FPayNm.SetColumn(nRow, "CALCU_AMT"  , CALCU_AMT  );
			ds_FPayNm.SetColumn(nRow, "PAY_TOT_AMT", PAY_TOT_AMT);
		}
	}
	
	if(ds_FPayNm.GetColumn(nRow, "LEASE_CLASS") == '20'){
		if(strColumnID == 'PERSO_PUBLIC_PRC' || strColumnID == 'AGREE_SQUARE' || strColumnID == 'LEASE_RT' || strColumnID == 'LEASE_DAY_CNT'){	
		var PERSO_PUBLIC_PRC = ds_FPayNm.GetColumn(nRow, "PERSO_PUBLIC_PRC"); // 개별공지시가
		var AGREE_SQUARE     = ds_FPayNm.GetColumn(nRow, "AGREE_SQUARE"    ); // 점용면적
		var LEASE_RT         = ds_FPayNm.GetColumn(nRow, "LEASE_RT"        ); // 요율
		var LEASE_DAY_CNT    = ds_FPayNm.GetColumn(nRow, "LEASE_DAY_CNT"   ); // 사용일수
		var VAT	       		 = ds_FPayNm.GetColumn(nRow, "VAT"             ); // 부가세
		var CALCU_AMT        = ''; // 산정금액
		var PAY_TOT_AMT      = ''; // 점용료(백단위절삭)
		
		if(LEASE_RT == '' || LEASE_RT == null){
			LEASE_RT = '1';
		}
		
		CALCU_AMT =  parseInt  (PERSO_PUBLIC_PRC  ) 
				  *  parseFloat(AGREE_SQUARE      ) 
				  *  parseFloat(LEASE_RT          )
				  * (parseFloat(parseInt(LEASE_DAY_CNT)/365))
				  ;
		
		CALCU_AMT = round(CALCU_AMT);		  
		
		VAT       = parseInt(Floor(parseInt(CALCU_AMT) * 0.1));
				
		// 부가세 사용유무에 따라
		if(ds_FPayNm.GetColumn(nRow, "VAT_YN") == "Y"){
				PAY_TOT_AMT = parseInt(CALCU_AMT) + parseInt(VAT);
				//PAY_TOT_AMT  = round(round(PAY_TOT_AMT) * 0.1) * 10;
				ds_FPayNm.SetColumn(nRow, "VAT", VAT);
		
		}else if(ds_FPayNm.GetColumn(nRow, "VAT_YN") == "N"){
				ds_FPayNm.SetColumn(nRow, "VAT", 0);
				//PAY_TOT_AMT  = round(round(PAY_TOT_AMT) * 0.1) * 10;
				PAY_TOT_AMT = parseInt(CALCU_AMT);		
		}			  
		
			ds_FPayNm.SetColumn(nRow, "CALCU_AMT"  , CALCU_AMT  );
			ds_FPayNm.SetColumn(nRow, "PAY_TOT_AMT", PAY_TOT_AMT);
		}
	}
}

//-----------------------
//  체크박스 체크
//-----------------------
function grd_List_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{	
	if(nCell > 0 || nCell > 1){
		//gfn_D1_SetGrid_Sort(Guid0);
		gfn_SetGridSort(obj, nCell);
	}
}

/*===============================================================================
 * 전표처리
===============================================================================*/ 
//-------------------------------------------------------------------------------
// 함수명: btn_Bill_OnClick()
//   설명: 전표 처리
// arguments   
//          obj: 사용된 객체를 전달 한다.
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function btn_bill_OnClick(obj)
{
	//-------------------------------------------------------------------------------
	// 함수명   : btn_bill_OnClick()
	// 설명     : 저장 트렌젝션을 처리 fn_E4_CallBack으로 결과를 넘김.
	// return 내용 : 없음
	//-------------------------------------------------------------------------------	
	
	// 2009-12-21 마감체크 추가 
	var strComId = gfn_GetGlobalValue("G_COM_ID");
	var strBizplc = gfn_GetGlobalValue("G_BIZPLACE");
	var strClsYmd = cal_BillYmd.Value;
	var massageYn = "Y";
	
	var Result  = gfn_E5_checkClsYn( strComId , strBizplc , strClsYmd , massageYn);
	
	if(Result == "1")
	{
		return;
	}
	
	if(!fn_D1_PreBill()){
		return false;
	}
		
	var strSvcID = "btn_bill_OnClick";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_AutoBillCreateMgr-service&insert=1"
				 ;
				 	
	var strInDatasets   = "";
	    strInDatasets  += "ds_Multi=ds_BillDetail:u ds_Single=ds_BillHeader:u";
	var strOutDatasets  = "";
	    strOutDatasets += "ds_BillDetail2=ds_Multi ds_BillHeader=ds_Single";
	var strArgument     = "";
	var strCallbackFunc = "fn_D1_CallBack";
	
	gfn_AsyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument,
	              strCallbackFunc);
}

function fn_D1_PreBill()
{     
	var cnt  = 0;
    var ccnt = 0;
    
 	if(cal_BillYmd.Value == '' ||  cal_BillYmd.Value = null){
		alert("전표발행일자를 지정하세요. ");
		return false;
	} 
    
    for(var i=0;i<ds_FPayNm.rowcount;i++){
	
		if(ds_FPayNm.GetColumn(i,"CHK") == "1"){
						
			cnt++;		
			if(ds_FPayNm.GetRowType(i) == "insert"){
				alert("추가된 내용을 저장 후 사용가능합니다");
				ds_FPayNm.Row = i;
				return;
			}
						
			if(!gfn_IsNull(ds_FPayNm.GetColumn(i,"BILL_YMD"))){
				ccnt++;
			}
		}		
    }    
    
	if(cnt > 0 && ccnt == 0){
		fn_D1_MakeBillData();
	}else{
		if(cnt < 0 || cnt == 0 ){
			alert(gfn_GetMessage("M000041"));//체크된 항목이 없습니다.
			return false;
		}
		if(ccnt > 0){
			alert("이미 전표생성된 자료가 포함되어있습니다");
			return false;
		}
	}
	return true;
}

function fn_D1_MakeBillData(){

	var comId		= gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd 	= gfn_GetGlobalValue("G_BIZPLACE");
	var billYmd  	= cal_BillYmd.Value;
	var billSeq  	= fn_D1_Tr_getBillSeq(comId,bizplcCd,billYmd);
		
	fn_D1_MakeBillDetail(comId,bizplcCd,billYmd,billSeq);
	fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq);
}

function fn_D1_Tr_getBillSeq(ComId,bizplcCd,billYmd)
{
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_getBillSeq(ComId,bizplcCd,billYmd)
	// 설명     : 전표번호를 리턴.
	// return 내용 : 4자리 문자형태의 전표번호 
	//-------------------------------------------------------------------------------
		
	var strSvcID = "fn_D1_Tr_find";
	var strPart  = "E50";
	var strURL   = "handle.do?ServiceName=E5_NonBillCreateMgr-service&seqSelect=1"
                 + "&COM_ID="		+ ComId			//회사구분
	             + "&BIZPLC_CD="	+ bizplcCd		//사업장코드
	             + "&NUMB_YMD=" 	+ billYmd		//전표일자
	             + "&NUMB_FLAG=" 	+ "10"			
	             ;
	 
	var strInDatasets   = "";
	var strOutDatasets  = "";
	    strOutDatasets += "ds_Com=ds_Multi";
	var strArgument     = "";

	gfn_SyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument);
	if (ErrorCode<0 )
	{
		return false;
		
	}else{
		if(ds_Com.RowCount()==0){
			return "0001";	
		}else{
			return ds_Com.GetColumn(0,"BILL_SEQ");
		}
	}
}

function fn_D1_MakeBillDetail(strComId,strBizplcCd,strBillYmd,strBillSeq)
{
	var count       = 0;												//선택된 row만 체크하여 전표BILL_LINE생성해주기위한 변수
	var sumvalue    = 0;												//선택된 row만 체크하여 발행금액합계를 구하기위한 변수												
												
	ds_BillDetail.ClearData();										//실행되기전 데이터셋내의 모든 데이터를 삭제함.
	
	for(var i=0;i<ds_FPayNm.rowcount;i++)					
	{	
		
		if(ds_FPayNm.GetColumn(i,"CHK") == "1"){					//ds_FPayNm의 선택된 row만 골라서 ds_BillDetail으로 복사.
				
			gfn_E5_DatasetAddRow(ds_BillDetail);
						
			//공통(차변)				
			ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"   ,strComId);               									//회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD",strBizplcCd);           									//사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD",strBillYmd);             									//전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ",strBillSeq);             									//전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE",LPAD((count+1),'0',4));									//전표lINE
			ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD",ds_FPayNm.GetColumn(i, "ACNT_TITACNT_CD_CR"));//계정코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG","1");														//차변으로 세팅
			if(ds_FPayNm.GetColumn(0, "LEASE_CLASS") == '30'){
				ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY",ds_FPayNm.GetColumn(i,"GOV_ROOM_NM") + " 정압실점용료 지로납부"); //적요
			}else{
				ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY",ds_FPayNm.GetColumn(i,"GOV_ROOM_NM") + " 정압실점용료"         ); //적요
			}
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD",gfn_GetGlobalValue("G_DEPT_CODE"));          
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD",gfn_GetGlobalValue("G_DEPT_CODE"));
			
			
			if(ds_FPayNm.GetColumn(0, "LEASE_CLASS") == '30'){
				ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",ds_FPayNm.GetColumn(i, "PAY_TOT_AMT"));// 미승인전표금액(점용료)
			}else{
				ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",ds_FPayNm.GetColumn(i, "CALCU_AMT"  ));// 미승인전표금액(점용료)
			}
			
			if(ds_FPayNm.GetColumn(0, "LEASE_CLASS") == '30'){
				sumvalue += toNumber(ds_FPayNm.GetColumn(i,"PAY_TOT_AMT"));											  //점용료 합계
			}else{
				sumvalue += toNumber(ds_FPayNm.GetColumn(i,"CALCU_AMT"));											  //점용료 합계
			}
			//공통(차변)
			
			//계정별관리항목에서 가져오는 선택값(차변) STSRT
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"          , ds_FPayNm.GetColumn(0, "AGREE_YMD")); 	  // 거래일자
			
			if(ds_FPayNm.GetColumn(0, "LEASE_CLASS") == '30'){
			ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '09'); // 증빙구분(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '00'); // 매입매출부가세코드	
			}else{
			ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '01'); // 증빙구분(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '11'); // 매입매출부가세코드
			}		
			ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"   ,  ""  ); // 116 원금액/공급가액
			ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"           , "400"); // 121 단위	
			//계정별관리항목에서 가져오는 선택값(차변) END												
			//---------------------------------------------------------------------------------------------------------------------------	
			count ++;
	
	    	//---------------------------------------------------------------------------------------------------------------------------
			if(ds_FPayNm.GetColumn(0, "TXBILL_PUBL_YN") == 'Y' && ds_FPayNm.GetColumn(0, "LEASE_CLASS") != '30'){ // 세금계산서 발행할 경우만 Y: 일반, N: 면세 영세없음	|| 사유지만 해당
	
			gfn_E5_DatasetAddRow(ds_BillDetail);
			
			//공통(차변)				
			ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"    		 ,strComId);              									//회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD" 		 ,strBizplcCd);           									//사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"  		 ,strBillYmd);            									//전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"  		 ,strBillSeq);            									//전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE" 		 ,LPAD((count+1),'0',4));									//전표lINE
			ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"		 ,ds_FPayNm.GetColumn(0,"ACNT_TITACNT_CD_CR1"));			//계정코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG" 		 ,"1");														//차변으로 세팅	
			ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY"            ,"정압실점용료, 부가세");								    //적요
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",ds_FPayNm.GetColumn(i,"VAT"));							//미승인전표금액(점용료)
			sumvalue += toNumber(ds_FPayNm.GetColumn(i,"VAT"));
			ds_BillDetail.SetColumn(ds_BillDetail.row,"VAT_BIZPLC"       ,"1098131605");		
			//공통(차변)
						
			//계정별관리항목에서 가져오는 선택값(차변: 사유지점용료 부가세) START
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"         , ds_FPayNm.GetColumn(i, "DEAL_FLAG"    )); // 거래처구분(필)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"           , ds_FPayNm.GetColumn(i, "DEPOSITOR_NM" )); // 거래처(필)		 	
			ds_BillDetail.SetColumn(ds_BillDetail.row,"EVIDENCE_FLAG"     , '01'                         		   ); // 증빙구분(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BUY_SALES_VAT_CD"  , '11'                      			   ); // 매입매출부가세코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_YMD"          , ds_FPayNm.GetColumn(i, "AGREE_YMD"    )); // 거래일자(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"CAPI_SUPPLY_VAL"   , ds_FPayNm.GetColumn(i, "CALCU_AMT"    )); // 원금액/공급가액(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"QTY_PERS"          , "1"                                    ); // 수량/인원(필수)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"UNIT_CD"		      , "400"								   ); // 단위(필수)
			//계정별관리항목에서 가져오는 선택값(대변: 사유지점용료 부가세) END										
			//---------------------------------------------------------------------------------------------------------------------------			
			count ++;			
			}
		}
	}
	
			gfn_E5_DatasetAddRow(ds_BillDetail);
			
			//공통(대변)				
			ds_BillDetail.SetColumn(ds_BillDetail.row,"COM_ID"           ,strComId   );           							//회사구분               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BIZPLC_CD"        ,strBizplcCd);	         							//사업장코드             
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_YMD"         ,strBillYmd );            							//전표일자               
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_SEQ"         ,strBillSeq );            							//전표SEQ                
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BILL_LINE"        ,LPAD((count+1),'0',4));			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"TITACNT_CD"       ,ds_FPayNm.GetColumn(ds_FPayNm.row,"ACNT_TITACNT_CD_DR"));			   //계정코드
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DRCR_FLAG"        ,"2");													   //대변으로 세팅		
						
			// 학교일경우에는 지로, 나머지는 계좌이체	
			if(ds_FPayNm.GetColumn(0, "LEASE_CLASS") == '30'){
				ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY"        ,"정압실점용료 지로납부"); //적요			
			}else{
				ds_BillDetail.SetColumn(ds_BillDetail.row,"APPLY"        ," 정압실점용료"		 ); //적요			
			}
			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"FIRM_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));          
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PASS_DEPT_CD"     ,gfn_GetGlobalValue("G_DEPT_CODE"));    			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"NO_APPRO_BILL_AMT",sumvalue);										//미승인전표금액(점용료)
			//공통(대변)
			
			//계정별관리항목에서 가져오는 선택값(대변) STSRT
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_FLAG"         , ds_FPayNm.GetColumn(ds_FPayNm.row, "DEAL_FLAG"     )); // 100 거래처구분(필)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"DEAL_CD"           , ds_FPayNm.GetColumn(ds_FPayNm.row, "DEPOSITOR_NM"  )); // 101 거래처(필)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"BNK_BRANCH_CD"     , ds_FPayNm.GetColumn(ds_FPayNm.row, "BNK_NM"        )); // 102 은행
			
			// 학교일경우에는 지로, 나머지는 계좌이체
			if(ds_FPayNm.GetColumn(i, "LEASE_CLASS") == '30'){
				ds_BillDetail.SetColumn(ds_BillDetail.row,"PAY_WAY"	      , "90"); // 106 지불수단(필)
			}else{
				ds_BillDetail.SetColumn(ds_BillDetail.row,"PAY_WAY"	      , "40"); // 106 지불수단(필)
			}
			
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PLAN_YMD"          , cal_BillYmd.Value									); // 107 예정일자(필)
			ds_BillDetail.SetColumn(ds_BillDetail.row,"PAY_ACCOUNT_NUM"   , ds_FPayNm.GetColumn(ds_FPayNm.row, "ACCOUNT_NUM"   )); // 108 지불계좌번호
			//계정별관리항목에서 가져오는 선택값(대변) END			
}

function fn_D1_MakeBillHeader(comId,bizplcCd,billYmd,billSeq)
{

    //헤더추가
    ds_BillHeader.ClearData();
	gfn_E5_DatasetAddRow(ds_BillHeader);
	
	var DR_sum = 0;
	var CR_sum = 0;
	
	ds_BillHeader.SetColumn(ds_BillHeader.row,"COM_ID"    , comId   );  //회사구분
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BIZPLC_CD" , bizplcCd);  //사업장
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_YMD"  , billYmd );  //전표일자 
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_SEQ"  , billSeq );  //전표번호                        
	ds_BillHeader.SetColumn(ds_BillHeader.row,"APPRO_YN"  , "N"     );  //승인여부
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_WRITE_DEPT_CD" ,gfn_GetGlobalValue("G_DEPT_CODE")); 
																		//입력부서코드
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_KIND" ,"3");        //전표종류 3:대체
	
	 //여기까지공통
	
	 //변경되는부분
	ds_BillHeader.SetColumn(ds_BillHeader.row,"SYS_FLAG" ,"D1");                //시스템구분 D1:안전공급 
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_FLAG" ,"410");              //전표구분   000:수전표
	ds_BillHeader.SetColumn(ds_BillHeader.row,"BILL_CRT_INFO" ,"D1801020010F"); //전표생성정보 D1801020010F : 전표등록프로그램
	ds_BillHeader.SetColumn(ds_BillHeader.row,"ACNT_FLAG" ,'30');                //회계구분 3:공통         
	ds_BillHeader.SetColumn(ds_BillHeader.row,"DEL_YN" ,"N");                   //삭제구분 
	//여기까지변경되는부분
	
	for (var i=0 ; i<ds_BillDetail.rowcount ; i++){
		drcrFlag = ds_BillDetail.GetColumn(i,"DRCR_FLAG");						//차변
		
		noApprAmt= toNumber(ds_BillDetail.GetColumn(i,"NO_APPRO_BILL_AMT"));	//미승인전표금액(점용료금액) 
	    
	    if(drcrFlag=="1"){
			DR_sum+=noApprAmt;													//차변금액합계
	    }else{
			CR_sum+=noApprAmt;													//대변금액합계
	    }
		
	}
	
	ds_BillHeader.SetColumn(0,"TOT_LN_NUM"  ,ds_BillDetail.rowcount);			//총행수
	ds_BillHeader.SetColumn(0,"FINL_LN_NUM" ,ds_BillDetail.Max("BILL_LINE"));	//최종행수	
	ds_BillHeader.SetColumn(0,"DR_SUM_AMT"  ,DR_sum);							//차변합계금액
	ds_BillHeader.SetColumn(0,"CR_SUM_AMT"  ,CR_sum);							//대변합계금액                       
}


//-------------------------------------------------------------------------------
// 함수명   : btn_billDel_OnClick()
// 설명     : 전표취소//조회 트렌젝션을 처리 fn_D1_CallBack으로 결과를 넘김.
// return 내용 : 없음
//-------------------------------------------------------------------------------
function btn_billDel_OnClick(obj)
{
 
    if(!confirm("발행된 전표를를 정말로 취소하시겠습니까? ")){
		return false;
	}
    
    var cnt  = 0;
    var ccnt = 0;
    
    for(var i=0;i<ds_FPayNm.rowcount;i++){
	
		if(ds_FPayNm.GetColumn(i,"CHK") == "1"){
						
			cnt++;		
			if(ds_FPayNm.GetRowType(i) == "insert"){
				alert("추가된 내용을 저장 후 사용가능합니다");
				ds_FPayNm.Row = i;
				return;
			}
						
			if(!gfn_IsNull(ds_FPayNm.GetColumn(i,"BILL_YMD"))){
				ccnt++;
			}
		}		
    }    
    
	if(cnt > 0 && ccnt > 0){
		    fn_D1_billDelete();
	}else{
		if(cnt < 0 || cnt == 0 ){
			alert(gfn_GetMessage("M000041"));//체크된 항목이 없습니다.
			return false;
		}
		
		if(ccnt < 0 || ccnt == 0 ){
			alert("이미 취소되거나 전표를 발행하지 않은 자료가 포함되어있습니다");
			return false;
		}
	}           
}

function fn_D1_billDelete(){

	var comId		= gfn_GetGlobalValue("G_COM_ID");
	var bizplcCd 	= gfn_GetGlobalValue("G_BIZPLACE");
    
	ds_BillDelete.ClearData();
	
	ds_BillDelete.AddColumn("COM_ID"    	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("BIZPLC_CD"    	   , "STRING"   , 256);	
	ds_BillDelete.AddColumn("BILL_YMD"     	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("BILL_SEQ"     	   , "STRING"   , 256);
	ds_BillDelete.AddColumn("SYS_FLAG"     	   , "STRING"   , 256);

	for(var i=0; i<ds_FPayNm.GetRowCount(); i++){
	
		if(ds_FPayNm.GetColumn(i,"CHK") == "1"){
		ds_BillDelete.AddRow();
			
		if(gfn_IsNull(trim(ds_FPayNm.GetColumn(i,"BILL_YMD")))){
			alert("전표가 발행되지 않아 취소 할 수 없습니다.");
			return;
		}else if(ds_FPayNm.GetColumn(i,"BILL_APPRO_YN") == '1'){
			alert("전표가 승인되어 취소 할 수 없습니다");
			return;
		}else{
			
			ds_BillDelete.SetColumn(ds_BillDelete.row,"COM_ID"    , comId);         							//회사구분
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BIZPLC_CD" , bizplcCd);         							//사업장
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_YMD"  , ds_FPayNm.GetColumn(i,"BILL_YMD"));  			//전표일자 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"BILL_SEQ"  , ds_FPayNm.GetColumn(i,"BILL_SEQ"));   		//전표번호 
			ds_BillDelete.SetColumn(ds_BillDelete.row,"SYS_FLAG"  ,"D1");   									//지급여부
		}}
	}			
	
	var strSvcID = "fn_D1_Tr_delete";
	var strPart  = "E50";
	var strURL ;
	    strURL = "handle.do?ServiceName=E5_AutoBillCreateMgr-service&delete=1";	 
	var strInDatasets   = "";
	    strInDatasets  += "ds_Single=ds_BillDelete:u ";
	var strOutDatasets  = "";
	   
	var strArgument     = "";
	var strCallbackFunc = "fn_D1_CallBack";	
	
	gfn_AsyncCall(strSvcID,
	              strPart,
	              strURL,
	              strInDatasets,
	              strOutDatasets,
	              strArgument,
	              strCallbackFunc
	);
	
	if(ErrorCode<0)
	{
		return false;
	}
		return true;
}

function fn_D1_billUpdate(value){
		
		var Flag = value;
		
		ds_Modify.ClearData();
		
		ds_Modify.AddColumn("UPD_EMPID"		    );
		ds_Modify.AddColumn("UPD_IP"	        );
		ds_Modify.AddColumn("BILL_APPRO_YN"     );
		ds_Modify.AddColumn("BILL_YMD"	        );
		ds_Modify.AddColumn("BILL_SEQ"	        );
		ds_Modify.AddColumn("TXBILL_VAT_BIZPLC" );
		ds_Modify.AddColumn("TXBILL_PUBL_YM"    );
		ds_Modify.AddColumn("TXBILL_PUBL_SEQ"   );
		ds_Modify.AddColumn("PAY_YEAR"		    );
		ds_Modify.AddColumn("FACI_NUM"		    );
		ds_Modify.AddColumn("LEASE_AMT_PAY_YN"  );
		ds_Modify.AddColumn("LEASE_AMT_PAY_YMD" );
		
		ds_Modify.UpdateControl = false;
	
		for(var i=0; i<ds_FPayNm.GetRowCount(); i++){
			if(ds_FPayNm.GetColumn(i,"CHK") == "1"){

				ds_Modify.AddRow();
				
				ds_Modify.SetColumn(ds_Modify.row, "UPD_EMPID"      , gfn_GetGlobalValue("G_USER_NO"));
				ds_Modify.SetColumn(ds_Modify.row, "UPD_IP"         , gfn_GetGlobalValue("G_IPADDRESS"));
						
				if(Flag = 'update'){
					ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN"     , 'N' );
					ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD"          , ds_BillDetail2.GetColumn(0, "BILL_YMD"    ));
					ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ"          , ds_BillDetail2.GetColumn(0, "BILL_SEQ"    ));
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC" , ds_BillDetail2.GetColumn(0, "VAT_BIZPLC"  ));
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM"    , ds_BillDetail2.GetColumn(0, "PUBL_YM"     ));
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ"   , ds_BillDetail2.GetColumn(0, "PUBL_SEQ"    ));
					ds_Modify.SetColumn(ds_Modify.row, "LEASE_AMT_PAY_YN"  , "Y");
					ds_Modify.SetColumn(ds_Modify.row, "LEASE_AMT_PAY_YMD" , ds_BillDetail2.GetColumn(0, "BILL_YMD"    ));
				}else{
					ds_Modify.SetColumn(ds_Modify.row, "BILL_APPRO_YN"    , ' ' );
					ds_Modify.SetColumn(ds_Modify.row, "BILL_YMD"         , ''  );
					ds_Modify.SetColumn(ds_Modify.row, "BILL_SEQ"         , ''  );			
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_VAT_BIZPLC", ''  );
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_YM"   , ''  );
					ds_Modify.SetColumn(ds_Modify.row, "TXBILL_PUBL_SEQ"  , ''  );
					ds_Modify.SetColumn(ds_Modify.row, "LEASE_AMT_PAY_YN" , 'N' );
					ds_Modify.SetColumn(ds_Modify.row, "LEASE_AMT_PAY_YMD", ''  );
				}
						
				ds_Modify.SetColumn(ds_Modify.row, "PAY_YEAR", ds_FPayNm.GetColumn(i, "PAY_YEAR"));	
				ds_Modify.SetColumn(ds_Modify.row, "FACI_NUM", ds_FPayNm.GetColumn(i, "FACI_NUM"));		
					
				ds_Modify.SetRowType(ds_Modify.row, "update");			
			}
		}
							
		var strSvcID         = "";
		var strPart          = "D10";	
		var strURL           = "handle.do?ServiceName=D1_RentalDiscuRmkRegisMgr-service" ;					
		var strInDatasets    = "ds_Modify=ds_Modify:u";
		var strOutDatasets   = "";		
		var strArgument      = "bill_update";
				
		gfn_SyncCall( 
						 strSvcID
					   , strPart  	 
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
				   );

	if(ErrorCode<0)
	{
		return false;
	}
		return true;	
}


function fn_D1_CallBack(svcId, ErrorCode, ErrorMsg)
{    
	//-------------------------------------------------------------------------------
	// 함수명   : fn_D1_CallBack(svcid, errcd, errmsg)
	// 설명     : 각 트렌젝션의 결과를 처리 .
	// return 내용 : 없음
	//-------------------------------------------------------------------------------
	//-------------------------------------------------------------------------------
    // svcid, errcd, errmsg 값 Transaction 함수에서 넘겨받음
    //-------------------------------------------------------------------------------
	if ( ErrorCode < 0 )
	{
		return false;
	}
	if ( ErrorCode <0 ){
	
		var tr_name;
		var tr_kname;
		
		switch(svcId){
			
			//조회 실패시
			case "fn_D1_Tr_find": 
				tr_name  ="find";
				tr_kname ="조회";
			break;	
		}
		
		//트렌젝션 메세지 출력
		alert(gfn_E5_GetDBErrorMsg(tr_name, ErrorMsg,tr_kname));
		return;
	}
	
	switch(svcId){	
	    case "fn_D1_Tr_find":	    
			//조회 성공메세지 출력
			if (ds_FPayNm.RowCount() > 0) {				
				gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true); 
			} else {
				gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","조회를"),"black",true); 
			}
			break;	
			
		case "btn_bill_OnClick": //전표생성후
			alert("전표가 발행되었습니다. ");
			fn_D1_billUpdate("update");
			fn_D1_Find();
			break;	
		case "fn_D1_Tr_delete": //업데이트 성공시 조회가 들어가므로 조회와 똑같이 처리 
			alert("전표가 취소되었습니다");
			fn_D1_billUpdate("delete"); 			
			fn_D1_Find();
			break;							
	}
}]]></Script>
</Window>