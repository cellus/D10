<?xml version="1.0" encoding="utf-8"?>
<Window>
	<Form Height="1008" Id="D1501010011F" Left="8" OnLoadCompleted="D1501010011F_OnLoadCompleted" PidAttrib="7" Title="위험작업요청등록&#32;가정관_D1501010011F" Top="8" Ver="1.0" Width="1270" WorkArea="false">
		<Datasets>
			<Dataset DataSetType="Dataset" Id="ds_Multi" OnLoadCompleted="ds_Multi_OnLoadCompleted" OnRowPosChanged="ds_Multi_OnRowPosChanged">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_2" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_KIND_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_YMD1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFO_MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_METHOD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_PRESS_CROSS_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ML_PRESS_M_PRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="ML_PRESS_L_PRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="NEED_PERS" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_PERS" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_AMT_PAY_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="LICENSE_TAX" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPRO_PERIOD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPRO_PERIOD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_FIRM" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="NOT_PERMIT_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_EXT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ROCATION" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RESULT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_STOP_NUM2" size="256" summ="default" type="STRING"/>
					<colinfo id="MAINTER_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Re" OnColumnChanged="ds_Multi_Re_OnColumnChanged">
				<Contents>
					<colinfo id="DANGER_NUM" size="11" summ="default" type="CHAR"/>
					<colinfo id="DANGER_JOB_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="UPD_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="UPD_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="UPD_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="CRT_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="CRT_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="6" summ="default" type="CHAR"/>
					<colinfo id="TEAM_CD" size="6" summ="default" type="CHAR"/>
					<colinfo id="JOB_REQ_YMD1" size="8" summ="default" type="CHAR"/>
					<colinfo id="JOB_REQ_STR_TIME" size="4" summ="default" type="CHAR"/>
					<colinfo id="JOB_REQ_END_TIME" size="4" summ="default" type="CHAR"/>
					<colinfo id="REQ_YMD_2" size="8" summ="default" type="CHAR"/>
					<colinfo id="JOB_STR_TIME" size="4" summ="default" type="CHAR"/>
					<colinfo id="JOB_END_TIME" size="4" summ="default" type="CHAR"/>
					<colinfo id="RECEIVE_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="DANGER_JOB_KIND_CD" size="1" summ="default" type="CHAR"/>
					<colinfo id="WORK_NUM" size="11" summ="default" type="CHAR"/>
					<colinfo id="ROCATION" size="2" summ="default" type="CHAR"/>
					<colinfo id="JOB_NM" size="300" summ="default" type="STRING"/>
					<colinfo id="JOB_NM1" size="300" summ="default" type="STRING"/>
					<colinfo id="JOB_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="ZIP_NO1" size="3" summ="default" type="CHAR"/>
					<colinfo id="ZIP_NO2" size="3" summ="default" type="CHAR"/>
					<colinfo id="ZIP_SEQ" size="10" summ="default" type="CHAR"/>
					<colinfo id="HILL" size="3" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="4" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="4" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="100" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="4" summ="default" type="STRING"/>
					<colinfo id="HOSU" size="4" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="300" summ="default" type="STRING"/>
					<colinfo id="NEW_ADDR_BLD_SEQ" size="10" summ="default" type="CHAR"/>
					<colinfo id="NEW_HOSU" size="4" summ="default" type="CHAR"/>
					<colinfo id="NEW_ADDR_UNION" size="300" summ="default" type="STRING"/>
					<colinfo id="BEFO_MATER_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="BEFO_PIPE_DIAM_CD" size="3" summ="default" type="CHAR"/>
					<colinfo id="PRESS_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="NEW_MATER_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="NEW_DIAM_CD" size="3" summ="default" type="CHAR"/>
					<colinfo id="NEW_PRESS_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="JOB_METHOD_CD" size="2" summ="default" type="CHAR"/>
					<colinfo id="JOB_CNT" size="1" summ="default" type="CHAR"/>
					<colinfo id="MID_PRESS_CROSS_YN" size="2" summ="default" type="CHAR"/>
					<colinfo id="ML_PRESS_M_PRESS" size="3" summ="default" type="CHAR"/>
					<colinfo id="ML_PRESS_L_PRESS" size="3" summ="default" type="CHAR"/>
					<colinfo id="REQ_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="REQ_NM" size="100" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_DDD" size="4" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_EXN" size="4" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_NUM" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="13" summ="default" type="CHAR"/>
					<colinfo id="WORK_FIRM_NM" size="150" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_DDD" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_EXN" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_NUM" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_NM" size="32" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_DDD" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_EXN" size="4" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_NUM" size="4" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_NM" size="32" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_DDD" size="4" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_EXN" size="4" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_NUM" size="4" summ="default" type="STRING"/>
					<colinfo id="NEED_PERS" size="2" summ="default" type="DECIMAL"/>
					<colinfo id="SCG_JOIN_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="SCG_JOIN_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_PERS" size="3" summ="default" type="DECIMAL"/>
					<colinfo id="PAVEMENT_KIND" size="2" summ="default" type="CHAR"/>
					<colinfo id="LENG" size="12" summ="default" type="DECIMAL"/>
					<colinfo id="DIG_REQ_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="RC_AMT_PAY_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="ADMIT_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="ADMIT_NUM" size="30" summ="default" type="CHAR"/>
					<colinfo id="DIR_RC_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="IND_RC_AMT" size="15" summ="default" type="DECIMAL"/>
					<colinfo id="LICENSE_TAX" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="LEASE_AMT" size="9" summ="default" type="DECIMAL"/>
					<colinfo id="APPRO_PERIOD_FROM" size="8" summ="default" type="CHAR"/>
					<colinfo id="APPRO_PERIOD_TO" size="8" summ="default" type="CHAR"/>
					<colinfo id="RC_FIRM" size="100" summ="default" type="STRING"/>
					<colinfo id="RC_TYPE" size="2" summ="default" type="CHAR"/>
					<colinfo id="RC_PLAN_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="NOT_PERMIT_WHY" size="300" summ="default" type="STRING"/>
					<colinfo id="RMK" size="1000" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="CHG_APPRO_REQ_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="CHG_APPRO_WHY" size="80" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="REVIEW_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="REVIEW_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="REVIEW_OPINI" size="300" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_STS_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="160" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_YN" size="1" summ="default" type="CHAR"/>
					<colinfo id="CHG_APPRO_REQ_CONF_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="CHG_APPRO_REQ_CONF_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="CHG_APPRO_REQ_CONF_WHY" size="300" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="ETC_RMK" size="160" summ="default" type="STRING"/>
					<colinfo id="JOB_RESULT_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="JOB_RESULT" size="160" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="SIGN" size="4000" summ="default" type="BLOB"/>
					<colinfo id="DRAFTER_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_ROUTE" size="300" summ="default" type="STRING"/>
					<colinfo id="DECIDE_OPINI" size="1200" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="1" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_REQ_NUM" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="DANGER_STOP_NUM" size="11" summ="default" type="CHAR"/>
					<colinfo id="DANGER_STOP_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="DANGER_STOP_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DELETE_FLAG" size="1" summ="default" type="CHAR"/>
					<colinfo id="CANCEL_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Review">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerJob" OnColumnChanged="ds_DangerJob_OnColumnChanged">
				<Contents>
					<colinfo id="JOB_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_PLAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_SCG_PLAN_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_APPRO_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_APPRO_END_TIME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DecideReq">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerJobStsFlag">
				<Contents>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="VALUE" size="256" summ="default" type="STRING"/>
					<record>
						<NAME>전체</NAME>
						<VALUE></VALUE>
					</record>
					<record>
						<NAME>위험작업요청전</NAME>
						<VALUE>00</VALUE>
					</record>
					<record>
						<NAME>위험작업요청</NAME>
						<VALUE>01</VALUE>
					</record>
					<record>
						<NAME>검토완료</NAME>
						<VALUE>04</VALUE>
					</record>
					<record>
						<NAME>검토반려</NAME>
						<VALUE>02</VALUE>
					</record>
					<record>
						<NAME>결재&#32;승인</NAME>
						<VALUE>07</VALUE>
					</record>
					<record>
						<NAME>결재&#32;반려</NAME>
						<VALUE>05</VALUE>
					</record>
					<record>
						<NAME>변경&#32;요청</NAME>
						<VALUE>03</VALUE>
					</record>
					<record>
						<NAME>변경&#32;요청&#32;승인</NAME>
						<VALUE>08</VALUE>
					</record>
					<record>
						<NAME>변경&#32;요청&#32;반려&#32;</NAME>
						<VALUE>06</VALUE>
					</record>
					<record>
						<NAME>공사완료</NAME>
						<VALUE>10</VALUE>
					</record>
					<record>
						<NAME>공사취소</NAME>
						<VALUE>90</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_WorkFirmCd">
				<Contents>
					<colinfo id="DEAL_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEAL_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerJobFlag">
				<Contents>
					<colinfo id="NAME" size="256" type="STRING"/>
					<colinfo id="VALUE" size="256" type="STRING"/>
					<record>
						<NAME>투자.외부</NAME>
						<VALUE>10</VALUE>
					</record>
					<record>
						<NAME>가정관</NAME>
						<VALUE>20</VALUE>
					</record>
					<record>
						<NAME>중폐지</NAME>
						<VALUE>30</VALUE>
					</record>
					<record>
						<NAME>정압기</NAME>
						<VALUE>40</VALUE>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_FileList">
				<Contents>
					<colinfo id="FILE_ID" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_PATH" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="FILE_CODE" size="256" summ="default" type="STRING"/>
					<colinfo id="ORG_FILE_NAME" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerEqup">
				<Contents>
					<colinfo id="EQUP1" size="256" summ="default" type="STRING"/>
					<colinfo id="EA1" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUP2" size="256" summ="default" type="STRING"/>
					<colinfo id="EA2" size="256" summ="default" type="STRING"/>
					<record>
						<EA1></EA1>
						<EA2></EA2>
						<EQUP1>소&#32;화&#32;기</EQUP1>
						<EQUP2>조명장비</EQUP2>
					</record>
					<record>
						<EA1></EA1>
						<EA2></EA2>
						<EQUP1>절&#32;단&#32;기</EQUP1>
						<EQUP2>가스검지기(SCG)</EQUP2>
					</record>
					<record>
						<EA1></EA1>
						<EA2></EA2>
						<EQUP1>산소농도측정기(SCG)</EQUP1>
						<EQUP2>휀&#32;스</EQUP2>
					</record>
					<record>
						<EA1></EA1>
						<EA2></EA2>
						<EQUP1>질&#32;소</EQUP1>
						<EQUP2>유도표지</EQUP2>
					</record>
					<record>
						<EA1></EA1>
						<EA2></EA2>
						<EQUP1>천공장비</EQUP1>
						<EQUP2>기타</EQUP2>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerEqup01">
				<Contents>
					<colinfo id="EQUIP_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_CD" size="256" summ="default" type="STRING"/>
					<record>
						<EQUIP_CD>01</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>02</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>03</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>04</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>05</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>06</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>07</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>08</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>09</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
					<record>
						<EQUIP_CD>10</EQUIP_CD>
						<EQUIP_QTY></EQUIP_QTY>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_DangerEqup02">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_QTY" size="256" summ="default" type="STRING"/>
					<colinfo id="EQUIP_USER_FLAG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Excel">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_2" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_KIND_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_SEQ" size="256" summ="default" type="STRING"/>
					<colinfo id="HILL" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_M" size="256" summ="default" type="STRING"/>
					<colinfo id="ADDR_S" size="256" summ="default" type="STRING"/>
					<colinfo id="SECOND_ADDR" size="256" summ="default" type="STRING"/>
					<colinfo id="BLD_DONG" size="256" summ="default" type="STRING"/>
					<colinfo id="HOSU" size="256" summ="default" type="STRING"/>
					<colinfo id="LOT_NUM_UNION" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_YMD1" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_STR_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_END_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="BEFO_MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_MATER_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="NEW_DIAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_METHOD_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_CNT" size="256" summ="default" type="STRING"/>
					<colinfo id="PRESS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="MID_PRESS_CROSS_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ML_PRESS_M_PRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="ML_PRESS_L_PRESS" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_MANAGER_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_DDD" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_EXN" size="256" summ="default" type="STRING"/>
					<colinfo id="SITE_CHIEF_TEL_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="NEED_PERS" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_PERS" size="256" summ="default" type="STRING"/>
					<colinfo id="PAVEMENT_KIND" size="256" summ="default" type="STRING"/>
					<colinfo id="LENG" size="256" summ="default" type="STRING"/>
					<colinfo id="DIG_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_AMT_PAY_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="LICENSE_TAX" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="APPRO_PERIOD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="APPRO_PERIOD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_FIRM" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_TYPE" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_PLAN_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="NOT_PERMIT_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_OPINI" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_RTURN_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="ATTACH_FILE_YN" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO2" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_REQ_TIME" size="256" summ="default" type="STRING"/>
					<colinfo id="ETC_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="REVIEW_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_EXT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_CONF_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RESULT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_KIND_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="SCG_JOIN_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DECIDE_REQ_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_BranchCd">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE_ITEM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Team_01">
				<Contents>
					<colinfo id="KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Data1">
				<Contents>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_PERIOD_FROM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_PERIOD_TO" size="256" summ="default" type="STRING"/>
					<colinfo id="RECEIVE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_FIRM_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="ADMIT_DOCU_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Data2">
				<Contents>
					<colinfo id="DIG_LENG" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Data3">
				<Contents>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DIR_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="IND_RC_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_TEMPOR" size="256" summ="default" type="STRING"/>
					<colinfo id="LEASE_AMT_CONTI" size="256" summ="default" type="STRING"/>
					<colinfo id="LICENSE_TAX" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_LEASE_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="TOT_AMT" size="256" summ="default" type="STRING"/>
					<colinfo id="RC_AMT_PAY_YMD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_WorkFrimCd">
				<Contents>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="REQNM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKFIRMTELDDD" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKFIRMTELEXN" size="256" summ="default" type="STRING"/>
					<colinfo id="WORKFIRMTELNUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Re1">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RESULT_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_RESULT" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="CRT_IP" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_User">
				<Contents>
					<colinfo id="EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="NAME" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_RNK_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DEPT_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="BRANCH_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="POS_RNK_CD" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Delete">
				<Contents>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="DELETE_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<record>
						<DANGER_JOB_FLAG></DANGER_JOB_FLAG>
						<DANGER_JOB_STS_FLAG></DANGER_JOB_STS_FLAG>
						<DANGER_NUM></DANGER_NUM>
						<DELETE_FLAG></DELETE_FLAG>
						<UPD_EMPID></UPD_EMPID>
						<UPD_IP></UPD_IP>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Team">
				<Contents>
					<colinfo id="KITEM" size="256" summ="default" type="STRING"/>
					<colinfo id="CODE" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SearchTop">
				<Contents>
					<colinfo id="BRANCH_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="ZIP_NO1" size="256" summ="default" type="STRING"/>
					<colinfo id="TEAM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_START" size="256" summ="default" type="STRING"/>
					<colinfo id="REQ_YMD_END" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="JOB_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="WORK_FIRM_CD" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<record>
						<BRANCH_CD></BRANCH_CD>
						<DANGER_JOB_FLAG></DANGER_JOB_FLAG>
						<DANGER_JOB_STS_FLAG></DANGER_JOB_STS_FLAG>
						<DANGER_NUM></DANGER_NUM>
						<JOB_FLAG></JOB_FLAG>
						<JOB_NM></JOB_NM>
						<REQ_YMD_END></REQ_YMD_END>
						<REQ_YMD_START></REQ_YMD_START>
						<TEAM_CD></TEAM_CD>
						<WORK_FIRM_CD></WORK_FIRM_CD>
						<ZIP_NO1></ZIP_NO1>
					</record>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Re_chg">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_STS_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_WHY" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_APPRO_REQ_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_DECIDE_YMD" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_DECIDE_RTURN_WHY_NM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHG_DECIDE_PROC_STS" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Multi_Ok_chg">
				<Contents>
					<colinfo id="DANGER_NUM" size="11" summ="default" type="CHAR"/>
					<colinfo id="DANGER_JOB_FLAG" size="2" summ="default" type="CHAR"/>
					<colinfo id="UPD_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="UPD_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="UPD_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="CRT_DTM" size="7" summ="default" type="DATE"/>
					<colinfo id="CRT_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="CRT_IP" size="32" summ="default" type="STRING"/>
					<colinfo id="DRAFTER_EMPID" size="9" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_ROUTE" size="300" summ="default" type="STRING"/>
					<colinfo id="DECIDE_OPINI" size="1200" summ="default" type="STRING"/>
					<colinfo id="DECIDE_PROC_STS" size="1" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_REQ_NUM" size="13" summ="default" type="DECIMAL"/>
					<colinfo id="DECIDE_YMD" size="8" summ="default" type="CHAR"/>
					<colinfo id="DECIDE_RTURN_WHY" size="160" summ="default" type="STRING"/>
					<colinfo id="CHG_DECIDE_EMPID_NM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Chk">
				<Contents>
					<colinfo id="WORK_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="CHK_CNT" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Cancel">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_EMPID" size="256" summ="default" type="STRING"/>
					<colinfo id="UPD_IP" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_RMK" size="256" summ="default" type="STRING"/>
					<colinfo id="CANCEL_EMPID" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Max">
				<Contents>
					<colinfo id="MAX" size="256" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_SearchNum">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_STOP_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Danger">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
				</Contents>
			</Dataset>
			<Dataset DataSetType="Dataset" Id="ds_Sign">
				<Contents>
					<colinfo id="DANGER_NUM" size="256" summ="default" type="STRING"/>
					<colinfo id="DANGER_JOB_FLAG" size="256" summ="default" type="STRING"/>
					<colinfo encrypt="base64" id="SIGN" size="256" summ="default" type="BLOB"/>
				</Contents>
			</Dataset>
		</Datasets>
		<Static BKColor="white" Border="Flat" Height="30" Id="Static123" Left="188" Style="table" TabOrder="270" Top="971" VAlign="Middle" Width="360" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="23" Id="Static154" Left="191" Style="table" TabOrder="286" Top="978" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static3" Left="91" Style="table" TabOrder="294" Top="890" VAlign="Middle" Width="532" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static53" Left="105" Style="table" TabOrder="255" Top="386" VAlign="Middle" Width="1143" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static52" Left="106" Style="table" TabOrder="254" Top="365" VAlign="Middle" Width="1143" WordWrap="TRUE"></Static>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="246" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="128" Id="grd_Main" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" OnHeadClick="grd_Main_OnHeadClick" Right="1248" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="67" TabStop="true" Top="118" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1243">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col width="82"/>
						<col width="108"/>
						<col width="85"/>
						<col width="108"/>
						<col width="88"/>
						<col width="96"/>
						<col width="76"/>
						<col width="105"/>
						<col width="91"/>
						<col width="108"/>
						<col width="283"/>
						<col width="245"/>
						<col width="80"/>
						<col width="85"/>
						<col width="80"/>
						<col width="70"/>
						<col width="81"/>
						<col width="120"/>
					</columns>
					<head>
						<cell col="0" display="normal" text="NO"/>
						<cell col="1" display="text" text="위험작업번호"/>
						<cell col="2" display="text" text="위험작업&#32;진행상태"/>
						<cell col="3" display="text" text="정비보수번호"/>
						<cell col="4" display="text" text="정비보수&#32;진행상태"/>
						<cell col="5" display="text" text="중폐지번호"/>
						<cell col="6" display="text" text="중폐지&#32;진행상태"/>
						<cell col="7" display="text" text="지사"/>
						<cell col="8" display="text" text="팀"/>
						<cell col="9" display="text" text="시/구"/>
						<cell col="10" display="text" text="시공회사"/>
						<cell col="11" display="text" text="작업명"/>
						<cell col="12" display="text" text="작업위치"/>
						<cell col="13" display="text" text="작업요청일자"/>
						<cell col="14" display="text" text="작업요청시간"/>
						<cell col="15" display="text" text="작업결재일자"/>
						<cell col="16" display="text" text="SCG담당자"/>
						<cell col="17" display="text" text="작업일자"/>
						<cell col="18" display="text" text="등록일시"/>
					</head>
					<body>
						<cell align="center" col="0" display="normal" expandsize="18" expr="rowindex+1" wordwrap="word"/>
						<cell align="center" col="1" colid="DANGER_NUM" display="text"/>
						<cell align="center" col="2" colid="DANGER_JOB_STS_FLAG" combocol="VALUE" combodataset="ds_DangerJobStsFlag" combotext="NAME" display="combo" expandsize="18" wordwrap="word"/>
						<cell align="center" col="3" colid="MAINTER_NUM" display="text"/>
						<cell col="4" colid="MAINTER_STS_FLAG_NM" display="text"/>
						<cell align="center" col="5" colid="DANGER_STOP_NUM2" display="text"/>
						<cell col="6" colid="DANGER_JOB_STS_FLAG_NM" display="text"/>
						<cell align="center" col="7" colid="BRANCH_CD_NM" display="text"/>
						<cell align="center" col="8" colid="TEAM_CD_NM" display="text"/>
						<cell align="center" col="9" colid="ZIP_NO1_NM" display="text"/>
						<cell col="10" colid="WORK_FIRM_NM" display="text"/>
						<cell col="11" colid="JOB_NM" display="text" expandsize="18"/>
						<cell col="12" colid="LOT_NUM_UNION" display="text" expandsize="18"/>
						<cell align="center" col="13" colid="JOB_REQ_YMD1" display="text" Mask="####-##-##"/>
						<cell align="center" col="14" colid="JOB_REQ_TIME" display="text"/>
						<cell align="center" col="15" colid="DECIDE_YMD" display="date"/>
						<cell col="16" colid="SCG_JOIN_EMPID_NM" display="text"/>
						<cell align="center" col="17" colid="JOB_RESULT_YMD" display="text"/>
						<cell align="center" col="18" colid="UPD_DTM" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Grid AutoEnter="TRUE" BindDataset="ds_Multi_Excel" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="242" ColSizing="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="114" Id="grd_ExcelList" InputPanel="FALSE" Left="1272" LineColor="default" LineType="ExVERT" MultiSelect="TRUE" OnCellClick="grd_Main_OnCellClick" Right="2515" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="162" TabStop="true" Top="128" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="1243">
			<contents>
				<format id="Default">
					<columns>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="100"/>
						<col width="140"/>
						<col width="80"/>
						<col width="80"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="위험작업번호"/>
						<cell align="center" col="1" display="text" text="위험작업구분"/>
						<cell align="center" col="2" display="text" text="지사"/>
						<cell align="center" col="3" display="text" text="요청일자2"/>
						<cell align="center" col="4" display="text" text="접수일자"/>
						<cell align="center" col="5" display="text" text="위험작업종류"/>
						<cell align="center" col="6" display="text" text="공사번호"/>
						<cell align="center" col="7" display="text" text="작업명"/>
						<cell align="center" col="8" display="text" text="지번주소조합"/>
						<cell align="center" col="9" display="text" text="작업요청일자"/>
						<cell align="center" col="10" display="text" text="작업시작시간"/>
						<cell align="center" col="11" display="text" text="작업종료시간"/>
						<cell align="center" col="12" display="text" text="기존재질구분"/>
						<cell align="center" col="13" display="text" text="시설관경"/>
						<cell align="center" col="14" display="text" text="신설재질구분"/>
						<cell align="center" col="15" display="text" text="신설관경"/>
						<cell align="center" col="16" display="text" text="작업방법"/>
						<cell align="center" col="17" display="text" text="작업개소"/>
						<cell align="center" col="18" display="text" text="압력구분"/>
						<cell align="center" col="19" display="text" text="중저압병행유무"/>
						<cell align="center" col="20" display="text" text="중저압_중압"/>
						<cell align="center" col="21" display="text" text="중저압_저압"/>
						<cell align="center" col="22" display="text" text="요청자명"/>
						<cell align="center" col="23" display="text" text="요청자전화_식별번호"/>
						<cell align="center" col="24" display="text" text="요청자전화_국번"/>
						<cell align="center" col="25" display="text" text="요청자전화_번호"/>
						<cell align="center" col="26" display="text" text="시공업체"/>
						<cell align="center" col="27" display="text" text="시공사전화_식별번호"/>
						<cell align="center" col="28" display="text" text="시공사전화_국번"/>
						<cell align="center" col="29" display="text" text="시공사전화_번호"/>
						<cell align="center" col="30" display="text" text="시공관리자명"/>
						<cell align="center" col="31" display="text" text="시공관리자전화_식별번호"/>
						<cell align="center" col="32" display="text" text="시공관리자전화_국번"/>
						<cell align="center" col="33" display="text" text="시공관리자전화_번호"/>
						<cell align="center" col="34" display="text" text="현장소장명"/>
						<cell align="center" col="35" display="text" text="현장소장전화_식별번호"/>
						<cell align="center" col="36" display="text" text="현장소장전화_국번"/>
						<cell align="center" col="37" display="text" text="현장소장전화_번호"/>
						<cell align="center" col="38" display="text" text="소요인원"/>
						<cell align="center" col="39" display="text" text="당사입회자명"/>
						<cell align="center" col="40" display="text" text="당사입회인원"/>
						<cell align="center" col="41" display="text" text="도로포장종류"/>
						<cell align="center" col="42" display="text" text="연장"/>
						<cell align="center" col="43" display="text" text="굴착신청일자"/>
						<cell align="center" col="44" display="text" text="복구비납부일자"/>
						<cell align="center" col="45" display="text" text="허가일자"/>
						<cell align="center" col="46" display="text" text="허가번호"/>
						<cell align="center" col="47" display="text" text="직접복구비"/>
						<cell align="center" col="48" display="text" text="간접복구비"/>
						<cell align="center" col="49" display="text" text="면허세"/>
						<cell align="center" col="50" display="text" text="점용료"/>
						<cell align="center" col="51" display="text" text="승인기간_FROM"/>
						<cell align="center" col="52" display="text" text="승인기간_TO"/>
						<cell align="center" col="53" display="text" text="복구업체"/>
						<cell align="center" col="54" display="text" text="복구형태"/>
						<cell align="center" col="55" display="text" text="복구예정일자"/>
						<cell align="center" col="56" display="text" text="불가사유"/>
						<cell align="center" col="57" display="text" text="특기사항"/>
						<cell align="center" col="58" display="text" text="변경승인요청구분"/>
						<cell align="center" col="59" display="text" text="변경승일요청일자"/>
						<cell align="center" col="60" display="text" text="변경승인사유"/>
						<cell align="center" col="61" display="text" text="검토구분"/>
						<cell align="center" col="62" display="text" text="검토자명"/>
						<cell align="center" col="63" display="text" text="검토일자"/>
						<cell align="center" col="64" display="text" text="검토의견"/>
						<cell align="center" col="65" display="text" text="위험작업상태구분"/>
						<cell align="center" col="66" display="text" text="결재상태구분"/>
						<cell align="center" col="67" display="text" text="결재일자"/>
						<cell align="center" col="68" display="text" text="우편번호1"/>
						<cell align="center" col="69" display="text" text="우편번호2"/>
						<cell align="center" col="70" display="text" text="변경승인요청확인구분"/>
						<cell align="center" col="71" display="text" text="변경승인요청확인일자"/>
						<cell align="center" col="72" display="text" text="작업요청시간"/>
						<cell align="center" col="73" display="text" text="기타사항"/>
						<cell align="center" col="74" display="text" text="결재진행상태"/>
						<cell align="center" col="75" display="text" text="결재의뢰번호"/>
						<cell col="76" display="text" text="정비보수(중폐지)번호"/>
						<cell col="77" display="text" text="작업일자"/>
						<cell col="78" display="text" text="업체평가여부"/>
					</head>
					<body>
						<cell align="center" col="0" colid="DANGER_NUM" display="text" edit="normal" limit="10"/>
						<cell align="center" col="1" colid="DANGER_JOB_FLAG_NM" display="text" edit="normal" limit="2"/>
						<cell align="center" col="2" colid="BRANCH_CD_NM" display="text" edit="normal" limit="6"/>
						<cell align="center" col="3" colid="REQ_YMD_2" display="date" edit="normal" limit="8"/>
						<cell align="center" col="4" colid="RECEIVE_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="5" colid="DANGER_JOB_KIND_NM" display="text" edit="normal" limit="1"/>
						<cell align="center" col="6" colid="WORK_NUM" display="text" edit="normal" limit="11"/>
						<cell align="center" col="7" colid="JOB_NM1" display="text" edit="normal" limit="160"/>
						<cell align="center" col="8" colid="LOT_NUM_UNION" display="text" edit="normal" limit="300"/>
						<cell align="center" col="9" colid="JOB_REQ_YMD1" display="date" edit="date" limit="8"/>
						<cell align="center" col="10" colid="JOB_STR_TIME" display="text" edit="normal" limit="6"/>
						<cell align="center" col="11" colid="JOB_END_TIME" display="text" edit="normal" limit="6"/>
						<cell align="center" col="12" colid="BEFO_MATER_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="13" colid="DIAM_CD" display="text" edit="normal" limit="1"/>
						<cell align="center" col="14" colid="NEW_MATER_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="15" colid="NEW_DIAM_CD" display="text" edit="normal" limit="1"/>
						<cell align="center" col="16" colid="JOB_METHOD_CD" display="text" edit="normal" limit="1"/>
						<cell align="center" col="17" colid="JOB_CNT" display="text" edit="normal" limit="1"/>
						<cell align="center" col="18" colid="PRESS_FLAG" display="text" edit="normal" limit="2"/>
						<cell align="center" col="19" colid="MID_PRESS_CROSS_YN" display="text" edit="normal" limit="1"/>
						<cell align="center" col="20" colid="ML_PRESS_M_PRESS" display="text" edit="normal" limit="2"/>
						<cell align="center" col="21" colid="ML_PRESS_L_PRESS" display="text" edit="normal" limit="2"/>
						<cell align="center" col="22" colid="REQ_NM" display="text" edit="normal" limit="100"/>
						<cell align="center" col="23" colid="REQ_TEL_DDD" display="text" edit="normal" limit="4"/>
						<cell align="center" col="24" colid="REQ_TEL_EXN" display="text" edit="normal" limit="4"/>
						<cell align="center" col="25" colid="REQ_TEL_NUM" display="text" edit="normal" limit="4"/>
						<cell align="center" col="26" colid="WORK_FIRM_CD_NM" display="text" edit="normal" limit="10"/>
						<cell align="center" col="27" colid="WORK_FIRM_TEL_DDD" display="text" edit="normal" limit="4"/>
						<cell align="center" col="28" colid="WORK_FIRM_TEL_EXN" display="text" edit="normal" limit="4"/>
						<cell align="center" col="29" colid="WORK_FIRM_TEL_NUM" display="text" edit="normal" limit="4"/>
						<cell align="center" col="30" colid="WORK_MANAGER_NM" display="text" edit="normal" limit="32"/>
						<cell align="center" col="31" colid="WORK_MANAGER_TEL_DDD" display="text" edit="normal" limit="4"/>
						<cell align="center" col="32" colid="WORK_MANAGER_TEL_EXN" display="text" edit="normal" limit="4"/>
						<cell align="center" col="33" colid="WORK_MANAGER_TEL_NUM" display="text" edit="normal" limit="4"/>
						<cell align="center" col="34" colid="SITE_CHIEF_NM" display="text" edit="normal" limit="32"/>
						<cell align="center" col="35" colid="SITE_CHIEF_TEL_DDD" display="text" edit="normal" limit="4"/>
						<cell align="center" col="36" colid="SITE_CHIEF_TEL_EXN" display="text" edit="normal" limit="4"/>
						<cell align="center" col="37" colid="SITE_CHIEF_TEL_NUM" display="text" edit="normal" limit="4"/>
						<cell align="center" col="38" colid="NEED_PERS" display="text" edit="normal" limit="2"/>
						<cell align="center" col="39" colid="SCG_JOIN_EMPID_NM" display="text" edit="normal" limit="9"/>
						<cell align="center" col="40" colid="SCG_JOIN_PERS" display="text" edit="normal" limit="3"/>
						<cell align="center" col="41" colid="PAVEMENT_KIND" display="text" edit="normal" limit="2"/>
						<cell align="center" col="42" colid="LENG" display="number" edit="normal" limit="5"/>
						<cell align="center" col="43" colid="DIG_REQ_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="44" colid="RC_AMT_PAY_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="45" colid="ADMIT_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="46" colid="ADMIT_NUM" display="text" edit="normal" limit="10"/>
						<cell align="center" col="47" colid="DIR_RC_AMT" display="number" edit="normal" limit="15"/>
						<cell align="center" col="48" colid="IND_RC_AMT" display="number" edit="normal" limit="15"/>
						<cell align="center" col="49" colid="LICENSE_TAX" display="number" edit="normal" limit="9"/>
						<cell align="center" col="50" colid="LEASE_AMT" display="number" edit="normal" limit="9"/>
						<cell align="center" col="51" colid="APPRO_PERIOD_FROM" display="date" edit="date" limit="8"/>
						<cell align="center" col="52" colid="APPRO_PERIOD_TO" display="date" edit="date" limit="8"/>
						<cell align="center" col="53" colid="RC_FIRM" display="text" edit="normal" limit="100"/>
						<cell align="center" col="54" colid="RC_TYPE" display="text" edit="normal" limit="3"/>
						<cell align="center" col="55" colid="RC_PLAN_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="56" colid="NOT_PERMIT_WHY" display="text" edit="normal" limit="100"/>
						<cell align="center" col="57" colid="RMK" display="text" edit="normal" limit="160"/>
						<cell align="center" col="58" colid="CHG_APPRO_REQ_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="59" colid="CHG_APPRO_REQ_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="60" colid="CHG_APPRO_WHY" display="text" edit="normal" limit="80"/>
						<cell align="center" col="61" colid="REVIEW_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="62" colid="REVIEW_EMPID_NM" display="text" edit="normal" limit="9"/>
						<cell align="center" col="63" colid="REVIEW_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="64" colid="REVIEW_OPINI" display="text" edit="normal" limit="80"/>
						<cell align="center" col="65" colid="DANGER_JOB_STS_FLAG_NM" display="text" edit="normal" limit="2"/>
						<cell align="center" col="66" colid="DECIDE_STS_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="67" colid="DECIDE_YMD" display="date" edit="date" limit="8"/>
						<cell align="center" col="68" colid="ZIP_NO1" display="text" edit="normal" limit="3"/>
						<cell align="center" col="69" colid="ZIP_NO2" display="text" edit="normal" limit="3"/>
						<cell align="center" col="70" colid="CHG_APPRO_REQ_CONF_FLAG" display="text" edit="normal" limit="1"/>
						<cell align="center" col="71" colid="CHG_APPRO_REQ_CONF_YMD" display="date" edit="normal" limit="8"/>
						<cell align="center" col="72" colid="JOB_REQ_TIME" display="text" edit="normal" limit="4"/>
						<cell align="center" col="73" colid="ETC_RMK" display="text" edit="normal" limit="160"/>
						<cell align="center" col="74" colid="DECIDE_PROC_STS" display="text" edit="normal" limit="1"/>
						<cell align="center" col="75" colid="DECIDE_REQ_NUM" display="text" edit="normal" limit="13"/>
						<cell col="76" colid="DANGER_STOP_NUM" display="text"/>
						<cell align="center" col="77" colid="JOB_RESULT_YMD" display="date"/>
						<cell align="center" col="78" colid="CHK_YN" display="text"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static Align="Center" Border="Flat" Height="12" Id="Static41" Left="1059" Style="table" TabOrder="224" Top="589" VAlign="Middle" Width="189" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static76" Left="553" Style="table" TabOrder="117" Top="643" VAlign="Middle" Width="695" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static122" Left="930" Style="table_indis" TabOrder="201" Top="643" VAlign="Middle" Width="318" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static45" Left="54" Style="table" TabOrder="174" Top="337" VAlign="Middle" Width="1194" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static43" Left="1059" Style="table" TabOrder="170" Top="570" VAlign="Middle" Width="189" WordWrap="TRUE"></Static>
		<Shape BKColor="user6" Bottom="92" Height="62" Id="Shape1" Left="5" LineColor="user7" Right="1248" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="63" Top="30" Type="RoundRect" Width="1243"></Shape>
		<Shape BKColor="user8" Bottom="87" Height="52" Id="Shape2" Left="10" LineWidth="0" Right="1241" RoundHeight="3" RoundUnit="Pixel" RoundWidth="3" TabOrder="64" Top="35" Type="Rectangle" Width="1231"></Shape>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static61" Left="292" Style="table" TabOrder="104" Top="863" VAlign="Middle" Width="257" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static57" Left="190" Style="table" TabOrder="103" Top="863" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static139" Left="54" Style="table" TabOrder="101" Top="316" VAlign="Middle" Width="1194" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static64" Left="88" Style="table" TabOrder="99" Top="863" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Div DisableBKColor="white" Height="30" Id="Div0" Left="5" OnLoadCompleted="ComButton_OnLoadCompleted" OnSize="ComButton_OnSize" OnTimer="ComButton_OnTimer" TabOrder="14" Text="Div0" Url="globals::ComHead.xml" Visible="FALSE" Width="1260">
			<Contents></Contents>
		</Div>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static30" Left="94" Style="table" TabOrder="44" Top="272" VAlign="Middle" Width="1154" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static32" Left="54" Style="table" TabOrder="45" Top="295" VAlign="Middle" Width="1194" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static31" Left="5" Style="table_1" TabOrder="43" Text="위험작업번호" Top="272" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_NUM" Enable="FALSE" Height="18" Id="edt_DangerNum" ImeMode="none" Left="96" MaxLength="10" Style="edit" TabOrder="46" Top="274" Width="108"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static86" Left="553" Style="table" TabOrder="47" Top="580" VAlign="Middle" Width="506" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static87" Left="553" Style="table" TabOrder="48" Top="559" VAlign="Middle" Width="506" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static89" Left="553" Style="table" TabOrder="49" Top="601" VAlign="Middle" Width="695" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static91" Left="543" Style="table_indis" TabOrder="50" Text="시공회사" Top="559" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static92" Left="543" Style="table" TabOrder="51" Text="대표자" Top="580" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static93" Left="543" Style="table_indis" TabOrder="52" Text="시공관리자" Top="601" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="44" Id="Static94" Left="930" Style="table_indis" TabOrder="53" Text="전화번호" Top="559" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static96" Left="930" Style="table_indis" TabOrder="54" Text="휴대전화번호" Top="601" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="REQ_NM" Height="18" Id="edt_ReqNm" ImeMode="none" Left="681" MaxLength="50" Style="edit" TabOrder="19" Top="582" Width="246"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="WORK_MANAGER_NM" Height="18" Id="edt_WorkManagerNm" ImeMode="none" Left="681" MaxLength="10" Style="edit_Indis" TabOrder="20" Top="603" Width="246"></Edit>
		<Static Height="13" Id="Static10" Left="1123" Style="static" TabOrder="56" Text="-" Top="574" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_EXN" Height="18" Id="ect_WorkFirmTelExn" ImeMode="none" Left="1131" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="17" Top="572" Width="51"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_DDD" Height="18" Id="cob_WorkFirmTelDdd" Left="1062" Style="combo_indis" TabOrder="16" Top="571" Width="61"></Combo>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_TEL_NUM" Height="18" Id="edt_WorkFirmTelNum" ImeMode="none" Left="1192" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="18" Top="572" Width="52"></Edit>
		<Static Height="13" Id="Static116" Left="1183" Style="static" TabOrder="57" Text="-" Top="574" Width="10"></Static>
		<Static Height="13" Id="Static119" Left="1123" Style="static" TabOrder="58" Text="-" Top="605" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_MANAGER_TEL_EXN" Height="18" Id="edt_WorkManagerTelExn" ImeMode="none" Left="1131" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="22" Top="603" Width="51"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_MANAGER_TEL_DDD" Height="18" Id="cob_WorkManagerTelDdd" Left="1062" Style="combo_indis" TabOrder="21" Top="602" Width="61"></Combo>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_MANAGER_TEL_NUM" Height="18" Id="edt_WorkManagerTelNum" ImeMode="none" Left="1192" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="23" Top="603" Width="52"></Edit>
		<Static Height="13" Id="Static120" Left="1183" Style="static" TabOrder="59" Text="-" Top="605" Width="10"></Static>
		<Image Align="Left" Height="18" Id="Image10" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search_Indis" TabOrder="60" Text="지사" Top="40" Width="60"></Image>
		<Image Align="Left" Height="18" Id="Image3" ImageID="blt" Left="157" LeftMargin="12" Style="blt_search" TabOrder="61" Text="시/구" Top="40" Width="60"></Image>
		<Combo Border="Flat" Height="18" Id="cob_BranchCd" Left="56" OnChanged="cob_BranchCd_OnChanged" Style="combo_indis" TabOrder="1" Top="40" Width="90"></Combo>
		<Image Align="Left" Height="18" Id="Image5" ImageID="blt" Left="774" LeftMargin="12" Style="blt_search" TabOrder="62" Text="진행상태" Top="40" Width="60"></Image>
		<Combo Border="Flat" Height="18" Id="cob_ZipNo1" Left="205" Style="combo" TabOrder="2" Top="40" Width="92"></Combo>
		<Combo Border="Flat" CodeColumn="VALUE" DataColumn="NAME" Height="18" Id="cob_DangerJobStsFlag" InnerDataset="ds_DangerJobStsFlag" Left="838" Style="combo" TabOrder="3" Top="40" Width="126"></Combo>
		<Image Align="Left" Height="18" Id="Image1" ImageID="blt" Left="481" LeftMargin="12" Style="blt_search" TabOrder="65" Text="작업요청일자" Top="41" Width="90"></Image>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdStart" Left="569" OnChanged="cal_ReqYmdStart_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="4" Top="41" WeeksFont="Default,-1" Width="90"></Calendar>
		<Calendar Border="Flat" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ReqYmdEnd" Left="670" OnChanged="cal_ReqYmdEnd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="5" Top="41" WeeksFont="Default,-1" Width="90"></Calendar>
		<Static Height="13" Id="Static109" Left="660" Style="static" TabOrder="66" Text="~" Top="45" Width="10"></Static>
		<Shape BKColor="#6cbae1" Bottom="119" Height="3" Id="Shape0" Left="5" LineWidth="0" Right="1248" TabOrder="68" Top="116" Type="Rectangle" Width="1243"></Shape>
		<Image Align="Left" Height="12" Id="Image2" ImageID="blt_8" Left="6" LeftMargin="12" Style="text_title" TabOrder="69" Text="위험작업내역" Top="99" Width="110"></Image>
		<Image Align="Left" Height="12" Id="Image6" ImageID="blt_8" Left="6" LeftMargin="12" Style="text_title" TabOrder="70" Text="위헙작업내역&#32;등록" Top="255" Width="210"></Image>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_DangerWork" ImageID="btn_8_Inquiry01" Left="1006" LeftMargin="21" OnClick="btn_DangerWork_OnClick" Style="button" TabOrder="71" Text="위험작업&#32;허가기준" Top="250" Width="128"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="Btn_Danger_Req" ImageID="btn_6_reg" Left="1138" LeftMargin="21" OnClick="Btn_Danger_Req_OnClick" Style="button" TabOrder="72" Text="위험작업요청" Top="250" Width="100"></Button>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static110" Left="205" Style="table_1" TabOrder="73" Text="진행상태" Top="272" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="REVIEW_YMD" Dateformat="LONGDATE" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_DecideYmd1" Left="792" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="74" Top="339" WeeksFont="Default,-1" Width="160"></Calendar>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static4" Left="205" Style="table_1" TabOrder="76" Text="공사명" Top="295" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static140" Left="693" Style="table_1" TabOrder="77" Text="작업위치(기존)" Top="295" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static147" Left="205" Style="table_1" TabOrder="78" Text="중압관경" Top="337" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="MID_PRESS_CROSS_YN" Height="18" Id="cob_MidPressCrossYn" Left="95" OnChanged="cob_MidPressCrossYn_OnChanged" Style="combo_indis" TabOrder="10" Top="338" Width="109"></Combo>
		<Image Align="Left" Height="12" Id="Image11" ImageID="blt_8" Left="10" LeftMargin="12" Style="text_title" TabOrder="80" Text="안전장비" Top="543" Width="74"></Image>
		<Shape BKColor="#6cbae1" Bottom="562" Height="3" Id="Shape4" Left="8" LineWidth="0" Right="538" TabOrder="79" Top="559" Type="Rectangle" Width="530"></Shape>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_DangerEqup" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="672" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="111" Id="Grid2" InputPanel="FALSE" Left="8" LineColor="default" LineType="ExVERT" MinWidth="100" Right="538" ScrollCell="true" SelColor="BACKGROUND" Style="grid" TabOrder="15" TabStop="true" Top="561" UseDBuff="true" UsePopupMenu="true" UseSelColor="FALSE" Visible="true" VLineColor="default" WheelScrollRow="1" Width="530">
			<contents>
				<format id="Default">
					<columns>
						<col width="150"/>
						<col width="95"/>
						<col width="150"/>
						<col width="95"/>
					</columns>
					<head>
						<cell col="0" display="text" text="장비명"/>
						<cell col="1" display="text" text="수량"/>
						<cell col="2" display="text" text="장비명"/>
						<cell col="3" display="text" text="수량"/>
					</head>
					<body>
						<cell align="center" col="0" colid="EQUP1" display="text"/>
						<cell align="right" col="1" colid="EA1" display="number" edit="number" expandsize="18" limit="3" Mask="##0" wordwrap="word"/>
						<cell align="center" col="2" colid="EQUP2" display="text" expandsize="18" wordwrap="word"/>
						<cell align="right" col="3" colid="EA2" display="number" edit="number" limit="3" Mask="##0"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Image Align="Left" Height="12" Id="Image12" ImageID="blt_8" Left="543" LeftMargin="12" Style="text_title" TabOrder="81" Text="작업수행&#32;및&#32;비상연락망" Top="544" Width="210"></Image>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static1" Left="8" Style="table_indis" TabOrder="82" Text="포장종류" Top="679" VAlign="Middle" Width="127" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static2" Left="8" Style="table" TabOrder="83" Top="700" VAlign="Middle" Width="127" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static15" Left="134" Style="table" TabOrder="85" Top="700" VAlign="Middle" Width="100" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static16" Left="134" Style="table_indis" TabOrder="84" Text="연장(m)" Top="679" VAlign="Middle" Width="100" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static17" Left="564" Style="table" TabOrder="89" Top="700" VAlign="Middle" Width="120" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static18" Left="564" Style="table" TabOrder="88" Text="허가번호" Top="679" VAlign="Middle" Width="120" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static19" Left="233" Style="table" TabOrder="87" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static20" Left="233" Style="table_indis" TabOrder="86" Text="굴착신청일자" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static21" Left="683" Style="table" TabOrder="91" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static22" Left="683" Style="table_indis" TabOrder="90" Text="직접복구비(원)" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="12" Id="Image15" ImageID="blt_8" Left="8" LeftMargin="12" Style="text_title" TabOrder="92" Text="첨부문서" Top="773" Width="210"></Image>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static25" Left="8" Style="table" TabOrder="93" Top="789" VAlign="Middle" Width="528" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="ADMIT_NUM" Height="18" Id="edt_AdmitNum" ImeMode="none" Left="566" MaxLength="10" Style="edit" TabOrder="31" Top="702" Width="116"></Edit>
		<Static Align="Center" Border="Flat" Height="43" Id="Static58" Left="9" Style="table" TabOrder="94" Text="검토" Top="842" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="43" Id="Static59" Left="548" Style="table" TabOrder="96" Top="842" VAlign="Middle" Width="73" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Review" Border="Flat" CheckLength="Byte" Column="REVIEW_OPINI" Enable="FALSE" Height="18" Id="edt_ReviewOpni" ImeMode="none" Left="296" MaxLength="40" Style="edit" TabOrder="39" Top="865" Width="250"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static60" Left="88" Style="table_indis" TabOrder="95" Text="검토자" Top="842" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static63" Left="190" Style="table_indis" TabOrder="97" Text="검토일자" Top="842" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Review" Border="Flat" Column="REVIEW_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_ReviewYmd" Left="194" OnChanged="cal_ReviewYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="38" Top="865" WeeksFont="Default,-1" Width="95"></Calendar>
		<Checkbox Height="15" Id="chk_Change3" Left="564" OnClick="chk_Change3_OnClick" Style="checkbox" TabOrder="100" Text="반려" Top="858" Width="45"></Checkbox>
		<Static Align="Center" Border="Flat" Height="22" Id="Static56" Left="292" Style="table" TabOrder="102" Text="검토의견" Top="842" VAlign="Middle" Width="257" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static62" Left="295" Style="table" TabOrder="111" Top="911" VAlign="Middle" Width="254" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static66" Left="193" Style="table" TabOrder="110" Top="911" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static67" Left="91" Style="table" TabOrder="108" Top="911" VAlign="Middle" Width="532" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_RTURN_WHY" Enable="FALSE" Height="18" Id="edt_DecideReturnWhy" ImeMode="none" Left="374" Style="edit" TabOrder="42" Top="913" Width="247"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static69" Left="171" Style="table" TabOrder="106" Text="결재자" Top="890" VAlign="Middle" Width="99" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static70" Left="269" Style="table" TabOrder="107" Text="결재일자" Top="890" VAlign="Middle" Width="104" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="cal_DecideYmd" Left="270" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="41" Top="913" WeeksFont="Default,-1" Width="100"></Calendar>
		<Static Align="Center" Border="Flat" Height="22" Id="Static71" Left="372" Style="table" TabOrder="109" Text="결재반려사유" Top="890" VAlign="Middle" Width="251" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="43" Id="Static72" Left="12" Style="table" TabOrder="105" Top="890" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_NM" Enable="FALSE" Height="18" Id="edt_JobNm1" ImeMode="none" Left="296" Style="edit" TabOrder="112" Top="297" Width="396"></Edit>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static65" Left="5" Style="table_1" TabOrder="113" Text="중/저압병행" Top="337" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static73" Left="404" Style="table_1" TabOrder="114" Text="저압관경" Top="337" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static74" Left="693" Style="table_1" TabOrder="115" Text="작업요청일자" Top="272" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static75" Left="693" Style="table_1" TabOrder="116" Text="검토일자" Top="337" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_REQ_YMD1" Dateformat="LONGDATE" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_JobReqYmd1" Left="792" OnChanged="cal_JobReqYmd1_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="7" Top="274" WeeksFont="Default,-1" Width="160"></Calendar>
		<Grid AutoEnter="TRUE" AutoFit="TRUE" BindDataset="ds_DangerJob" BkColor2="user3" BoldHead="FALSE" Border="Flat" Bottom="533" ColSizing="TRUE" Editable="TRUE" Enable="true" EndLineColor="default" HeadBorder="Flat" HeadHeight="20" Height="96" Id="grd_DangerJob" InputPanel="FALSE" Left="5" LineColor="default" LineType="ExVERT" MinWidth="100" Right="1248" SelColor="BACKGROUND" Style="grid" TabOrder="13" TabStop="true" Top="437" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="true" VLineColor="default" WheelScrollRow="1" Width="1243">
			<contents>
				<format id="Default">
					<columns>
						<col fix="left" width="30"/>
						<col fix="left" width="90"/>
						<col fix="left" width="20"/>
						<col fix="left" width="90"/>
						<col fix="left" width="460"/>
						<col fix="left" width="538"/>
					</columns>
					<head>
						<cell align="center" col="0" display="text" text="NO"/>
						<cell bkcolor="user11" col="1" colspan="3" display="text" text="작업시간"/>
						<cell bkcolor="user11" col="4" display="text" text="작업내용"/>
						<cell col="5" display="text" text="비고"/>
					</head>
					<body>
						<cell align="center" col="0" display="text" expr="rowindex+1"/>
						<cell align="center" col="1" colid="JOB_STR_TIME" display="text" edit="mask" Mask="##:##"/>
						<cell align="center" col="2" display="text" text="~"/>
						<cell align="center" col="3" colid="JOB_END_TIME" display="text" edit="mask" expandsize="18" Mask="##:##" wordwrap="word"/>
						<cell col="4" colid="DANGER_JOB_PLAN_CD" display="combo" edit="combo" expandsize="18" wordwrap="word"/>
						<cell checklength="Byte" col="5" colid="RMK" display="text" edit="normal" limit="80"/>
					</body>
				</format>
			</contents>
		</Grid>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static77" Left="553" Style="table" TabOrder="118" Top="622" VAlign="Middle" Width="695" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static79" Left="543" Style="table_indis" TabOrder="119" Text="현장소장" Top="622" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static80" Left="543" Style="table_indis" TabOrder="120" Text="소요인원" Top="643" VAlign="Middle" Width="135" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static82" Left="930" Style="table_indis" TabOrder="121" Text="휴대전화번호" Top="622" VAlign="Middle" Width="130" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="SITE_CHIEF_NM" Height="18" Id="edt_SiteChiefNm" ImeMode="none" Left="681" MaxLength="10" Style="edit_Indis" TabOrder="24" Top="624" Width="246"></Edit>
		<Static Height="13" Id="Static85" Left="1123" Style="static" TabOrder="122" Text="-" Top="626" Width="10"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="SITE_CHIEF_TEL_EXN" Height="18" Id="edt_SiteChiefTelExn" ImeMode="none" Left="1131" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="26" Top="624" Width="51"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="SITE_CHIEF_TEL_DDD" Height="18" Id="cob_SiteChiefTelDdd" Left="1062" Style="combo_indis" TabOrder="25" Top="623" Width="61"></Combo>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="SITE_CHIEF_TEL_NUM" Height="18" Id="edt_SiteChiefTelNum" ImeMode="none" Left="1192" MaxLength="4" Number="TRUE" Style="edit_Indis" TabOrder="27" Top="624" Width="52"></Edit>
		<Static Height="13" Id="Static88" Left="1183" Style="static" TabOrder="123" Text="-" Top="626" Width="10"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="SCG_JOIN_EMPID_NM" Enable="FALSE" Height="18" Id="edt_ScgJoinEmpidNm" ImeMode="none" Left="495" MaxLength="9" Style="edit" TabOrder="28" Top="274" Width="87"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static0" Left="346" Style="table" TabOrder="125" Top="700" VAlign="Middle" Width="106" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="RC_AMT_PAY_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_RcAmtPayYmd" Left="349" OnChanged="cal_RcAmtPayYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="30" Top="702" WeeksFont="Default,-1" Width="100"></Calendar>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static78" Left="346" Style="table_indis" TabOrder="124" Text="복구비납부일" Top="679" VAlign="Middle" Width="106" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static81" Left="451" Style="table" TabOrder="127" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static97" Left="451" Style="table" TabOrder="126" Text="허가일자" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static98" Left="796" Style="table" TabOrder="129" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static99" Left="796" Style="table_indis" TabOrder="128" Text="간접복구비(원)" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static100" Left="909" Style="table" TabOrder="131" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static101" Left="1022" Style="table" TabOrder="133" Top="700" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static102" Left="1022" Style="table_indis" TabOrder="132" Text="점용료(원)" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static103" Left="1135" Style="table" TabOrder="135" Top="700" VAlign="Middle" Width="113" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static104" Left="1135" Style="table" TabOrder="134" Text="합계(원)" Top="679" VAlign="Middle" Width="113" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static105" Left="909" Style="table_indis" TabOrder="130" Text="면허세(원)" Top="679" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static107" Left="8" Style="table" TabOrder="136" Text="승인기간" Top="721" VAlign="Middle" Width="226" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static108" Left="8" Style="table" TabOrder="137" Top="742" VAlign="Middle" Width="226" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static111" Left="233" Style="table" TabOrder="139" Top="742" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static112" Left="234" Style="table" TabOrder="138" Text="복구업체" Top="721" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static115" Left="346" Style="table" TabOrder="141" Top="742" VAlign="Middle" Width="106" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static121" Left="346" Style="table_indis" TabOrder="140" Text="복구형태" Top="721" VAlign="Middle" Width="106" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static124" Left="451" Style="table" TabOrder="143" Top="742" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="RC_PLAN_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_RcPlanYmd" Left="453" OnChanged="cal_RcPlanYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="34" Top="744" WeeksFont="Default,-1" Width="110"></Calendar>
		<Static Align="Center" Border="Flat" Color="dimgray" Height="22" Id="Static125" Left="451" Style="table_indis" TabOrder="142" Text="복구예정일자" Top="721" VAlign="Middle" Width="114" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static130" Left="908" Style="table" TabOrder="145" Top="742" VAlign="Middle" Width="340" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static134" Left="909" Style="table" TabOrder="144" Text="특기사항_시공업체용" Top="721" VAlign="Middle" Width="339" WordWrap="TRUE"></Static>
		<Image Align="Left" Height="12" Id="Image18" ImageID="blt_8" Left="554" LeftMargin="12" Style="text_title" TabOrder="146" Text="특기사항_SCG용" Top="796" Width="130"></Image>
		<TextArea BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="RMK" Height="23" Id="edt_Rmk" Left="687" MaxLength="300" Style="textarea" TabOrder="36" Top="790" VScroll="TRUE" Width="561"></TextArea>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_NO1" Enable="FALSE" Height="18" Id="edt_Zip1" Left="714" MaxLength="3" Readonly="TRUE" Style="edit" TabOrder="147" Top="245" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_NO2" Enable="FALSE" Height="18" Id="edt_Zip2" Left="769" MaxLength="3" Readonly="TRUE" Style="edit" TabOrder="148" Top="245" Visible="FALSE" Width="40"></Edit>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="APPRO_PERIOD_FROM" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ApproPeriodFrom" Left="11" OnChanged="cal_ApproPeriodFrom_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="32" Top="744" WeeksFont="Default,-1" Width="105"></Calendar>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="APPRO_PERIOD_TO" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ApproPeriodTo" Left="127" OnChanged="cal_ApproPeriodTo_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="33" Top="744" WeeksFont="Default,-1" Width="105"></Calendar>
		<Static Height="13" Id="Static8" Left="117" Style="static" TabOrder="149" Text="~" Top="748" Width="10"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="PAVEMENT_KIND" Height="18" Id="cob_PavementKind" Left="10" Style="combo_indis" TabOrder="29" Top="701" Width="123"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static34" Left="404" Style="table_1" TabOrder="150" Text="SCG입회자" Top="272" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="BRANCH_CD" Editable="TRUE" Enable="FALSE" Height="18" Id="cob_BranchCd01" Left="295" OnChanged="cob_BranchCd01_OnChanged" Style="combo_indis" TabOrder="151" Top="317" Width="109"></Combo>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Safety" ImageID="btn_5_From" Left="1078" LeftMargin="21" OnClick="btn_Safety_OnClick" Style="button" TabOrder="152" Text="안&#32;전&#32;수&#32;칙" Top="818" Width="87"></Button>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_JOB_STS_FLAG" Enable="FALSE" Height="18" Id="edt_DangerJobStsFlag" ImeMode="none" Left="144" MaxLength="2" Number="TRUE" Style="edit" TabOrder="154" Top="249" Visible="FALSE" Width="50"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_JOB_STS_FLAG_NM" Enable="FALSE" Height="18" Id="edt_DangerJobStsFlagNm" ImeMode="none" Left="296" Style="edit" TabOrder="75" Top="274" Width="107"></Edit>
		<Edit BindDataset="ds_Review" Border="Flat" Column="REVIEW_EMPID" Height="12" Id="edt_ReviewEmpid" ImeMode="none" Left="10" Style="edit_Indis" TabOrder="98" Top="871" Visible="FALSE" Width="80"></Edit>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static39" Left="953" Style="table_1" TabOrder="155" Text="작업요청시간" Top="272" VAlign="Middle" Width="101" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Plan_Add" ImageID="btn_add" Left="1137" LeftMargin="20" OnClick="btn_Plan_Add_OnClick" Style="button" TabOrder="156" Text="추가" Top="415" Width="50"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Plan_Del" ImageID="btn_delete" Left="1192" LeftMargin="20" OnClick="btn_Plan_Del_OnClick" Style="button" TabOrder="157" Text="삭제" Top="415" Width="50"></Button>
		<Edit BindDataset="ds_Review" Border="Flat" Column="REVIEW_EMPID_NM" Enable="FALSE" Height="18" Id="edt_ReviewEmpidNm" ImeMode="none" Left="91" Style="edit_Indis" TabOrder="37" Top="865" Width="97"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_CD" Enable="FALSE" Height="19" Id="edt_WorkFirmCd" ImeMode="none" Left="706" Style="edit_Indis" TabOrder="153" Top="537" Visible="FALSE" Width="75"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_FIRM_NM" Enable="FALSE" Height="18" Id="edt_WorkFirmCdNm" ImeMode="none" Left="681" Style="edit_Indis" TabOrder="55" Top="561" Width="246"></Edit>
		<Edit AutoSelect="TRUE" Border="Flat" Enable="FALSE" Height="18" Id="edtFileList" ImeMode="none" Left="11" Style="edit" TabOrder="158" Top="791" Width="443"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_FileFolder" ImageID="btn_4_fileadd" Left="458" LeftMargin="21" OnClick="btn_FileFolder_OnClick" Style="button" TabOrder="35" Text="파일첨부&#32;" Top="791" Width="76"></Button>
		<Edit BindDataset="ds_DecideReq" Border="Flat" Column="DECIDE_EMPID_NM" Enable="FALSE" Height="18" Id="edt_DecideEmpidNm" ImeMode="none" Left="173" Style="edit" TabOrder="40" Top="913" Width="96"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="WORK_NUM" Enable="FALSE" Height="18" Id="edt_WorkNum" ImeMode="none" Left="96" Style="edit" TabOrder="159" Top="297" Width="89"></Edit>
		<Button Cursor="HAND" Height="17" Id="btn_WorkNumButton" ImageID="search" Left="186" OnClick="btn_WorkNumButton_OnClick" TabOrder="160" Text="Button8" Top="298" Width="17"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static26" Left="5" Style="table_1" TabOrder="161" Text="공사번호" Top="295" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" ClipMode="IncludeSpace" Column="JOB_REQ_STR_TIME" DecimalLen="0" DigitLen="0" Enable="FALSE" Height="18" Id="edt_JobReqStrTime" Left="1054" Mask="##:##&#32;" MaxLength="4" Style="edit_Indis" TabOrder="8" Top="274" Type="STRING" Width="45"></MaskEdit>
		<Static Height="13" Id="Static37" Left="1100" Style="static" TabOrder="164" Text="~" Top="278" Width="10"></Static>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" ClipMode="IncludeSpace" Column="JOB_REQ_END_TIME" DecimalLen="0" DigitLen="0" Enable="FALSE" Height="18" Id="edt_JobReqEndTime" Left="1110" Mask="##:##&#32;" MaxLength="4" Style="edit_Indis" TabOrder="9" Top="274" Type="STRING" Width="45"></MaskEdit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" CodeColumn="CODE" Column="TEAM_CD" DataColumn="KITEM" Enable="FALSE" Height="18" Id="cob_TeamCd" InnerDataset="ds_Team_01" Left="494" Style="combo_indis" TabOrder="6" Top="317" Width="127"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static38" Left="404" Style="table_1" TabOrder="165" Text="팀" Top="316" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="ML_PRESS_M_PRESS" Height="18" Id="cob_MlPressMPress" Left="295" Style="combo" TabOrder="11" Top="338" Width="109"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="ML_PRESS_L_PRESS" Height="18" Id="cob_MlPressLPress" Left="494" Style="combo" TabOrder="12" Top="338" Width="127"></Combo>
		<Button Cursor="HAND" Height="17" Id="btn_ScgJoinEmpid" ImageID="search" Left="584" OnClick="btn_ScgJoinEmpid_OnClick" TabOrder="166" Text="Button8" Top="275" Width="17"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static40" Left="5" Style="table_1" TabOrder="167" Text="위치구분" Top="316" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="ROCATION" Height="18" Id="cob_Rocation" Left="95" OnChanged="cob_Rocation_OnChanged" Style="combo" TabOrder="168" Top="317" Width="109"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="RC_TYPE" Height="18" Id="cob_RcType" Left="347" Style="combo_indis" TabOrder="169" Top="743" Width="104"></Combo>
		<Static Align="Center" Border="Flat" Height="12" Id="Static42" Left="1059" Style="table" TabOrder="171" Top="559" VAlign="Middle" Width="189" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_GulChak" ImageID="btn_5_From" Left="1159" LeftMargin="21" OnClick="btn_GulChak_OnClick" Style="button" TabOrder="172" Text="굴&#32;착&#32;확&#32;인" Top="537" Width="87"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" EscapeButton="TRUE" Height="19" Id="btn_gis" ImageID="btn_5_gis" Left="904" LeftMargin="21" OnClick="btn_gis_OnClick" Style="button" TabOrder="173" TabStop="FALSE" Text="GIS&#32;위치보기" Top="250" Width="98"></Button>
		<Static Align="Right" Border="Flat" Height="22" Id="Static46" Left="693" Style="table_1" TabOrder="175" Text="작업위치(신)" Top="316" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ZIP_SEQ" Height="18" Id="edt_Zip_Seq" Left="560" MaxLength="160" Style="edit" TabOrder="182" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ADDR_M" Height="18" Id="edt_Addr_M" Left="608" MaxLength="160" Style="edit" TabOrder="183" Top="248" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="HILL" Height="18" Id="edt_Hill" Left="608" MaxLength="160" Style="edit" TabOrder="176" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="ADDR_S" Height="18" Id="edt_Addr_S" Left="656" MaxLength="160" Style="edit" TabOrder="177" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="SECOND_ADDR" Height="18" Id="edt_SecondAddr" Left="704" MaxLength="160" Style="edit" TabOrder="178" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="BLD_DONG" Height="18" Id="edt_Bld_Ding" Left="752" MaxLength="160" Style="edit" TabOrder="179" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_ADDR_BLD_SEQ" Height="18" Id="edt_New_Addr_Bld_Seq" Left="800" MaxLength="160" Style="edit" TabOrder="180" Top="229" Visible="FALSE" Width="40"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_HOSU" Height="18" Id="edt_New_Hosu" Left="848" MaxLength="160" Style="edit" TabOrder="181" Top="229" Visible="FALSE" Width="40"></Edit>
		<Button Cursor="HAND" Height="17" Id="btn_AddrSearch" ImageID="search" Left="1229" OnClick="btn_AddrSearch_OnClick" TabOrder="184" Text="Button8" Top="297" Width="17"></Button>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_ADDR_UNION" Enable="FALSE" Height="18" Id="edt_Addr_Union" ImeMode="none" Left="792" Readonly="TRUE" Style="edit" TabOrder="186" Top="318" Width="454"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="LOT_NUM_UNION" Enable="FALSE" Height="18" Id="edt_LotNumUnion" ImeMode="none" Left="792" Readonly="TRUE" Style="edit" TabOrder="185" Top="297" Width="436"></Edit>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="HOSU" Height="18" Id="edt_Hosu" Left="656" MaxLength="160" Style="edit" TabOrder="187" Top="248" Visible="FALSE" Width="40"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static114" Left="564" Style="table" TabOrder="188" Text="불가사유" Top="721" VAlign="Middle" Width="346" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="ADMIT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_AdmitYmd" Left="454" OnChanged="cal_AdmitYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="189" Top="702" WeeksFont="Default,-1" Width="108"></Calendar>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="DIG_REQ_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_DigReqYmd" Left="236" OnChanged="cal_DigReqYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="190" Top="702" WeeksFont="Default,-1" Width="108"></Calendar>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="RC_FIRM" Height="18" Id="edt_RcFirm" ImeMode="none" Left="235" MaxLength="30" Style="edit" TabOrder="191" Top="744" Width="110"></Edit>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static113" Left="564" Style="table" TabOrder="192" Top="742" VAlign="Middle" Width="345" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="NOT_PERMIT_WHY" Height="18" Id="edt_NotPermitWhy" ImeMode="none" Left="566" MaxLength="30" Style="edit" TabOrder="193" Top="744" Width="341"></Edit>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" CheckLength="Byte" Column="ETC_RMK" Height="18" Id="edt_EtcRmk" ImeMode="none" Left="910" MaxLength="40" Style="edit" TabOrder="194" Top="744" Width="336"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static90" Left="604" Style="table" TabOrder="196" Text="외" Top="272" VAlign="Middle" Width="22" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static106" Left="670" Style="table" TabOrder="197" Text="명" Top="272" VAlign="Middle" Width="22" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static83" Left="901" Style="table_indis" TabOrder="198" Text="명" Top="643" VAlign="Middle" Width="30" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Color="blue" Height="22" Id="Static117" Left="789" Style="table_indis" TabOrder="199" Text="외" Top="643" VAlign="Middle" Width="30" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static118" Left="677" Style="table" TabOrder="200" Text="용접/융착공" Top="643" VAlign="Middle" Width="113" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static126" Left="636" Style="table" TabOrder="206" Top="839" VAlign="Middle" Width="612" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="69" Id="Static127" Left="636" Style="table" TabOrder="207" Top="860" VAlign="Middle" Width="612" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static128" Left="636" Style="table" TabOrder="204" Text="작업일자" Top="839" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="69" Id="Static129" Left="636" Style="table" TabOrder="205" Text="작업결과내용" Top="860" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re1" Border="Flat" Column="JOB_RESULT_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_JobResultYmd" Left="727" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="202" Top="842" WeeksFont="Default,-1" Width="110"></Calendar>
		<Static Align="Center" Border="Flat" Height="26" Id="Static131" Left="838" Style="table_indis" TabOrder="208" Top="839" VAlign="Middle" Width="410" WordWrap="TRUE"></Static>
		<TextArea BindDataset="ds_Multi_Re1" Column="JOB_RESULT" Height="65" Id="edt_JobResult" Left="728" MaxLength="50" TabOrder="203" Top="864" VScroll="TRUE" Width="519"></TextArea>
		<Image Align="Left" Height="12" Id="Image4" ImageID="blt_8" Left="642" LeftMargin="12" Style="text_title" TabOrder="209" Text="작업결과" Top="822" Width="82"></Image>
		<Edit AutoSelect="TRUE" BKColor="white" Border="None" Height="20" Id="Edit1" ImeMode="none" Left="102" MaxLength="10" Style="static" TabOrder="212" Text="(" Top="96" Width="7"></Edit>
		<Image Align="Left" Height="10" Id="Image7" ImageID="blt" Left="130" LeftMargin="12" Style="blt_search" TabOrder="213" Text="건" Top="101" Width="30"></Image>
		<Edit Align="CENTER" AutoSelect="TRUE" BKColor="white" Border="None" DisableBKColor="white" Height="20" Id="edt_Count" ImeMode="none" Left="112" MaxLength="10" Number="TRUE" Readonly="TRUE" Style="static" TabOrder="210" Top="94" Width="30"></Edit>
		<Edit AutoSelect="TRUE" BKColor="white" Border="None" Height="20" Id="Edit3" ImeMode="none" Left="159" MaxLength="10" Style="static" TabOrder="211" Text=")" Top="96" Width="7"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Valuation" ImageID="btn_4" Left="1167" LeftMargin="21" OnClick="btn_Valuation_OnClick" Style="button" TabOrder="214" Text="업체평가" Top="818" Width="76"></Button>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="DIR_RC_AMT" Height="18" Id="cob_DirRcAmt" Left="685" MaxLength="15" OnCharChanged="cob_DirRcAmt_OnCharChanged" Style="edit_Indis" TabOrder="215" Top="702" Value="MaskEdit0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="IND_RC_AMT" Height="18" Id="edt_IndRcAmt" Left="798" MaxLength="15" OnCharChanged="edt_IndRcAmt_OnCharChanged" Style="edit_Indis" TabOrder="216" Top="702" Value="MaskEdit0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="LICENSE_TAX" Height="18" Id="edt_LicenseTax" Left="911" MaxLength="9" OnCharChanged="edt_LicenseTax_OnCharChanged" Style="edit_Indis" TabOrder="217" Top="702" Value="MaskEdit0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="LEASE_AMT" Height="18" Id="edt_LeaseAmt" Left="1024" MaxLength="9" OnCharChanged="edt_LeaseAmt_OnCharChanged" Style="edit_Indis" TabOrder="218" Top="702" Value="MaskEdit0" Width="110"></MaskEdit>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="TOTAL_SUM" Enable="FALSE" Height="18" Id="edt_Sum" Left="1137" OnCharChanged="edt_Sum_OnCharChanged" Style="edit" TabOrder="219" Top="702" Width="109"></MaskEdit>
		<MaskEdit BindDataset="ds_Multi_Re" Border="Flat" Column="LENG" Height="18" Id="edt_Leng" Left="136" MaxLength="10" Style="edit_Indis" TabOrder="220" Top="702" Width="96"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="NEED_PERS" Height="18" Id="edt_NeedPers" Left="820" MaxLength="2" OnCharChanged="edt_IndRcAmt_OnCharChanged" Style="edit_Indis" TabOrder="221" Top="645" Width="80"></MaskEdit>
		<MaskEdit AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="SCG_JOIN_PERS" Height="18" Id="edt_ScgJoinPers" Left="627" MaxLength="3" OnCharChanged="edt_IndRcAmt_OnCharChanged" Style="edit" TabOrder="222" Top="274" Width="40"></MaskEdit>
		<Shape BKColor="#6cbae1" Bottom="439" Height="3" Id="Shape5" Left="5" LineWidth="0" Right="1248" TabOrder="223" Top="436" Type="Rectangle" Width="1243"></Shape>
		<Static Height="13" Id="Static54" Left="81" Style="static" TabOrder="195" Text="※&#32;배관도면,&#32;복구비&#32;납부&#32;영수증&#32;사본,&#32;도로굴착복구비&#32;승인서&#32;사본,&#32;지적도,&#32;토지대장" Top="772" Width="479"></Static>
		<Edit Align="CENTER" AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="SCG_JOIN_EMPID" Enable="FALSE" Height="18" Id="edt_ScgJoinEmpid" ImeMode="none" Left="495" MaxLength="9" Style="edit" TabOrder="225" Top="250" Visible="FALSE" Width="87"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static33" Left="953" Style="table_1" TabOrder="226" Text="중폐지/정비보수" Top="337" VAlign="Middle" Width="101" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_STOP_NUM" Enable="FALSE" Height="18" Id="edt_DangerStopNum" ImeMode="none" Left="1055" MaxLength="10" Style="edit" TabOrder="227" Top="339" Width="81"></Edit>
		<Combo Border="Flat" CodeColumn="CODE" DataColumn="KITEM" Height="18" Id="cob_TeamCdSearch" InnerDataset="ds_Team" Left="333" Style="combo_indis" TabOrder="228" Top="40" Width="140"></Combo>
		<Image Align="Left" Height="18" Id="Image19" ImageID="blt" Left="306" LeftMargin="12" Style="blt_search" TabOrder="229" Text="팀" Top="40" Width="60"></Image>
		<Image Align="Left" Height="18" Id="Image20" ImageID="blt" Left="17" LeftMargin="12" Style="blt_search" TabOrder="230" Text="시공사" Top="65" Width="60"></Image>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_WorkFirmCdSearch" ImeMode="none" Left="70" Style="edit" TabOrder="231" Top="65" Width="85"></Edit>
		<Edit Border="Flat" Enable="FALSE" Height="18" Id="edt_WorkFirmNmSearch" ImeMode="none" Left="156" Style="edit" TabOrder="232" Top="65" Width="110"></Edit>
		<Grid AutoFit="TRUE" BindDataset="GDS_VALUE" BkColor2="default" BoldHead="true" Bottom="240" ColSelect="TRUE" ColSizing="TRUE" Enable="true" EndLineColor="default" Height="96" Id="Grid0" InputPanel="FALSE" Left="264" LineColor="default" MinWidth="100" Right="560" TabOrder="233" TabStop="true" Top="144" UseDBuff="true" UsePopupMenu="true" UseSelColor="true" Visible="FALSE" VLineColor="default" WheelScrollRow="1" Width="296">
			<contents>
				<columns>
					<col width="80"/>
					<col width="80"/>
					<col width="80"/>
				</columns>
				<head>
					<cell col="0" display="text" text="ReqVariable"/>
					<cell col="1" display="text" text="ReqVariableValue"/>
					<cell col="2" display="text" text="Description"/>
				</head>
				<body>
					<cell col="0" colid="ReqVariable" display="text"/>
					<cell col="1" colid="ReqVariableValue" display="text"/>
					<cell col="2" colid="Description" display="text"/>
				</body>
			</contents>
		</Grid>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_STOP_FLAG_NM" Enable="FALSE" Height="18" Id="edt_DangerStopFlagNM" ImeMode="none" Left="1137" MaxLength="10" Style="edit" TabOrder="234" Top="339" Width="109"></Edit>
		<Static Align="Right" Border="Flat" Height="43" Id="Static47" Left="5" Style="table_1" TabOrder="243" Text="작업내용" Top="365" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static48" Left="107" Style="table_1" TabOrder="244" Text="기존" Top="365" VAlign="Middle" Width="131" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static49" Left="107" Style="table_1" TabOrder="245" Text="신규" Top="386" VAlign="Middle" Width="131" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static141" Left="240" Style="table_1" TabOrder="246" Text="재질" Top="365" VAlign="Middle" Width="81" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static142" Left="240" Style="table_1" TabOrder="247" Text="재질" Top="386" VAlign="Middle" Width="81" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="BEFO_MATER_FLAG" Height="18" Id="cob_BefoMaterFlag1" Left="321" OnChanged="cob_BefoMaterFlag_OnChanged" Style="combo_indis" TabOrder="235" Top="366" Width="175"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_MATER_FLAG" Height="18" Id="cob_BefoMaterFlag2" Left="321" OnChanged="cob_BefoMaterFlag_OnChanged" Style="combo_indis" TabOrder="239" Top="387" Width="175"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static143" Left="495" Style="table_1" TabOrder="248" Text="관경" Top="365" VAlign="Middle" Width="133" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static144" Left="495" Style="table_1" TabOrder="249" Text="관경" Top="386" VAlign="Middle" Width="133" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="BEFO_PIPE_DIAM_CD" Enable="FALSE" Height="18" Id="cob_BefoPipeDiamCd1" Left="629" Style="combo_indis" TabOrder="236" Top="366" Width="117"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_DIAM_CD" Enable="FALSE" Height="18" Id="cob_BefoPipeDiamCd2" Left="629" Style="combo_indis" TabOrder="240" Top="387" Width="117"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static145" Left="747" Style="table_1" TabOrder="250" Text="압력" Top="365" VAlign="Middle" Width="117" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static50" Left="747" Style="table_1" TabOrder="253" Text="압력" Top="386" VAlign="Middle" Width="117" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="PRESS_FLAG" Height="18" Id="cob_PressFlag" Left="865" OnChanged="cob_PressFlag_OnChanged" Style="combo_indis" TabOrder="237" Top="366" Width="128"></Combo>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="NEW_PRESS_FLAG" Height="18" Id="cob_NewPressFlag" Left="865" Style="combo_indis" TabOrder="241" Top="387" Width="128"></Combo>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static51" Left="994" Style="table_1" TabOrder="251" Text="작업방법" Top="365" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Static Align="Right" Border="Flat" Color="blue" Height="22" Id="Static148" Left="994" Style="table_1" TabOrder="252" Text="작업개소" Top="386" VAlign="Middle" Width="98" WordWrap="TRUE"></Static>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_METHOD_CD" Height="18" Id="cob_JobMothodCd" Left="1092" Style="combo_indis" TabOrder="238" Top="366" Width="155"></Combo>
		<Edit Align="RIGHT" AutoSelect="TRUE" BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_CNT" Height="18" Id="edt_JobCnt" ImeMode="none" Left="1093" MaxLength="1" Number="TRUE" Style="edit_Indis" TabOrder="242" Top="388" Width="153"></Edit>
		<Combo BindDataset="ds_Multi_Re" Border="Flat" Column="DECIDE_PROC_STS" Enable="FALSE" Height="18" Id="cob_DECIDE_PROC_STS" Left="92" Style="combo" TabOrder="256" Top="912" Width="81"></Combo>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_Admission" ImageID="btn_7_Consultant" Left="961" LeftMargin="21" OnClick="btn_Admission_OnClick" Style="button" TabOrder="257" Text="현장입회서등록" Top="818" Width="119"></Button>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="19" Id="btn_Reject_MIS" ImageID="btn_8_Con" Left="1103" LeftMargin="21" OnClick="btn_Reject_MIS_OnClick" Style="button" TabOrder="258" Text="위험작업요청전(권)" Top="216" Visible="FALSE" Width="132"></Button>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="CRT_DTM" Enable="FALSE" Height="18" Id="Edit0" ImeMode="none" Left="296" MaxLength="10" Style="edit" TabOrder="259" Top="250" Width="164"></Edit>
		<Static Align="Right" Border="Flat" BorderColor="red" Height="22" Id="Static95" Left="205" Style="table_1" TabOrder="260" Text="등록일시" Top="249" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="DANGER_STOP_FLAG" Enable="FALSE" Height="18" Id="edt_DangerStopFlag" Left="825" MaxLength="3" Readonly="TRUE" Style="edit" TabOrder="261" Top="245" Visible="FALSE" Width="40"></Edit>
		<Button ButtonStyle="TRUE" Height="19" Id="brn_work_save" ImageID="btn_popsave" Left="726" LeftMargin="21" OnClick="brn_work_save_OnClick" Style="button" TabOrder="262" Text="저장" Top="817" Width="50"></Button>
		<Static Color="blue" Height="13" Id="Static133" Left="774" Style="static" TabOrder="263" Text="&lt;==&#32;작업&#32;결과등록&#32;저장&#32;저장&#32;버튼" Top="821" Width="192"></Static>
		<Static Align="Right" Border="Flat" Height="22" Id="Static55" Left="205" Style="table_1" TabOrder="264" Text="지&#32;&#32;사" Top="316" VAlign="Middle" Width="90" WordWrap="TRUE"></Static>
		<Static Color="red" Height="13" Id="Static44" Left="88" Style="static" TabOrder="280" Text="※&#32;변경&#32;처리는&#32;변경&#32;요청일자&#32;및&#32;변경&#32;사유&#32;등록&#32;후&#32;결재&#32;요청처리하시면&#32;됩니다.(저장버튼&#32;클릭하지&#32;않아도&#32;됩니다.)" Top="939" Width="632"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="STATIC" Left="88" Style="table" TabOrder="268" Top="978" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re_chg" Border="Flat" Column="CHG_APPRO_REQ_YMD" DayFont="Default,-1" HeaderFont="Default,-1" Height="18" Id="cal_ChgApproReqYmd" Left="195" OnChanged="cal_ChgApproReqYmd_OnChanged" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="265" Top="981" WeeksFont="Default,-1" Width="95"></Calendar>
		<Static Align="Center" Border="Flat" Height="43" Id="Static84" Left="12" Style="table" TabOrder="267" Text="변경검토" Top="957" VAlign="Middle" Width="77" WordWrap="TRUE"></Static>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Re_chg" Border="Flat" Column="CHG_APPRO_WHY" Height="18" Id="edt_ChgApproWhy" ImeMode="none" Left="295" MaxLength="50" Style="edit" TabOrder="266" Top="981" Width="254"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static135" Left="292" Style="table" TabOrder="269" Text="변경사유" Top="957" VAlign="Middle" Width="258" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static136" Left="918" Style="table" TabOrder="278" Top="978" VAlign="Middle" Width="262" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static137" Left="816" Style="table" TabOrder="277" Top="978" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="22" Id="Static138" Left="714" Style="table" TabOrder="275" Top="978" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static BKColor="white" Border="Flat" Height="43" Id="Static146" Left="1179" Style="table" TabOrder="273" Top="957" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static149" Left="714" Style="table" TabOrder="272" Text="결재자" Top="957" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static150" Left="816" Style="table" TabOrder="274" Text="결재일자" Top="957" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="22" Id="Static151" Left="918" Style="table" TabOrder="276" Text="결재반려사유" Top="957" VAlign="Middle" Width="340" WordWrap="TRUE"></Static>
		<Static Align="Center" Border="Flat" Height="43" Id="Static152" Left="635" Style="table" TabOrder="271" Text="결재/반려" Top="957" VAlign="Middle" Width="80" WordWrap="TRUE"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="20" Id="btn_chg" ImageID="btn_4" Left="553" LeftMargin="21" OnClick="btn_chg_OnClick" Style="button" TabOrder="279" Text="변경결재" Top="959" Width="76"></Button>
		<Combo BindDataset="ds_Multi_Ok_chg" Border="Flat" Column="DECIDE_PROC_STS" Enable="FALSE" Height="18" Id="cob_chg_state" Left="555" Style="combo" TabOrder="281" Top="980" Width="73"></Combo>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Ok_chg" Border="Flat" Column="CHG_DECIDE_EMPID_NM" Enable="FALSE" Height="18" Id="edt_CHG_DECIDE_EMPID_NM" ImeMode="none" Left="719" MaxLength="9" Style="edit" TabOrder="282" Top="980" Width="95"></Edit>
		<Calendar BindDataset="ds_Multi_Ok_chg" Border="Flat" Column="DECIDE_YMD" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="Calendar1" Left="821" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar" SundayTextColor="red" TabOrder="283" Top="980" WeeksFont="Default,-1" Width="95"></Calendar>
		<Edit AutoSelect="TRUE" BindDataset="ds_Multi_Ok_chg" Border="Flat" Column="DECIDE_RTURN_WHY" Enable="FALSE" Height="18" Id="Edit10" ImeMode="none" Left="923" MaxLength="50" Style="edit" TabOrder="284" Top="980" Width="335"></Edit>
		<Static Align="Center" Border="Flat" Height="22" Id="Static153" Left="190" Style="table" TabOrder="285" Text="변경작업일자" Top="957" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Calendar BindDataset="ds_Multi_Re" Border="Flat" Column="JOB_REQ_YMD1" DayFont="Default,-1" Enable="FALSE" HeaderFont="Default,-1" Height="18" Id="Calendar2" Left="93" SaturdayTextColor="blue" SelectedDayFont="Default,-1" Style="calendar_indis" SundayTextColor="red" TabOrder="287" Top="980" WeeksFont="Default,-1" Width="95"></Calendar>
		<Static Align="Center" Border="Flat" Height="22" Id="Static155" Left="88" Style="table_indis" TabOrder="288" Text="최초작업일자" Top="957" VAlign="Middle" Width="103" WordWrap="TRUE"></Static>
		<Static Color="red" Height="13" Id="st_chg_rmk" Left="160" Style="static" TabOrder="289" Text="※&#32;작업위치,&#32;작업내용&#32;및&#32;시간대별&#32;작업&#32;계획&#32;부분&#32;안전장비&#32;및&#32;작업수행/비상연락망&#32;수정시&#32;반드시&#32;저장&#32;버튼을&#32;클릭하시고&#32;검토&#32;처리하시기바랍니다." Top="418" Width="840"></Static>
		<Image Align="Left" Height="12" Id="Image9" ImageID="blt_8" Left="10" LeftMargin="12" Style="text_title" TabOrder="290" Text="시간대별&#32;작업계획" Top="418" Width="130"></Image>
		<Static Color="red" Height="13" Id="Static35" Left="11" Style="static" TabOrder="291" Text="※&#32;검토처리는&#32;결재&#32;요청시&#32;자동처리됨_&#32;결재반려&#32;및&#32;결재취소시&#32;내역&#32;수정이&#32;가능.&#32;단)시공사&#32;반려시는&#32;수정불가" Top="822" Width="608"></Static>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" Height="21" Id="btn_approval" ImageID="btn_6_reg" Left="12" LeftMargin="21" OnClick="btn_approval_OnClick" Style="button" TabOrder="292" Text="검토/결재" Top="914" Width="78"></Button>
		<Image Align="Left" Height="12" Id="Image0" ImageID="blt_8" Left="9" LeftMargin="12" Style="text_title" TabOrder="293" Text="변경결재" Top="941" Width="66"></Image>
		<Static Align="Center" Border="Flat" Height="22" Id="Static5" Left="91" Style="table" TabOrder="295" Text="결재상태" Top="890" VAlign="Middle" Width="81" WordWrap="TRUE"></Static>
		<Button ButtonStyle="TRUE" Height="19" Id="btn_Report" ImageID="btn_2_Division" Left="29" LeftMargin="21" OnClick="btn_Report_OnClick" Style="button" TabOrder="163" Text="장표" Top="893" Visible="FALSE" Width="50"></Button>
		<Static Align="Center" Border="Flat" Color="red" Height="22" Id="Static6" Left="626" Style="table" TabOrder="296" Text="취소사유" Top="767" VAlign="Middle" Width="59" WordWrap="TRUE"></Static>
		<Edit BindDataset="ds_Multi_Re" Border="Flat" Column="CANCEL_RMK" Height="18" Id="edt_cancel_rmk" ImeMode="none" Left="687" MaxLength="200" Style="edit" TabOrder="300" Top="769" Width="253"></Edit>
		<Button Align="Left" ButtonStyle="TRUE" Cursor="HAND" EscapeButton="TRUE" Height="19" Id="Btn_cancel" ImageID="btn_5_cal" Left="946" LeftMargin="21" OnClick="Btn_cancel_OnClick" Style="button" TabOrder="298" TabStop="FALSE" Text="취소처리" Top="770" Width="90"></Button>
		<Static Align="Center" Border="Flat" Color="red" Height="22" Id="Static7" Left="1037" Style="table" TabOrder="297" Text="취소정보" Top="767" VAlign="Middle" Width="63" WordWrap="TRUE"></Static>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="CANCEL_DTM" Enable="FALSE" Height="18" Id="Edit11" ImeMode="none" Left="1102" Style="edit" TabOrder="299" Top="768" Width="86"></Edit>
		<Edit Align="CENTER" BindDataset="ds_Multi_Re" Border="Flat" BorderColor="red" Column="CANCEL_NM" Enable="FALSE" Height="18" Id="Edit2" ImeMode="none" Left="1190" Style="edit" TabOrder="301" Top="768" Width="57"></Edit>
		<Image Align="Left" Height="12" Id="Image13" ImageID="blt_8" Left="553" LeftMargin="12" Style="text_title" TabOrder="302" Text="취소처리" Top="772" Width="66"></Image>
		<Static Color="red" Height="13" Id="Static9" Left="845" Style="static" TabOrder="303" Text="※&#32;작업일자는&#32;작업요청일&#32;또는&#32;변경작업일&#32;기준으로&#32;7일&#32;이내&#32;필히&#32;등록" Top="846" Width="608"></Static>
	</Form>
	<Script><![CDATA[/***************************************************************************************************
* FormID     : D1501010011F.xml
* Form 설명  : 위험작업 요청_등록 가정관
* 시스템 명  : 안전공급 (D1)
* 작성자     : 정대권 
* 작성일     : 2008-01-16
* 변경내용   : - 2009-09-07 황재혁
               1. 화면조회시 선택된 로우 보여주기.
               2. 정비보수번호 SQL변경 
               3. 필수컬럼체크 정리
               4. 화면 권한 정리
****************************************************************************************************/
/***************************************************************************************************
*                                         공통 Script Include                                      *
***************************************************************************************************/
#include "JS::COMMONA10001.js";
#include "JS::COMMONA10002.js";
#include "JS::COMMOND10001.js";
#include "JS::COMMONE20001.js";
#include "js::COMMONA10008.js";
/***************************************************************************************************
*                                          화면 변수 선언부                                        *
***************************************************************************************************/
var fv_FindRow_ShowRow = -1; 		  // 조회후 보여줄 컬럼 체크변수
var fv_FindRow_ShowKey = -1;          // KEY값

var danger_num = "";							//위험작업번호
var danger_job_sts_flag = "";					//위험작업상태값 구분
var danger_job_flag = "";						//위험작업구분	

var StopNum = "";
var StopFalg = "";

var fv_COM_ID = "";
var fv_COOP_YN = false;  // 협력사여부
var fv_DEAL_CD = "";     // 업체코드
var fv_DEAL_NM = "";     // 업체명

var fv_emp_id = "";
var fv_emp_nm = "";

/***************************************************************************************************
*                                         공통 Event 처리 부분                                     *
***************************************************************************************************/
//--------------------------------------------------------------------------------------------------
//	OnLoadCompleted
//--------------------------------------------------------------------------------------------------
function D1501010011F_OnLoadCompleted(obj)
{
	gfn_LoadForm(obj);
	fn_Init();
	
	fv_emp_id = gfn_GetGlobalValue("G_USER_NO");
	fv_emp_nm = gfn_GetGlobalValue("G_NAME");
	fv_COM_ID = gfn_GetGlobalValue("G_COM_ID");
	fv_DEAL_CD= gfn_GetGlobalValue("G_DEAL_CD");
	fv_DEAL_NM= gfn_GetGlobalValue("G_COM_NAME");	
	
	if(fv_COM_ID == "92") // 시공사-협력사 여부
	{	
		fv_COOP_YN = true;
		Image20.Visible = true;
		edt_WorkFirmCdSearch.Visible = true;
		edt_WorkFirmNmSearch.Visible = true;
		
		//취소처리 비활성화
		edt_cancel_rmk.Enable = false;
		Btn_cancel.Enable = false;
	}	
	else
	{
		Image20.Visible = false;
		edt_WorkFirmCdSearch.Visible = false;
		edt_WorkFirmNmSearch.Visible = false;	
	}	
	
	edt_DangerNum.Text = "";
	edt_DangerJobStsFlagNm.Text = "";
	fn_D10_Common4();
	btn_DangerWork.Enable = false;
	Btn_Danger_Req.Enable = false;
	btn_Plan_Add.Enable = false;
	btn_Plan_Del.Enable = false;
	
	btn_Safety.Enable = false;
	btn_approval.Enable = false;
	btn_GulChak.Enable = false;
	btn_ScgJoinEmpid.Enable = false;
	fn_D10_Common6();
	
	btn_Report.Visible = false; 
	btn_Report.Enable = false;
	btn_gis.Enable = false;
		
	//gfn_D1_SetGrid_Sort(grd_Main);  -->> 공통로직변경바람.
	//gfn_D1_SetGrid_Sort(grd_DangerJob);
	
	
	//-----------------------------------------
	//  조회조건 초기값 설정
	//-----------------------------------------	
		
	// 시공사이면
 	if( fv_COOP_YN )
 	{
		// 지사설정
		cob_BranchCd.Enable = true;
		cob_BranchCd.Value = "";
		cob_BranchCd_OnChanged();
		// 팀설정	
		cob_TeamCdSearch.Enable = true;	
		cob_TeamCdSearch.Value = "";
		// 시공사 설정
		edt_WorkFirmCdSearch.Text = fv_DEAL_CD;
		edt_WorkFirmNmSearch.Text = fv_DEAL_NM;
		
 	}
 	else
 	{
 		// SCG이면
		
		//-----------------------------------------
		//  지사,팀 콤보박스의 초기 설정
		//-----------------------------------------	
		if (gfn_GetGlobalValue("G_BRANCH_CD") == "999999") 
		{
			// 지사설정
			cob_BranchCd.Enable = true;
			cob_BranchCd.Value = "";
			cob_BranchCd_OnChanged();
			
			// 팀설정	
			cob_TeamCdSearch.Enable = true;	
			cob_TeamCdSearch.Value = "";
		
		} 
		else 
		{
			// 지사설정
			cob_BranchCd.Enable = false;
			cob_BranchCd.Value = gfn_GetGlobalValue("G_BRANCH_CD");
			cob_BranchCd_OnChanged();
			// 팀설정 //상황팀 관계로 팀 해제 2010.3.4 권기철
			//cob_TeamCdSearch.Enable = false;		
			cob_TeamCdSearch.Enable = true;	
			cob_TeamCdSearch.Value = gfn_GetGlobalValue("G_DEPT_CODE");

		}
		
 	}
 	
	//cal_ReqYmdStart.Value = substr(today(),0,6)+"01";		// 작업의뢰일자 default 이번달 1일부터 오늘까지 
	cal_ReqYmdStart.Value = AddDate(today(),-20);
	//cal_ReqYmdEnd.Value = today();
	// 해당날의 마지막날 구하기
	//cal_ReqYmdEnd.Value = adddate(addMonth(substr(today(),0,6)+"01", 1),-1);
	cal_ReqYmdEnd.Value = AddDate(today(),+10);
	cob_DangerJobStsFlag.Value = ''; // 진행상태
		

	//포틀릿 EP화면에서 넘어온것
    if (IsExistVar("dangerNumPK", true)) 				
    {
		//alert("dangerNumPK:"+dangerNumPK);
		//alert("dangerJobFlag:"+dangerJobFlag);

		fv_FindRow_ShowRow = 1;
		fv_FindRow_ShowKey = dangerNumPK; //위험작업번호

		//fn_D1_FindListOne(dangerNumPK, dangerJobFlag);

	}
	
	/*
	//중폐지에서 메인이동 2009.06.08	
    if (IsExistVar("STOP_FLAG", true)) 				
    {
    	if (STOP_FLAG == "NEW") 
		{
		    // 신규등록
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드

		    fn_CommonAddRow();
		    
		    cob_BranchCd01_OnChanged();
		    cob_TeamCd.Value = TEAM_CD;
		    edt_DangerStopNum.Text = DANGER_STOP_NUM;
		    edt_DangerStopFlag.Text = DANGER_STOP_FLAG;
		    
		}
		else if (STOP_FLAG == "STOP") 
		{
			// 기존데이터 조회상태
			alert("DANGER_STOP_NUM:"+DANGER_STOP_NUM);
			alert("DANGER_STOP_FLAG:"+DANGER_STOP_FLAG);

		}

	}		*/

	
	
	
	// 화면연계시 필요한 사항들
	fn_CommonActivate();
	
}
//--------------------------------------------------------------------------------------------------
//	fn_CommonActivate
//-------------------------------------------------------------------------------------------------
function fn_CommonActivate()
{
	//alert("fn_CommonActivate");
	
	
	//중폐지에서 메인이동 2009.06.08	
    if (IsExistVar("STOP_FLAG", true)) 				
    {
		// 신규등록
    	if (STOP_FLAG == "NEW") 
		{
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드


		    // 신규등록
		    // 추가버튼 클릭후 
		    fn_CommonAddRow();
		    
		    cob_BranchCd01_OnChanged();
		    cob_TeamCd.Value = TEAM_CD;
		    
		    edt_DangerStopNum.Text = DANGER_STOP_NUM;   // 위험작업번호 (참조키)
		    edt_DangerStopFlag.Text = DANGER_STOP_FLAG; // 위험작업구분 (참조키)
		    
		    edt_ScgJoinEmpid.Text = EMPID;
		    edt_ScgJoinEmpidNm.Text = EMPNM;
		    edt_ScgJoinPers.Text = '1';
		    
		    cob_BefoMaterFlag1.Value = OLD_MATER_FLAG; // 기존재질
		    cob_BefoMaterFlag_OnChanged(cob_BefoMaterFlag1,cob_BefoMaterFlag1.Value);

			cob_BefoPipeDiamCd1.Value = OLD_DIAM_CD;   // 기존관경
			cob_PressFlag.Value = OLD_PRESS_FLAG;      // 기존압력
			 
			cal_JobReqYmd1.Value = JOB_REQ_YMD;         // 작업요청일자
			edt_JobReqStrTime.Value = JOB_REQ_STR_TIME; // 작업시작시간
			edt_JobReqEndTime.Value = JOB_REQ_END_TIME; // 작업종료시간
			
			edt_WorkFirmCd.Text = WORK_FIRM_CD;// 시공사코드
			edt_WorkFirmCdNm.Text = WORK_FIRM_CD_NM; // 시공사명
			
			// 2013.05.31. 이건민 - 안전공급 개선사항
			edt_ReqNm.Text = REPRE_NM;	// 시공사 대표자
		    cob_WorkFirmTelDdd.Value = WORK_FIRM_TEL_DDD; // 시공사전화번호
		    ect_WorkFirmTelExn.Text = WORK_FIRM_TEL_EXN;  // 시공사전화번호
		    edt_WorkFirmTelNum.Text = WORK_FIRM_TEL_NUM;  // 시공사전화번호
		    
			ds_Multi_Re.SetColumn(0, "ZIP_NO1"      , ZIP_NO1      );  // 우편번호1
			ds_Multi_Re.SetColumn(0, "ZIP_NO2"      , ZIP_NO2      );  // 우편번호2
			ds_Multi_Re.SetColumn(0, "ZIP_SEQ"      , ZIP_SEQ      );  // 우편일련번호
			ds_Multi_Re.SetColumn(0, "HILL"         , HILL         );  // 산번지
			ds_Multi_Re.SetColumn(0, "ADDR_M"       , ADDR_M       );  // 본번
			ds_Multi_Re.SetColumn(0, "ADDR_S"       , ADDR_S       );  // 부번
			ds_Multi_Re.SetColumn(0, "BLD_DONG"     , BLD_DONG     );  // 건물동
			ds_Multi_Re.SetColumn(0, "HOSU"         , HOSU         );  // 호수
			ds_Multi_Re.SetColumn(0, "SECOND_ADDR"  , SECOND_ADDR  );  // 보조주소
			ds_Multi_Re.SetColumn(0, "LOT_NUM_UNION", LOT_NUM_UNION);  // 지번주소조합			    
		    
		    
		    btn_WorkNumButton.Enable = false;   // 공사번호팝업
		    cob_BefoMaterFlag2.Enable = false;  // 신규재질 
		    cob_BefoPipeDiamCd2.Enable = false; // 신규관경 
		    cob_NewPressFlag.Enable = false;    // 신규압력
		    
			alert("[1.중폐지-가정관등록 연계] 신규데이터를 입력가능합니다. 내용을 입력하여 저장하시기 바랍니다.");
		    cal_JobReqYmd1.SetFocus();
		}
		else if (STOP_FLAG == "STOP") // 조회
		{
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드


			fv_FindRow_ShowRow = 1;
			fv_FindRow_ShowKey = DANGER_STOP_NUM; //위험작업번호
	
			fn_D1_FindListOne(DANGER_STOP_NUM, DANGER_STOP_FLAG);
			
			if( ds_Multi.GetRowCount() > 0)
			{
				alert("[1.중폐지-가정관등록 연계] 위험작업번호("+DANGER_STOP_NUM +") 의 데이터가 조회 되었습니다.");
			}
			else
			{
				alert("[1.중폐지-가정관등록 연계] 위험작업번호("+DANGER_STOP_NUM +") 의 데이터가 존재하지 않습니다.");				
			}
			// 기존데이터 조회상태
			//alert("DANGER_STOP_NUM:"+DANGER_STOP_NUM);
			//alert("DANGER_STOP_FLAG:"+DANGER_STOP_FLAG);
			cal_JobReqYmd1.SetFocus();
		}

	}	
	
	// 시설물 정비보수작업 의뢰 
    if (IsExistVar("MAIN_FLAG", true)) 				
    {
		// 신규등록
    	if (MAIN_FLAG == "NEW") 
		{
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드


		    // 신규등록
		    // 추가버튼 클릭후 
		    fn_CommonAddRow();
		    
		    cob_BranchCd01_OnChanged();
		    cob_TeamCd.Value = TEAM_CD;
		    edt_DangerStopNum.Text = DANGER_STOP_NUM;   // 위험작업번호 (참조키) - 정비보수번호
		    //edt_DangerStopFlag.Text = DANGER_STOP_FLAG; // 위험작업구분 (참조키) - 00
		    //2010.10.13권기철 변경함.
		    edt_DangerStopFlag.Text = '40'; // 위험작업구분 (참조키) - 40  정비보수건 D10140코드 참조			
		    
		    
		    cob_BefoMaterFlag1.Value = OLD_MATER_FLAG; // 기존재질
		    cob_BefoMaterFlag_OnChanged(cob_BefoMaterFlag1,cob_BefoMaterFlag1.Value);
		    
			cob_BefoPipeDiamCd1.Value = OLD_DIAM_CD;   // 기존관경
			cob_PressFlag.Value = OLD_PRESS_FLAG;      // 기존압력
			
			cal_JobReqYmd1.Value = JOB_REQ_YMD;         // 작업요청일자
			edt_JobReqStrTime.Value = JOB_REQ_STR_TIME; // 작업시작시간
			edt_JobReqEndTime.Value = JOB_REQ_END_TIME; // 작업종료시간
			
			edt_WorkFirmCd.Text = WORK_FIRM_CD;// 시공사코드
			edt_WorkFirmCdNm.Text = WORK_FIRM_CD_NM; // 시공사명
			
			// 2013.05.31. 이건민 - 안전공급 개선사항
			edt_ReqNm.Text = REPRE_NM;	// 시공사 대표자
			cob_WorkFirmTelDdd.Value = WORK_FIRM_TEL_DDD; // 시공사전화번호
		    ect_WorkFirmTelExn.Text = WORK_FIRM_TEL_EXN;  // 시공사전화번호
		    edt_WorkFirmTelNum.Text = WORK_FIRM_TEL_NUM;  // 시공사전화번호
		    
		    // 2013.06.17. 이건민 - 안전공급 개선사항 (안전기획팀 기기현 과장님 추가요청으로 하드코딩)
		    if(trim(edt_WorkFirmCd.Text) == "1178118618")			// 서부지사, 삼기에너지
			{
				edt_WorkManagerNm.Text 		= "최현재";
				cob_WorkManagerTelDdd.Index = 0;
				edt_WorkManagerTelExn.Text 	= "4324";
				edt_WorkManagerTelNum.Text 	= "7322";
				
				edt_SiteChiefNm.Text   		= "박용순";
				cob_SiteChiefTelDdd.Index 	= 0;
				edt_SiteChiefTelExn.Text 	= "3563";
				edt_SiteChiefTelNum.Text 	= "4777";
				
			}
			else if(trim(edt_WorkFirmCd.Text) == "1088193345")		// 남부지사, 태연기연
			{
				edt_WorkManagerNm.Text 		= "이동현";
				cob_WorkManagerTelDdd.Index = 0;
				edt_WorkManagerTelExn.Text 	= "8876";
				edt_WorkManagerTelNum.Text 	= "1135";
				
				edt_SiteChiefNm.Text   		= "권오경";
				cob_SiteChiefTelDdd.Index 	= 0;
				edt_SiteChiefTelExn.Text 	= "2101";
				edt_SiteChiefTelNum.Text 	= "9515";
			}
			else if(trim(edt_WorkFirmCd.Text) == "1178131246")		// 강북지사, 성윤이엔지
			{
				edt_WorkManagerNm.Text 		= "한춘입";
				cob_WorkManagerTelDdd.Index = 0;
				edt_WorkManagerTelExn.Text 	= "2379";
				edt_WorkManagerTelNum.Text 	= "1994";
				
				edt_SiteChiefNm.Text   		= "조익";
				cob_SiteChiefTelDdd.Index 	= 1;
				edt_SiteChiefTelExn.Text 	= "778";
				edt_SiteChiefTelNum.Text 	= "6591";
			}
			else											// 경기지사, 협성설비
			{
				edt_WorkManagerNm.Text 		= "강희성";
				cob_WorkManagerTelDdd.Index = 0;
				edt_WorkManagerTelExn.Text 	= "9039";
				edt_WorkManagerTelNum.Text 	= "0400";
				
				edt_SiteChiefNm.Text   		= "임진선";
				cob_SiteChiefTelDdd.Index 	= 1;
				edt_SiteChiefTelExn.Text 	= "255";
				edt_SiteChiefTelNum.Text 	= "2760";
			}
		    
			ds_Multi_Re.SetColumn(0, "ZIP_NO1"      , ZIP_NO1      );  // 우편번호1
			ds_Multi_Re.SetColumn(0, "ZIP_NO2"      , ZIP_NO2      );  // 우편번호2
			ds_Multi_Re.SetColumn(0, "ZIP_SEQ"      , ZIP_SEQ      );  // 우편일련번호
			ds_Multi_Re.SetColumn(0, "HILL"         , HILL         );  // 산번지
			ds_Multi_Re.SetColumn(0, "ADDR_M"       , ADDR_M       );  // 본번
			ds_Multi_Re.SetColumn(0, "ADDR_S"       , ADDR_S       );  // 부번
			ds_Multi_Re.SetColumn(0, "BLD_DONG"     , BLD_DONG     );  // 건물동
			ds_Multi_Re.SetColumn(0, "HOSU"         , HOSU         );  // 호수
			ds_Multi_Re.SetColumn(0, "SECOND_ADDR"  , SECOND_ADDR  );  // 보조주소
			ds_Multi_Re.SetColumn(0, "LOT_NUM_UNION", LOT_NUM_UNION);  // 지번주소조합	
			//당사입회자 연계 추가(로그인자)2010.10.11 권기철
			ds_Multi_Re.SetColumn(0, "SCG_JOIN_EMPID"  , gfn_GetGlobalValue("G_USER_NO"));  // 당사입회자 사번
			ds_Multi_Re.SetColumn(0, "SCG_JOIN_EMPID_NM", gfn_GetGlobalValue("G_NAME"));  // 당사입회자명
		    ds_Multi_Re.SetColumn(0, "SCG_JOIN_PERS", 1);
					    
		    
		    btn_WorkNumButton.Enable = false;   // 공사번호팝업
		    cob_BefoMaterFlag2.Enable = false;  // 신규재질 
		    cob_BefoPipeDiamCd2.Enable = false; // 신규관경 
		    cob_NewPressFlag.Enable = false;    // 신규압력
		    
			alert("[2.정비보수의뢰-가정관등록 연계] 신규데이터를 입력가능합니다. 내용을 입력하여 저장하시기 바랍니다.");
		    cal_JobReqYmd1.SetFocus();
		}
		else if (MAIN_FLAG == "STOP") // 조회
		{
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드

			fv_FindRow_ShowRow = 1;
		    edt_DangerStopFlag.Text = DANGER_STOP_FLAG; // 위험작업구분 (참조키) - 00
	
			fn_D1_FindListOne(DANGER_STOP_NUM, DANGER_STOP_FLAG);
			
			if( ds_Multi.GetRowCount() > 0)
			{
				alert("[2.정비보수의뢰-가정관등록 연계] 위험작업번호("+DANGER_STOP_NUM +") 의 데이터가 조회 되었습니다.");
			}
			else
			{
				alert("[2.정비보수의뢰-가정관등록 연계] 위험작업번호("+DANGER_STOP_NUM +") 의 데이터가 존재하지 않습니다.");				
			}
			// 기존데이터 조회상태
			//alert("DANGER_STOP_NUM:"+DANGER_STOP_NUM);
			//alert("DANGER_STOP_FLAG:"+DANGER_STOP_FLAG);
			cal_JobReqYmd1.SetFocus();
		}

	}
	
	
	// 타블릿용 (TABLET) - 싱글팝에서 띄우기 때문에 여기밖에 안됨. 
    if (IsExistVar("TAB_FLAG", true)) 				
    {
    
		// 신규등록
    	if (TAB_FLAG == "NEW") 
		{
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드

		    // 신규등록
		    // 추가버튼 클릭후 
		    fn_CommonAddRow();
		    
		    cob_BranchCd01_OnChanged();
		    cob_TeamCd.Value = TEAM_CD;
		    edt_DangerStopNum.Text = DANGER_STOP_NUM;   // 위험작업번호 (참조키) - 정비보수번호
		    //edt_DangerStopFlag.Text = DANGER_STOP_FLAG; // 위험작업구분 (참조키) - 00
		    //2010.10.13권기철 변경함.
		    edt_DangerStopFlag.Text = '40'; // 위험작업구분 (참조키) - 40  정비보수건 D10140코드 참조			
		    
		    
		    cob_BefoMaterFlag1.Value = OLD_MATER_FLAG; // 기존재질
		    cob_BefoMaterFlag_OnChanged(cob_BefoMaterFlag1,cob_BefoMaterFlag1.Value);
		    
			cob_BefoPipeDiamCd1.Value = OLD_DIAM_CD;   // 기존관경
			cob_PressFlag.Value = OLD_PRESS_FLAG;      // 기존압력
			
			cal_JobReqYmd1.Value = JOB_REQ_YMD;         // 작업요청일자
			edt_JobReqStrTime.Value = JOB_REQ_STR_TIME; // 작업시작시간
			edt_JobReqEndTime.Value = JOB_REQ_END_TIME; // 작업종료시간
			
			edt_WorkFirmCd.Text = WORK_FIRM_CD;// 시공사코드
			edt_WorkFirmCdNm.Text = WORK_FIRM_CD_NM; // 시공사명
			//시공회사 기본정보 연계
			fn_WorkFirm_info();
			/*
			edt_ReqNm.Text = ;//시공사 대표자명
			cob_WorkFirmTelDdd.Text = ;//시공회사 전화번호1
			ect_WorkFirmTelExn.Text = ;//시공회사 전화번호2
			edt_WorkFirmTelNum.Text = ;//시공회사 전화번호3
		    */
		    btn_WorkNumButton.Enable = false;   // 공사번호팝업
		    cob_BefoMaterFlag2.Enable = false;  // 신규재질 
		    cob_BefoPipeDiamCd2.Enable = false; // 신규관경 
		    cob_NewPressFlag.Enable = false;    // 신규압력
		    
		    
			alert("[3.타블릿-정비보수의뢰-가정관등록 연계] 신규데이터를 입력가능합니다. 내용을 입력하여 저장하시기 바랍니다.");
		    cal_JobReqYmd1.SetFocus();
		    
		}
		else if (TAB_FLAG == "STOP") // 조회
		{
		
		    // 타블릿에서 정비보수번호만 가지고 있기에
		    
		    
		    // 조회조건셋팅
		    cob_BranchCd.Value = BRANCH_CD; 		//지사코드
		    cob_BranchCd_OnChanged();
		    cob_TeamCdSearch.Value = TEAM_CD;		//팀코드

            // 정비보수번호로 조회
			fv_FindRow_ShowRow = 1;
			fv_FindRow_ShowKey = DANGER_STOP_NUM; //위험작업번호
	
			fn_D1_FindListOneTAB(DANGER_STOP_NUM, '40'); // 타블릿은 정비보수번호를 던진다.
			
			if( ds_Multi.GetRowCount() > 0)
			{
				alert("[3.타블릿-정비보수의뢰-가정관등록 연계] 위험작업 데이터가 조회 되었습니다.");
			}
			else
			{
				alert("[3.타블릿-정비보수의뢰-가정관등록 연계] 위험작업 데이터가 존재하지 않습니다.");				
			}

			cal_JobReqYmd1.SetFocus();
		}

	}
		
	
}
//-------------------------------------------------------------------------------
// 함수명   : D1501010011F_OnUnloadCompleted()
// 설명     : 닫기 버튼 클릭시 실행 
// return 내용 : 
//-------------------------------------------------------------------------------
function D1501010011F_OnUnloadCompleted(obj)
{
	/*
	if(ds_Multi_Re.GetUpdate())
	{
		if(!confirm(gfn_GetMessage("M000016","%AAA%","변경된 값이 있습니다. 종료")))
		{
			return false;
		} 
	}
	*/
	
}

//--------------------------------------------------------------------------------------------------
//	fn_Init
//--------------------------------------------------------------------------------------------------
function fn_Init()
{

	grd_Main.NoDataText = gfn_GetMessage("M000022","%AAA%","조회결과가");

	//gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd"));				//지사코드
	gfn_D1_All_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd"));				//지사코드

	gfn_D1_SetComboBox_Branchcd(gfn_D1_setDsObject_Branchcd("cob_BranchCd01"));				//지사코드
	//gfn_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("cob_MlPressMPress")); 		//관경코드(중압)
	gfn_D1_NULL_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("cob_MlPressMPress"));
	//gfn_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("cob_MlPressLPress")); 		//관경코드(저압)
	gfn_D1_NULL_SetComboBox_Comcode("B30007",gfn_setDsObject_Comcode("cob_MlPressLPress"));
	
	gfn_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("cob_BefoMaterFlag1")); 		//재질코드 (현재 운영계만 적용)(06.08)
	gfn_SetComboBox_Comcode("D10002",gfn_setDsObject_Comcode("cob_BefoMaterFlag2")); 		//재질코드 (현재 운영계만 적용)(06.08)
	gfn_SetComboBox_Comcode("D10034",gfn_setDsObject_Comcode("cob_PressFlag")); 			//압력구분 
	gfn_SetComboBox_Comcode("D10034",gfn_setDsObject_Comcode("cob_NewPressFlag")); 			//압력구분 	
	gfn_SetComboBox_Comcode("D10219",gfn_setDsObject_Comcode("cob_JobMothodCd")); 			//작업방법	
	
	//gfn_SetComboBox_Comcode("D10228",gfn_setDsObject_Comcode("cob_Rocation")); 				
	gfn_D1_NULL_SetComboBox_Comcode("D10228",gfn_setDsObject_Comcode("cob_Rocation"));      //위치구분
	gfn_SetComboBox_Comcode("B20022",gfn_setDsObject_Comcode("cob_RcType")); 				//복구형태
	gfn_SetComboBox_Comcode("D10225",gfn_setDsObject_Comcode("cob_MidPressCrossYn")); 		//중저압병행
	gfn_D1_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_WorkFirmTelDdd"),"010#011#016#017#018#019"); 	//식별번호(시공회사전화)
	gfn_D1_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_WorkManagerTelDdd"),"0130#02#031#032#033#041#042#043#0502#0505#051#052#053#054#055#061#062#063#064");  //식별번호(시공관리지전화)
	gfn_D1_SetComboBox_Comcode("A10110",gfn_setDsObject_Comcode("cob_SiteChiefTelDdd"),"0130#02#031#032#033#041#042#043#0502#0505#051#052#053#054#055#061#062#063#064");    //식별번호(현장소장전화)
	gfn_SetComboBox_Comcode("B20041",gfn_setDsObject_Comcode("cob_PavementKind")); 			//포장종류
	
	gfn_SetGrdComboBox_Comcode ("grd_DangerJob",4,"D10156");
	
	gfn_SetComboBox_Comcode("A10411",gfn_setDsObject_Comcode("cob_DECIDE_PROC_STS")); 				//결재진행상태 
	gfn_SetComboBox_Comcode("A10411",gfn_setDsObject_Comcode("cob_chg_state")); 				//변경결재진행상태 

}

//-------------------------------------------------------------------------------
// 설명     : 공통 조회 
//-------------------------------------------------------------------------------
function fn_CommonSearch()
{
	
	/*
	// 시공사이면
 	if( ! fv_COOP_YN )
 	{
		if (gfn_isNull( cob_BranchCd.Value )) //지사 선택
		{
			alert(gfn_GetMessage("M000040", "%AAA%", "지사를"));
			cob_BranchCd.SetFocus();
			return;
		}
	}
	*/
	
	fn_D1_FindList();
	//fn_D1_FindListExcel();
	
	edt_Count.Text = ds_Multi.GetRowCount();
}

/********************************************************************************
* 기      능   :  공통 조회 버튼(CommonSearch) 클릭시 실행
********************************************************************************/
function fn_D1_FindList()
{	

	ds_Multi.ClearData();

	//'팀코드가 200138','200148','200149','200151' 이면 지사코드를 ''으로 넣어준다 20110923 이상목 권기철과장요청
    if(cob_TeamCdSearch.Value == "200138" || cob_TeamCdSearch.Value == "200148" || cob_TeamCdSearch.Value == "200149" || cob_TeamCdSearch.Value == "200151")
    {
		ds_SearchTop.SetColumn(0,"BRANCH_CD"          , ""       );  // 지사
    }else{
		ds_SearchTop.SetColumn(0,"BRANCH_CD"          , cob_BranchCd.Value        );  // 지사
    }    
    ds_SearchTop.SetColumn(0,"ZIP_NO1"            , cob_ZipNo1.Value          );  // 시/구
    ds_SearchTop.SetColumn(0,"TEAM_CD"            , cob_TeamCdSearch.Value    );  // 팀
    ds_SearchTop.SetColumn(0,"REQ_YMD_START"      , cal_ReqYmdStart.Value     );  // 작업요청일자
    ds_SearchTop.SetColumn(0,"REQ_YMD_END"        , cal_ReqYmdEnd.Value       );  // 작업요청일자
    //ds_SearchTop.SetColumn(0,"JOB_NM"             , edt_JobNm.Text            );  // 작업명
	ds_SearchTop.SetColumn(0,"DANGER_JOB_STS_FLAG", cob_DangerJobStsFlag.Value);  // 진행상태
	ds_SearchTop.SetColumn(0,"WORK_FIRM_CD"       , edt_WorkFirmCdSearch.Text );  // 시공사


	var strSvcID = "findList";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi=ds_Multi";
	var strArgument  = "searchList=1";
		
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   

}

//-------------------------------------------------------------------------------
// 가정관-중폐지 연계시 조회
//-------------------------------------------------------------------------------
function fn_D1_FindListOne(strDANGER_NUM, strDANGER_JOB_FLAG)
{	

	ds_Multi.ClearData();

	ds_SearchTop.ClearData();
	ds_SearchTop.AddRow();
    ds_SearchTop.SetColumn(0,"DANGER_NUM"      , strDANGER_NUM      );  // 위험작업번호
    ds_SearchTop.SetColumn(0,"DANGER_JOB_FLAG" , strDANGER_JOB_FLAG );  // 위험작업구분

	var strSvcID = "findListOne";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi=ds_Multi";
	var strArgument  = "searchOne=1";
		
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   

}

//-------------------------------------------------------------------------------
// 타블릿연계시 조회
//-------------------------------------------------------------------------------
function fn_D1_FindListOneTAB(strDANGER_NUM, strDANGER_JOB_FLAG)
{	

	ds_Multi.ClearData();

	ds_SearchTop.ClearData();
	ds_SearchTop.AddRow();
    ds_SearchTop.SetColumn(0,"DANGER_NUM"      , strDANGER_NUM      );  // 위험작업번호 - 타블릿은 정비보수번호
    ds_SearchTop.SetColumn(0,"DANGER_JOB_FLAG" , strDANGER_JOB_FLAG );  // 위험작업구분

	var strSvcID = "findList";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi=ds_Multi";
	var strArgument  = "searchOneTAB=1";
		
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   

}

//--------------------------------------------------------------------------------------------------
//	서비스 CallBack
//--------------------------------------------------------------------------------------------------
function fn_D1_CallBack(SrvID,ErrorCode,ErrorMsg)
{

	if(ErrorCode < 0) {
	
		alert(ErrorMsg);
		//에러시 초기화
		fv_FindRow_ShowRow = -1;
		return;
	}
	
    switch(SrvID){

		//상세 조회
        case "findDetail":
        

			gfn_D1_SetComboBox_Teamcd01("ds_Team_01",cob_BranchCd01);        
			cob_MidPressCrossYn_OnChanged(); // 중저압병행
	        
			cob_BefoMaterFlag1.Value = ds_Multi_Re.GetColumn(0, "BEFO_MATER_FLAG");
			cob_BefoMaterFlag2.Value = ds_Multi_Re.GetColumn(0, "NEW_MATER_FLAG" );
			
			if(!gfn_IsNull(ds_Multi_Re.GetColumn(0, "BEFO_MATER_FLAG"))){
				cob_BefoMaterFlag_OnChanged(cob_BefoMaterFlag1);
			}
			
			if(!gfn_IsNull(ds_Multi_Re.GetColumn(0, "NEW_DIAM_CD"))){
				cob_BefoMaterFlag_OnChanged(cob_BefoMaterFlag2);
			}	        
	        
			edt_Sum.Value = ParseInt(cob_DirRcAmt.Value)+ParseInt(edt_IndRcAmt.Value)+ParseInt(edt_LicenseTax.Value)+ParseInt(edt_LeaseAmt.Value);	        
	        
			ds_DangerEqup.SetColumn(0,"EA1",ds_DangerEqup02.GetColumn(0,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(0,"EA2",ds_DangerEqup02.GetColumn(1,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(1,"EA1",ds_DangerEqup02.GetColumn(2,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(1,"EA2",ds_DangerEqup02.GetColumn(3,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(2,"EA1",ds_DangerEqup02.GetColumn(4,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(2,"EA2",ds_DangerEqup02.GetColumn(5,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(3,"EA1",ds_DangerEqup02.GetColumn(6,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(3,"EA2",ds_DangerEqup02.GetColumn(7,"EQUIP_QTY")); 	
			ds_DangerEqup.SetColumn(4,"EA1",ds_DangerEqup02.GetColumn(8,"EQUIP_QTY")); 
			ds_DangerEqup.SetColumn(4,"EA2",ds_DangerEqup02.GetColumn(9,"EQUIP_QTY")); 	
	
			fn_D1_OnRowPosChanged();
			
			if( !gfn_IsNull( ds_Multi_Re.GetColumn(0,"DANGER_STOP_NUM")  ) )
			{
				btn_WorkNumButton.Enable = false;   // 공사번호팝업
				cob_BefoMaterFlag2.Enable = false;  // 신규재질 
				cob_BefoPipeDiamCd2.Enable = false; // 신규관경 
				cob_NewPressFlag.Enable = false;    // 신규압력
			}
        
			// 로우선택하기
			if(fv_FindRow_ShowRow > 0)
			{
				var nFocusRow = ds_Multi.FindRow("DANGER_NUM",fv_FindRow_ShowKey);
				if (nFocusRow != -1)
				{
					ds_Multi.row = nFocusRow;
				}	
				fv_FindRow_ShowRow = -1;
			}
		
        	break;	

        default:

    }
}

//--------------------------------------------------------------------------------------------------
// 로우 변경시
//--------------------------------------------------------------------------------------------------
function ds_Multi_OnRowPosChanged(obj,nOldRow,nRow)
{
	//trace("ds_Multi_OnRowPosChanged - " +nRow +" "+danger_num);
	
	
	if(nRow < 0) 
	{
		//로우 없을경우 초기화
		ds_Multi_Re.ClearData();  // 위험작업내역등록
		ds_DangerJob.ClearData(); // 작업계획
		// 안전장비
		fn_D10_Common8();
		
		ds_Review.ClearData();        // 검토/반려
		ds_DecideReq.ClearData();     // 결재/반려
		ds_Multi_Re_chg.ClearData();     // 변경승인요청
	}
	else
	{
		danger_num          = ds_Multi.GetColumn(nRow, "DANGER_NUM");
		danger_job_flag     = ds_Multi.GetColumn(nRow, "DANGER_JOB_FLAG");
		danger_job_sts_flag = ds_Multi.GetColumn(nRow, "DANGER_JOB_STS_FLAG");
		
		fn_D1_SearchDetailTeamUserList();	// 팀장 명 및 코드 가져오기 
		// detail Grid 조회
		fn_D1_SearchDetail(nRow); 		// 정비보수 내역 조회	
		// 첨부화일
		fn_File_List();
	}
	
}
//--------------------------------------------------------------------------------------------------
// 상세조회 - 위험작업내역 상세조회 
//--------------------------------------------------------------------------------------------------
function fn_D1_SearchDetail(nRow)
{	

	if(nRow < 0) return;
	
	ds_Multi_Re.ClearData();
	ds_DangerJob.ClearData();
	ds_DangerEqup02.ClearData();
	ds_Multi_Ok_chg.ClearData();
		
	var strSvcID = "findDetail";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_Multi_Re=ds_Multi_Re ds_DangerJob=ds_DangerJob ds_DangerEqup02=ds_DangerEqup02 ds_Multi_Ok_chg=ds_Multi_Ok_chg";
	var strArgument    = "searchDetail=1";
		strArgument	  += " DANGER_NUM=" + quote(danger_num);
		strArgument	  += " DANGER_JOB_FLAG=" + quote(danger_job_flag);	
	var strCallbackFunc = "fn_D1_CallBack";	
		
	gfn_AsyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				   , strCallbackFunc
			   );

	
}

function fn_D1_OnRowPosChanged()
{	
// 위험작업 요청전	00
// 위험작업 요청	01
// 반려	            02
// 변경요청	        03
// 승인         	04
// 결재반려	        05
// 변경요청반려	    06
// 결재승인	        07
// 변경요청승인	    08


	//############################################################################
	// 모든화면을 막는다.
	//############################################################################
	fn_D10_Common4();
	fn_D10_Common5();
	fn_D10_Common6();
	
	btn_gis.Enable = false;         // GIS_위치보기
	btn_DangerWork.Enable = false;  // 위험작업 허가기준
	Btn_Danger_Req.Enable = false;  // 위험작업요청
	
	st_chg_rmk.Visible = false; 
	btn_Plan_Add.Enable = false;    // 추가
	btn_Plan_Del.Enable = false;    // 삭제
	
	
	btn_GulChak.Enable = false;     // 굴착확인	
	btn_Safety.Enable = false;      // 안전수칙
	
	btn_Valuation.Enable = false;   // 업체평가
	btn_approval.Enable = false;    // 전자결재
	btn_Report.Visible = false; 
	btn_Report.Enable = false;  	// 장표
	
	btn_ScgJoinEmpid.Enable = false; // 입회자
	
	// 검토
	edt_ReviewOpni.Enable = false; // 검토의견
	
	fn_D10_CommonJobResult(false);	 // 6. 작업결과 작성 비활성화
	
	// 데이터 바인딩	
	fn_D10_Common_Review();  		//검토 승인/반려 부분
	fn_D10_Common_DecideReq();		//결재/반려 부분
	fn_D10_Common_ReqChange();		//변경 승인 부분 
	fn_D10_Common_Result();			//결과 등록부분 	
	
	brn_work_save.Enable = false;
	btn_chg.Enable = false;
	edt_ChgApproWhy.Enable = false;			
	cal_ChgApproReqYmd.Enable = false;	

	
	//############################################################################
	// 권한에 따라서 화면을 풀어준다.
	//############################################################################

	btn_gis.Enable = true;         // GIS_위치보기
	btn_DangerWork.Enable = true;  // 위험작업 허가기준	

	grd_DangerJob.SetCellProp("body",1,"Edit","none");
	grd_DangerJob.SetCellProp("body",3,"Edit","none");
	grd_DangerJob.SetCellProp("body",4,"Edit","none");
	grd_DangerJob.SetCellProp("body",5,"Edit","none");
	
	if( fv_COOP_YN ) // 협력사이면 불가능
	{
		btn_Safety.Enable = false;      // 안전수칙
		edt_cancel_rmk.Enable = false;
		Btn_cancel.Enable = false;						
	}
	else
	{
		btn_Safety.Enable = true;      // 안전수칙
		/*
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "10" || danger_job_sts_flag == "90") 
		{
			edt_cancel_rmk.Enable = false;
			Btn_cancel.Enable = false;		
		}
		*/
		//2012.04.23 권기철과장님 추가요청_이건민
		//00 위험작업 요청전, 02 검토반려, 10 공사완료, 90 공사취소
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02" || danger_job_sts_flag == "10" || danger_job_sts_flag == "90") 
		{
			edt_cancel_rmk.Enable = false;
			Btn_cancel.Enable = false;		
		}
		else
		{
			edt_cancel_rmk.Enable = true;
			Btn_cancel.Enable = true;
		}	
	}
	
	// 등록상태(00) 반려(02)
	if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
	{	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{
			fn_D10_Common7();						//위험작업 내역 활성화
			cob_Rocation_OnChanged();
			
			grd_DangerJob.Enable = true;	// 작업계획(시공사)
			Btn_Danger_Req.Enable = true;   // 위험작업요청

			btn_Plan_Add.Enable = true;     // 추가
			btn_Plan_Del.Enable = true;     // 삭제
			
			grd_DangerJob.SetCellProp("body",1,"Edit","mask");
			grd_DangerJob.SetCellProp("body",3,"Edit","mask");
			grd_DangerJob.SetCellProp("body",4,"Edit","combo");
			grd_DangerJob.SetCellProp("body",5,"Edit","normal");
		}
		else // SCG
		{

			if( ! gfn_IsNull( ds_Multi_Re.GetColumn(0, "DANGER_STOP_NUM") ))
			{
				Btn_Danger_Req.Enable = true;   // 위험작업요청
				chk_Change3.Enable = false;
				
				edt_ReviewOpni.Enable = true; // 검토의견 
				btn_Safety.Enable = true;      // 안전수칙		
	
				btn_Plan_Add.Enable = false;     // 추가
				btn_Plan_Del.Enable = false;     // 삭제
				
				grd_DangerJob.SetCellProp("body",1,"Edit","none");
				grd_DangerJob.SetCellProp("body",3,"Edit","none");
				grd_DangerJob.SetCellProp("body",4,"Edit","none");
				grd_DangerJob.SetCellProp("body",5,"Edit","none");				
			}
			else if ((gfn_GetGlobalValue("G_USER_NO") == "199443297") || (gfn_GetGlobalValue("G_USER_NO") == "700004008"))
			{
				Btn_Danger_Req.Enable = true;   // 위험작업요청				
			}
		}

	}else if(danger_job_sts_flag == "01" || danger_job_sts_flag == "05")		//-----위험요청승인-----
	{
	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{
		
		}
		else // SCG
		{
				fn_D10_Common7();						//위험작업 내역 활성화
				//SCG는  SCG입회자, 작업요청일자, 공사번호 수정은 불가함
				btn_WorkNumButton.Enable = false;
				btn_ScgJoinEmpid.Enable = false;
				cal_JobReqYmd1.Enable = false;
				
				cob_Rocation_OnChanged();
				
				chk_Change3.Enable = true;
				
				st_chg_rmk.Visible = true; 
				
				grd_DangerJob.Enable = true;	// 작업계획(시공사)
				Btn_Danger_Req.Enable = true;   // 위험작업요청
				
				edt_ReviewOpni.Enable = true; // 검토의견 

				btn_Plan_Add.Enable = true;     // 추가
				btn_Plan_Del.Enable = true;     // 삭제
				
				grd_DangerJob.SetCellProp("body",1,"Edit","mask");
				grd_DangerJob.SetCellProp("body",3,"Edit","mask");
				grd_DangerJob.SetCellProp("body",4,"Edit","combo");
				grd_DangerJob.SetCellProp("body",5,"Edit","normal");
								
				btn_approval.Enable = true; // 전자결재버튼(결재처리)
		}

	}else if(danger_job_sts_flag == "04")		//-----검토승인상태-----
	{   
	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{
		
		
		}
		else // SCG
		{
			btn_approval.Enable = true; // 전자결재버튼(결재처리)
			btn_Report.Enable = true;   // 장표
		}
		
	}else if(danger_job_sts_flag == "07") // 결재승인(07)
	{
	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{

		}
		else // SCG
		{
		
			fn_D10_CommonJobResult(true);	 // 6. 작업결과 작성 활성화
			btn_Report.Visible = true;     
			btn_Report.Enable = true;
			btn_Valuation.Enable = true;     // 업체평가 
			cal_ChgApproReqYmd.Enable = true;
			edt_ChgApproWhy.Enable = true;			
			brn_work_save.Enable = true;
			//변경처리
			btn_chg.Enable = true;
			edt_ChgApproWhy.Enable = true;			
			cal_ChgApproReqYmd.Enable = true;
		}		
		
	}else if(danger_job_sts_flag == "03")	// 변경요청
	{
	
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{

		}
		else // SCG
		{		
			cal_ChgApproReqYmd.Enable = true;
			edt_ChgApproWhy.Enable = true;
			//변경처리
			btn_chg.Enable = true;
			edt_ChgApproWhy.Enable = true;			
			cal_ChgApproReqYmd.Enable = true;
		}	
		
	}else if(danger_job_sts_flag == "06")	   // 변경요청반려 (06)
	{
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{

		}
		else // SCG
		{
			cal_ChgApproReqYmd.Enable = true;
			edt_ChgApproWhy.Enable = true;
			//변경처리
			btn_chg.Enable = true;
			edt_ChgApproWhy.Enable = true;			
			cal_ChgApproReqYmd.Enable = true;			
		}

		
	}else if(danger_job_sts_flag == "08")	     // 변경요청완료(08)
	{
		if( fv_COOP_YN ) // 협력사이면 수정가능
		{

		}
		else // SCG
		{
			fn_D10_CommonJobResult(true);	 // 6. 작업결과 작성 활성화 
			btn_Valuation.Enable = true; // 업체평가 
			btn_Report.Visible = true; 
			btn_Report.Enable = true;	
			brn_work_save.Enable = true;
		}

	}
	// 2012.08.28 이건민 - 권기철 과장님 추가요청 사항 (공사완료 건에 대해서 작업결과내용 수정이 가능하도록 수정요청)
	else if(danger_job_sts_flag == "10")	     // 공사완료(10)
	{
		brn_work_save.Enable = true;
		edt_JobResult.Enable = true;
	}
}	

//---------------------------------------------------------------------------------------------------
// 기      능   :  공통 저장 (2009.01.17 현재 검토(접수/반려) 부분까지 ==> 결재후 승인/반려 SELECT 
//---------------------------------------------------------------------------------------------------
function fn_CommonSave()
{	
	danger_job_sts_flag = edt_DangerJobStsFlag.Text;


// 위험작업 요청전	00
// 위험작업 요청	01
// 반려	            02
// 변경요청	        03
// 승인         	04
// 결재반려	        05
// 변경요청반려	    06
// 결재승인	        07
// 변경요청승인	    08	

	if( fv_COOP_YN ) // 협력사이면 수정가능
	{
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
		{
		}
		else
		{
			alert("[시공사] 저장할 수 없습니다. 수정가능한 진행상태까지 기다려 주십시오.");
			return;
		}

	}
	else // SCG
	{
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "01" || danger_job_sts_flag == "05" ||  danger_job_sts_flag == "07"  || danger_job_sts_flag == "08")
		{
		}
		else
		{		
			alert("[SCG] 저장할 수 없습니다. 수정가능한 진행상태까지 기다려 주십시오.");		
			return;
		}
	}	

	if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02") // 요청전(00), 반려(02)
	{
		var chk01 = fn_D11_Validation01();
		if(chk01 == "1")
		{
			return;
		}
		else
		{
			fn_D10_Save1();  //위험작업 작업내용	
		}
		
	}else if(danger_job_sts_flag == "01" || danger_job_sts_flag == "05")			//위험작업요청상태
	{
		var chk01 = fn_D11_Validation01();
		if(chk01 == "1")
		{
			return;
		}else
		{
			fn_D10_Save1();  //작업계획(SCG)
		}
				
			
	}else if(danger_job_sts_flag == "04")	//검토자 승인상태
	{

	}else if(danger_job_sts_flag == "05")	//팀장 반려상태
	{

	}else if(danger_job_sts_flag == "07")	// 팀장 승인상태 
	{
	
	}else if(danger_job_sts_flag == "03")	// 변경승인 요청 
	{

	}else if(danger_job_sts_flag == "06")	// 변셩승인 요청 반려 
	{

	}else if(danger_job_sts_flag == "08")	// 변경요청승인
	{

	}
}
//-------------------------------------------------------------------------------
// 기      능   :  공통 추가
//-------------------------------------------------------------------------------
function fn_CommonAddRow()
{ 
	if( gfn_IsNull(cob_BranchCd.Value))
	{
		alert("먼저 지사를 선택하시고 조회바랍니다.");
		cob_BranchCd.SetFocus();
		return;
	}	
	
	fn_D10_Common7();
	
	btn_DangerWork.Enable = true;
	Btn_Danger_Req.Enable = false;
	btn_Plan_Add.Enable = true;
	btn_Plan_Del.Enable = true;
	btn_Safety.Enable = true;	
	btn_approval.Enable = false;
	btn_ScgJoinEmpid.Enable = true;
	btn_gis.Enable = false;
	st_chg_rmk.Visible = false; 
	btn_Safety.Enable = false;
	btn_Valuation.Enable = false;
	
	fn_D10_Common4();
	fn_D10_Common5();
	fn_D10_Common8();
	edt_Zip1.Text = "";
	edt_Zip2.Text = "";
	edt_LotNumUnion.Text = "";		

	ds_Multi_Re.ClearData();
	ds_Multi_Re.AddRow();

	// 시공사 이면
	if(fv_COOP_YN)
	{
		edt_WorkFirmCd.Text = gfn_GetGlobalValue("G_DEAL_CD");		  
		edt_WorkFirmCdNm.Text = gfn_GetGlobalValue("G_COM_NAME"); 
	}
	
	edt_DangerNum.Text = "";  					// 새로 등록할 위험작업번호 보여주기
	edt_DangerJobStsFlag.Text = "00";
	edt_DangerJobStsFlagNm.Text = "위험작업요청전";	
	ds_Multi_Re.SetColumn(0,"DANGER_JOB_STS_FLAG",'00');
	ds_Multi_Re.SetColumn(0,"DANGER_JOB_FLAG","20");	//가정관
	
	ds_DangerEqup02.ClearData();
	ds_DangerJob.ClearData();
	
	grd_DangerJob.SetCellProp("body",1,"Edit","mask");
	grd_DangerJob.SetCellProp("body",3,"Edit","mask");
	grd_DangerJob.SetCellProp("body",4,"Edit","combo");
	grd_DangerJob.SetCellProp("body",5,"Edit","none");

	edtFileList.Text = "";						// 첨부파일 초기화 
	edt_Sum.Text = "";							// 합계 초기화 
	ds_Review.ClearData();
	ds_Multi_Re_chg.ClearData();
	ds_DecideReq.ClearData();
	
	cob_MidPressCrossYn.Value = "20";

	cob_MidPressCrossYn_OnChanged();  // 중저압병행
	
	cob_Rocation_OnChanged();
	
	cob_BranchCd01.Value = cob_BranchCd.Value; // 지사셋팅
	
	cob_BranchCd01_OnChanged();
}
//-------------------------------------------------------------------------------
// 기      능   :  시공사 등록
//-------------------------------------------------------------------------------
function fn_D10_Save1()
{	
	//2011.08.22 이상목 중복된 정비보수번호와 중폐지번호가 있는지 체크 
    if (IsExistVar("MAIN_FLAG", true)) 				
    {

    	if (MAIN_FLAG == "NEW") 
		{
				fn_Request_Chk(); 
								
				if(ds_Danger.rowcount() > 0)
				{			
					alert("이미 등록된 정비보수번호입니다.");
					return false;
				}else{
				
				}
		}
	}
	

    if (IsExistVar("STOP_FLAG", true)) 				
    {

    	if (STOP_FLAG == "NEW")
    	{
				fn_Request_Chk();
								
				if(ds_Danger.rowcount() > 0)
				{
					alert("이미 등록된 중폐지번호입니다.");
					return false;
				}else{
				
				}	
		 }
	 }
	  
	if(ds_Multi_Re.GetRowType(0) == "insert")
	{
		//위험작업번호 max 값 불러오기	
		fn_max();
		var strMax = ds_Max.GetColumn(0, "MAX");
		ds_Multi_Re.SetColumn(0,"DANGER_NUM",strMax);
//		alert(strMax);		
		//ds_Multi_Re.SetColumn(0,"DANGER_NUM",ds_Max.GetColumn(0, "MAX"));
		ds_Multi_Re.SetColumn(0,"CRT_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Re.SetColumn(0,"CRT_EMPID",gfn_GetGlobalValue("G_USER_NO"));
		ds_Multi_Re.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Re.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));		
	}
	else
	{
		ds_Multi_Re.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Re.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	}		
	
	var  str_time = '';
	var  end_time = '';
		
	if (ds_DangerJob.RowCount() > 0)
	{
		str_time = ds_DangerJob.GetColumn(0,"JOB_STR_TIME");
		end_time = ds_DangerJob.GetColumn(0,"JOB_END_TIME");	
	}		
	
	for(var i=0; i<ds_DangerJob.RowCount(); i++)
	{	
		if(ds_DangerJob.GetRowType(i) == "insert")
		{
			ds_DangerJob.SetColumn(i,"DANGER_NUM",ds_Multi_Re.GetColumn(0, "DANGER_NUM"));
		}
		else if(ds_DangerJob.GetRowType(i) == "update") 
		{
			ds_DangerJob.SetColumn(i, "UPD_EMPID", gfn_GetGlobalValue("G_USER_NO"));
			ds_DangerJob.SetColumn(i, "UPD_IP",    gfn_GetLocalIpAddress());
		}	
		
		if(str_time > ds_DangerJob.GetColumn(i,"JOB_STR_TIME"))
		{
			str_time = ds_DangerJob.GetColumn(i,"JOB_STR_TIME");
		}
			
		if(end_time < ds_DangerJob.GetColumn(i,"JOB_END_TIME"))
		{
			end_time = ds_DangerJob.GetColumn(i,"JOB_END_TIME");
		}		
	}
	
	ds_Multi_Re.SetColumn(0,"JOB_REQ_STR_TIME", str_time); // 작업요청시간 (시작)
	ds_Multi_Re.SetColumn(0,"JOB_REQ_END_TIME", end_time); // 작업요청시간 (종료)


	if(str_time == '' || end_time =='')
	{
		alert("작업계획을 등록 후 저장 하세요.. ");
		return;
	}
	
	fn_D10_DangerEqup(); //안전장비(값 넘겨주기)
	
	// 3. 안전장비
	for(var i=0; i<ds_DangerEqup01.RowCount(); i++)
	{
		if(ds_DangerEqup02.GetColumn(i,"EQUIP_QTY") == "" ||ds_DangerEqup02.GetColumn(i,"EQUIP_QTY") == null){
			ds_DangerEqup02.SetRowType(i,"insert");
			ds_DangerEqup02.AddRow();
			ds_DangerEqup02.SetColumn(i,"CRT_IP",gfn_GetGlobalValue("G_IPADDRESS"));	
			ds_DangerEqup02.SetColumn(i,"CRT_EMPID",gfn_GetGlobalValue("G_USER_NO"));	
			
		}else
		{
			ds_DangerEqup02.SetRowType(i,"update");
		}

		ds_DangerEqup02.SetColumn(i,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));	
		ds_DangerEqup02.SetColumn(i,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));	

		ds_DangerEqup02.SetColumn(i,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM"));
		ds_DangerEqup02.SetColumn(i,"EQUIP_QTY",ds_DangerEqup01.GetColumn(i,"EQUIP_QTY"));
		ds_DangerEqup02.SetColumn(i,"EQUIP_CD",ds_DangerEqup01.GetColumn(i,"EQUIP_CD"));
		ds_DangerEqup02.SetColumn(i,"DANGER_JOB_FLAG","20");
		ds_DangerEqup02.SetColumn(i,"EQUIP_USER_FLAG","01");	
	}
	
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_Multi_Re.GetColumn(0,"DANGER_NUM"); //위험작업번호

	var strSvcID = "fn_D10_Save1";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";
	var strInDatasets  = "ds_Multi_Re=ds_Multi_Re:u ds_DangerJob=ds_DangerJob:u ds_DangerEqup02=ds_DangerEqup02:u";
	var strOutDatasets  = "";
	var strArgument  = "save=1";	
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
		fn_CommonSearch();	
	}				  
}

//-------------------------------------------------------------------------------
// 함수명   : fn_max()
// 설명     : 위험작업번호의 max 값 조회
// return 내용 : 
//-------------------------------------------------------------------------------
function fn_max()
{   
    ds_Max.ClearData();
    
	var strSvcID = "find_max";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Max=ds_Max";
	var strArgument  = "max=1";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}

function fn_D10_DangerEqup()
{	
	ds_DangerEqup01.SetColumn(0,"EQUIP_QTY",Grid2.GetCellValue(0,1));
	ds_DangerEqup01.SetColumn(1,"EQUIP_QTY",Grid2.GetCellValue(0,3));
	ds_DangerEqup01.SetColumn(2,"EQUIP_QTY",Grid2.GetCellValue(1,1));
	ds_DangerEqup01.SetColumn(3,"EQUIP_QTY",Grid2.GetCellValue(1,3));
	ds_DangerEqup01.SetColumn(4,"EQUIP_QTY",Grid2.GetCellValue(2,1));
	ds_DangerEqup01.SetColumn(5,"EQUIP_QTY",Grid2.GetCellValue(2,3));
	ds_DangerEqup01.SetColumn(6,"EQUIP_QTY",Grid2.GetCellValue(3,1));
	ds_DangerEqup01.SetColumn(7,"EQUIP_QTY",Grid2.GetCellValue(3,3));	
	ds_DangerEqup01.SetColumn(8,"EQUIP_QTY",Grid2.GetCellValue(4,1));
	ds_DangerEqup01.SetColumn(9,"EQUIP_QTY",Grid2.GetCellValue(4,3));	
}

/********************************************************************************
* 기      능   :  지사_구 콤보 
********************************************************************************/
function cob_BranchCd_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex) 
{
    
    fn_SetComboBox_Comcode("1", cob_BranchCd.value, fn_setDsObject_Comcode("1", "cob_ZipNo1"));
    cob_ZipNo1.Value = "";
    //gfn_D1_SetComboBox_Teamcd("ds_Team", cob_BranchCd);
    
    // 2013.06.26. 이건민 - 권기철 과장님 요청사항으로 주석처리
    //gfn_D1_SetComboBox_Teamcd_all("ds_Team", cob_BranchCd);
    
    // 2013.06.26. 이건민 - 권기철 과장님 요청사항(지사 선택 시 팀정보에 공사관리팀, 수요개발팀 빼기)
    gfn_D1_SetComboBox_Teamcd("ds_Team", cob_BranchCd);
    cob_TeamCdSearch.Value = "";    
    
    
    ds_Multi.ClearData();

}

/*===============================================================================
 * 기      능   :  지사내의 팀장조회
===============================================================================*/
function fn_D1_SearchDetailTeamUserList()	
{	
	var strSvcID = "fn_D1_SearchDetailTeamUserList";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_User=ds_Multi_User";
	var strArgument  = "user=1";
	    strArgument += " BRANCH_CD=" +quote(cob_BranchCd01.Value);
	    
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}

//-------------------------------------------------------------------------------
// 기      능   :  파일첨부 조회
//-------------------------------------------------------------------------------
function fn_File_List()
{	

	ds_FileList.ClearData();
	
	var strWORK_FLAG = "10";	
	
	var strSvcID = "findFile";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets = "ds_FileList=ds_FileList";
	var strArgument    = "findFile=1";
	    strArgument   += " DANGER_NUM=" + quote(danger_num);
		strArgument	  += " DANGER_JOB_FLAG=" +quote(danger_job_flag);
		strArgument	  += " WORK_FLAG=" + quote(strWORK_FLAG);
			
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
	
	edtFileList.text = "";
	for(var i=0; i<ds_FileList.RowCount(); i++)
	{
		edtFileList.text += ds_FileList.GetColumn(i,"ORG_FILE_NAME");
		if(ds_FileList.RowCount()-1 != i) edtFileList.text += "/";
	}
}

//-------------------------------------------------------------------------------
// 기      능   :  위험작업 요청(버튼 클릭시 상태값 강제 01) 변경
//-------------------------------------------------------------------------------
function Btn_Danger_Req_OnClick(obj)
{   
	danger_job_str_flag = ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG");

	if(danger_job_str_flag == "00" || danger_job_str_flag == "02" )
	{	
		if(Confirm("위험작업 요청을 하시겠습니까? ") == true)
		{
			ds_Review.UpdateControl = false;
			ds_Review.SetRowType(0,"update");
			
			ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","01");
			ds_Review.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));   
			ds_Review.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));   
			ds_Review.SetColumn(0,"DANGER_NUM",danger_num);  
			ds_Review.SetColumn(0,"DANGER_JOB_FLAG","20");  //가정관
			
			ds_Review.SetColumn(0,"REVIEW_EMPID","");  //검토자
			ds_Review.SetColumn(0,"REVIEW_YMD","");  //검토일자
			ds_Review.SetColumn(0,"REVIEW_OPINI","");  //검토내용
			ds_Review.SetColumn(0,"REVIEW_FLAG","");  //검토여부
			
			fn_update2();
		}
	}
	else
	{
		alert("이미 위험작업 요청을 하였습니다.");
		return;
	}
}

//-------------------------------------------------------------------------------
// 기      능   :  접수,검토시 업데이트 (검토시 04, 반려시 02)
//-------------------------------------------------------------------------------
function fn_update2()
{   
	// edt_ReviewEmpidNm.Text = gfn_GetGlobalValue("G_NAME");
	// edt_ReviewEmpid.Text = 
	// cal_ReviewYmd.Value = ;
	
	// var strDANGER_NUM      = ds_Multi_Re.GetColumn(0,"DANGER_NUM");
	// var strDANGER_JOB_FLAG = ds_Multi_Re.GetColumn(0,"DANGER_JOB_FLAG");
	// var strJOB_REQ_YMD1    = ds_Multi_Re.GetColumn(0,"JOB_REQ_YMD1");
	
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_Multi_Re.GetColumn(0,"DANGER_NUM"); //위험작업번호	
	
	var strSvcID = "review_return";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";
	var strInDatasets  = "ds_Review=ds_Review:u";
	var strOutDatasets = "";
	var strArgument  = "review_return=1";
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
		fn_CommonSearch();	
	}				  
}

//-------------------------------------------------------------------------------
// 기      능   :  주소검색 등록
//-------------------------------------------------------------------------------
//-------------------------------------------------------------------------------
// 함수명   : fn_ZipSearch()
// 설명     : 주소 검색 팝업
// return 내용 : 
//-------------------------------------------------------------------------------	
function fn_ZipSearch(obj)
{
	var arrList = gfn_Dialog("A10", "A1101020010U", "", 1100, 600, true, -1, -1);
	if(arrList == "" || arrList == null || arrList ==0){
		return;
	} 
	
	//지번주소
	edt_Zip_Seq    .Text = arrList[0];            // "주소일련번호"
	edt_Zip1 	   .Text = arrList[2];            // "우편번호1"
	edt_Zip2 	   .Text = arrList[3];            // "우편번호2"
	edt_Hill	   .Text = arrList[10];           // "산번지"
	edt_Addr_M     .Text = arrList[11];           // "본번"
	edt_Addr_S     .Text = arrList[12];           // "지번"
	
	edt_SecondAddr .Text = arrList[13];     	  // "보조주소"
	edt_Bld_Ding   .Text = arrList[14];           // "동"
	edt_Hosu       .Text = arrList[15];           // "호수"
	edt_LotNumUnion.Text = arrList[17];           // "지번주소조합";
			
	//새주소
	edt_New_Addr_Bld_Seq.Text	= arrList[18];    // "주소일련번호";
	edt_New_Hosu	    .Text   = arrList[21];    // "호수";
	edt_Addr_Union	    .Text	= arrList[23];    // "새주소조합";
	  
}

function btn_AddrSearch_OnClick(obj)
{
	fn_ZipSearch(obj);
	// fn_D1_FindBranchCd();
	// cob_BranchCd01.Value = ds_BranchCd.GetColumn(0,"BRANCH_CD");
	// cob_BranchCd01_OnChanged();
}
//-------------------------------------------------------------------------------
// 함수명   : fn_D1_FindBranchCd()
// 설명     : 지사코드 가져오기 
// return 내용 : 
//-------------------------------------------------------------------------------
function fn_D1_FindBranchCd()
{	
	var strSvcID = "findbranchcd";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_BranchCd=ds_BranchCd";
	var strArgument  = "branchcd=1";
		strArgument	+= " CODE_ITEM=" + quote(edt_Zip1.Text);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}

//-------------------------------------------------------------------------------
// 기      능   :  chk_Change 체크 버튼 구분
//-------------------------------------------------------------------------------

// 반려
function chk_Change3_OnClick(obj,strValue)
{
	if(chk_Change3.Value == 1){
	
		/* 2011.08.22  이상목 같은 팀원만 가능하던걸 뺌
		if ((gfn_GetGlobalValue("G_USER_NO") != "199443297") && (gfn_GetGlobalValue("G_DEPT_NAME") != cob_TeamCd.Text))
		{
			alert("검토 및 결재는 " + cob_TeamCd.Text + "팀원만 가능합니다.");
			chk_Change3.Value = 0;
			return;
		}		
		*/
		if(confirm("검토 반려를 하시겠습니까?"))
		{
			ds_Review.UpdateControl = false;
			ds_Review.SetRowType(0,"update");
			
			ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","02");
			ds_Review.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));   
			ds_Review.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));  
			ds_Review.SetColumn(0,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM")); 
			ds_Review.SetColumn(0,"DANGER_JOB_FLAG","20");
			
			ds_Review.SetColumn(0,"REVIEW_FLAG","N");
			ds_Review.SetColumn(0,"REVIEW_YMD",today());  //검토일자
			ds_Review.SetColumn(0,"REVIEW_OPINI",edt_ReviewOpni.Text);  //검토내용
			ds_Review.SetColumn(0,"REVIEW_EMPID",gfn_GetGlobalValue("G_USER_NO"));  //검토자
		
			fn_update2();  // 검토			
		}
		else
		{
			chk_Change3.Value = 0;
		}
	}
}

//-------------------------------------------------------------------------------
// 기      능   :  위험작업 허가기준 보기(POPUP)
//-------------------------------------------------------------------------------
function btn_DangerWork_OnClick(obj)
{
	gfn_Dialog("D10","D1502010013U","",660,376,true,-1,-1);
}

//-------------------------------------------------------------------------------
// 기      능   :  logic 공통부분 빼기
//-------------------------------------------------------------------------------
function fn_D10_Common_Review()  		//검토 승인/반려 부분
{
	ds_Review.ClearData();
	ds_Review.AddRow();
	
	ds_Review.SetColumn(0,"REVIEW_EMPID_NM", ds_Multi_Re.GetColumn(0,"REVIEW_EMPID_NM"));
	ds_Review.SetColumn(0,"REVIEW_EMPID",    ds_Multi_Re.GetColumn(0,"REVIEW_EMPID"));
	ds_Review.SetColumn(0,"REVIEW_YMD",      ds_Multi_Re.GetColumn(0,"REVIEW_YMD"));
	ds_Review.SetColumn(0,"REVIEW_OPINI",    ds_Multi_Re.GetColumn(0,"REVIEW_OPINI"));	
	
	// 검토, 반려
	if( ds_Multi_Re.GetColumn(0,"REVIEW_FLAG") == 'Y' ) 
	{
		chk_Change3.Value = 0;			
	}
	else if(ds_Multi_Re.GetColumn(0,"REVIEW_FLAG") == 'N' )
	{
		chk_Change3.Value = 1;			
	}
	else
	{
		chk_Change3.Value = 0;			
	}		
}

function fn_D10_Common_DecideReq()		//결재/반려 부분
{
	ds_DecideReq.ClearData();
	ds_DecideReq.AddRow();
	
	ds_DecideReq.SetColumn(0,"DECIDE_EMPID_NM",  ds_Multi_Re.GetColumn(0,"DECIDE_EMPID_NM"));
	ds_DecideReq.SetColumn(0,"DECIDE_EMPID",     ds_Multi_Re.GetColumn(0,"DECIDE_EMPID"));
	ds_DecideReq.SetColumn(0,"DECIDE_YMD",       ds_Multi_Re.GetColumn(0,"DECIDE_YMD"));
	ds_DecideReq.SetColumn(0,"DECIDE_RTURN_WHY", ds_Multi_Re.GetColumn(0,"DECIDE_RTURN_WHY"));
	ds_DecideReq.SetColumn(0,"DECIDE_RTURN_WHY_NM", ds_Multi_Re.GetColumn(0,"DECIDE_RTURN_WHY_NM"));
	
	
/*  결재상태 (A10411)
0 - 승인
1 - 작성
2 - 결재중
5 - 반려 */
	
}
function fn_D10_Common_ReqChange()		//변경 승인 부분 
{
	ds_Multi_Re_chg.ClearData();
	ds_Multi_Re_chg.AddRow();

	ds_Multi_Re_chg.SetColumn(0,"CHG_APPRO_REQ_YMD", ds_Multi_Re.GetColumn(0,"CHG_APPRO_REQ_YMD"));
	ds_Multi_Re_chg.SetColumn(0,"CHG_APPRO_WHY",     ds_Multi_Re.GetColumn(0,"CHG_APPRO_WHY"));
	
	ds_Multi_Re_chg.SetColumn(0,"CHG_DECIDE_PROC_STS",ds_Multi_Re.GetColumn(0,"CHG_DECIDE_PROC_STS"));
	ds_Multi_Re_chg.SetColumn(0,"CHG_DECIDE_EMPID_NM",ds_Multi_Re.GetColumn(0,"CHG_DECIDE_EMPID_NM"));
	ds_Multi_Re_chg.SetColumn(0,"CHG_DECIDE_YMD",ds_Multi_Re.GetColumn(0,"CHG_DECIDE_YMD"));
	ds_Multi_Re_chg.SetColumn(0,"CHG_DECIDE_RTURN_WHY_NM",ds_Multi_Re.GetColumn(0,"CHG_DECIDE_RTURN_WHY_NM"));	
}


function fn_D10_Common_Result()				// 결과 등록부분 		
{

	ds_Multi_Re1.ClearData();
	ds_Multi_Re1.AddRow();
	
	ds_Multi_Re1.SetColumn(0,"JOB_RESULT_YMD",ds_Multi_Re.GetColumn(0,"JOB_RESULT_YMD"));
	ds_Multi_Re1.SetColumn(0,"JOB_RESULT",    ds_Multi_Re.GetColumn(0,"JOB_RESULT"));
}


// 작업결과 등록 fn_D10_Common23
function fn_D10_CommonJobResult( bType )
{
	cal_JobResultYmd.Enable = bType;
	edt_JobResult.Enable = bType;
}

function fn_D10_Common4()				//체크 버튼 값 설정 
{
	chk_Change3.Value = 0;
}
function fn_D10_Common5()				//체크 버튼 비활성화
{
	chk_Change3.Enable = false;
}	
function fn_D10_Common6()				//위험작업 내역 비활성화
{
	cob_BefoMaterFlag1.Enable = false;
	cob_BefoPipeDiamCd1.Enable = false;
	cob_BefoMaterFlag2.Enable = false;
	cob_BefoPipeDiamCd2.Enable = false;
	cob_PressFlag.Enable = false;
	cob_NewPressFlag.Enable = false;	
	
	edt_JobCnt.Enable = false;
	cob_JobMothodCd.Enable = false;
	
	cob_MidPressCrossYn.Enable = false;		
	cob_MlPressMPress.Enable = false;
	cob_MlPressLPress.Enable = false;

	btn_WorkNumButton.Enable = false;
	btn_AddrSearch.Enable = false;	
	edt_SecondAddr.Enable = false;
	cob_Rocation.Enable = false;
	cal_JobReqYmd1.Enable = false;
	//edt_JobReqStrTime.Enable = false;
	//edt_JobReqEndTime.Enable = false;
	
	Grid2.Enable = false;
	btn_ScgJoinEmpid.Enable = false;
	cob_WorkFirmTelDdd.Enable = false;
	ect_WorkFirmTelExn.Enable = false;
	edt_WorkFirmTelNum.Enable = false;
	edt_ReqNm.Enable = false;
	edt_WorkManagerNm.Enable = false;
	cob_WorkManagerTelDdd.Enable = false;
	edt_WorkManagerTelExn.Enable = false;
	edt_WorkManagerTelNum.Enable = false;
	edt_SiteChiefNm.Enable = false;
	cob_SiteChiefTelDdd.Enable = false;
	edt_SiteChiefTelExn.Enable = false;
	edt_SiteChiefTelNum.Enable = false;
	edt_NeedPers.Enable = false;
	edt_ScgJoinPers.Enable = false;
	cob_PavementKind.Enable = false;
	edt_Leng.Enable = false;
	cal_DigReqYmd.Enable = false;
	cal_RcAmtPayYmd.Enable = false;
	cal_AdmitYmd.Enable = false;
	edt_AdmitNum.Enable = false;
	cob_DirRcAmt.Enable = false;
	edt_IndRcAmt.Enable = false;
	edt_LicenseTax.Enable = false;
	edt_LeaseAmt.Enable = false;
	cal_ApproPeriodFrom.Enable = false;
	cal_ApproPeriodTo.Enable = false;
	edt_RcFirm.Enable = false;
	cob_RcType.Enable = false;
	cal_RcPlanYmd.Enable = false;
	edt_NotPermitWhy.Enable = false;
	edt_EtcRmk.Enable = false;
	//btn_FileFolder.Enable = false;			//-----------------------------첨부문서
	edt_Rmk.Enable = false;
	
	// 2013.06.17. 이건민 - 안전공급 개선사항 (공사명)
	edt_JobNm1.Enable = false;
}
function fn_D10_Common7()				//위험작업 내역 활성화
{
	
	cob_BefoMaterFlag1.Enable = true;
	cob_BefoPipeDiamCd1.Enable = true;
	cob_BefoMaterFlag2.Enable = true;
	cob_BefoPipeDiamCd2.Enable = true;
	cob_PressFlag.Enable = true;
	cob_NewPressFlag.Enable = true;
	
	edt_JobCnt.Enable = true;
	cob_JobMothodCd.Enable = true;
		
	cob_MidPressCrossYn.Enable = true;		
	//cob_MlPressMPress.Enable = true;
	cob_MlPressLPress.Enable = true;
	btn_WorkNumButton.Enable = true;
	btn_AddrSearch.Enable = true;
	edt_SecondAddr.Enable = true;
	cob_Rocation.Enable = true;
	cal_JobReqYmd1.Enable = true;
	//edt_JobReqStrTime.Enable = true;
	//edt_JobReqEndTime.Enable = true;
	
	Grid2.Enable = true;
	btn_ScgJoinEmpid.Enable = true;
	cob_WorkFirmTelDdd.Enable = true;
	ect_WorkFirmTelExn.Enable = true;
	edt_WorkFirmTelNum.Enable = true;
	edt_ReqNm.Enable = true;
	edt_WorkManagerNm.Enable = true;
	cob_WorkManagerTelDdd.Enable = true;
	edt_WorkManagerTelExn.Enable = true;
	edt_WorkManagerTelNum.Enable = true;
	edt_SiteChiefNm.Enable = true;
	cob_SiteChiefTelDdd.Enable = true;
	edt_SiteChiefTelExn.Enable = true;
	edt_SiteChiefTelNum.Enable = true;
	edt_NeedPers.Enable = true;
	edt_ScgJoinPers.Enable = true;
	cob_PavementKind.Enable = true;
	edt_Leng.Enable = true;
	cal_DigReqYmd.Enable = true;
	cal_RcAmtPayYmd.Enable = true;
	cal_AdmitYmd.Enable = true;
	edt_AdmitNum.Enable = true;
	cob_DirRcAmt.Enable = true;
	edt_IndRcAmt.Enable = true;
	edt_LicenseTax.Enable = true;
	edt_LeaseAmt.Enable = true;
	cal_ApproPeriodFrom.Enable = true;
	cal_ApproPeriodTo.Enable = true;
	edt_RcFirm.Enable = true;
	cob_RcType.Enable = true;
	cal_RcPlanYmd.Enable = true;
	edt_NotPermitWhy.Enable = true;
	edt_EtcRmk.Enable = true;
	//btn_FileFolder.Enable = true;			//-----------------------------첨부문서
	edt_Rmk.Enable = true;
	
	// 2013.06.17. 이건민 - 안전공급 개선사항 (공사명)
	edt_JobNm1.Enable = true;
}
function fn_D10_Common8()				//위험장비 초기값 - 0으로 셋팅
{
	ds_DangerEqup.SetColumn(0,"EA1","0"); 
	ds_DangerEqup.SetColumn(1,"EA1","0"); 
	ds_DangerEqup.SetColumn(2,"EA1","0"); 
	ds_DangerEqup.SetColumn(3,"EA1","0");
	ds_DangerEqup.SetColumn(4,"EA1","0");
	ds_DangerEqup.SetColumn(0,"EA2","0"); 
	ds_DangerEqup.SetColumn(1,"EA2","0");
	ds_DangerEqup.SetColumn(2,"EA2","0");
	ds_DangerEqup.SetColumn(3,"EA2","0");
	ds_DangerEqup.SetColumn(4,"EA2","0");
}	
//-------------------------------------------------------------------------------
// 설명     :   validation check
//-------------------------------------------------------------------------------
function fn_D11_Validation01()
{

	var strDANGER_STOP_NUM = ds_Multi_Re.GetColumn(0, "DANGER_STOP_NUM");
	var strInput = "";
	
	if( length(trim( strDANGER_STOP_NUM )) > 0)
	{
		strInput = "Y";
	}

	if( gfn_IsNull( edt_DangerJobStsFlagNm.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","진행상태는 "));
		return 1;
	}
	if( gfn_IsNull( cob_BranchCd01.Value ) )
	{		
		alert(gfn_GetMessage("M000015","%AAA%","지사는 "));
		cob_BranchCd01.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( cal_JobReqYmd1.Value ) )
	{			
		alert(gfn_GetMessage("M000015","%AAA%","작업요청일자는 "));
		cal_JobReqYmd1.SetFocus();
		return 1;
	}
	/*
	if( gfn_IsNull( edt_JobReqStrTime.Value ) )
	{             
		alert(gfn_GetMessage("M000015","%AAA%","작업요청시작시간은 "));
		edt_JobReqStrTime.SetFocus();
		return 1;
	}	
	if( gfn_IsNull( edt_JobReqEndTime.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업요청종료시간은 "));
		edt_JobReqEndTime.SetFocus();
		return 1;
	}
	*/
	
	// 2013.06.17. 이건민 - 안전공급 개선사항 (공사명 필수 추가)
	if( gfn_IsNull( edt_JobNm1.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","공사명은 "));
		edt_JobNm1.SetFocus();
		return 1;
	}	
	
	if( gfn_IsNull( edt_LotNumUnion.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","기존 작업위치는 "));
		edt_LotNumUnion.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_MidPressCrossYn.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","중저압병행은 "));
		cob_MidPressCrossYn.SetFocus();
		return 1;
	}	 
		  	 
	if( gfn_IsNull( cob_BefoMaterFlag1.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","기존재질은 "));
		cob_BefoMaterFlag1.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_BefoPipeDiamCd1.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","기존관경은 "));
		cob_BefoPipeDiamCd1.SetFocus();
		return 1;
	}
	if( gfn_IsNull( cob_PressFlag.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","기존압력은 "));
		cob_PressFlag.SetFocus();
		return 1;
	}
		
	// 중폐지,정비보수 연계시에는 체크 안함 (2009-10-24 권과장님)
	if(strInput != "Y") 
	{
			
		if( gfn_IsNull( cob_BefoMaterFlag2.Value ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","신규재질은 "));
			cob_BefoMaterFlag2.SetFocus();
			return 1;
		}
		if( gfn_IsNull( cob_BefoPipeDiamCd2.Value ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","신규관경은 "));
			cob_BefoPipeDiamCd2.SetFocus();
			return 1;
		}	 	 	 	 	 	 
	
		if( gfn_IsNull( cob_NewPressFlag.Value ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","신규압력은 "));
			cob_NewPressFlag.SetFocus();
			return 1;
		}
	}	
	
		 	 
	if( gfn_IsNull( cob_JobMothodCd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업방법은 "));
		cob_JobMothodCd.SetFocus();
		return 1;
	}		 	 	 	 	 
	if( gfn_IsNull( edt_JobCnt.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","작업개소는 "));
		edt_JobCnt.SetFocus();
		return 1;
	}	
	
	
	if(ds_DangerJob.GetRowCount() < 1)
	{
		alert("[시간대별 작업계획]이 등록되지 않았습니다. 작성해 주세요.");
		return 1;
	}	  
	
	for(var i=0; i<ds_DangerJob.RowCount(); i++)
	{		
		if( gfn_IsNull( ds_DangerJob.GetColumn(i,"JOB_STR_TIME") ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","작업계획 시작시간은 "));
			ds_DangerJob.row = i;
			return 1;
		}	
		
		if( length(trim( ds_DangerJob.GetColumn(i,"JOB_STR_TIME") )) != 4 )
		{
			alert("작업계획 시작시간은 4자리이어야 합니다.");
			ds_DangerJob.row = i;
			return 1;		
		}
		
		if( gfn_IsNull( ds_DangerJob.GetColumn(i,"JOB_END_TIME") ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","작업계획 종료시간은 "));
			ds_DangerJob.row = i;			
			return 1;
		}		 	 	 	 	 	 	 
		
		if( length(trim( ds_DangerJob.GetColumn(i,"JOB_END_TIME") )) != 4 )
		{
			alert("작업계획 종료시간은 4자리이어야 합니다.");
			ds_DangerJob.row = i;
			return 1;		
		}		
		
		if( gfn_IsNull( ds_DangerJob.GetColumn(i,"DANGER_JOB_PLAN_CD") ) )
		{
			alert(gfn_GetMessage("M000015","%AAA%","작업계획 작업내용은 "));
			ds_DangerJob.row = i;			
			return 1;
		}	
	}
	
	//잠시대기
	// if( gfn_IsNull( edt_WorkFirmCdNm.Text ) )
	// {
		// alert(gfn_GetMessage("M000015","%AAA%","시공회사명은 "));
		// edt_WorkFirmCdNm.SetFocus();
		// return 1;
	// }
	if( gfn_IsNull( cob_WorkFirmTelDdd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공사전화번호는 "));
		cob_WorkFirmTelDdd.SetFocus();
		return 1;
	}	 
	if( gfn_IsNull( ect_WorkFirmTelExn.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공사전화번호는 "));
		ect_WorkFirmTelExn.SetFocus();
		return 1;
	}	
	if( gfn_IsNull( edt_WorkFirmTelNum.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공사전화번호는 "));
		edt_WorkFirmTelNum.SetFocus();
		return 1;
	}		

	if( gfn_IsNull( edt_WorkManagerNm.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공관리자는 "));
		edt_WorkManagerNm.SetFocus();
		return 1;
	}
	
	if( gfn_IsNull( cob_WorkManagerTelDdd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공관리자전화번호는 "));
		cob_WorkManagerTelDdd.SetFocus();
		return 1;
	}	
	if( gfn_IsNull( edt_WorkManagerTelExn.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공관리자전화번호는 "));
		edt_WorkManagerTelExn.SetFocus();
		return 1;
	}
	if( gfn_IsNull( edt_WorkManagerTelNum.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","시공관리자전화번호는 "));
		edt_WorkManagerTelNum.SetFocus();
		return 1;
	}
	
	if( gfn_IsNull( edt_SiteChiefNm.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","현장소장은 "));
		edt_SiteChiefNm.SetFocus();
		return 1;
	}
		
	if( gfn_IsNull( cob_SiteChiefTelDdd.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","현장소장전화번호는 "));
		cob_SiteChiefTelDdd.SetFocus();
		return 1;
	}	
	if( gfn_IsNull( edt_SiteChiefTelExn.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","현장소장전화번호는 "));
		edt_SiteChiefTelExn.SetFocus();
		return 1;
	}
	if( gfn_IsNull( edt_SiteChiefTelNum.Text ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","현장소장전화번호는 "));
		edt_SiteChiefTelNum.SetFocus();
		return 1;
	}	 	 
	if( gfn_IsNull( edt_NeedPers.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","소요인원은 "));
		edt_NeedPers.SetFocus();
		return 1;
	}
	
	if( gfn_IsNull( edt_ScgJoinEmpidNm.Value ) )
	{
		alert(gfn_GetMessage("M000015","%AAA%","입회자는 "));
		edt_ScgJoinEmpidNm.SetFocus();
		return 1;
	}
	 
	 // 정비보수 번호가 없으면 체크
	 //정우현과장 2010.4.6 굴착과련 사항 필수에서 제외
	 // if( gfn_IsNull( edt_DangerStopNum.Text ) )
	 // {
		 
		 // 단지외(20)	
		 // if(cob_Rocation.Value == "20")
		 // {
		 
			// if( gfn_IsNull( cob_PavementKind.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","포장종류는 "));
				// cob_PavementKind.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull(edt_Leng.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","연장은 "));
				// edt_Leng.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( cal_DigReqYmd.Value) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","굴착신청일자는 "));
				// cal_DigReqYmd.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( cal_RcAmtPayYmd.Value) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","복구비납부일은 "));
				// cal_RcAmtPayYmd.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( cal_AdmitYmd.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","허가일자는 "));
				// return 1;
			// }
			// if( gfn_IsNull( edt_AdmitNum.Text ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","허가번호는 "));
				// return 1;
			// }	
			// if( gfn_IsNull( cob_DirRcAmt.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","직접복구비는 "));
				// cob_DirRcAmt.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( edt_IndRcAmt.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","간접복구비는 "));
				// edt_IndRcAmt.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( edt_LicenseTax.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","면허세는 "));
				// edt_LicenseTax.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( edt_LeaseAmt.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","점용료는 "));
				// edt_LeaseAmt.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( cal_ApproPeriodFrom.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","승인기간은 "));
				// return 1;
			// }	
			// if( gfn_IsNull( cal_ApproPeriodTo.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","승인기간은 "));
				// return 1;
			// }	
			// if( gfn_IsNull( cob_RcType.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","복구형태는 "));
				// cob_RcType.SetFocus();
				// return 1;
			// }	
			// if( gfn_IsNull( cal_RcPlanYmd.Value ) )
			// {
				// alert(gfn_GetMessage("M000015","%AAA%","복구예정일자는 "));
				// cal_RcPlanYmd.SetFocus();
				// return 1;
			// }
			 
		 //단지내(10)	
		// }else if(cob_Rocation.Value == "10"){
			
		// }
	// }
}


function btn_AddrSearch01_OnClick(obj)
{
	var nameList = gfn_Dialog("B20","B2203050011U","",450,400,true,-1,-1);

	edt_WorkFirmCd.Text = nameList[0];
	edt_WorkFirmCdNm.Text = nameList[1];
}

// 안전수칙
function btn_Safety_OnClick(obj)
{
	
	if(gfn_IsNull(edt_DangerNum.Text))
	{
		alert("등록된 위험작업이 없습니다. 데이터를 저장후 진행바랍니다.");
		return;
	}
	
	var strDangerNum = ds_Multi_Re.GetColumn(0,"DANGER_NUM");
	var strDANGER_JOB_FLAG = "20";
	
	var args = "WORK_FIRM_CD=" + quote(edt_WorkFirmCdNm.Text)
	        + " SITE_CHIEF_NM=" + quote(edt_SiteChiefNm.Text)
	        + " DANGER_NUM=" + quote(strDangerNum)
	        + " DANGER_JOB_FLAG=" + quote(strDANGER_JOB_FLAG);
	     
	gfn_Dialog("D10","D1503010012U",args,660,280,true,-1,-1);
}

function btn_Plan_Add_OnClick(obj)
{
	if( fv_COOP_YN )
	{
		if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '00')
		{
		}
		else if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '02')
		{
			alert("작업계획 추가시 내용 추가 후 위의 저장버튼을 반드시 클릭하셔야 합니다..");
		}
		else
		{
			alert("작업계획 수정은 위험작업 요청전 및 검토반려 단계에서 가능합니다..");
			return;	
		}			
	}
	else
	{	
		if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '00' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '02')
		{	
		}
		else if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '01' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '05')
		{
			alert("작업계획 추가시 내용 추가 후 위의 저장버튼을 반드시 클릭하셔야 합니다..");	
		}
		else
		{
			alert("작업계획 수정은 위험작업 요청 및 결재반려 단계에서 가능합니다..");
			return;	
		}
	}
	
	grd_DangerJob.Enable = true;
	var row = ds_DangerJob.AddRow();
	grd_DangerJob.SetCellProp("body",1,"Edit","mask");
	grd_DangerJob.SetCellProp("body",3,"Edit","mask");
	grd_DangerJob.SetCellProp("body",4,"Edit","combo");
	grd_DangerJob.SetCellProp("body",5,"Edit","normal");
	
	ds_DangerJob.SetColumn(row, "DANGER_JOB_FLAG","20");		
	ds_DangerJob.SetColumn(row, "CRT_EMPID",   gfn_GetGlobalValue("G_USER_NO"));
	ds_DangerJob.SetColumn(row, "CRT_IP",      gfn_GetLocalIpAddress()); 
	ds_DangerJob.SetColumn(row, "UPD_EMPID",   gfn_GetGlobalValue("G_USER_NO"));	
	ds_DangerJob.SetColumn(row, "UPD_IP",      gfn_GetLocalIpAddress()); 	

	if(ds_DangerJob.GetRowCount() == 1)
	{
		return;
	}
	else{
		ds_DangerJob.SetColumn(ds_DangerJob.row,"JOB_STR_TIME",ds_DangerJob.GetColumn(ds_DangerJob.row-1,"JOB_END_TIME"));
	}		
}

function btn_Plan_Del_OnClick(obj)
{
	if (ds_DangerJob.RowCount() == 0)
	{
		return;
	}
	
	if( fv_COOP_YN )
	{
		if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '00' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '02')
		{
			
		}
		else
		{
			alert("작업계획 수정은 위험작업 요청전 및 검토반려 단계에서 가능합니다..");
			return;	
		}			
	}
	else
	{
		if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '01' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '05')
		{
			
		}
		else
		{
			alert("작업계획 수정은 위험작업 요청 및 결재반려 단계에서 가능합니다..");
			return;	
		}
	}
	
	if(ds_DangerJob.GetRowType(ds_DangerJob.row) == "insert")
	{
		ds_DangerJob.DeleteRow(ds_DangerJob.row);
		return;
	}else if(!confirm("등록된 작업계획을 삭제하시겠습니까?"))
	{
		return;
	}
		
	ds_DangerJob.DeleteRow(ds_DangerJob.row);
	
	var  str_time = '';
	var  end_time = '';
		
	if (ds_DangerJob.RowCount() > 0 && ds_DangerJob.GetRowType(0) != "insert")
	{
		str_time = ds_DangerJob.GetColumn(0,"JOB_STR_TIME");
		end_time = ds_DangerJob.GetColumn(0,"JOB_END_TIME");	
	}		
	
	for(var i=0; i<ds_DangerJob.RowCount(); i++)
	{	
		if(ds_DangerJob.GetRowType(i) != "insert")
		{
			if(str_time > ds_DangerJob.GetColumn(i,"JOB_STR_TIME"))
			{
				str_time = ds_DangerJob.GetColumn(i,"JOB_STR_TIME");
			}
				
			if(end_time < ds_DangerJob.GetColumn(i,"JOB_END_TIME"))
			{
				end_time = ds_DangerJob.GetColumn(i,"JOB_END_TIME");
			}		
		}			
	}
	
	edt_JobReqStrTime.Text = str_time;
	edt_JobReqEndTime.Text = end_time;
	
	ds_Multi_Re.UpdateControl = false;
	ds_Multi_Re.SetRowType(0,"update");

	ds_Multi_Re.SetColumn(0, "JOB_REQ_STR_TIME",   str_time);
	ds_Multi_Re.SetColumn(0, "JOB_REQ_END_TIME",   end_time);
	
	ds_Multi_Re.SetColumn(0, "CRT_EMPID",   gfn_GetGlobalValue("G_USER_NO"));
	ds_Multi_Re.SetColumn(0, "CRT_IP",      gfn_GetLocalIpAddress()); 
	ds_Multi_Re.SetColumn(0, "UPD_EMPID",   gfn_GetGlobalValue("G_USER_NO"));	
	ds_Multi_Re.SetColumn(0, "UPD_IP",      gfn_GetLocalIpAddress()); 	
	
	var strSvcID = "jobpln_delete";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";
	var strInDatasets  = "ds_DangerJob=ds_DangerJob:u ds_Multi_Re=ds_Multi_Re:u";
	var strOutDatasets  = "";
	var strArgument  = "jobpln_delete=1";	
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  				  
	if(ErrorCode < 0)
	{    
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를")); 
	}					  		
}

function cob_DirRcAmt_OnCharChanged(obj,strPreText,strPostText)
{	
	var sum = parseInt(cob_DirRcAmt.Value)+parseInt(edt_IndRcAmt.Value)+parseInt(edt_LicenseTax.Value)+parseInt(edt_LeaseAmt.Value);
	edt_Sum.Value = sum;
}
function edt_IndRcAmt_OnCharChanged(obj,strPreText,strPostText)
{
	var sum = parseInt(cob_DirRcAmt.Value)+parseInt(edt_IndRcAmt.Value)+parseInt(edt_LicenseTax.Value)+parseInt(edt_LeaseAmt.Value);
	edt_Sum.Value = sum;	
}
function edt_LicenseTax_OnCharChanged(obj,strPreText,strPostText)
{
	var sum = parseInt(cob_DirRcAmt.Value)+parseInt(edt_IndRcAmt.Value)+parseInt(edt_LicenseTax.Value)+parseInt(edt_LeaseAmt.Value);
	edt_Sum.Value = sum;	
}
function edt_LeaseAmt_OnCharChanged(obj,strPreText,strPostText)
{
	var sum = parseInt(cob_DirRcAmt.Value)+parseInt(edt_IndRcAmt.Value)+parseInt(edt_LicenseTax.Value)+parseInt(edt_LeaseAmt.Value);
	edt_Sum.Value = sum;	
}
function edt_Sum_OnCharChanged(obj,strPreText,strPostText)
{
	edt_Sum.Value = gfn_D1_SetComma(edt_Sum.Value);
}

//파일첨부 
function btn_FileFolder_OnClick(obj)
{
	if(gfn_IsNull(edt_DangerNum.Text)){
		alert("등록된 위험작업이 없습니다. 데이터를 저장후 파일업로드를 진행바랍니다.");
		return;
	}else{

		var strEnable = "";
		
		// 등록상태(00) 반려(02)
		// 투자외부 - 위험작업요청전(00) 이전까지 수정된다.
		/*
		if( ! (danger_job_sts_flag == "00" || danger_job_sts_flag == "02") )
		{
			strEnable = "Y";	
		}
		else
		{
			// 시공사가 아닐때 막는다
			if( ! fv_COOP_YN )
			{
				strEnable = "Y";			
			}
		}
		*/
		
		// 2010-03-02 무조건 푼다. - 권기철과장
		strEnable = "";

		var arg = "fa_Url=handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service&DANGER_NUM="+danger_num+"&DANGER_JOB_FLAG=20&WORK_FLAG=10 fa_Part=D10 fa_Enable="+strEnable;
		var arrList = gfn_Dialog("D10","D1101010018U",arg,450,280,true,-1,-1);
		edtFileList.text = "";
		for(var i=0; i<arrList.length; i++)
		{
			edtFileList.text += arrList[i];
			if(arrList.length-1 != i) edtFileList.text += "/";
		}	
	}
}

//--------------------------------------------------------------------------------------------
//  공사번호 가져오기 
//--------------------------------------------------------------------------------------------
function btn_WorkNumButton_OnClick(obj)
{

	var strBranchCd = cob_BranchCd01.Value;
	var strArgument = "fa_BranchCd="+quote(strBranchCd);  // 지사코드
	    strArgument+= " fa_SelFlag=2";                    // 공사구분 전체(0), 투자(1), 외부(2) 
	    strArgument+= " fa_SelFlag_Enable=Y";             // 공사구분 enable 
	
	
	var workNumList = gfn_Dialog("B20","B2202010012U",strArgument,675,424,true,-1,-1);
	
	if( length( workNumList ) > 0 )
	{
		/*
		if(strBranchCd != workNumList[2] )
		{
			alert("검색한 지사와 등록하실 지사가 틀립니다. 같은지사를 선택바랍니다.");
			return;
		}
		*/
		// 외부공사인것만 체크 (영업공사 확인)
		if( workNumList[4] == '') // 공사구분
		{
			alert("가정관은 공사구분이 외부공사만 등록 가능합니다.");
			return;
		}
		
		edt_WorkNum.Text 		= workNumList[0];  // 공사번호
		edt_JobNm1.Text 		= workNumList[1];  // 공사명
		
		// 2010-03-30 (권기철과장)공사번호로 시공업체정보 가져오지 말기
		//edt_WorkFirmCd.Text   = workNumList[12]; // 업체코드
		//edt_WorkFirmCdNm.Text = workNumList[5];  // 업체명
		fn_D1_FindSearchList1();
		fn_D1_FindSearchList2();
		fn_D1_FindSearchList3();
		
		cal_DigReqYmd.Value 		=	ds_Multi_Data1.GetColumn(0,"RECEIVE_YMD");			//신청일자
		edt_AdmitNum.Text 			=	ds_Multi_Data1.GetColumn(0,"ADMIT_DOCU_NUM");		//허가번호	
		cal_AdmitYmd.Text 			=	ds_Multi_Data1.GetColumn(0,"ADMIT_YMD");			//허가일자
		cal_ApproPeriodFrom.Value 	=	ds_Multi_Data1.GetColumn(0,"ADMIT_PERIOD_FROM");	//승인기간
		cal_ApproPeriodTo.Value 	=	ds_Multi_Data1.GetColumn(0,"ADMIT_PERIOD_TO");		//승인기간
		edt_Leng.Value 				=	ds_Multi_Data2.GetColumn(0,"DIG_LENG");				//연장
		cal_RcAmtPayYmd.Value 		=	ds_Multi_Data3.GetColumn(0,"RC_AMT_PAY_YMD");		//복구납부일자	
		cob_DirRcAmt.Value 			= 	ds_Multi_Data3.GetColumn(0,"DIR_RC_AMT");			//직접복구비
		edt_IndRcAmt.Value			=	ds_Multi_Data3.GetColumn(0,"DIR_RC_AMT");			//간접복구비
		edt_LicenseTax.Value 		=	ds_Multi_Data3.GetColumn(0,"LICENSE_TAX");			//면허세
		edt_LeaseAmt.Value 			=	ds_Multi_Data3.GetColumn(0,"TOT_LEASE_AMT");		//점용료	
	
		cob_DirRcAmt_OnCharChanged();
		edt_IndRcAmt_OnCharChanged();
		edt_LicenseTax_OnCharChanged();
		edt_LeaseAmt_OnCharChanged();
		edt_Sum_OnCharChanged();	
		
		if(edt_WorkNum.Text != "" || edt_WorkNum.Text != null){
			btn_GulChak.Enable = true;
		}	
	
	}
}
//--------------------------------------------------------------------------------------------
//  시공사코드 및 명 가져오기 
//--------------------------------------------------------------------------------------------
function fn_WorkFirm_info()
{   
	ds_WorkFrimCd.Clear();
	
	var strSvcID = "FindWorkFrimInfo";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_WorkFrimCd=ds_WorkFrimCd";
	var strArgument  = "FindWorkFrimInfo=1";
		strArgument	+= " WORK_FIRM_CD=" + quote(edt_WorkFirmCd.Text);

	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}
//--------------------------------------------------------------------------------------------
//   검토 승인 후 전자 결제
//--------------------------------------------------------------------------------------------
function btn_approval_OnClick(obj)
{
	if ((gfn_GetGlobalValue("G_USER_NO") != "199443297") && (gfn_GetGlobalValue("G_DEPT_NAME") != cob_TeamCd.Text))
	{
		alert("검토 및 결재는 " + cob_TeamCd.Text + "팀원만 가능합니다.");
		return;
	}
	
	var dangernum        = ds_Multi.GetColumn(ds_Multi.row,"DANGER_NUM");
	//alert(ds_Multi.GetColumn(ds_Multi.row,"DANGER_NUM"));
	var dangerjobflag    = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_FLAG");
	//alert(dangerjobflag);
	//alert(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_FLAG"));
	var dangerjobstsflag = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG");
	//alert(dangerjobstsflag);
	//alert(ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG"));


	if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '01' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '04' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '05')
	{
		if(cob_DECIDE_PROC_STS.Value == '0' || cob_DECIDE_PROC_STS.Value == '1' || cob_DECIDE_PROC_STS.Value == '2')
		{
			 alert("현재 [" + cob_DECIDE_PROC_STS.Text + "] 입니다...");
			 return;
		}			
			
		ds_Review.UpdateControl = false;
		ds_Review.SetRowType(0,"update");
		
		ds_Review.SetColumn(0,"DANGER_JOB_STS_FLAG","04");
		ds_Review.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));   
		ds_Review.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));  
		ds_Review.SetColumn(0,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM")); 
		ds_Review.SetColumn(0,"DANGER_JOB_FLAG","20");
		
		ds_Review.SetColumn(0,"REVIEW_FLAG","Y");
		ds_Review.SetColumn(0,"REVIEW_YMD",today());  //검토일자
		ds_Review.SetColumn(0,"REVIEW_OPINI",edt_ReviewOpni.Text);  //검토내용
		ds_Review.SetColumn(0,"REVIEW_EMPID",gfn_GetGlobalValue("G_USER_NO"));  //검토자
	
		fn_update2();  // 검토					
	}	
	else
	{
		alert("검토 및 결재 요청가능 단계[작업요청 단계]가 아닙니다...");
		return;
	}
	
	gfv_callGWInfo("fmD33","d10","",2,dangernum+','+dangerjobflag);
	
	// 2012.07.09 이건민 - 권기철 과장님 추가요청 (중복으로 전자결재를 태울 수 있기 때문에 검토/전자결재 버튼 비활성화)
	btn_approval.Enable = false;
}


// 제외
function Button0_OnClick(obj)
{
	var dangernum = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_NUM");
	var dangerjobflag = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_JOB_FLAG");
	var dangerjobstsflag = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_JOB_STS_FLAG");
	gfv_callGWInfo("fmD17","d10","",2,dangernum+','+dangerjobstsflag);
}

function btn_Report_OnClick(obj)
{
	 var strTitle ="위험작업 승인서"; 
	 var strPart ="D10" ;           
	 var strReport="D1502010011P"; 
	 var strParameter="DANGER_NUM="+ ds_Multi_Re.GetColumn(0,"DANGER_NUM")    
		 +", DANGER_JOB_FLAG="+ds_Multi_Re.GetColumn(0,"DANGER_JOB_FLAG")
		 +", GUBUN=2"
     ;            
	//gfn_MultiReportPopup
	// 공통 레포트 팝업 함수 호출 
	gfn_ReportPopup(strTitle,strPart,strReport,strParameter);	
}
//-------------------------------------------------------------------------------
//	공통 버튼 클릭 - 인쇄
//-------------------------------------------------------------------------------
function fn_CommonPrint()
{
	PrintScreen(true);
}
//-------------------------------------------------------------------------------
// 설명     :   시간대별 작업계획 중복 체크
//-------------------------------------------------------------------------------
function ds_DangerJob_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == "DANGER_JOB_PLAN_CD")
	{
		var DangerJobPlanCd = ds_DangerJob.GetColumn(ds_DangerJob.row,"DANGER_JOB_PLAN_CD");
		for(var i=0; ds_DangerJob.GetRowCount()>i; i++)
		{
			if(DangerJobPlanCd == ds_DangerJob.GetColumn(i, "DANGER_JOB_PLAN_CD") && i != ds_DangerJob.row)
			{
				alert("이미 작성된 작업내용 입니다. 재입력 해주세요");
				ds_DangerJob.SetColumn(ds_DangerJob.row,"DANGER_JOB_PLAN_CD","");
				return;
			}
		}		
	}else if(strColumnID == "DANGER_SCG_PLAN_CD")
	{
		var DangerJobPlanCd = ds_DangerJob.GetColumn(ds_DangerJob.row,"DANGER_SCG_PLAN_CD");
		for(var i=0; ds_DangerJob.GetRowCount()>i; i++)
		{
			if(DangerJobPlanCd == ds_DangerJob.GetColumn(i, "DANGER_SCG_PLAN_CD") && i != ds_DangerJob.row)
			{
				alert("이미 작성된 작업내용 입니다. 재입력 해주세요");
				ds_DangerJob.SetColumn(ds_DangerJob.row,"DANGER_SCG_PLAN_CD","");
				return;
			}
		}		
	}
	else if(strColumnID == "JOB_APPRO_END_TIME")
	{
		// SCG (작업계획) 시간등록시 다음시간 자동 채우주기 (2009-10-28) 정과장님의 간곡한 부탁으로.
		var nRowNew = nRow+1;
		if ( nRowNew < ds_DangerJob.GetRowCount())
		{
			ds_DangerJob.SetColumn(nRowNew,"JOB_APPRO_STR_TIME",varNewValue);
		}
		
	}
		
}
//-------------------------------------------------------------------------------
// 설명     :   FROM ~ TO 체크 (내역)
//-------------------------------------------------------------------------------
function cal_ApproPeriodFrom_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ApproPeriodFrom.Value < today() && !gfn_IsNull(cal_ApproPeriodFrom.Value)){
		alert("승인기간 시작일자는 오늘날짜보다 작을 수 없습니다. 수정해주세요.");
		cal_ApproPeriodFrom.Value = "";
		return;	
	}
	if(cal_ApproPeriodFrom.Value !="" && cal_ApproPeriodTo.Value !="" && cal_ApproPeriodFrom.Value > cal_ApproPeriodTo.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ApproPeriodFrom.SetFocus();
		cal_ApproPeriodFrom.value = "";
		cal_ApproPeriodTo.value = "";
		return;
	}
}

function cal_ApproPeriodTo_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ApproPeriodTo.Value < today() && !gfn_IsNull(cal_ApproPeriodTo.Value)){
		alert("승인기간 종료일자는 오늘날짜보다 작을 수 없습니다. 수정해주세요.");
		cal_ApproPeriodTo.Value = "";
		return;	
	}
	if(cal_ApproPeriodFrom.Value !="" && cal_ApproPeriodTo.Value !="" && cal_ApproPeriodFrom.Value > cal_ApproPeriodTo.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ApproPeriodFrom.SetFocus();
		cal_ApproPeriodFrom.value = "";
		cal_ApproPeriodTo.value = "";		
		return;
	}
}
//-------------------------------------------------------------------------------
// 설명     :   FROM ~ TO 체크 (조회)
//-------------------------------------------------------------------------------
function cal_ReqYmdStart_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ReqYmdStart.Value !="" && cal_ReqYmdEnd.Value !="" && cal_ReqYmdStart.Value > cal_ReqYmdEnd.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ReqYmdStart.SetFocus();
		cal_ReqYmdStart.value = "";
		cal_ReqYmdEnd.value = "";
		return;
	}	
}

function cal_ReqYmdEnd_OnChanged(obj,strOldText,strNewText)
{
	if(cal_ReqYmdStart.Value !="" && cal_ReqYmdEnd.Value !="" && cal_ReqYmdStart.Value > cal_ReqYmdEnd.Value){	
		alert("TO 날짜는 FROM 날짜보다 같거나 큰값을 입력하세요.");
		cal_ReqYmdStart.SetFocus();
		cal_ReqYmdStart.value = "";
		cal_ReqYmdEnd.value = "";
		return;
	}	
}

//-------------------------------------------------------------------------------
// 설명     :   지사에 따른 팀코드 셋팅해주기
//-------------------------------------------------------------------------------
function cob_BranchCd01_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	gfn_D1_SetComboBox_Teamcd01("ds_Team_01",cob_BranchCd01);
	//cob_TeamCd.Index = 0 ;	
}


function cob_MidPressCrossYn_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	if(cob_MidPressCrossYn.Value == "10"){
		cob_MlPressMPress.Enable = true;
		cob_MlPressLPress.Enable = true;
	}else if(cob_MidPressCrossYn.Value == "20"){
		cob_MlPressMPress.Value = "";	
		cob_MlPressMPress.Enable = false;
		cob_MlPressLPress.Enable = true;	
	}
}


// SCG 입회자
function btn_ScgJoinEmpid_OnClick(obj)
{	
	if(gfn_IsNull(cob_BranchCd01.value))
	{
		alert("먼저 지사를 선택하여 주십시오.");
		return;
	}
	
	var args  = "BRANCH_CD=" + quote(cob_BranchCd01.value);
		args += " TEAM_CD="  + quote(cob_TeamCd.value);
		args += " SFALG=Y";	
				 
	var arrList = gfn_Dialog("D10","D1101020015U",args,700,400,true,-1,-1);				 
					 
	if( length( arrList ) > 0 )
	{
		// 2013.06.26. 이건민 - 권기철 과장님 요청사항 (등록한 지사와 공사담당자 지사비교 후 틀리게 되면 리턴)
		if(cob_BranchCd01.value == arrList[6])
		{
			edt_ScgJoinEmpid.Text 	= arrList[0];  // SCG담당자사번
			edt_ScgJoinEmpidNm.Text = arrList[1];  // SCG담당자명
			cob_TeamCd.Value    	= arrList[2];  // 팀
		}
		else
		{
			alert("SCG의 지사 담당자가 아닙니다.");
			return;
		}
		
		// 2013.06.26. 이건민 - 권기철 과장님 요청으로 주석처리
		/*
		edt_ScgJoinEmpid.Text = arrList[0];  // SCG담당자사번
		edt_ScgJoinEmpidNm.Text = arrList[1];  // SCG담당자명
		cob_TeamCd.Value    = arrList[2];  // 팀
		*/
	}
}
//------------------------------------------------------------------------------- 
// 함수명: fn_D1_FindSearchList()
//   설명:  등록할 항목 불러오기 (외부)
// arguments
//   return 내용: 없음
//------------------------------------------------------------------------------- 
function fn_D1_FindSearchList1()
{
	var strSvcID = "searchList1";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_Data1=ds_Multi_Data1";
	var strArgument  = "searchList1=1";
		strArgument	+= " WORK_NUM=" + quote(edt_WorkNum.Text);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}
function fn_D1_FindSearchList2()
{
	var strSvcID = "searchList2";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_Data2=ds_Multi_Data2";
	var strArgument  = "searchList2=1";
		strArgument	+= " WORK_NUM=" + quote(edt_WorkNum.Text);
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}
function fn_D1_FindSearchList3()
{
	var strSvcID = "searchList3";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Multi_Data3=ds_Multi_Data3";
	var strArgument  = "searchList3=1";
		strArgument	+= " WORK_NUM=" + quote(edt_WorkNum.Text);
		
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
}

// 굴착확인 이동
function btn_GulChak_OnClick(obj)		
{
	//굴착확인 MAIN 이동
	var strArg = "";
	gfn_NewWindow("B20","B2303010010F",strArg) ;	
	
}
//-------------------------------------------------------------------------------
//	  GIS 위치보기 
//-------------------------------------------------------------------------------
function btn_gis_OnClick(obj)
{
	var args="";

        args  = "BUNGI='01'";
        args += " GU_NM="      + quote(ds_Multi_Re.GetColumn(0, "ZIP_NO1_NM")) ;
	    args += " DONG_NM_H="  + quote(ds_Multi_Re.GetColumn(0, "TOWN"      )) ;
	    args += " FNU=" 	   + quote(ds_Multi_Re.GetColumn(0, "ADDR_M"    )) ;
	    args += " SNU=" 	   + quote(ds_Multi_Re.GetColumn(0, "ADDR_S"    )) ;
	 	
	    gfn_Dialog("D10","D1402060011U",args,1208,840,true,-1,-1);	 	
}

function cal_JobReqYmd1_OnChanged    (obj,strOldText,strNewText){			// 작업요청일 체크 
	//조건체크 제외 2010.4.5 정우현 과장 요청
	// if(cal_JobReqYmd1.Value < today() && !gfn_IsNull(cal_JobReqYmd1.Value)){
		// alert("작업요청일자가 오늘날짜보다 작을 수 없습니다. 수정해주세요.");
		// cal_JobReqYmd1.Value = "";
		// return;	
	// }	
}
function cal_RcPlanYmd_OnChanged	 (obj,strOldText,strNewText){			// 복구예정일 체크 
	if(cal_RcPlanYmd.Value < today() && !gfn_IsNull(cal_RcPlanYmd.Value)){
		alert("복구예정일이 오늘날짜보다 작을 수 없습니다. 수정해주세요.");
		cal_RcPlanYmd.Value = "";
		return;	
	}	
}
function cal_ReviewYmd_OnChanged(obj,strOldText,strNewText){										// 검토일자 체크 
	if(gfn_IsNull(cal_ReviewYmd.Value)){
		return;
	}else{
		fn_DateCheckTodayOver(obj,"검토일자");
	}	
}				
function cal_DigReqYmd_OnChanged(obj,strOldText,strNewText){										// 굴착신청일 체크 
	if(cal_DigReqYmd.Value > today() && !gfn_IsNull(cal_DigReqYmd.Value)){
		alert("굴착신청일이 오늘날짜보다 클 수 없습니다. 수정해주세요.");
		cal_DigReqYmd.Value = "";
		return;
	}
}			
function cal_RcAmtPayYmd_OnChanged(obj,strOldText,strNewText){										// 복구납부일 체크 
	if(cal_RcAmtPayYmd.Value > today() && !gfn_IsNull(cal_RcAmtPayYmd.Value)){
		alert("복구납부일이 오늘날짜보다 클 수 없습니다. 수정해주세요.");
		cal_RcAmtPayYmd.Value = "";
		return;	
	}
}			
function cal_AdmitYmd_OnChanged(obj,strOldText,strNewText){											// 허가일 체크 
	if(cal_AdmitYmd.Value > today() && !gfn_IsNull(cal_AdmitYmd.Value)){
		alert("허가일자가 오늘날짜보다 클 수 없습니다. 수정해주세요.");
		cal_AdmitYmd.Value = "";
		return;		
	}
}



// 작업요청 시간 확인
function ds_Multi_Re_OnColumnChanged(obj,nRow,strColumnID,varOldValue,varNewValue,nPivotIndex)
{
	if(strColumnID == 'JOB_REQ_STR_TIME'){
		
		if(edt_JobReqStrTime.Value == '' || edt_JobReqStrTime.Value == null){ return;}				
		if(substr(edt_JobReqStrTime.Value,0,2) > "24"){
			alert("25시 이상 입력할 수 없습니다. ");
			edt_JobReqStrTime.Value = '';
			edt_JobReqStrTime.SetFocus();
			return;
		}
		if(substr(edt_JobReqStrTime.Value,2,2) > "59"){
			alert("60분 이상 입력할 수 없습니다. ");
			edt_JobReqStrTime.Value = '';
			edt_JobReqStrTime.SetFocus();
			return;
		}		
		/*
		if(edt_JobReqEndTime.value != ''){
			if(edt_JobReqStrTime.Value > edt_JobReqEndTime.Value){
				alert("작업요청 종료시간보다 클 수 없습니다. ");
				edt_JobReqStrTime.Value = '';
				edt_JobReqStrTime.SetFocus();
				return;
			}
		}*/
	}
	
	if(strColumnID == 'JOB_REQ_END_TIME'){
				
		if(edt_JobReqEndTime.Value == '' || edt_JobReqEndTime.Value == null){
			return;
		}
		
		if(substr(edt_JobReqEndTime.Value,0,2) > "24"){
			alert("25시 이상 입력할 수 없습니다. ");
			edt_JobReqEndTime.Value = '';
			edt_JobReqEndTime.SetFocus();
			return;
		}
		if(substr(edt_JobReqEndTime.Value,2,2) > "59"){
			alert("60분 이상 입력할 수 없습니다. ");
			edt_JobReqEndTime.Value = '';
			edt_JobReqEndTime.SetFocus();
			return;
		}
		
		/*
		if(edt_JobReqStrTime.value != ''){
			if(edt_JobReqStrTime.Value > edt_JobReqEndTime.Value){
				alert("작업요청 시작시간보다 작을 수 없습니다. ");
				edt_JobReqEndTime.Value = '';
				edt_JobReqEndTime.SetFocus();
				return;
			}
		}*/
	}	
}

//-------------------------------------------------------------------------------
//	  업체평가 버튼 (MAIN 이동)
//-------------------------------------------------------------------------------
function btn_Valuation_OnClick(obj)
{
	var strWORK_NUM = ds_Multi_Re.GetColumn(0,"WORK_NUM");
	var strDANGER_NUM = ds_Multi_Re.GetColumn(0,"DANGER_NUM");
	var strDANGER_JOB_FLAG = ds_Multi_Re.GetColumn(0,"DANGER_JOB_FLAG");

	var strArg    = " fa_WorkNum=" +quote(strWORK_NUM);
	    strArg   += " fa_dangerNumPK=" +quote(strDANGER_NUM);
	    strArg   += " fa_dangerJobFlag=" +quote(strDANGER_JOB_FLAG);
	             
	//gfn_NewWindowAndExistClose("B20","B2102040010F",strArg);
	//gfn_Dialog("B20","B2102040010F",strArg,660,280,true,-1,-1);
	
	gfn_Dialog("B20","B2102040010F",strArg,1100,700,"AutoSize=false Scroll=true Resize=true",-1,270);
}

// 위치구분 변경시
function cob_Rocation_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	//trace ("cob_Rocation_OnChanged: "+cob_Rocation.Value);
	
	// 정비보수 번호가 없으면 체크
	if( gfn_IsNull( edt_DangerStopNum.Text ) )
	{
		// 단지내(10) , 사유지(30)	
		if(length(trim(cob_Rocation.Value)) == 0 || cob_Rocation.Value == "10" || cob_Rocation.Value == "30" )
		{		
		//trace ("10 cob_Rocation_OnChanged: "+cob_Rocation.Value);		
			cob_PavementKind.Enable = false;   // 포장종류
			edt_Leng.Enable = false;           // 연장
			cal_DigReqYmd.Enable = false;      // 굴착신청일자
			cal_RcAmtPayYmd.Enable = false;    // 복구비납부일 
			cal_AdmitYmd.Enable = false;       // 허가일자
			edt_AdmitNum.Enable = false;       // 허가번호
			cob_DirRcAmt.Enable = false;       // 직업복구비 
			edt_IndRcAmt.Enable = false;       // 간접복구비
			edt_LicenseTax.Enable = false;     // 면허세
			edt_LeaseAmt.Enable = false;       // 점용료
			//edt_Sum.Enable = false;            // 합계
			cal_ApproPeriodFrom.Enable = false;// 승인기간(From)
			cal_ApproPeriodTo.Enable = false;  // 승인기간(To)
			edt_RcFirm.Enable = false;         // 복구업체
			cob_RcType.Enable = false;         // 복구형태
			cal_RcPlanYmd.Enable = false;      // 복구예정일자
			edt_NotPermitWhy.Enable = false;   // 불가사유
			edt_EtcRmk.Enable = false;         // 기타사항
			
			cob_PavementKind.Value    = '';  // 포장종류        
			edt_Leng.Text             = '';  // 연장            
			cal_DigReqYmd.Value       = '';  // 굴착신청일자    
			cal_RcAmtPayYmd.Value     = '';  // 복구비납부일    
			cal_AdmitYmd.Value        = '';  // 허가일자        
			edt_AdmitNum.Text         = '';  // 허가번호        
			cob_DirRcAmt.Value        = '';  // 직업복구비      
			edt_IndRcAmt.Text         = '';  // 간접복구비      
			edt_LicenseTax.Text       = '';  // 면허세          
			edt_LeaseAmt.Text         = '';  // 점용료          
			edt_Sum.Text              = '';  // 합계            
			cal_ApproPeriodFrom.Value = '';  // 승인기간(From)
			cal_ApproPeriodTo.Value   = '';  // 승인기간(To)  
			edt_RcFirm.Text           = '';  // 복구업체      
			cob_RcType.Value          = '';  // 복구형태      
			cal_RcPlanYmd.Value       = '';  // 복구예정일자  
			edt_NotPermitWhy.Text     = '';  // 불가사유      
			edt_EtcRmk.Text           = '';	 // 기타사항  		
		}
		else if(cob_Rocation.Value == "20") 	// 단지외(20)	
		{		
	//trace ("20 cob_Rocation_OnChanged: "+cob_Rocation.Value);
			cob_PavementKind.Enable = true;     // 포장종류        
			edt_Leng.Enable = true;             // 연장            
			cal_DigReqYmd.Enable = true;        // 굴착신청일자    
			cal_RcAmtPayYmd.Enable = true;      // 복구비납부일    
			cal_AdmitYmd.Enable = true;         // 허가일자        
			edt_AdmitNum.Enable = true;         // 허가번호        
			cob_DirRcAmt.Enable = true;         // 직업복구비      
			edt_IndRcAmt.Enable = true;         // 간접복구비      
			edt_LicenseTax.Enable = true;       // 면허세          
			edt_LeaseAmt.Enable = true;         // 점용료          
			//edt_Sum.Enable = true;              // 합계            
			cal_ApproPeriodFrom.Enable = true;  // 승인기간(From)
			cal_ApproPeriodTo.Enable = true;    // 승인기간(To)  
			edt_RcFirm.Enable = true;           // 복구업체      
			cob_RcType.Enable = true;           // 복구형태      
			cal_RcPlanYmd.Enable = true;        // 복구예정일자  
			edt_NotPermitWhy.Enable = true;     // 불가사유      
			edt_EtcRmk.Enable = true;	        // 기타사항  
		}
	}
	else
	{
			cob_PavementKind.Enable = false;   // 포장종류
			edt_Leng.Enable = false;           // 연장
			cal_DigReqYmd.Enable = false;      // 굴착신청일자
			cal_RcAmtPayYmd.Enable = false;    // 복구비납부일 
			cal_AdmitYmd.Enable = false;       // 허가일자
			edt_AdmitNum.Enable = false;       // 허가번호
			cob_DirRcAmt.Enable = false;       // 직업복구비 
			edt_IndRcAmt.Enable = false;       // 간접복구비
			edt_LicenseTax.Enable = false;     // 면허세
			edt_LeaseAmt.Enable = false;       // 점용료
			//edt_Sum.Enable = false;            // 합계
			cal_ApproPeriodFrom.Enable = false;// 승인기간(From)
			cal_ApproPeriodTo.Enable = false;  // 승인기간(To)
			edt_RcFirm.Enable = false;         // 복구업체
			cob_RcType.Enable = false;         // 복구형태
			cal_RcPlanYmd.Enable = false;      // 복구예정일자
			edt_NotPermitWhy.Enable = false;   // 불가사유
			edt_EtcRmk.Enable = false;         // 기타사항
			
			cob_PavementKind.Value    = '';  // 포장종류        
			edt_Leng.Text             = '';  // 연장            
			cal_DigReqYmd.Value       = '';  // 굴착신청일자    
			cal_RcAmtPayYmd.Value     = '';  // 복구비납부일    
			cal_AdmitYmd.Value        = '';  // 허가일자        
			edt_AdmitNum.Text         = '';  // 허가번호        
			cob_DirRcAmt.Value        = '';  // 직업복구비      
			edt_IndRcAmt.Text         = '';  // 간접복구비      
			edt_LicenseTax.Text       = '';  // 면허세          
			edt_LeaseAmt.Text         = '';  // 점용료          
			edt_Sum.Text              = '';  // 합계            
			cal_ApproPeriodFrom.Value = '';  // 승인기간(From)
			cal_ApproPeriodTo.Value   = '';  // 승인기간(To)  
			edt_RcFirm.Text           = '';  // 복구업체      
			cob_RcType.Value          = '';  // 복구형태      
			cal_RcPlanYmd.Value       = '';  // 복구예정일자  
			edt_NotPermitWhy.Text     = '';  // 불가사유      
			edt_EtcRmk.Text           = '';	 // 기타사항  	
	}	
}
//-------------------------------------------------------------------------------
//	공통 버튼 클릭 - 삭제
//-------------------------------------------------------------------------------
function fn_CommonDeleteRow()
{
	if(ds_Multi.RowCount() == 0)
	{
		alert("삭제할 데이터가 존재하지 않습니다.");
		return;
	}
	else
	{		
		
		if(danger_job_sts_flag == "00" || danger_job_sts_flag == "02")
		{
		
			if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_NUM") != "")
			{
				//2012.05.03 권기철 과장님 추가요청_이건민
				if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "30")
				{
					alert("중폐지 진행 상태가 ["+ ds_Multi.GetColumn(ds_Multi.row, "DANGER_JOB_STS_FLAG_NM") + "] 로 삭제가 불가능합니다.\n중폐지작업을 삭제 하시면 삭제가 됩니다.");
					return;
				}else if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "40"){
					alert("정비보수 진행 상태가 ["+ ds_Multi.GetColumn(ds_Multi.row, "MAINTER_STS_FLAG_NM") + "] 로 삭제가 불가능합니다.\n정비보수작업을 삭제 하시면 삭제가 됩니다.");
					return;
				}
				
				//2012.05.03 권기철 과장님 추가요청으로 주석처리_이건민
				/*	
				if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "30")
				{
					alert("중폐지작업이 연계되어 있어 삭제할수 없습니다 중폐지작업을 삭제 하시면 삭제가 됩니다.");
					return;
				}else if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "40"){
					alert("정비보수작업이 연계되어 있어 삭제할수 없습니다 정비보수작업을 삭제 하시면 삭제가 됩니다.");
					return;
				}
				*/
			}
				
			if(confirm("작성된 위험작업 내역을 삭제하시겠습니까?"))
			{
				ds_Multi.DeleteRow(ds_Multi.row);
				
				var strSvcID        = "delete";
				var strPart         = "D10";
				var strURL          = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
				var strInDatasets   = "ds_Multi=ds_Multi:u";
				var strOutDatasets  = "";
				var strArgument     = "deleteMain=1";	
				//var strCallbackFunc = "fn_D1_CallBack";
				
				gfn_SyncCall(strSvcID,
						  strPart,
						  strURL,
						  strInDatasets,
						  strOutDatasets,
						  strArgument,
						 );
						 
				if(ErrorCode < 0)
				{    
					alert(ErrorMsg);
					return;
				}
				else
				{
					gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"),"black",true); 
					alert(gfn_GetMessage("M000009","%AAA%","정상적으로 삭제를"));
					fn_CommonSearch();
				}	
			}		
		}
		else
		{
			alert("진행상태가 위험작업요청전 상태만 삭제가 가능합니다. 시스템관리자에게 문의바랍니다. ");
			return;
		}
	}
}

/*===============================================================================
 * 기      능   :  공통 Excel
===============================================================================*/
function fn_CommonExcelExport()
{
	ds_Multi_Excel.ClearData();
	
    ds_SearchTop.SetColumn(0,"BRANCH_CD"          , cob_BranchCd.Value        );  // 지사
    ds_SearchTop.SetColumn(0,"ZIP_NO1"            , cob_ZipNo1.Value          );  // 시/구
    ds_SearchTop.SetColumn(0,"TEAM_CD"            , cob_TeamCdSearch.Value    );  // 팀
    ds_SearchTop.SetColumn(0,"REQ_YMD_START"      , cal_ReqYmdStart.Value     );  // 작업요청일자
    ds_SearchTop.SetColumn(0,"REQ_YMD_END"        , cal_ReqYmdEnd.Value       );  // 작업요청일자
    //ds_SearchTop.SetColumn(0,"JOB_NM"             , edt_JobNm.Text            );  // 작업명
	ds_SearchTop.SetColumn(0,"DANGER_JOB_STS_FLAG", cob_DangerJobStsFlag.Value);  // 진행상태
	ds_SearchTop.SetColumn(0,"WORK_FIRM_CD"       , edt_WorkFirmCdSearch.Text );  // 시공사

	
	var strSvcID = "findExcel";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_SearchTop=ds_SearchTop";
	var strOutDatasets = "ds_Multi_Excel=ds_Multi_Excel";
	var strArgument  = "excel=1";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   			   
	var SearchCondition= "";
    SearchCondition = SearchCondition + "지사코드 :" + RPad(cob_BranchCd.Text," ",20);
    SearchCondition = SearchCondition + "시/구 :" + RPad(cob_ZipNo1.Text," ",20);
    SearchCondition = SearchCondition + "시공사 :" + RPad(edt_WorkFirmNmSearch.Text," ",20);
    SearchCondition = SearchCondition + "공사진행상태 :" + RPad(cob_DangerJobStsFlag.Text," ",20);
    SearchCondition = SearchCondition + "작업요청일자 :" + RPad(cal_ReqYmdStart.Value +" ~ "+ cal_ReqYmdEnd.Value," ",20);
    //SearchCondition = SearchCondition + "위험작업명 :" + RPad(edt_JobNm.Text," ",20); 
    
    gfn_ExportExcel("위험작업 가정관 조회", 5, SearchCondition, "grd_ExcelList"); 	
}

//-------------------------------------------------------------------------------
//	  재질에 따른 관경정보 셋팅 
//-------------------------------------------------------------------------------
function cob_BefoMaterFlag_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	var MaterFlag = obj.Value ;
	var PipeFlag  = '';
	
	if(obj == eval("cob_BefoMaterFlag1")) {
		PipeFlag = "cob_BefoPipeDiamCd1";
		cob_BefoPipeDiamCd1.Enable = true;
	}
	if(obj == eval("cob_BefoMaterFlag2")) {
		PipeFlag = "cob_BefoPipeDiamCd2";
		cob_BefoPipeDiamCd2.Enable = true;
	}
	
	switch(MaterFlag){
		//10 PLP : D10300
		case "10" : gfn_SetComboBox_Comcode("D10300",gfn_setDsObject_Comcode(PipeFlag));	
		break;
		//20 PE : D10301
		case "20" : gfn_SetComboBox_Comcode("D10301",gfn_setDsObject_Comcode(PipeFlag));	
		break;
		//30 ZS : D10302
		case "30" : gfn_SetComboBox_Comcode("D10302",gfn_setDsObject_Comcode(PipeFlag));	
		break;
		//40 AS : D10303
		case "40" : gfn_SetComboBox_Comcode("D10303",gfn_setDsObject_Comcode(PipeFlag));	
		break;
		//50 PT : D10304
		case "50" : gfn_SetComboBox_Comcode("D10304",gfn_setDsObject_Comcode(PipeFlag));	
		break;
	}
}
//-------------------------------------------------------------------------------------------------------
// 기존압력구분 변경시 
//-------------------------------------------------------------------------------------------------------
function cob_PressFlag_OnChanged(obj,strCode,strText,nOldIndex,nNewIndex)
{
	// 압력변경시 신규압력에도 값을 복사 2009-09-29 (정과장님 추가)
	cob_NewPressFlag.Value = cob_PressFlag.Value;	
}

function grd_Main_OnHeadClick(obj,nCell,nX,nY,nPivotIndex)
{
	gfn_SetGridSort(obj, nCell);
}


// 현장입회서등록
function btn_Admission_OnClick(obj)
{
 	// 시공사이면
 	if( fv_COOP_YN )
 	{
		return;
	}
 	else
 	{
		if( ds_Multi_Re.rowcount <= 0) return;
		
		var strArg    = " fa_WorkNum=" +quote(ds_Multi_Re.GetColumn(ds_Multi_Re.row,"WORK_NUM"));
		gfn_NewWindowAndExistClose("B20","B2304010010F",strArg);
	}
}

function ds_Multi_OnLoadCompleted(obj,nErrorCode,strErrorMsg,nReason)
{
	if(nReason == 5)
	{
		ds_Multi_OnRowPosChanged();
	}
}

function brn_work_save_OnClick(obj)
{		
	if ((gfn_GetGlobalValue("G_USER_NO") != "700004008") && (gfn_GetGlobalValue("G_DEPT_NAME") != cob_TeamCd.Text))
	{
		alert("작업결과 등록은 " + cob_TeamCd.Text + "팀원만 가능합니다.");
		return;
	}
	
	if( gfn_IsNull(cal_JobResultYmd.Value) )
	{
		alert("작업일자를 입력하여 주세요.");
		cal_JobResultYmd.SetFocus();
		return;
	}
	
	// 2013.06.18. 이건민 - 안전공급 개선사항(작업일자는 요청일자 7일 또는 변경작업일자 7일)
	if(cal_ChgApproReqYmd.Value == "" || cal_ChgApproReqYmd.Value == null)
	{
		if(cal_JobResultYmd.Value < cal_JobReqYmd1.Value)
		{
			alert("작업일자는 작업요청일보다 같거나 커야 합니다.");
			cal_JobResultYmd.SetFocus();
			return;
		}
		else if(cal_JobResultYmd.Value > AddDate(cal_JobReqYmd1.Value, 7))
		{
			alert("작업일자는 작업요청 7일 이내 하셔야 합니다.");
			cal_JobResultYmd.SetFocus();
			return;
		}
		
	}else
	{
		if(cal_JobResultYmd.Value < cal_ChgApproReqYmd.Value)
		{
			alert("작업일자는 변경작업일보다 같거나 커야 합니다.");
			cal_JobResultYmd.SetFocus();
			return;
		}
		else if(cal_JobResultYmd.Value > AddDate(cal_ChgApproReqYmd.Value, 7))
		{
			alert("작업일자는 변경작업일 기준 7일 이내 하셔야 합니다.");
			cal_JobResultYmd.SetFocus();
			return;
		}
	}
		
	if( gfn_IsNull(edt_JobResult.Text) )
	{
		alert("작업결과내용을 입력하여 주세요.");
		edt_JobResult.SetFocus();
		return;
	}
	
	if(!gfn_IsNull(ds_Multi_Re.GetColumn(0, "WORK_NUM")))
	{
		alert(ds_Multi_Re.GetColumn(0, "WORK_NUM"));
		if(!fn_cust_chk_yn())
		{
			alert("업체평가가 등록되지 않았습니다. 업체평가를 먼저 하시기 바랍니다..");
			return;
		}	
	}
	
	//2013.06.11. 이건민 - 안전공급 개선사항 (안전수칙 체크여부 추가)
	if(!fn_safety_chk_yn())
	{
		alert("안전수칙이 작성되지 않았습니다. 안전수칙를 먼저 하시기 바랍니다.");
		return;
	}
	
	// 2012.08.28 이건민 - 권기철 과장님 추가요청 사항 (공사완료건에 대해서 작업결과내용 수정 가능하도록 수정요청)
	if(ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "07" || ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "08" || ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "10")	// 전자결재 승인 
	{
		fn_updateResult(); // 작업결과 등록
	}
}

//업체평가여부 check
function fn_cust_chk_yn()
{
	ds_Chk.ClearData();
	ds_Chk.AddRow();
	ds_Chk.SetColumn(0,"WORK_NUM" , ds_Multi_re.GetColumn(ds_Multi_re.Row, "WORK_NUM"));
    
	var strSvcID = "chk_yn";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequirEMgr-service";  
	var strInDatasets  = "ds_Chk=ds_Chk";
	var strOutDatasets = "ds_Chk=ds_Chk";
	var strArgument  = "chk_yn=1";    
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );			  
		   
	if(ErrorCode < 0)
	{    
		return false;
	}				   	
			
	if(ds_Chk.GetColumn(0, "CHK_CNT") == 'Y')
	{
		return true;
	}
	else
	{
		return false;
	}	
}

// 2013.06.11. 이건민 - 안전공급 개선사항 (안전수칙 체크여부)
// 안전수칙 체크여부
function fn_safety_chk_yn()
{
	var DangerNum     = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_NUM");
	var DangerJobFlag = ds_Multi_Re.GetColumn(ds_Multi_Re.row,"DANGER_JOB_FLAG");
	
	var strSvcID = "";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service&SignSearch=1"
				+"&DANGER_JOB_FLAG=" +DangerJobFlag
				+"&DANGER_NUM=" + DangerNum
				;  
	var strInDatasets  = "";
	var strOutDatasets  = "ds_Sign=ds_Sign";
	var strArgument  = "";
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );
			   	
	if( length(ds_Sign.GetColumn(0, "SIGN")) > 0 )
	{
		return true;
	}
	else
	{
		return false;
	}
}

//---------------------------------------------------------------------------------------------------------------------------5월 15일---------------
// 함수명   : fn_updateResult()
// 설명     : 결재완료시 결과등록
// return 내용 : 
//-------------------------------------------------------------------------------
function fn_updateResult()
{   
	danger_num = ds_Multi_Re.GetColumn(0,"DANGER_NUM");	
	
	ds_Multi_Re1.UpdateControl = false;
	ds_Multi_Re1.SetRowType(0,"update");
	
	ds_Multi_Re1.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS"));
	ds_Multi_Re1.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
	ds_Multi_Re1.SetColumn(0,"DANGER_NUM",danger_num);
	ds_Multi_Re1.SetColumn(0,"DANGER_JOB_FLAG","20");
		
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = danger_num; //위험작업번호	
			
	var strSvcID = "updateResult";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";
	var strInDatasets  = "ds_Multi_Re1=ds_Multi_Re1:u";
	var strOutDatasets  = "";
	var strArgument  = "updateResult=1";
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 저장을")); 
		fn_CommonSearch();
	}				  
}

function cal_ChgApproReqYmd_OnChanged(obj,strOldText,strNewText)
{
	if(gfn_IsNull(cal_ChgApproReqYmd.Value)){
		return;
	}else{
		fn_DateCheckTodayOver(obj,"변경승인일자");
	}	
}

function btn_chg_OnClick(obj)
{
	if(ds_Multi_re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "03" || ds_Multi_re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "06" || ds_Multi_re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "07")
	{
	}	
	else
	{
		alert("변경 신청단계가 아닙니다...");
		return;
	}
	
	//alert(ds_Multi_re.GetColumn(0, "DANGER_JOB_STS_FLAG") );
	
	if(ds_Multi_re.GetColumn(0, "DANGER_JOB_STS_FLAG") == "03")
	{
		if(cob_chg_state.Value == '0' || cob_chg_state.Value == '1' || cob_chg_state.Value == '2')
		{
			alert("현재 [" + cob_chg_state.Text + "] 입니다...");
			return;
		}
	}

	if ((gfn_GetGlobalValue("G_USER_NO") != "199443297") && (gfn_GetGlobalValue("G_DEPT_NAME") != cob_TeamCd.Text) && (gfn_GetGlobalValue("G_USER_NO") != "700004008"))
	{
		alert("작업일자 변경 처리는 " + cob_TeamCd.Text + "팀원만 가능합니다.");
		return;
	}		
	
	if( gfn_IsNull(cal_ChgApproReqYmd.Value) )
	{
		alert("변경 작업일자를 입력하여 주세요.");
		cal_ChgApproReqYmd.SetFocus();
		return;
	}
			
	if( gfn_IsNull(edt_ChgApproWhy.Text) )
	{
		alert("변경사유를 입력하여 주세요.");
		edt_ChgApproWhy.SetFocus();
		return;
	}

	 //변경작업일자
	fv_FindRow_ShowRow = 1;
	fv_FindRow_ShowKey = ds_Multi_Re.GetColumn(0,"DANGER_NUM");	 //위험작업번호
	//03변경요청
	//06변경결재 반려
	//07결재 승인
	
	if(ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '03' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '06' || ds_Multi_Re.GetColumn(0,"DANGER_JOB_STS_FLAG") == '07')
	{	
		//trace(ds_Multi_Ok_chg.RowCount());
		
		if(ds_Multi_Ok_chg.RowCount() >0)
		{
			ds_Multi_Ok_chg.UpdateControl = false;
			ds_Multi_Ok_chg.SetRowType(0,"update");		
		}
		else
		{
			ds_Multi_Ok_chg.ClearData();
			ds_Multi_Ok_chg.AddRow();
			ds_Multi_Ok_chg.UpdateControl = false;
			ds_Multi_Ok_chg.SetRowType(0,"insert");			
		}			
		
		ds_Multi_Re_chg.UpdateControl = false;
		ds_Multi_Re_chg.SetRowType(0,"update");
		
		ds_Multi_Re_chg.SetColumn(0,"DANGER_JOB_STS_FLAG","03");
		ds_Multi_Re_chg.SetColumn(0,"CHG_APPRO_REQ_FLAG","Y"); // 변경 체크 할경우 Y 값 강제 넣기
		ds_Multi_Re_chg.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Re_chg.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
		ds_Multi_Re_chg.SetColumn(0,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM"));
		ds_Multi_Re_chg.SetColumn(0,"DANGER_JOB_FLAG","20");
	
		ds_Multi_Re_chg.SetColumn(0,"CHG_APPRO_REQ_YMD",cal_ChgApproReqYmd.Value); 
		ds_Multi_Re_chg.SetColumn(0,"CHG_APPRO_WHY",edt_ChgApproWhy.text); 

		ds_Multi_Ok_chg.SetColumn(0,"CRT_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Ok_chg.SetColumn(0,"CRT_EMPID",gfn_GetGlobalValue("G_USER_NO"));		
		ds_Multi_Ok_chg.SetColumn(0,"UPD_IP",gfn_GetGlobalValue("G_IPADDRESS")); 
		ds_Multi_Ok_chg.SetColumn(0,"UPD_EMPID",gfn_GetGlobalValue("G_USER_NO"));
		ds_Multi_Ok_chg.SetColumn(0,"DANGER_NUM",ds_Multi_Re.GetColumn(0,"DANGER_NUM"));
		ds_Multi_Ok_chg.SetColumn(0,"DANGER_JOB_FLAG","20");   //가정관
	
		var strSvcID = "chg_danger";
		var strPart = "D10";
		var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";
		var strInDatasets  = "ds_Multi_Re_chg=ds_Multi_Re_chg:u ds_Multi_Ok_chg=ds_Multi_Ok_chg:u";
		var strOutDatasets  = "";
		var strArgument  = "chg_danger=1";	
		
		gfn_SyncCall(
						 strSvcID
					   , strPart
					   , strURL
					   , strInDatasets
					   , strOutDatasets
					   , strArgument
					  );
					  
		if(ErrorCode < 0)
		{    
			alert(ErrorMsg);
			return;
		}				  
	}
	else
	{
		alert("변경 요청 작업단계가 아닙니다..");
		return;
	}	
	
	//alert("확인 버튼을 클릭하시면 변경결재 화면으로 이동합니다..");
	cal_ChgApproReqYmd.Enable = false;
	edt_ChgApproWhy.Enable = false;
	ds_Multi.SetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG" , '03');
	
	//전자결재 처리필요...	
	var dangernum        = ds_Multi.GetColumn(ds_Multi.row,"DANGER_NUM");
	var dangerjobflag    = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_FLAG");
	var dangerjobstsflag = ds_Multi.GetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG");
	gfv_callGWInfo("fmD38","d10","",2,dangernum+','+dangerjobflag);
}

function Btn_cancel_OnClick(obj)
{ 
	if (gfn_GetGlobalValue("G_DEPT_CODE") == ds_Multi.GetColumn(ds_Multi.row,"TEAM_CD") || gfn_GetGlobalValue("G_USER_NO") == '700004008') 
	{
		if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_NUM") != "")
		{
			// 2012.05.03 권기철 과장님 추가요청_이건민
			if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "30")
			{
				alert("중폐지 진행 상태가 ["+ ds_Multi.GetColumn(ds_Multi.row, "DANGER_JOB_STS_FLAG_NM") + "] 로 취소가 불가능합니다.\n중폐지작업을 취소 하시면 삭제가 됩니다.");
				return;
			}else if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "40"){
				alert("정비보수 진행 상태가 ["+ ds_Multi.GetColumn(ds_Multi.row, "MAINTER_STS_FLAG_NM") + "] 로 취소가 불가능합니다.\n정비보수작업을 취소 하시면 삭제가 됩니다.");
				return;
			}
			
			// 2012.05.03 권기철 과장님 추가요청으로 주석처리_이건민
			/*
			if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "30")
			{
				alert("중폐지작업이 연계되어 있어 삭제할수 없습니다. 중폐지작업을 취소 하시면 취소 됩니다.");
				return;
			}else if(ds_Multi_Re.GetColumn(0,"DANGER_STOP_FLAG") == "40"){
				alert("정비보수작업이 연계되어 있어 삭제할수 없습니다. 정비보수작업을 취소 하시면 취소가 됩니다.");
				return;
			}
			*/
		}	
		
		//2012.04.23. 권기철 과장님 조건 추가로 주석처리_이건민
		/*
		if (edt_cancel_rmk.text == '')
		{
			alert("취소사유를 입력 하세요");
			return;
		} 
		
		if(confirm("취소처리하시겠습니까?"))
		{
			fn_D1_Cancel();
		}	
		else
		{
			return;
		}
		*/
		
		// 2012.04.23 권기철 과장님 추가_이건민
		if(    ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '01'	|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '03' 
			|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '04' 	|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '05'
			|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '06' 	|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '07' 
			|| ds_Multi_Re.GetColumn(0, "DANGER_JOB_STS_FLAG") == '08' )
		{
			if (edt_cancel_rmk.text == '')
			{
				alert("취소사유를 입력 하세요");
				return;
			}
			if(confirm("취소처리하시겠습니까?"))
			{
				fn_D1_Cancel();
			}
			else
			{
				return;
			}
		}
	}
	else
	{
		alert("취소는 해당 팀원만 가능합니다..");
		return;
	}		
}

//----------------------------------------------------------------------------------------------
// 함수명: fn_D1_Cancel()
// 설명:   위험작업 취소
// arguments
// return 내용: 없음
//----------------------------------------------------------------------------------------------
function fn_D1_Cancel()
{    
	ds_Cancel.ClearData();
	ds_Cancel.UpdateControl = false ;
	var row = ds_Cancel.AddRow();
	ds_Cancel.SetRowType(row, "update");
    ds_Cancel.SetColumn(row,"DANGER_NUM"  , ds_Multi.GetColumn(ds_Multi.row , "DANGER_NUM"));  // 위험작업번호
    ds_Cancel.SetColumn(row,"DANGER_JOB_FLAG"  , ds_Multi.GetColumn(ds_Multi.row , "DANGER_JOB_FLAG"));  // 위험작업구분
	ds_Cancel.SetColumn(row,"UPD_EMPID" , gfn_GetGlobalValue("G_USER_NO"));  // UPD_EMPID
	ds_Cancel.SetColumn(row,"UPD_IP"    , gfn_GetLocalIpAddress());  // UPD_IP
	ds_Cancel.SetColumn(row,"CANCEL_RMK"   , edt_cancel_rmk.Text);  // 취소사유
	ds_Cancel.SetColumn(row,"CANCEL_EMPID" , gfn_GetGlobalValue("G_USER_NO"));  // 취소자사번

	var strSvcID = "cancel";
	var strPart = "D10";
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_Cancel=ds_Cancel:u";
	var strOutDatasets  = "";
	var strArgument  = "cancel=1";	
	
	gfn_SyncCall(
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
				  );
				  
	if(ErrorCode < 0)
	{    
		alert(ErrorMsg);
		return;
	}else{
		gfn_SetStatusMsg(gfn_GetMessage("M000009","%AAA%","정상적으로 취소"),"black",true); 
		alert(gfn_GetMessage("M000009","%AAA%","정상적으로 취소")); 
		ds_Multi.SetColumn(ds_Multi.row,"DANGER_JOB_STS_FLAG" , '90');
	}				  
}

function fn_Request_Chk()
{
	ds_SearchNum.ClearData();
	ds_SearchNum.AddRow();
	ds_SearchNum.SetColumn(0,"DANGER_NUM" , ds_Multi_Re.GetColumn(ds_Multi_Re.Row, "DANGER_NUM"));
    ds_SearchNum.SetColumn(0,"DANGER_STOP_NUM" , ds_Multi_Re.GetColumn(ds_Multi_Re.Row, "DANGER_STOP_NUM"));

	var strSvcID = "chk_Request";
	var strPart = "D10";	
	var strURL = "handle.do?ServiceName=D1_DangerWorkRequiRegisHmppMgr-service";  
	var strInDatasets  = "ds_SearchNum=ds_SearchNum";
	var strOutDatasets = "ds_Danger=ds_Danger";
	var strArgument  = "chk_Request=1";    	
	
	gfn_SyncCall( 
					 strSvcID
				   , strPart
				   , strURL
				   , strInDatasets
				   , strOutDatasets
				   , strArgument
			   );			  
		   
	if(ErrorCode < 0)
	{    
		return false;
	}				   				
}
]]></Script>
</Window>